;/*FB_PKG_DELIM*/

__d("OverlayConfigLayer",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$1=a,this.$2=b}var b=a.prototype;b.getLayerSource=function(){return this.$1};b.getValue=function(a){return this.$2[a]};b.logExposure=function(a){};return a}();f["default"]=a}),66);
__d("OverlayConfigLayerBuilder",["OverlayConfigConstants","OverlayConfigLayer","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=new Array(b("OverlayConfigConstants").OverlayConfigNumParameters).fill(b("OverlayConfigConstants").OverlayConfigNotPresentFlagValue),this.$2=a}var c=a.prototype;c.build=function(){return new(b("OverlayConfigLayer"))(this.$2,this.$1)};c.$3=function(a,c){a>=b("OverlayConfigConstants").OverlayConfigNumParameters&&b("unrecoverableViolation")("Parameter ID passed in exceeds max parameter id","rtc_www"),this.$1[a]=c};c.$4=function(a,b){this.$3(a,b?1:0)};c.setExampleConfigEnabled=function(a){this.$4(0,a)};c.setExampleConfigSomeBoolean=function(a){this.$4(2,a)};c.setExampleConfigSomeOtherIntegerHasValue=function(a){this.$4(1724,a)};c.setExampleConfigSomeOtherBoolean=function(a){this.$4(2044,a)};c.setExampleConfigSomeInteger=function(a){this.$3(1,a)};c.setExampleConfigSomeOtherInteger=function(a){this.$3(3,a)};c.setExampleConfigSomeDouble=function(a){this.$3(2011,a)};c.setSimulcastOverSignalingConfigSimulcastOverSignalingEnabled=function(a){this.$4(651,a)};c.setPreferredCaptureConfigEnabled=function(a){this.$4(173,a)};c.setPreferredCaptureConfigPreferStableFps=function(a){this.$4(3919,a)};c.setPreferredCaptureConfigEnabledForZenon=function(a){this.$4(4478,a)};c.setPreferredCaptureConfigWidthPx=function(a){this.$3(174,a)};c.setPreferredCaptureConfigHeightPx=function(a){this.$3(175,a)};c.setPreferredCaptureConfigFps=function(a){this.$3(176,a)};c.setZenonSdpTransformConfigPreserveH264=function(a){this.$4(244,a)};c.setZenonSdpTransformConfigPreferH264ForMwCall=function(a){this.$4(420,a)};c.setZenonSdpTransformConfigPreferSwH264=function(a){this.$4(421,a)};c.setZenonSdpTransformConfigAddAudioNack=function(a){this.$4(245,a)};c.setZenonSdpTransformConfigDisableOpusStereo=function(a){this.$4(246,a)};c.setZenonSdpTransformConfigPreferIsacForGroupAudio=function(a){this.$4(248,a)};c.setZenonSdpTransformConfigEnableOpusFmtpMunging=function(a){this.$4(1448,a)};c.setZenonSdpTransformConfigSetOpusUsedtx=function(a){this.$4(1444,a)};c.setZenonSdpTransformConfigSetOpusUseinbandfec=function(a){this.$4(1445,a)};c.setZenonSdpTransformConfigSetOpusMaxplaybackrate=function(a){this.$3(1446,a)};c.setZenonSdpTransformConfigSetOpusMaxaveragebitrate=function(a){this.$3(1447,a)};c.setZenonPeerConnectionConfigRtpDataChannels=function(a){this.$4(302,a)};c.setZenonStartCallImmediatelyConfigEnabled=function(a){this.$4(308,a)};c.setZenonGeneralizedIdentityConfigDuplicatedParticipantsProcessingMode=function(a){this.$3(1891,a)};c.setZenonMultiCallSupportConfigMaxConnectedCalls=function(a){this.$3(309,a)};c.setZenonPlatformSupportConfigSupportsZenonPlatform=function(a){this.$4(316,a)};c.setZenonPlatformSupportConfigStartImmediatelyEnabled=function(a){this.$4(318,a)};c.setZenonPlatformSupportConfigUploadSummaryOnCallEnded=function(a){this.$4(2251,a)};c.setZenonPlatformSupportConfigMultiwayAvEscalationEnabled=function(a){this.$4(1900,a)};c.setZenonPlatformSupportConfigMaxConnectedCalls=function(a){this.$3(317,a)};c.setZenonPlatformSupportConfigParentWindowConnectionTimeoutMs=function(a){this.$3(319,a)};c.setZenonSimulcastConfigSimulcastEnabled=function(a){this.$4(453,a)};c.setDynamicRuleConfigEnabled=function(a){this.$4(1342,a)};c.setDynamicRuleConfigDebugLoggingEnabled=function(a){this.$4(1597,a)};c.setDynamicRuleConfigProcessIntervalMs=function(a){this.$3(1359,a)};c.setDynamicRuleConfigNetworkProcessIntervalMs=function(a){this.$3(1510,a)};c.setDynamicRuleConfigDebugLoggingIntervalMs=function(a){this.$3(1612,a)};c.setSignalingPingConfigPingIntervalMs=function(a){this.$3(1470,a)};return a}();e.exports=a}),null);
__d("ChromeOverlayConfigLayer",["OverlayConfigLayerBuilder","OverlayConfigLayerSource"],(function(a,b,c,d,e,f,g){"use strict";a=function(){var a=new(c("OverlayConfigLayerBuilder"))(c("OverlayConfigLayerSource").BROWSER);a.setZenonSdpTransformConfigDisableOpusStereo(!0);a.setSimulcastOverSignalingConfigSimulcastOverSignalingEnabled(!0);a.setZenonPeerConnectionConfigRtpDataChannels(!0);return a.build()}();b=a;g["default"]=b}),98);
__d("EchoConfidenceMetricsManager",["ZenonMediaActionLogger"],(function(a,b,c,d,e,f,g){"use strict";var h="ZenonEchoConfidenceMetricsManager",i="[EchoConfidenceMetricsManager]";a=function(){function a(){this.$1=!1,this.$2=null,this.$3=null,this.$4=null,this.$5=null}var b=a.prototype;b.setEnabled=function(a){this.$1=a};b.setProcessorUrl=function(a){this.$3=a};b.setAudioContext=function(a){this.$2=a,this.$4=null};b.getProcessor=async function(){if(this.$2===null)return null;if(this.$4)return this.$4;await this.$6();return this.$4};b.getAndResetEchoConfidenceMetrics=function(){if(!this.$1)return null;var a=this.$5;this.$5=null;return a};b.cleanUp=function(){var a;(a=this.$4)==null?void 0:a.port.postMessage("clean");this.$4=null};b.$6=async function(){var a=this;c("ZenonMediaActionLogger").logCheckpoint(i+" Initializing the Echo Confidence Metrics Processor!");if(!this.$2){var b="Audio Context is null when initializing the Echo Confidence Metrics Processor!";c("ZenonMediaActionLogger").logErrorToFbLogger(i+" "+b,h,null,"warn");return}if(this.$3===null||this.$3===""){b="Unable to retrieve processor url!";c("ZenonMediaActionLogger").logErrorToFbLogger(i+" "+b,h,null,"warn");this.$2=null;return}try{await this.$2.audioWorklet.addModule(this.$3)}catch(a){b="Audio Worklet AddModule method returned the following error: "+a;c("ZenonMediaActionLogger").logErrorToFbLogger(i+" "+b,h,null,"warn");return}this.$4=new AudioWorkletNode(this.$2,"echo-confidence-metrics-processor",{numberOfInputs:2});this.$4.port.onmessage=function(b){if(b.data.type==="metrics"){if(!b.data.metrics){var d="AudioWorklet Processor Node returned null metrics!";c("ZenonMediaActionLogger").logErrorToFbLogger(i+" "+d,h,null,"warn")}a.$5===null?a.$5=b.data.metrics:a.$7(b.data.metrics,a.$5)}else if(b.data.type==="error"){d="AudioWorklet Processor Node returned the following error: "+b.data.message;c("ZenonMediaActionLogger").logErrorToFbLogger(i+" "+d,h,null,"warn")}};this.$4.onprocessorerror=function(a){a="AudioWorklet Processor Node returned the following uncaught error: "+a.message;c("ZenonMediaActionLogger").logErrorToFbLogger(i+" "+a,h,null,"warn")}};b.$7=function(a,b){b.echoConfidence=Math.max(b.echoConfidence,a.echoConfidence),b.echoCrossCorrelation=Math.max(b.echoCrossCorrelation,a.echoCrossCorrelation),b.echoDelay=Math.max(b.echoDelay,a.echoDelay),b.echoERL=Math.max(b.echoERL,a.echoERL),b.echoLpbRMS=Math.max(b.echoLpbRMS,a.echoLpbRMS),b.echoRMS=Math.max(b.echoRMS,a.echoRMS),b.goldenEchoMetric=Math.max(b.goldenEchoMetric,a.goldenEchoMetric),b.ltEchoConfidence=Math.max(b.ltEchoConfidence,a.ltEchoConfidence),b.ltEchoDelay=Math.max(b.ltEchoDelay,a.ltEchoDelay),b.ltEchoDelayEntropy=Math.max(b.ltEchoDelayEntropy,a.ltEchoDelayEntropy),b.ltEchoERL=Math.max(b.ltEchoERL,a.ltEchoERL),b.ltEchoFramesPercentage=Math.max(b.ltEchoFramesPercentage,a.ltEchoFramesPercentage)};return a}();b=new a();g.default=b}),98);
__d("EdgeOverlayConfigLayer",["OverlayConfigLayerBuilder","OverlayConfigLayerSource"],(function(a,b,c,d,e,f,g){"use strict";a=function(){var a=new(c("OverlayConfigLayerBuilder"))(c("OverlayConfigLayerSource").BROWSER);a.setZenonSdpTransformConfigDisableOpusStereo(!0);return a.build()}();b=a;g["default"]=b}),98);
__d("FirefoxOverlayConfigLayer",["OverlayConfigLayerBuilder","OverlayConfigLayerSource"],(function(a,b,c,d,e,f,g){"use strict";a=function(){var a=new(c("OverlayConfigLayerBuilder"))(c("OverlayConfigLayerSource").BROWSER);a.setZenonSdpTransformConfigDisableOpusStereo(!0);return a.build()}();b=a;g["default"]=b}),98);
__d("OperaOverlayConfigLayer",["OverlayConfigLayerBuilder","OverlayConfigLayerSource","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=function(){var a=new(c("OverlayConfigLayerBuilder"))(c("OverlayConfigLayerSource").BROWSER);a.setZenonSdpTransformConfigDisableOpusStereo(!0);a.setZenonSdpTransformConfigPreserveH264(c("gkx")("25201"));return a.build()}();b=a;g["default"]=b}),98);
__d("PsiClientSearchTypesTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({TEXT:1,IMAGE:2,VIDEO:3,AUDIO:4,CONTACT:5,LOCATION:6,LINK:7,DOCUMENT:8,GIF:9,STICKER:10,PAYMENT_REQUEST:11,POLL:12,EVENT:13,MEDIA_ALBUM:14,PRODUCT:15,PTT:16});c=b("$InternalEnum")({USER:1,ASSISTANT:2});d=b("$InternalEnum")({UNKNOWN:0,OPEN:1,TEE:2});e.exports={ChatRole:c,InfraStackType:d,TEEMessageType:a}}),null);
__d("PsiClientSearchTypesSerializers",["PsiClientSearchTypesTypes","ThriftTypes"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return{conversations:[],queries:[]}}function b(){return{}}function e(){return{messages:[]}}function f(){return{}}function i(){return{}}function j(a,b){b.writeStructBegin("PSIToolQueryPlan");b.writeFieldBegin({fname:"conversations",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:1});if(a.conversations!=null){b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRING,size:a.conversations.length});for(var d of a.conversations)b.writeString(d);b.writeListEnd()}else{d=[];b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRING,size:d.length});for(d of d)b.writeString(d);b.writeListEnd()}b.writeFieldEnd();b.writeFieldBegin({fname:"queries",ftype:h.LIST,fid:2});if(a.queries!=null){b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRING,size:a.queries.length});for(d of a.queries)b.writeString(d);b.writeListEnd()}else{d=[];b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRING,size:d.length});for(d of d)b.writeString(d);b.writeListEnd()}b.writeFieldEnd();a.timeStart!=null&&(b.writeFieldBegin({fname:"timeStart",ftype:(h||(h=c("ThriftTypes"))).I32,fid:3}),b.writeI32(a.timeStart),b.writeFieldEnd());a.timeEnd!=null&&(b.writeFieldBegin({fname:"timeEnd",ftype:(h||(h=c("ThriftTypes"))).I32,fid:4}),b.writeI32(a.timeEnd),b.writeFieldEnd());a.maxRelevant!=null&&(b.writeFieldBegin({fname:"maxRelevant",ftype:(h||(h=c("ThriftTypes"))).I32,fid:5}),b.writeI32(a.maxRelevant),b.writeFieldEnd());a.maxRelevantPerQuery!=null&&(b.writeFieldBegin({fname:"maxRelevantPerQuery",ftype:(h||(h=c("ThriftTypes"))).I32,fid:6}),b.writeI32(a.maxRelevantPerQuery),b.writeFieldEnd());a.minRelevantPerQuery!=null&&(b.writeFieldBegin({fname:"minRelevantPerQuery",ftype:(h||(h=c("ThriftTypes"))).I32,fid:7}),b.writeI32(a.minRelevantPerQuery),b.writeFieldEnd());a.distanceThreshold!=null&&(b.writeFieldBegin({fname:"distanceThreshold",ftype:(h||(h=c("ThriftTypes"))).FLOAT,fid:8}),b.writeFloat(a.distanceThreshold),b.writeFieldEnd());a.contextWindowAbove!=null&&(b.writeFieldBegin({fname:"contextWindowAbove",ftype:(h||(h=c("ThriftTypes"))).I32,fid:9}),b.writeI32(a.contextWindowAbove),b.writeFieldEnd());a.contextWindowBelow!=null&&(b.writeFieldBegin({fname:"contextWindowBelow",ftype:(h||(h=c("ThriftTypes"))).I32,fid:10}),b.writeI32(a.contextWindowBelow),b.writeFieldEnd());a.includeLastNMessages!=null&&(b.writeFieldBegin({fname:"includeLastNMessages",ftype:(h||(h=c("ThriftTypes"))).I32,fid:11}),b.writeI32(a.includeLastNMessages),b.writeFieldEnd());a.maxTotal!=null&&(b.writeFieldBegin({fname:"maxTotal",ftype:(h||(h=c("ThriftTypes"))).I32,fid:12}),b.writeI32(a.maxTotal),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function k(a,b){b.writeStructBegin("TEEMessage");if(a.type!=null){var d;b.writeFieldBegin({fname:"type",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});b.writeI32((d=a.type)!=null?d:0);b.writeFieldEnd()}a.text!=null&&(b.writeFieldBegin({fname:"text",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.text),b.writeFieldEnd());a.senderName!=null&&(b.writeFieldBegin({fname:"senderName",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.senderName),b.writeFieldEnd());a.timestamp_seconds!=null&&(b.writeFieldBegin({fname:"timestamp_seconds",ftype:(h||(h=c("ThriftTypes"))).I64,fid:4}),b.writeI64(BigInt(a.timestamp_seconds)),b.writeFieldEnd());a.timezone_offset_hour!=null&&(b.writeFieldBegin({fname:"timezone_offset_hour",ftype:(h||(h=c("ThriftTypes"))).I32,fid:5}),b.writeI32(a.timezone_offset_hour),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function l(a,b){b.writeStructBegin("PSIConversation");a.conversationName!=null&&(b.writeFieldBegin({fname:"conversationName",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.conversationName),b.writeFieldEnd());b.writeFieldBegin({fname:"messages",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:2});if(a.messages!=null){b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:a.messages.length});for(a of a.messages)k(a,b);b.writeListEnd()}else{a=[];b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:a.length});for(a of a)k(a,b);b.writeListEnd()}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function m(a,b){b.writeStructBegin("PSIToolQueryData");if(a.conversations!=null){b.writeFieldBegin({fname:"conversations",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:1});b.writeListBegin({etype:h.STRUCT,size:a.conversations.length});for(a of a.conversations)l(a,b);b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function n(a,b){b.writeStructBegin("ChatMessage");if(a.role!=null){var d;b.writeFieldBegin({fname:"role",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});b.writeI32((d=a.role)!=null?d:0);b.writeFieldEnd()}a.content!=null&&(b.writeFieldBegin({fname:"content",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.content),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function o(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).LIST){b.conversations=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=a.readString();b.conversations.push(g)}}else a.skip(e);break;case 2:if(e===(h||(h=c("ThriftTypes"))).LIST){b.queries=[];g=a.readListBegin();for(f=0;f<g.size;f++){d=a.readString();b.queries.push(d)}}else a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).I32?b.timeStart=a.readI32():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).I32?b.timeEnd=a.readI32():a.skip(e);break;case 5:e===(h||(h=c("ThriftTypes"))).I32?b.maxRelevant=a.readI32():a.skip(e);break;case 6:e===(h||(h=c("ThriftTypes"))).I32?b.maxRelevantPerQuery=a.readI32():a.skip(e);break;case 7:e===(h||(h=c("ThriftTypes"))).I32?b.minRelevantPerQuery=a.readI32():a.skip(e);break;case 8:e===(h||(h=c("ThriftTypes"))).FLOAT?b.distanceThreshold=a.readFloat():a.skip(e);break;case 9:e===(h||(h=c("ThriftTypes"))).I32?b.contextWindowAbove=a.readI32():a.skip(e);break;case 10:e===(h||(h=c("ThriftTypes"))).I32?b.contextWindowBelow=a.readI32():a.skip(e);break;case 11:e===(h||(h=c("ThriftTypes"))).I32?b.includeLastNMessages=a.readI32():a.skip(e);break;case 12:e===(h||(h=c("ThriftTypes"))).I32?b.maxTotal=a.readI32():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.conversations===void 0&&(b.conversations=[]);b.queries===void 0&&(b.queries=[]);return b}function p(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.type=d("PsiClientSearchTypesTypes").TEEMessageType.cast(a.readI32()):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRING?b.text=a.readString():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).STRING?b.senderName=a.readString():a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).I64?b.timestamp_seconds=a.readI64().toString():a.skip(f);break;case 5:f===(h||(h=c("ThriftTypes"))).I32?b.timezone_offset_hour=a.readI32():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();return b}function q(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.conversationName=a.readString():a.skip(e);break;case 2:if(e===(h||(h=c("ThriftTypes"))).LIST){b.messages=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=p(a);b.messages.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.messages===void 0&&(b.messages=[]);return b}function r(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).LIST){b.conversations=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=q(a);b.conversations.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function s(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.role=d("PsiClientSearchTypesTypes").ChatRole.cast(a.readI32()):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRING?b.content=a.readString():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();return b}g.PSIToolQueryPlan$DefaultConstructor=a;g.TEEMessage$DefaultConstructor=b;g.PSIConversation$DefaultConstructor=e;g.PSIToolQueryData$DefaultConstructor=f;g.ChatMessage$DefaultConstructor=i;g.serializePSIToolQueryPlan=j;g.serializeTEEMessage=k;g.serializePSIConversation=l;g.serializePSIToolQueryData=m;g.serializeChatMessage=n;g.deserializePSIToolQueryPlan=o;g.deserializeTEEMessage=p;g.deserializePSIConversation=q;g.deserializePSIToolQueryData=r;g.deserializeChatMessage=s}),98);
__d("RPWebUXEventType",[],(function(a,b,c,d,e,f){a=Object.freeze({CLICK:"click",IMPRESSION:"impression"});f["default"]=a}),66);
__d("ZenonInitializationContext",["ZenonMediaPermissionState","ZenonRequestedMediaType","react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b=a.createContext({joinCall:function(){throw new Error("joinCall is not implemented!")},rejoinCall:function(){throw new Error("rejoinCall is not implemented!")},signalingStatus:"unknown",swapCall:function(a){throw new Error("rejoinCall is not implemented!")},userMediaRequestStatus:{state:c("ZenonMediaPermissionState").Unknown,type:c("ZenonRequestedMediaType").Audio}});e=b;g["default"]=e}),98);
__d("ZenonUnloadHooks",["fbt","DateConsts","ZenonCallsHooks","ZenonCallsModelTypes","ZenonInitializationContext","ZenonLoggingHooks","ZenonMediaPermissionState","ZenonWindowHooks","qpl","react","useZenonQPLLogger"],(function(a,b,c,d,e,f,g,h){"use strict";var i;e=i||d("react");var j=e.useCallback,k=e.useContext,l=30*d("DateConsts").MS_PER_SEC,m="DidNotInitiate";function a(){var a=k(c("ZenonInitializationContext")),b=a.userMediaRequestStatus,e=c("ZenonCallsHooks").useCallState(),f=c("ZenonCallsHooks").useEndCall(),g=d("ZenonLoggingHooks").useCheckpointLogging(),h=c("useZenonQPLLogger")(c("qpl")._(880941096,"1806"));d("ZenonWindowHooks").useOnUnload(j(function(){g("endCallOnUnload call state: "+e);h.endSuccess({});switch(e){case d("ZenonCallsModelTypes").ZenonCallState.Connecting:case d("ZenonCallsModelTypes").ZenonCallState.Connected:case d("ZenonCallsModelTypes").ZenonCallState.PendingApproval:f("HangupCall","BrowserClosed");break;case d("ZenonCallsModelTypes").ZenonCallState.New:b.state===c("ZenonMediaPermissionState").Pending||b.state===c("ZenonMediaPermissionState").Rejected?f("ClientInterrupted",m):f("HangupCall",m);break;default:break}},[e,f,h,g,b.state]))}function b(){var a=d("ZenonLoggingHooks").useCheckpointLogging(),b=c("useZenonQPLLogger")(c("qpl")._(880941096,"1806")),e=j(function(){a("window_beforeunload");b.start({cancelExisting:!0,cancelOnUnload:!1,timeoutInMs:l});return n()},[b,a]);d("ZenonWindowHooks").useOnBeforeUnload(e)}function n(){return h._(/*BTDS*/"Leaving this page will end your call.")}g.DID_NOT_INITIATE=m;g.useEndCallOnUnload=a;g.useWarnBeforeUnload=b}),226);
__d("ZenonCallsContext",["ZenonCallSDK","err","immutable","react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b=new(c("ZenonCallSDK"))({relayEnvironment:null});e=a.createContext({calls:new Map(),callSDK:b,callTimers:c("immutable").Map(),currentCallInstanceSDK:b.createCall(),e2eeModel:null,endCallHooks:new Set(),isE2eeMandated:!1,setCurrentCallInstanceSDK:function(){throw c("err")("setCurrentCallInstanceSDK is not implemented!")},setE2eeModel:function(){throw c("err")("setE2eeModel is not implemented!")}});f=e;g["default"]=f}),98);
__d("ZenonDataMessageTopics",[],(function(a,b,c,d,e,f){"use strict";a="rtc_av_escalation_decline";f.AV_ESCALATION_DECLINE_DATA_MESSAGE_TOPIC=a}),66);
__d("ZenonRemoteVideoRenderingEnabledAtom",["Decoil"],(function(a,b,c,d,e,f,g){"use strict";a=d("Decoil").atom({"default":!0,key:"ZenonCallsDecoil_ZenonRemoteVideoRenderingEnabledAtom"});g["default"]=a}),98);
__d("ZenonThreadContext",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b=a.createContext(null);c=b;g["default"]=c}),98);
__d("ZenonThreadType",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({OneToOne:"ONE_TO_ONE",Group:"GROUP",Other:"OTHER"});c=a;f["default"]=c}),66);
__d("ZenonThreadHooks",["MercuryIDs","ZenonThreadContext","ZenonThreadType","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j=i.useContext,k=i.useDebugValue,l=i.useMemo;function a(){var a=j(c("ZenonThreadContext"));a=a?a.id:null;k(a);return a}function b(){var a=j(c("ZenonThreadContext"));a=a?a.participants:[];k(a);return a}function e(){var a=j(c("ZenonThreadContext")),b=(a=a==null?void 0:(a=a.mercuryThread)==null?void 0:a.participants)!=null?a:null;a=l(function(){return b?b.map(function(a){return d("MercuryIDs").getUserIDFromParticipantID(a)}).filter(Boolean):[]},[b]);k(a);return a}function f(){var a=j(c("ZenonThreadContext"));a=a?a.imageUrl:null;k(a);return a}function m(){var a=j(c("ZenonThreadContext"));a=(a=a==null?void 0:a.type)!=null?a:c("ZenonThreadType").Other;k(a);return a}function n(){var a=j(c("ZenonThreadContext"));a=a?a.name:null;k(a);return a}function o(){var a=j(c("ZenonThreadContext"));a=a?a.hasOngoingCall:null;k(a);return a}function p(){var a=j(c("ZenonThreadContext"));a=a?a.mercuryThread:null;k(a);return a}g.useThreadFBID=a;g.useThreadAndCallParticipants=b;g.useThreadParticipants=e;g.useThreadImage=f;g.useThreadType=m;g.useThreadName=n;g.useOngoingCall=o;g.useMercuryThread=p}),98);
__d("ZenonTransportType",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["SIGNALING","SCTP","SIGNALING_AND_SCTP"]);f.ZenonTransportType=a}),66);
__d("ZenonCallsHooks",["CacheStorage","Decoil","E2eeMetricsSerializers","FBLogger","UserAgent","ZenonActorHooks","ZenonBackgroundBlurHooks","ZenonCallsContext","ZenonCallsModelTypes","ZenonDataMessageTopics","ZenonE2ee","ZenonNetworkQualityMonitor","ZenonRemoteVideoRenderingEnabledAtom","ZenonScreenSharingAvailabilityType","ZenonThreadHooks","ZenonTransportType","ZenonUsers","ZenonUsersHooks","filterMap","findInMap","gkx","immutable","justknobx","promiseDone","react","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j=i.useCallback,k=i.useContext,l=i.useDebugValue,m=i.useEffect,n=i.useMemo,o=i.useRef,p=i.useState,q="RTC_LS_CALL_SUMMARY_",r="ls_summary";function b(){var a=k(c("ZenonCallsContext")),b=a.currentCallInstanceSDK;return j(function(a){return b.addLocalTrack(a)},[b])}function e(){var a=k(c("ZenonCallsContext")),b=a.currentCallInstanceSDK;return j(function(a){return c("promiseDone")(b.approveParticipants(a))},[b])}function f(){var a=X.useConnectedRemoteUsersIDs(),b=X.useCurrentCall(),c=0;b&&a.forEach(function(a){a=b.participants.get(a);if(a!=null){a=a.trackIDs.filter(function(a){return(a=b.mediaTracks.get(a))==null?void 0:a.enabled}).map(function(a){return(a=(a=b.mediaTracks.get(a))==null?void 0:a.contentType)!=null?a:null});a.includes("screen_audio")&&(c+=1)}});return c}function s(){var a=k(c("ZenonCallsContext")),b=a.callTimers;a=a.currentCallInstanceSDK;a=a.getClientCallID_DEPRECATED();a=(b=b.get(a))!=null?b:null;l(a);return a}function t(a){var b=null,c=$();if(c){b=(c=c.get(a))!=null?c:null}l(b);return b}function u(){var a=$();return(a=a)!=null?a:c("immutable").Map()}function v(){var a=$(),b=n(function(){return a===null?[]:Array.from(a.keys()).sort()},[a]);l(b);return b}function w(a){if(typeof a==="function")throw c("unrecoverableViolation")("Functional state types will break useCallSpecificState!","rtc_www");var b=k(c("ZenonCallsContext"));b=b.currentCallInstanceSDK;var d=b.getClientCallID_DEPRECATED();b=p(function(){return c("immutable").Map([[d,a]])});var e=b[0],f=b[1];b=j(function(b){typeof b==="function"?f(function(c){return c.set(d,b(c.get(d,a)))}):f(e.set(d,b))},[d,a,e]);m(function(){e.has(d)||f(e.set(d,a))},[d,a,e]);return[e.get(d,a),b]}function x(){var a=X.useCurrentCall();a=a?a.callState:d("ZenonCallsModelTypes").ZenonCallState.New;l(a);return a}function y(){var a;a=(a=(a=X.useCurrentCall())==null?void 0:a.features.canAddParticipants)!=null?a:!1;l(a);return a}function z(){var a;return(a=(a=X.useCurrentCall())==null?void 0:a.clientEndpointId)!=null?a:""}function A(){var a=X.useCurrentCall();a=(a=a==null?void 0:a.collisionContext)!=null?a:null;l(a);return a}function B(a){var b=$(a);a=n(function(){if(b!==null&&b.size>0){var a=b.filter(function(a){a=a.state;return a===d("ZenonCallsModelTypes").ZenonCallParticipantState.Connected});return Array.from(a.keys()).sort()}return[]},[b]);l(a);return a}function C(){var a=d("ZenonActorHooks").useZenonActor(),b=a[0],c=$();a=n(function(){return c===null?0:c.filter(function(a){var c=a.id;a=a.state;return c!==b&&a===d("ZenonCallsModelTypes").ZenonCallParticipantState.Connected}).size},[b,c]);l(a);return a}function D(){var a=d("ZenonActorHooks").useZenonActor(),b=a[0],e=$();a=n(function(){return e!==null&&e.size>0?e.filter(function(a){var c=a.id;a=a.state;return c!==b&&a===d("ZenonCallsModelTypes").ZenonCallParticipantState.Connected}):c("immutable").Map()},[b,e]);l(a);return a}function E(){var a=d("ZenonActorHooks").useZenonActor(),b=a[0],c=$();a=n(function(){return c===null?[]:c.filter(function(a){var c=a.id;a=a.state;return c!==b&&a===d("ZenonCallsModelTypes").ZenonCallParticipantState.Connected}).map(function(a){return a.id}).toArray()},[b,c]);l(a);return a}function F(){var a=X.useCurrentCall();if(a){a=(a=a.stateSyncOutputStates.get("coplay"))==null?void 0:a.data;return{eligibleParticipants:(a==null?void 0:a.eligibleParticipants)||[],matchState:(a==null?void 0:a.matchState)||null}}return null}function G(){var a=d("ZenonActorHooks").useZenonActor();a=a[0];var b=$();return(b=b==null?void 0:b.get(a))!=null?b:null}function H(){var a=X.useCurrentCall(),b=d("ZenonActorHooks").useZenonActor();b=b[0];return(a=a==null?void 0:a.userIdToNodeIdMap.get(b))!=null?a:null}function I(a,b){var e=k(c("ZenonCallsContext")),f=e.currentCallInstanceSDK,g=X.useCallState();m(function(){g===d("ZenonCallsModelTypes").ZenonCallState.Connected&&c("promiseDone")(f.createDataMessageSubscription(a,b));return function(){c("promiseDone")(f.removeDataMessageSubscription(a,b))}},[g,f,a,b])}function J(){var a=k(c("ZenonCallsContext")),b=a.currentCallInstanceSDK,e=X.useConnectedRemoteUsersIDs();return j(function(){c("promiseDone")(b.sendGenericDataMessage(d("ZenonDataMessageTopics").AV_ESCALATION_DECLINE_DATA_MESSAGE_TOPIC,"",{recipientIDs:e},d("ZenonTransportType").ZenonTransportType.SCTP))},[b,e])}function K(){var a=k(c("ZenonCallsContext")),b=a.currentCallInstanceSDK;return j(function(a){return c("promiseDone")(b.denyParticipants(a))},[b])}function L(){var a=X.useCurrentCall();a=(a=a==null?void 0:a.features.dominantSpeaker)!=null?a:null;l(a);return a}function M(){var a=k(c("ZenonCallsContext")),b=a.currentCallInstanceSDK,e=a.endCallHooks,f=d("ZenonBackgroundBlurHooks").useOriginalVideoTrack();return j(function(a,d){f==null?void 0:f.webrtcTrack.stop(),c("promiseDone")(b.endCall(a,d)),e.forEach(function(b){return b(a,d)})},[b,e,f==null?void 0:f.webrtcTrack])}function N(){var a=X.useCurrentCall();a=(a=a==null?void 0:a.endCallReason)!=null?a:null;l(a);return a}function O(){var a=X.useCurrentCall();a=(a=a==null?void 0:a.endCallDetails)!=null?a:null;l(a);return a}function P(){var b,e=k(c("ZenonCallsContext")),f=e.currentCallInstanceSDK;e=f.getMediaMode();var g=f.getSignalingProtocol(),h=c("ZenonE2ee").shouldUseE2eeWorker();b=(b=c("ZenonE2ee").getP2pE2eeMetrics())!=null?b:d("E2eeMetricsSerializers").P2pE2eeMetrics$DefaultConstructor();var i=f.getEncryptionKeysManagerState().sfuE2eeNegotiationState,j=p(null),l=j[0],n=j[1],o=function(){var a=f.getSCTPDataChannelState("data");n((a=a)!=null?a:null)};m(function(){var b=a.setInterval(o,1e3);return function(){return a.clearInterval(b)}});return{isAsyncE2ee:h,mediaMode:e,p2pE2eeMetrics:b,sctpDataChannelStatus:l,sfuE2eeNegotiationState:i,signalingProtocol:g}}function Q(){var b=o(!0),d=p(null),e=d[0],f=d[1];d=k(c("ZenonCallsContext"));var g=d.currentCallInstanceSDK,h=async function(){var a=await g.getEncryptionKeysManagerState().e2eeStats;f(a?babelHelpers.extends({},a):null)};m(function(){b.current&&(b.current=!1,void h());var c=a.setInterval(h,1e3);return function(){return a.clearInterval(c)}});return e}function R(){var a;a=(a=Z().find(function(a){return a.contentType==="screen_audio"}))!=null?a:null;l(a);return a}function S(){var a=k(c("ZenonCallsContext")),b=a.calls;a=a.currentCallInstanceSDK;a=(b=b.get(a.getClientCallID_DEPRECATED()))!=null?b:null;l(a);return a}function T(){var a=k(c("ZenonCallsContext"));a=a.currentCallInstanceSDK;return a.getEncryptionKeysManagerState()}function U(){var a=X.useConnectedRemoteUsersIDs();a=d("ZenonUsersHooks").useZenonUsers(a);return a.some(function(a){return a.userType===d("ZenonUsers").ZenonUserType.ParentApprovedUser})}function V(){var a=X.useCurrentCall();a=(a==null?void 0:a.isVideoCall)?"video":"audio";l(a);return a==="audio"}function W(a){var b=X.useCallParticipant(a),c=d("ZenonThreadHooks").useThreadParticipants();return n(function(){return(b==null?void 0:b.participantType)===d("ZenonCallsModelTypes").ZenonCallParticipantType.Guest||!c.includes(a)},[b,a,c])}function aa(a,b){var e=d("Decoil").useDecoilValue(c("ZenonRemoteVideoRenderingEnabledAtom")),f=X.useCurrentCall(),g=f==null?void 0:f.participants.get(a),h=f==null?void 0:f.mediaTracks;a=n(function(){var a=null;if(h&&(b!=="video"||e)&&g){var c;a=(c=g.trackIDs.map(function(a){return h.get(a)}).find(function(a){return a!=null&&a.contentType===b&&a.enabled&&a.webrtcTrack.readyState==="live"}))!=null?c:null}return a},[h,e,b,g]);l(a);return a}function ba(a,b){var c=X.useCurrentCall(),d=[];if(c){a=c.participants.get(a);a&&(d=a.trackIDs.map(function(a){return c.mediaTracks.get(a)}).filter(Boolean).filter(function(a){return a.contentType===b&&a.enabled&&a.webrtcTrack.readyState==="live"}))}l(d);return d}function ca(a){var b=X.useLiveMediaTrack(a,"video"),c=X.useSupportMultipleStreams();a=X.useLiveMediaTrack(a,"screen");if(c){b=(c=a)!=null?c:b}return b}function da(a){var b=X.useCurrentCall();if(b){b=b.participants.get(a);if(b)return b.isVideoSubscribed}return!1}function ea(){var a;a=(a=Z().find(function(a){return a.contentType==="audio"}))!=null?a:null;l(a);return a}function fa(){var a;a=(a=Z().find(function(a){return a.contentType==="screen"}))!=null?a:null;l(a);return a}function ga(){var a;a=(a=Z().find(function(a){return a.contentType==="video"}))!=null?a:null;l(a);return a}function ha(a,b){var c=X.useCurrentCall(),d=null;if(c){a=c.participants.get(a);if(a){d=(a=a.trackIDs.map(function(a){return c.mediaTracks.get(a)}).find(function(a){return a!=null&&a.contentType===b}))!=null?a:null}}l(d);return d}function ia(){var a=k(c("ZenonCallsContext")),b=a.currentCallInstanceSDK;return j(function(a){return b.muteTrack(a)},[b])}function ja(){var a=k(c("ZenonCallsContext")),b=a.endCallHooks;return j(function(a){b.add(a)},[b])}function ka(){var a;a=((a=X.useCurrentCall())==null?void 0:a.features.networkStatus.local)===d("ZenonNetworkQualityMonitor").ZenonNetworkQuality.Poor;l(a);return a}function la(){var a=X.useCurrentCall(),b=X.useSupportMultipleStreams(),d=null;if(b){d=a===null?null:(b=c("findInMap")(a.remoteMediaTracks,function(a){return a.contentType==="screen"&&a.enabled}))!=null?b:null}l(d);return d}function ma(){var a=X.useCurrentCall();return(a=a==null?void 0:a.remoteScreenSharingUserIDs)!=null?a:c("immutable").OrderedSet()}function na(){var a=X.useIsAudioCall(),b=X.useCurrentCall(),d=X.useSupportMultipleStreams();a=!a&&b!==null&&d?Array.from(c("filterMap")(b.remoteMediaTracks,function(a){return a.contentType==="screen"&&a.enabled}).values()):[];l(a);return a}function oa(){var a=d("Decoil").useDecoilValue(c("ZenonRemoteVideoRenderingEnabledAtom")),b=X.useIsAudioCall(),e=X.useCurrentCall();a=a&&!b&&e!==null?Array.from(c("filterMap")(e.remoteMediaTracks,function(a){return a.contentType==="video"&&a.enabled}).values()):[];l(a);return a}function pa(){var a=X.useCurrentCall();a=a!==null?Array.from(c("filterMap")(a.remoteMediaTracks,function(a){return a.contentType==="audio"&&a.enabled}).values()):[];l(a);return a}function qa(){var a=k(c("ZenonCallsContext")),b=a.currentCallInstanceSDK;return j(function(a){return b.removeLocalTrack(a)},[b])}function ra(){var a=k(c("ZenonCallsContext")),b=a.currentCallInstanceSDK;return j(function(a){b!=null&&c("promiseDone")(b.removeParticipants(a))},[b])}function sa(){var a=k(c("ZenonCallsContext")),b=a.currentCallInstanceSDK;return j(function(a,c){return b.replaceLocalTrack(a,c)},[b])}function ta(){var a=X.useCurrentCall();return(a=a==null?void 0:a.responseSubCode)!=null?a:null}function ua(){var a=k(c("ZenonCallsContext")),b=a.currentCallInstanceSDK;return j(function(a,d){b!=null&&c("promiseDone")(b.ringParticipants(a,d))},[b])}function va(){var a=X.useCurrentCall();a=(a=a==null?void 0:a.rtpReceivers_I_KNOW_WHAT_I_AM_DOING)!=null?a:[];Y("useRtpReceivers");l(a);return a}function wa(){var a=X.useCurrentCall();a=(a=a==null?void 0:a.rtpSenders_I_KNOW_WHAT_I_AM_DOING)!=null?a:[];Y("useRtpSenders");l(a);return a}function xa(){var a;a=(a=(a=X.useCurrentCall())==null?void 0:a.features.screenSharingAvailability)!=null?a:c("ZenonScreenSharingAvailabilityType").Unknown;c("UserAgent").isBrowser("Oculus Browser")&&(a=c("ZenonScreenSharingAvailabilityType").Unknown);l(a);return a}function ya(){var a=X.useCollisionContext();return(a=a==null?void 0:a.serverInfoData)!=null?a:null}function za(){var a=k(c("ZenonCallsContext")),b=a.currentCallInstanceSDK;return j(function(a,d){c("promiseDone")(b.subscribeToRemoteVideo(a,d))},[b])}function Aa(){var a=k(c("ZenonCallsContext")),b=a.calls;a=a.currentCallInstanceSDK;b=b.get(a.getClientCallID_DEPRECATED());a=(a=b==null?void 0:b.features.supportMultipleStreams)!=null?a:!1;b=Array.from((b=b==null?void 0:(b=b.mediaTracks)==null?void 0:b.values())!=null?b:[]).some(function(a){return a.contentType!=="audio"});var d=c("gkx")("4262");l(a&&(b||d));return a&&(b||d)}function Ba(){var a=k(c("ZenonCallsContext")),b=a.calls;a=a.currentCallInstanceSDK;b=b.get(a.getClientCallID_DEPRECATED());a=b==null?void 0:b.features.supportConstrainedDevices;return{frameRate:(b=a==null?void 0:a.frameRate)!=null?b:void 0,height:(b=a==null?void 0:a.height)!=null?b:void 0,isEnabled:(b=a==null?void 0:a.isEnabled)!=null?b:!1,width:(b=a==null?void 0:a.width)!=null?b:void 0}}function Ca(){var a=k(c("ZenonCallsContext")),b=a.currentCallInstanceSDK;return j(function(a){return b.unmuteTrack(a)},[b])}function Da(){var a=X.useCallParticipantsIDs(),b=d("ZenonThreadHooks").useThreadName();return a.length<=2&&b==null}function Ea(){var a=X.useCallParticipantsIDs();return a.length}function Fa(){var a=c("justknobx")._("4080"),b=Ga(),d=Ha();if(a)return d;else return b}function Ga(){var a=X.useCurrentCall();return(a=a==null?void 0:a.participants.filter(function(a){return a.state===d("ZenonCallsModelTypes").ZenonCallParticipantState.Connected}).every(function(a){try{return a.userCapabilities!=null&&a.userCapabilities.length>0&&((a=JSON.parse(a.userCapabilities))==null?void 0:a.screen_sharing)===!0}catch(a){c("FBLogger")("rtc_www").catching(a).mustfix("ZenonCallsHooks.useIsScreensharingCapabilityEnabled: Unable to parse userCapabilities");return!1}}))!=null?a:!1}function Ha(){var a=X.useCurrentCall(),b=D();b=(b=b.filter(function(a){return a.state===d("ZenonCallsModelTypes").ZenonCallParticipantState.Connected}).every(function(a){try{return a.userCapabilities!=null&&a.userCapabilities.length>0&&((a=JSON.parse(a.userCapabilities))==null?void 0:a.screen_sharing)===!0}catch(a){c("FBLogger")("rtc_www").catching(a).mustfix("ZenonCallsHooks.useIsScreensharingCapabilityEnabled: Unable to parse userCapabilities");return!1}}))!=null?b:!1;a=(a=a==null?void 0:a.features.screenSharingEnabled)!=null?a:!1;return b&&a}var X={useAddLocalTrack:b,useApproveParticipants:e,useAudioSharingRemoteUsersCount:f,useCallConnectedTime:s,useCallParticipant:t,useCallParticipants:u,useCallParticipantsIDs:v,useCallSpecificState:w,useCallState:x,useCanAddParticipants:y,useClientEndpointId:z,useCollisionContext:A,useConnectedCallParticipantsIDs:B,useConnectedRemoteUserCount:C,useConnectedRemoteUsers:D,useConnectedRemoteUsersIDs:E,useCoplayOutputState:F,useCurrentParticipant:G,useCurrentUserNodeId:H,useDataMessageSubscription:I,useDeclineVideoEscalation:J,useDenyParticipants:K,useDominantSpeakerID_DEPRECATED:L,useEndCall:M,useEndCallReason:N,useEndCallDetails:O,useGetDebugInfo:P,useGetE2eeStats:Q,useGetScreenAudio:R,useCurrentCall:S,useGetEncryptionKeysManagerState:T,useHasActiveCall:Ia,useHasParentApprovedParticipants:U,useIsAudioCall:V,useIsGuest:W,useLiveMediaTrack:aa,useLiveMediaTracks_DEBUG:ba,useLiveScreenOrVideoTrack:ca,useIsVideoSubscribed:da,useLocalAudio:ea,useLocalScreen:fa,useLocalVideo:ga,useMediaTrack_DEBUG:ha,useMuteTrack:ia,useOnCallEnded:ja,usePoorConnectionStatus:ka,useRemoteScreen:la,useRemoteScreenSharingUserIDs_DEPRECATED:ma,useRemoteScreenTracks:na,useRemoteVideoTracks:oa,useRemoteAudioTracks:pa,useRemoveLocalTrack:qa,useRemoveParticipants:ra,useReplaceLocalTrack:sa,useResponseSubCode:ta,useRingParticipants:ua,useRtpReceivers_I_KNOW_WHAT_I_AM_DOING:va,useRtpSenders_I_KNOW_WHAT_I_AM_DOING:wa,useScreenSharingAvailability:xa,useServerInfoData:ya,useSubscribeToRemoteVideo:za,useSupportMultipleStreams:Aa,useSupportConstrainedDevice:Ba,useUnmuteTrack:Ca,useIsTwoPersonCall:Da,useParticipantsCount:Ea,useIsScreensharingCapabilityEnabled:Fa};function Y(a){m(function(){c("FBLogger")("ZenonCallsHooks").event(a)},[a])}function Z(){var a=X.useCurrentCall();return Array.from((a=a==null?void 0:a.localMediaTracks.values())!=null?a:[])}function $(a){var b=X.useCurrentCall();a=(a=a)!=null?a:b;a=(b=a==null?void 0:a.participants)!=null?b:null;l(a);return a}function Ia(){var a=c("justknobx")._("4056"),b=new(c("CacheStorage"))("localstorage",q);b=b.get(r);if(!b||Object.keys(b).length===0)return!1;b=Object.values(b)[0];if(!b||Object.keys(b).length===0)return!1;b=Object.values(b)[0].__t;return b<Date.now()-a?!1:!0}i=X;g.default=i}),98);
__d("ZenonProductConnectFunnel",["FBLogger","performanceNow","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(){return Math.trunc((h||(h=c("performanceNow")))())};a=function(){function a(){this.$6=null,this.$7=null,this.$1=null,this.$2=null,this.$3=null,this.$4=null,this.$5=null,this.$8=new Map(),this.$9=new Map()}var b=a.prototype;b.$10=function(a){var b=this.$8.get(a);if(b!=null)return b;b={acceptedTs:this.$3,connectedTs:null,connectingTs:null,contactingTs:null,endCallTs:null,permissionsReceivedTs:this.$5,permissionsRequestTs:this.$4,ringingTs:this.$2,triggeredTs:this.$1};var c={cameraPermission:this.$6,microphonePermission:this.$7};this.clearPreJoinTimings();this.$8.set(a,b);this.$9.set(a,c);return b};b.$11=function(a,b){a=a==null?void 0:(a=a.getLogIdentifiers())==null?void 0:a.clientSessionID;if(a==null){c("FBLogger")("rtc_www").warn("ProductConnectFunnel: could not record UI event due to missing signaling ID");return}a=this.$10(a);if(a[b]!=null)return;a[b]=i()};b.getTimings=function(a){return this.$8.get(a)};b.getPreJoinTimings=function(){return{acceptedTs:this.$3,ringingTs:this.$2,triggeredTs:this.$1}};b.clearPreJoinTimings=function(){this.$3=null,this.$2=null,this.$1=null,this.$4=null,this.$5=null,this.$6=null,this.$7=null};b.setPreJoinTimings=function(a){this.$3=a.acceptedTs,this.$2=a.ringingTs,this.$1=a.triggeredTs};b.getAnnotations=function(a){return this.$9.get(a)};b.remove=function(a){this.clearPreJoinTimings(),this.$8["delete"](a),this.$9["delete"](a)};b.setUITriggered=function(){var a;(a=this.$1)!=null?a:this.$1=i()};b.setUIPermissionsRequest=function(){var a=this;if(this.$4!=null)return;this.$4=i();c("promiseDone")(navigator.permissions.query({name:"microphone"}).then(function(b){a.$7=b.state}));c("promiseDone")(navigator.permissions.query({name:"camera"}).then(function(b){a.$6=b.state}))};b.setUIPermissionsReceived=function(){var a;(a=this.$5)!=null?a:this.$5=i()};b.setUIAccepted=function(){var a;(a=this.$3)!=null?a:this.$3=i()};b.setUIConnected=function(a){this.$11(a,"connectedTs")};b.setUIConnecting=function(a){this.$11(a,"connectingTs")};b.setUIRinging=function(){var a;(a=this.$2)!=null?a:this.$2=i()};b.setUIContacting=function(a){this.$11(a,"contactingTs")};b.setUIEnded=function(a){this.$11(a,"endCallTs")};return a}();b=new a();g["default"]=b}),98);
__d("ZenonLocalAudioVideoHooks",["ZenonCallsHooks","ZenonLocalAudioVideoManager","ZenonLocalAudioVideoTypes","ZenonLocalMediaContext","ZenonLoggingHooks","ZenonProductConnectFunnel","ZenonUserActionLogger","ZenonVideoConstraintUtils","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j=i.useCallback,k=i.useContext,l=i.useEffect,m=i.useRef,n="ZenonLocalAudioVideoHooks";function o(a,b,c){return a&&b!=null&&b>0&&c!=null&&c>0}function p(a,b,e,f){f===void 0&&(f=!1);a===d("ZenonLocalAudioVideoTypes").ZenonLocalMediaOwnershipType.Strong&&c("ZenonLocalAudioVideoManager").retain("PRIMARY_AUDIO");try{var g;f===!0&&(g=function(a){a.webrtcTrack.enabled=!1;return Promise.resolve(babelHelpers.extends({},a,{enabled:!1}))});return c("ZenonLocalAudioVideoManager").setLocalAudio("PRIMARY_AUDIO",b,e,g)}catch(b){a===d("ZenonLocalAudioVideoTypes").ZenonLocalMediaOwnershipType.Strong&&c("ZenonLocalAudioVideoManager").release("PRIMARY_AUDIO");c("ZenonUserActionLogger").logError({checkpoint:n+"_getUserMedia_audio_error",error_domain:n,error_type:b.toString()});throw b}}function q(a){a===d("ZenonLocalAudioVideoTypes").ZenonLocalMediaOwnershipType.Strong&&c("ZenonLocalAudioVideoManager").release("PRIMARY_AUDIO")}function a(a,b){b===void 0&&(b=!0);var d=m(!1);l(function(){d&&b&&q(a)},[a,b]);return j(async function(b,e,f){f===void 0&&(f=!1);q(a);d.current=!0;c("ZenonProductConnectFunnel").setUIPermissionsRequest();b=await p(a,b,e,f);c("ZenonProductConnectFunnel").setUIPermissionsReceived();return b},[a])}function b(b,e){e===void 0&&(e=!0);l(function(){b===d("ZenonLocalAudioVideoTypes").ZenonLocalMediaOwnershipType.Strong&&c("ZenonLocalAudioVideoManager").retain("PRIMARY_AUDIO");return function(){b===d("ZenonLocalAudioVideoTypes").ZenonLocalMediaOwnershipType.Strong&&e&&c("ZenonLocalAudioVideoManager").release("PRIMARY_AUDIO")}},[b,e]);var a=j(async function(a,b,d){d===void 0&&(d=!1);try{var e;d===!0&&(e=function(a){a.webrtcTrack.enabled=!1;return Promise.resolve(babelHelpers.extends({},a,{enabled:!1}))});c("ZenonProductConnectFunnel").setUIPermissionsRequest();d=await c("ZenonLocalAudioVideoManager").setLocalAudio("PRIMARY_AUDIO",a,b,e);c("ZenonProductConnectFunnel").setUIPermissionsReceived();return d}catch(a){c("ZenonUserActionLogger").logError({checkpoint:n+"_getUserMedia_audio_error",error_domain:n,error_type:a.toString()});throw a}},[]);return a}i=c("gkx")("11524")?a:b;function e(){l(function(){c("ZenonLocalAudioVideoManager").retain("PRIMARY_AUDIO");c("ZenonLocalAudioVideoManager").retain("PRIMARY_VIDEO");return function(){c("ZenonLocalAudioVideoManager").release("PRIMARY_AUDIO"),c("ZenonLocalAudioVideoManager").release("PRIMARY_VIDEO")}},[]);var a=c("ZenonCallsHooks").useSupportConstrainedDevice(),b=a.frameRate,e=a.height,f=a.isEnabled,g=a.width;l(function(){if(o(f,g,e)){var a;void c("ZenonLocalAudioVideoManager").applyNewVideoCaptureConstraints({ideal:((a=g)!=null?a:16)/((a=e)!=null?a:9)},{max:(a=b)!=null?a:30},{max:e},{max:g})}else{void c("ZenonLocalAudioVideoManager").applyNewVideoCaptureConstraints({ideal:(a=d("ZenonVideoConstraintUtils")).CONSTRAINT_720P_30FPS_CONFIG.aspectRatio},{ideal:a.CONSTRAINT_720P_30FPS_CONFIG.frameRate},{ideal:a.CONSTRAINT_720P_30FPS_CONFIG.height},{ideal:a.CONSTRAINT_720P_30FPS_CONFIG.width})}},[b,e,f,g]);a=j(async function(a,h,i){try{if(o(f,g,e)){var j;b!=null&&(h.frameRate={max:b});h.height={max:e};h.width={max:g};h.aspectRatio={ideal:((j=g)!=null?j:16)/((j=e)!=null?j:9)}}else{h.frameRate={ideal:(j=d("ZenonVideoConstraintUtils")).CONSTRAINT_720P_30FPS_CONFIG.frameRate};h.height={ideal:j.CONSTRAINT_720P_30FPS_CONFIG.height};h.width={ideal:j.CONSTRAINT_720P_30FPS_CONFIG.width};h.aspectRatio={ideal:j.CONSTRAINT_720P_30FPS_CONFIG.aspectRatio}}c("ZenonProductConnectFunnel").setUIPermissionsRequest();j=await c("ZenonLocalAudioVideoManager").setLocalAudioAndVideo(a,h,i,!0);c("ZenonProductConnectFunnel").setUIPermissionsReceived();return j}catch(a){c("ZenonUserActionLogger").logError({checkpoint:n+"_useCreateLocalAudioAndVideo_error",error_domain:n,error_type:a.toString()});throw a}},[b,e,f,g]);return a}function f(){l(function(){c("ZenonLocalAudioVideoManager").retain("PREVIEW_AUDIO");c("ZenonLocalAudioVideoManager").retain("PREVIEW_VIDEO");return function(){c("ZenonLocalAudioVideoManager").release("PREVIEW_AUDIO"),c("ZenonLocalAudioVideoManager").release("PREVIEW_VIDEO")}},[]);var a=j(async function(a,b,d){try{return await c("ZenonLocalAudioVideoManager").setLocalAudioAndVideo(a,b,d,!1)}catch(a){c("ZenonUserActionLogger").logError({checkpoint:n+"_useCreateLocalAudioAndVideoForPreview_error",error_domain:n,error_type:a.toString()});throw a}},[]);return a}function r(){var a=d("ZenonLoggingHooks").useErrorLogging();l(function(){c("ZenonLocalAudioVideoManager").retain("PREVIEW_AUDIO");return function(){c("ZenonLocalAudioVideoManager").release("PREVIEW_AUDIO")}},[]);var b=j(async function(b,d){try{return await c("ZenonLocalAudioVideoManager").setLocalAudio("PREVIEW_AUDIO",b,d)}catch(b){a({checkpoint:n+"_getUserMedia_error_audio_preview",error:b,errorDomain:n});throw b}},[a]);return b}function s(a){l(function(){a===d("ZenonLocalAudioVideoTypes").ZenonLocalMediaOwnershipType.Strong&&c("ZenonLocalAudioVideoManager").retain("PRIMARY_VIDEO");return function(){a===d("ZenonLocalAudioVideoTypes").ZenonLocalMediaOwnershipType.Strong&&c("ZenonLocalAudioVideoManager").release("PRIMARY_VIDEO")}},[a]);var b=c("ZenonCallsHooks").useSupportConstrainedDevice(),e=b.frameRate,f=b.height,g=b.isEnabled,h=b.width,i=d("ZenonLoggingHooks").useErrorLogging();b=j(async function(a,b,j,k){j===void 0&&(j=!1);try{var l=k;j===!0&&(l=function(a){a.webrtcTrack.enabled=!1;a=babelHelpers.extends({},a,{enabled:!1});return!k?Promise.resolve(a):k(a)});if(o(g,h,f)){e!=null&&(b.frameRate={max:e});b.width={max:h};b.height={max:f};b.aspectRatio={ideal:((j=h)!=null?j:16)/((j=f)!=null?j:9)}}else{b.frameRate={ideal:(j=d("ZenonVideoConstraintUtils")).CONSTRAINT_720P_30FPS_CONFIG.frameRate};b.height={ideal:j.CONSTRAINT_720P_30FPS_CONFIG.height};b.width={ideal:j.CONSTRAINT_720P_30FPS_CONFIG.width};b.aspectRatio={ideal:j.CONSTRAINT_720P_30FPS_CONFIG.aspectRatio}}c("ZenonProductConnectFunnel").setUIPermissionsRequest();j=await c("ZenonLocalAudioVideoManager").setLocalVideo("PRIMARY_VIDEO",a,b,l);c("ZenonProductConnectFunnel").setUIPermissionsReceived();return j}catch(a){i({checkpoint:n+"_getUserMedia_video_error",error:a,errorDomain:n});throw a}},[e,f,i,g,h]);return b}function t(){l(function(){c("ZenonLocalAudioVideoManager").retain("PREVIEW_VIDEO");return function(){c("ZenonLocalAudioVideoManager").release("PREVIEW_VIDEO")}},[]);var a=d("ZenonLoggingHooks").useErrorLogging(),b=j(async function(b,d){try{return await c("ZenonLocalAudioVideoManager").setLocalVideo("PREVIEW_VIDEO",b,d)}catch(b){a({checkpoint:n+"_getUserMedia_error_video_preview",error:b,errorDomain:n});throw b}},[a]);return b}function u(){var a=d("ZenonLoggingHooks").useErrorLogging(),b=j(async function(b,d,e){try{return await c("ZenonLocalAudioVideoManager").createtNonReferenceCountedVideoTrack(b,d,e)}catch(b){a({checkpoint:n+"_getUserMedia_error_useCreateNonReferenceCountedVideo",error:b,errorDomain:n});throw b}},[a]);return b}function v(){return j(function(a){return c("ZenonLocalAudioVideoManager").disableAudioTrack(a)},[])}function w(){return j(function(a){return c("ZenonLocalAudioVideoManager").disableVideoTrack(a)},[])}function x(){var a=k(c("ZenonLocalMediaContext"));a=a.audioTrack;return a}function y(){var a=k(c("ZenonLocalMediaContext"));a=a.videoTrack;return a}a={useCreateLocalAudio:i,useCreateLocalAudioAndVideo:e,useCreateLocalAudioAndVideoForPreview:f,useCreateLocalAudioForPreview:r,useCreateLocalVideo:s,useCreateLocalVideoForPreview:t,useCreateNonReferenceCountedVideo:u,useDisableAudio:v,useDisableVideo:w,useLocalAudio:x,useLocalVideo:y};b=a;g.default=b}),98);
__d("RPWebUXLoggerSurfaceContext",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b=a.createContext("unknown");g.RPWebUXSurfaceLoggerContext=b}),98);
__d("RpWebUxEventFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("4962");b=d("FalcoLoggerInternal").create("rp_web_ux_event",a);e=b;g["default"]=e}),98);
__d("ZenonLoggingContext",["react","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b=a.createContext({annotations:{},callTrigger:"",codebaseVersion:"",deviceID:"",isCaller:null,isCheckpointDomainLogged:function(a){throw c("unrecoverableViolation")("isCheckpointDomainsLogged is not implemented!","rtc_www")},isErrorDomainLogged:function(a){throw c("unrecoverableViolation")("isErrorDomainLogged is not implemented!","rtc_www")},page:"",peerID:null,roomID:"",setCallTrigger:function(a){throw c("unrecoverableViolation")("setCallTrigger is not implemented!","rtc_www")},setCheckpointDomainLogged:function(a){throw c("unrecoverableViolation")("setCheckpointDomainsLogged is not implemented!","rtc_www")},setErrorDomainLogged:function(a){throw c("unrecoverableViolation")("setErrorDomainLogged is not implemented!","rtc_www")},setIsCaller:function(a){throw c("unrecoverableViolation")("setIsCaller is not implemented!","rtc_www")},signalingID:null,startTimer:function(a){throw c("unrecoverableViolation")("startTimer is not implemented!","rtc_www")},stopTimer:function(a){throw c("unrecoverableViolation")("stopTimer is not implemented!","rtc_www")}});e=b;g["default"]=e}),98);
__d("RPWebUXLogger",["RPWebUXLoggerSurfaceContext","RpWebUxEventFalcoEvent","ZenonCallsContext","ZenonCallsHooks","ZenonLoggingContext","react","useSinglePartialViewImpression"],(function(a,b,c,d,e,f,g){"use strict";var h;e=h||d("react");var i=e.useCallback,j=e.useContext,k=e.useRef;function a(){var a=l();return i(function(b){a(babelHelpers["extends"]({},b,{eventType:"click"}))},[a])}function b(a){var b=l();return c("useSinglePartialViewImpression")({onImpressionStart:function(){return b(babelHelpers["extends"]({},a,{eventType:"impression"}))}})}function l(){var a=j(c("ZenonLoggingContext")),b=a.isCaller,e=a.signalingID;a=j(d("RPWebUXLoggerSurfaceContext").RPWebUXSurfaceLoggerContext);var f=k(a);a=j(c("ZenonCallsContext"));var g=k(a),h=a.currentCallInstanceSDK.getMediaMode(),l=a.currentCallInstanceSDK.getConferenceName(),m=c("ZenonCallsHooks").useIsAudioCall(),n=c("ZenonCallsHooks").useServerInfoData(),o=c("ZenonCallsHooks").useConnectedRemoteUsersIDs();return i(function(a){var d=a.component,i=a.eventName,j=a.eventType;c("RpWebUxEventFalcoEvent")==null?void 0:c("RpWebUxEventFalcoEvent").log(function(){var a;return{call_media_mode:h,call_media_type:m?"audio":"video",client_session_id:e==null?null:String(e),client_timestamp_ms:Date.now().toString(),component:d,conference_name:l,event_name:i,event_type:(a=j)!=null?a:"click",is_caller:b,is_e2ee_mandated:g.current.isE2eeMandated,other_user_ids:o,server_info_data:n,surface:f.current}})},[h,l,m,b,o,n,e])}f={useClickEventLogger:a,useImpressionEventLoggerRef:b};g["default"]=f}),98);
__d("ZenonLoggingSurfaceContext",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b=a.createContext("call_container");g["default"]=b}),98);
__d("ZenonLoggingHooks",["FBLogger","RtcWebUserActionsDebugFalcoEvent","RtcWebUserActionsFalcoEvent","ZenonCallsContext","ZenonCallsHooks","ZenonCallsModelTypes","ZenonDebugLogger","ZenonLoggingContext","ZenonLoggingSurfaceContext","ZenonLoggingUtils","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j=i.useCallback,k=i.useContext,l=i.useEffect,m=i.useRef;function a(){var a=k(c("ZenonLoggingContext"));return j(function(b){a.setIsCaller(b)},[a])}function b(){var a=k(c("ZenonLoggingContext"));return j(function(b){a.setCallTrigger(b)},[a])}function e(a){var b=v();l(function(){b({component:a})},[a,b])}function f(a,b){b===void 0&&(b=!0);var c=v(),d=m(!1);return j(function(){if(b&&d.current===!0)return;c({component:a});d.current=!0},[a,c,b])}function n(a){var b=v();l(function(){a!=null&&b({component:a})},[a,b])}function o(a,b){var c=w();return j(function(d){c({component:b});return a(d)},[a,b,c])}function p(){var a=x();return j(function(b){return a({checkpoint:b})},[a])}function q(a){var b=k(c("ZenonLoggingContext")),d=b.isErrorDomainLogged,e=b.setErrorDomainLogged,f=u();return j(function(b){d(a)||(e(a),f({errorDomain:a,errorType:b.toString()}),c("FBLogger")("rtc_www").catching(b).warn(a))},[a,d,f,e])}function r(){var a=u();return j(function(b){var d=b.checkpoint,e=b.error;b=b.errorDomain;a({checkpoint:d,errorDomain:b,errorType:e.toString()});e instanceof Error?c("FBLogger")("rtc_www").catching(e).warn(d):c("FBLogger")("rtc_www").warn(d+"_"+e.toString())},[a])}function s(a){var b=k(c("ZenonLoggingContext")),d=b.isCheckpointDomainLogged,e=b.setCheckpointDomainLogged,f=x();return j(function(){d(a)||(e(a),f({checkpoint:a}))},[a,d,f,e])}function t(a,b){var d=k(c("ZenonLoggingContext")),e=d.startTimer,f=d.stopTimer;d=j(function(){return e(a)},[a,e]);var g=x(),h=j(function(){var c;c=(c=b)!=null?c:a;var d=f(a);g({checkpoint:c+"_timerEnd",timeElapsed:d});return d},[b,g,a,f]);return[d,h]}function u(){var a=y();return j(function(b){return a(babelHelpers["extends"]({eventName:"error"},b))},[a])}function v(){var a=y();return j(function(b){return a(babelHelpers["extends"]({eventName:"impression"},b))},[a])}function w(){var a=y();return j(function(b){return a(babelHelpers["extends"]({eventName:"tap"},b))},[a])}function x(){var a=y();return j(function(b){return a(babelHelpers["extends"]({eventName:"checkpoint"},b))},[a])}function y(){var a=z(),b=k(c("ZenonCallsContext")),e=b.isE2eeMandated;return j(function(b){if(e||!d("ZenonLoggingUtils").shouldAllowLogging())return;a(b,c("RtcWebUserActionsDebugFalcoEvent"));var f=a(b,c("RtcWebUserActionsFalcoEvent"));A(b.eventName,f)},[e,a])}function z(){var a=k(c("ZenonLoggingSurfaceContext")),b=c("ZenonCallsHooks").useCallState(),d=k(c("ZenonCallsContext")),e=k(c("ZenonLoggingContext")),f=c("ZenonCallsHooks").useIsAudioCall(),g=m(a),h=m(b),i=m(d),l=m(e),n=m(f);g.current=a;h.current=b;i.current=d;l.current=e;n.current=f;return j(function(a,b){var c,d=i.current,e=d.calls;d=d.currentCallInstanceSDK;var f=n.current?"audio":"video",j=l.current.signalingID==null?void 0:String(l.current.signalingID);c=(c=l.current.roomID)!=null?c:d==null?void 0:d.getConferenceName();var k=l.current.isCaller,m=l.current.page,o=l.current.deviceID,p=l.current.callTrigger,q=l.current.codebaseVersion,r=l.current.peerID;d=(e=e.get(d.getClientCallID_DEPRECATED()))==null?void 0:e.collisionContext.serverInfoData;var s={call_id:j,call_trigger:p,call_type:"mw",checkpoint:a.checkpoint,client_time:Date.now().toString(),codebase_version:q,component:a.component,conference_name:c,conference_state:B(h.current),device_id:o,error_domain:a.errorDomain,error_type:a.errorType,event:a.eventName,event_time_elapsed:(e=a.timeElapsed)==null?void 0:e.toString(),is_caller:k,media_type:f,page:C(m),peer_id:r,server_info_data:d,surface:g.current};b.log(function(){return s});return s},[])}function A(a,b){a=a==null?"null":a;c("ZenonDebugLogger").getInstance().getLogHistory().log(a,JSON.stringify(b))}function B(a){switch(a){case d("ZenonCallsModelTypes").ZenonCallState.New:return"NEW";case d("ZenonCallsModelTypes").ZenonCallState.Connecting:return"CONNECTING";case d("ZenonCallsModelTypes").ZenonCallState.Connected:return"CONNECTED";case d("ZenonCallsModelTypes").ZenonCallState.Terminating:return"TERMINATING";case d("ZenonCallsModelTypes").ZenonCallState.Terminated:return"TERMINATED";case d("ZenonCallsModelTypes").ZenonCallState.PendingApproval:return"PENDING_APPROVAL"}}function C(a){switch(a){case"messenger_dot_com":case"facebook":case"mweb":case"workplace":return a;default:return null}}g.useSetIsCaller=a;g.useSetCallTrigger=b;g.useImpressionLogging=e;g.useImpressionLogger=f;g.useImpressionLoggingOptional=n;g.useClickLogging=o;g.useCheckpointLogging=p;g.useErrorLoggingOnceForDomain=q;g.useErrorLogging=r;g.useCheckpointLoggingOnceForDomain=s;g.useTimerLogging=t}),98);
__d("useZenonQPLLogger",["QPLUserFlow","ZenonCallsContext","ZenonLoggingContext","react"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");var i=b.useCallback,j=b.useContext,k=b.useMemo;function a(a){var b=j(c("ZenonCallsContext")),d=b.currentCallInstanceSDK,e=b.isE2eeMandated;b=j(c("ZenonLoggingContext"));var f=b.annotations;b=d==null?void 0:d.getLogIdentifiers();b=(d=b)!=null?d:{};var g=b.localCallID,h=b.peerID,l=b.sharedCallID,m=i(function(b){var d=b.instanceKey;c("QPLUserFlow").start(a,b);c("QPLUserFlow").addAnnotations(a,f,{instanceKey:d});c("QPLUserFlow").addAnnotations(a,{bool:{is_e2ee_mandated:e},string:{local_call_id:g,peer_id:h==="MW_PEER_ID"?void 0:h,shared_call_id:l}},{instanceKey:d})},[f,a,e,g,h,l]);d=k(function(){function b(b,d){c("QPLUserFlow").addAnnotations(a,b,d)}function d(b,d){c("QPLUserFlow").addPoint(a,b,d)}function e(b){b.joinID!=null&&c("QPLUserFlow").addAlignmentPointForJoin(a,3,{instanceKey:b.instanceKey,requestId:b.joinID,timestamp:b.timestamp}),c("QPLUserFlow").endCancel(a,{annotations:b.annotations,cancelReason:b.cancelReason,instanceKey:b.instanceKey,timestamp:b.timestamp})}function f(b,d){d.joinID!=null&&c("QPLUserFlow").addAlignmentPointForJoin(a,3,{instanceKey:d.instanceKey,requestId:d.joinID,timestamp:d.timestamp}),c("QPLUserFlow").endFailure(a,b,{annotations:d.annotations,debugInfo:d.debugInfo,error:d.error,instanceKey:d.instanceKey,timestamp:d.timestamp})}function g(b){b.joinID!=null&&c("QPLUserFlow").addAlignmentPointForJoin(a,3,{instanceKey:b.instanceKey,requestId:b.joinID,timestamp:b.timestamp}),c("QPLUserFlow").endSuccess(a,{annotations:b.annotations,instanceKey:b.instanceKey,timestamp:b.timestamp})}function h(b,d){c("QPLUserFlow").markError(a,b,d)}return{addAnnotations:b,addPoint:d,endCancel:e,endFailure:f,endSuccess:g,markError:h,start:m}},[a,m]);return d}g["default"]=a}),98);
__d("ZenonWindowHooks",["Run","ZenonCallsHooks","ZenonCallsModelTypes","ZenonLoggingHooks","ZenonThreadHooks","emptyFunction","gkx","react","useDebounced","useEffectOnce"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j=i.useCallback,k=i.useEffect,l=i.useLayoutEffect;function a(){var a=d("ZenonLoggingHooks").useClickLogging(c("emptyFunction"),"window_resize"),b=c("useDebounced")(j(function(){a()},[a]),2e3);k(function(){window.addEventListener("resize",b);return function(){window.removeEventListener("resize",b)}},[b])}function b(){var a=d("ZenonLoggingHooks").useCheckpointLogging();c("useEffectOnce")(function(){var b,c;b=(b=window.screenLeft)!=null?b:window.screenX;c=(c=window.screenTop)!=null?c:window.screenY;if(document.hidden){var d;a("Hidden_CallWindow: screen:("+window.screen.availLeft+","+window.screen.availTop+","+window.screen.availWidth+","+window.screen.availHeight+"), orientation:"+((d=window.screen.orientation)==null?void 0:d.type))}a("CallWindow: left="+b+",top="+c)})}function e(){l(function(){var a="hidden";c("gkx")("20935")&&(a="hidden !important");document.documentElement&&(document.documentElement.style.overflow=a);document.body&&(document.body.style.overflow=a)},[])}function f(a){k(function(){window.addEventListener("pagehide",a);return function(){window.removeEventListener("pagehide",a)}},[a])}function m(a){k(function(){var b=d("Run").onBeforeUnload(a,!1);return function(){b.remove()}},[a])}function n(){var a=c("ZenonCallsHooks").useCallState(),b=d("ZenonThreadHooks").useThreadFBID();k(function(){var c=window;if(a===d("ZenonCallsModelTypes").ZenonCallState.Terminated)c.inCallWith=void 0;else{c.inCallWith=(c=b)!=null?c:void 0}},[a,b])}g.useResizeLogging=a;g.useStartupLogging=b;g.useHiddenOverflow=e;g.useOnUnload=f;g.useOnBeforeUnload=m;g.useInCallWith=n}),98);
__d("ZenonCapabilities",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b;a={AddParticipantEnabled:(b=a.addParticipantEnabled)!=null?b:!1,GROUP_COWATCH:(b=a.cowatchGroupEnabled)!=null?b:!1,MultipleVideoStreamsAllowed:(b=a.multipleVideoStreamsAllowed)!=null?b:!1,MW_AV_ESCALATION:(b=a.multiwayVideoEscalation)!=null?b:!1,canApproveCollaborationSpaceJoinRequests:(b=a.canApproveCollaborationSpaceJoinRequests)!=null?b:!1,cowatch:(b=a.cowatchEnabled)!=null?b:!1,screen_sharing:(b=a.screenSharingEnabled)!=null?b:!1,sctpSecondPc:(b=a.sctpSecondPcEnabled)!=null?b:!1};return JSON.stringify(a)}f.capabilitiesToString=a}),66);
__d("ZenonConnectionInitState",["Promise","ZenonCapabilities","ZenonParticipantState","gkx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,e){var f=[];if(e.type!=="createConnection")return{};var g=e.payload.direction==="outgoing",i=e.payload,j=i.appMessages,k=i.callMedia,l=i.dataChannels,m=i.hasOfferInRing,n=i.initialSyncStates,o=i.isSecondaryJoinRole,p=i.serializedInitialSyncStates,q=i.tracks,r=i.usersToRing;i=i.usersToRingFromRingRequest;var s=g?r:i;a.updateConnectionModel(function(b){s==null?void 0:s.forEach(function(a){b.updateParticipantState(a,d("ZenonParticipantState").ZenonParticipantState.CONTACTING),b.updatePreferredCaptureConfigs()}),b.registerTrackFetcher(function(){return a.peerConnectionManager.getTracks()}),b.registerRtpSendersFetcher(function(){return a.peerConnectionManager.getRtpSenders()}),b.registerRtpReceiversFetcher(function(){return a.peerConnectionManager.getRtpReceivers()}),q==null?void 0:q.forEach(function(a){b.addLocalTrackToTrackMap({enabled:a.enabled,participantID:b.selfParticipantID,trackID:a.trackId,type:a.contentType})})});g&&c("promiseDone")(a.signalingClient.sendInvite(r,j));i=a.getConnectionModel();r=i.currentUserCapabilities;j=i.selfParticipantID;i={addParticipantEnabled:r.canAddParticipants,canApproveCollaborationSpaceJoinRequests:r.canApproveCollaborationSpaceJoinRequests,cowatchEnabled:r.cowatchEnabled,cowatchGroupEnabled:r.cowatchGroupEnabled,multipleVideoStreamsAllowed:r.supportMultipleStreams,multiwayVideoEscalation:r.multiwayVideoEscalation,screenSharingEnabled:r.screenSharingEnabled};r=d("ZenonCapabilities").capabilitiesToString(i);f.push(a.signalingClient.sendClientInfo(new Map([[j,r]]),n,p,o));var t=a.signalingClient.getSignalingModel().getMediaModeManager().getMediaMode();q&&f.push(a.peerConnectionManager.addLocalTracks(q,t,k,g));i=t==="sfu"||g;a.peerConnectionManager.setShouldEstablishDataChannel(i);var u=t==="sfu"||t==="p2p"&&((j=a.signalingClient.getSignalingModel().getRoomInfo().context)==null?void 0:j.peerID)==null||c("gkx")("25203");l&&l.forEach(function(b){u&&f.push(a.peerConnectionManager.createDataChannel(b,t))});a.peerConnectionManager.getSupportsSimulcastOverSignaling()&&c("promiseDone")(a.peerConnectionManager.createDataMessageSubscription("signalingVideoUploadUpdate",function(b){return a.peerConnectionManager.onSimulcastSignalingDataMessage(b)}));(g||m!==!0)&&f.push(a.peerConnectionManager.applyLocalSdp());(h||(h=b("Promise"))).all(f).then(function(){return e.onSuccess()})["catch"](function(a){return e.onError(a)});return{callMedia:k}}g.onCreateConnection=a}),98);
__d("ZenonConnectionPeerConnectionRestartingState",["RpWebPeerConnectionEndDelay","ZenonAuditedCheckpointLogId","ZenonInfraActionsLogger","ZenonMWMessageTypes","ZenonMediaActionLogger","ZenonParticipantState","promiseDone","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){if(b.type!=="sdpReceived")return;b=b.payload;var d=b.e2eeServerState,e=b.mediaStates,f=b.messageID,g=b.onProcessed,h=b.renegotiationOffer,i=b.sdp,j=b.sdpOriginLocalId;b=b.source;a.updateConnectionModel(function(a){a.updateTrackMapFromMediaStates(e.tracks,i.type==="pranswer")});c("promiseDone")(a.secondaryPeerConnectionManager.applyRemoteSdp(i,e,b,h,j,g,f,d))}function b(a,b){if(b.type!=="connectionEstablished"||b.payload.peerConnectionRole!=="secondary")return{};var e=a.peerConnectionManager,f=a.secondaryPeerConnectionManager;b=a.signalingClient;var g=a.updateConnectionModel,h=b.getSignalingModel(),i=h.getMediaModeManager(),j=i.getMediaMode(),k=f.getTracks();e.getTracks().forEach(function(a){var b=k.get(a.trackId);!a.remote&&b!=null&&a.enabled!==b.enabled&&(c("ZenonMediaActionLogger").logEvent({checkpoint:"media track out of sync during pc transition"}),a.webrtcTrack.enabled?c("promiseDone")(f.unmuteLocalTrack(a.trackId)):c("promiseDone")(f.muteLocalTrack(a.trackId)))});f.renegotiateNullSenderTransport();f.setTrackListenersFromManager(e);f.swapPeerConnectionEventHandlers(e);h=j==="sfu"||((h=h.getRoomInfo().context)==null?void 0:h.peerID)!=null&&a.getConnectionModel().connectionDirection==="outgoing";f.setIceRestartEligible(h);a.sctpHelper.setupSctpChannelApi(b.getSignalingModel().getSignalingID(),b.getSignalingModel().getMediaModeManager(),f);c("promiseDone")(b.sendClientEvent(d("ZenonMWMessageTypes").ZenonMWClientEventType.MEDIA_CONNECTED));g(function(a){a.registerTrackFetcher(function(){return f.getTracks()}),a.registerRtpSendersFetcher(function(){return f.getRtpSenders()}),a.registerRtpReceiversFetcher(function(){return f.getRtpReceivers()}),a.updateParticipantState(a.selfParticipantID,d("ZenonParticipantState").ZenonParticipantState.CONNECTED),a.updatePreferredCaptureConfigs()});a.logEvent({name:"callConnected"});a.logEvent({name:"connectionReady"});h=c("setTimeout")(function(){c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"Issuing delayed end call to previous peer connection"}),c("promiseDone")(e.end(!1))},c("RpWebPeerConnectionEndDelay").DELAY);j==="sfu"?(a.logEvent({name:"callEscalated"}),c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"secondaryConnectionEstablished: SFU escalation complete"})):c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"secondaryConnectionEstablished: De-escalation complete"});i.onPeerConnectionEstablished();return{activePeerConnection:"primary",bufferTimeout:h,peerConnectionManager:f,secondaryPeerConnectionManager:e}}g.onSdpReceived=a;g.onSecondaryConnectionEstablished=b}),98);
__d("ZenonConnectionSMGuards",["ZenonAuditedCheckpointLogId","ZenonInfraActionsLogger","ZenonMWMessageTypes","ZenonScreenShare"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){if(b.type!=="addLocalTracks"||a.getConnectionModel().currentUserCapabilities.supportMultipleStreams)return!1;b=b.payload.tracks;return!d("ZenonScreenShare").isScreenSharingTrack(b)?!1:Array.from(a.getConnectionModel().getTracks().values()).some(function(a){return!a.remote&&(a.contentType==="video"||a.contentType==="screen")})}function b(a,b){return b.type==="createConnection"&&b.payload.direction==="incoming"}function e(a,b){return b.type==="createConnection"&&b.payload.direction==="outgoing"}function f(a,b){if(b.type!=="removeLocalTrack"||a.getConnectionModel().currentUserCapabilities.supportMultipleStreams)return!1;b=b.payload.trackID;var c=a.getConnectionModel().getTracks().get(b);return c==null||!d("ZenonScreenShare").isScreenSharingTrack([c])?!1:Array.from(a.getConnectionModel().getTracks().values()).some(function(a){return a.trackId!==c.trackId&&!a.remote&&(a.contentType==="video"||a.contentType==="screen")})}function h(a,b){return b.type==="sdpReceived"&&b.payload.sdp.type==="answer"}function i(a,b){return b.type==="sdpReceived"&&b.payload.sdp.type==="pranswer"}function j(a,b){return b.type==="sdpReceived"&&b.payload.sdp.type==="offer"}function k(a,b){return b.type==="sdpReceived"&&(b.payload.sdp.type==="answer"||b.payload.sdp.type==="offer"&&b.payload.mediaPath===d("ZenonMWMessageTypes").ZenonMWMediaPath.P2P)}function l(a,b){return b.payload!=null&&b.payload.peerConnectionRole!=null&&b.payload.peerConnectionRole===a.activePeerConnection}function m(a,b){return b.payload!=null&&b.payload.peerConnectionRole!=null&&b.payload.peerConnectionRole==="secondary"}function n(a,b){a=b.type==="mediaUpdateResponseReceived"&&b.payload.cancelNegotiations;b.type==="mediaUpdateResponseReceived"&&c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"[ZP] cancel negotiations called with: "+String(b.payload.cancelNegotiations)});return a}g.addScreenShareTrackWithReplaceGuard=a;g.incomingConnectionGuard=b;g.outgoingConnectionGuard=e;g.removeScreenShareTrackWithReplaceGuard=f;g.sdpAnswerReceiveGuard=h;g.sdpPrAnswerReceiveGuard=i;g.sdpOfferReceiveGuard=j;g.sdpAnswerOrP2POfferReceiveGuard=k;g.activePeerConnectionGuard=l;g.secondaryPeerConnectionGuard=m;g.cancelNegotiationsGuard=n}),98);
__d("ZenonConnectionSdpNegotiatedState",["Promise","ZenonScreenShare","gkx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,d){if(d.type!=="addLocalTracks"&&d.type!=="initiateAddLocalTracks")return;var e=[],f=d.payload.tracks;e.push(a.peerConnectionManager.addLocalTracks(f,a.signalingClient.getSignalingModel().getMediaModeManager().getMediaMode(),a.callMedia));e.push(a.peerConnectionManager.applyLocalSdp());a.updateConnectionModel(function(a){f.forEach(function(b){a.addLocalTrackToTrackMap({enabled:b.enabled,participantID:a.selfParticipantID,trackID:b.trackId,type:b.contentType})})});c("promiseDone")((h||(h=b("Promise"))).all(e),d.onSuccess,d.onError)}function e(a,b){if(b.type!=="addLocalTracks")return;var e=b.payload.tracks;if(!d("ZenonScreenShare").isScreenSharingTrack(e))return;c("promiseDone")(a.peerConnectionManager.addLocalTracks(e,a.signalingClient.getSignalingModel().getMediaModeManager().getMediaMode(),a.callMedia));a.updateConnectionModel(function(a){e.forEach(function(b){a.addLocalTrackToTrackMap({enabled:b.enabled,participantID:a.selfParticipantID,trackID:b.trackId,type:b.contentType})})})}function f(a,b){if(b.type!=="initiatePeerConnectionRestarting")return{};var d=a.bufferTimeout,e=a.peerConnectionManager,f=a.secondaryPeerConnectionManager;window.clearTimeout(d);c("promiseDone")(f.restart());c("promiseDone")(f.setLocalMediaStateVersion(e.getLocalMediaStateVersion()));d=a.signalingClient.getSignalingModel().getMediaModeManager();var g=d.getMediaMode();c("promiseDone")(f.addLocalTracks(Array.from(e.getTracks().values()).filter(function(a){return!a.remote}),g,a.callMedia));b=b.payload.hasRemoteOffer;var h=g==="sfu",i=h||!b;a.secondaryPeerConnectionManager.setShouldEstablishDataChannel(i);e.setIceRestartEligible(!1);(h||c("gkx")("25203"))&&e.getDataChannelLabels().forEach(function(a){var b=e.getDataChannelOptions(a);c("promiseDone")(f.createDataChannel(a,g,b))});a.secondaryPeerConnectionManager.getSupportsSimulcastOverSignaling()&&c("promiseDone")(a.secondaryPeerConnectionManager.createDataMessageSubscription("signalingVideoUploadUpdate",function(b){return a.secondaryPeerConnectionManager.onSimulcastSignalingDataMessage(b)}));b||c("promiseDone")(f.applyLocalSdp());d.onInitiatePeerConnectionRestarting();return{activePeerConnection:"secondary",bufferTimeout:null}}function i(a,d){if(d.type!=="removeLocalTrack"&&d.type!=="initiateRemoveLocalTrack")return;var e=[],f=d.payload.trackID;e.push(a.peerConnectionManager.removeLocalTrack(f));e.push(a.peerConnectionManager.applyLocalSdp());a.updateConnectionModel(function(a){a.removeLocalTrackFromTrackMap(f)});c("promiseDone")((h||(h=b("Promise"))).all(e),d.onSuccess,d.onError)}function j(a,b){if(b.type!=="removeLocalTrack")return;var d=b.payload.trackID;c("promiseDone")(a.peerConnectionManager.removeLocalTrack(d),b.onSuccess,b.onError);a.updateConnectionModel(function(a){a.removeLocalTrackFromTrackMap(d)})}function k(a,b){if(b.type!=="replaceLocalTrack")return;var d=b.payload,e=d.preserveOriginal,f=d.replacementTrack,g=d.trackIDToReplace;e!=null?c("promiseDone")(a.peerConnectionManager.replaceLocalTrack(g,f,e),b.onSuccess,b.onError):c("promiseDone")(a.peerConnectionManager.replaceLocalTrack(g,f),b.onSuccess,b.onError);a.updateConnectionModel(function(a){a.removeLocalTrackFromTrackMap(g),a.addLocalTrackToTrackMap({enabled:f.enabled,participantID:a.selfParticipantID,trackID:f.trackId,type:f.contentType})})}g.onAddLocalTracks=a;g.onAddScreenShareLocalTrack=e;g.onInitiatePeerConnectionRestarting=f;g.onRemoveLocalTrack=i;g.onRemoveScreenShareLocalTrack=j;g.onReplaceLocalTrack=k}),98);
__d("ZenonConnectionSdpSetState",["ZenonMWMessageTypes","ZenonParticipantState","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){if(b.type!=="connectionEstablished")return;c("promiseDone")(a.signalingClient.sendClientEvent(d("ZenonMWMessageTypes").ZenonMWClientEventType.MEDIA_CONNECTED));a.updateConnectionModel(function(a){a.updateParticipantState(a.selfParticipantID,d("ZenonParticipantState").ZenonParticipantState.CONNECTED),a.updatePreferredCaptureConfigs()});a.logEvent({name:"callConnected"});a.logEvent({name:"connectionReady"})}g.onConnectionEstablished=a}),98);
__d("RTCIceCandidate",[],(function(a,b,c,d,e,f){"use strict";a=window.RTCIceCandidate||window.mozRTCIceCandidate;f["default"]=a}),66);
__d("ZenonPeerConnectionConstants",[],(function(a,b,c,d,e,f){"use strict";a="SCTP_MEDIA_SERVER_ID";b=new Set(["connected","completed"]);c=new Set(["disconnected","failed"]);d=new Set(["new","checking","closed"]);f.SCTP_MEDIA_SERVER_ID=a;f.CONNECTED_STATES=b;f.DISCONNECTED_STATES=c;f.INDETERMINANT_STATES=d}),66);
__d("ZenonConnectionSharedActions",["DateConsts","Promise","RTCIceCandidate","ZenonActorHooks","ZenonAppProvider","ZenonAuditedCheckpointLogId","ZenonDismissReason","ZenonE2ee","ZenonInfraActionsLogger","ZenonMWMessageTypes","ZenonParticipantState","ZenonPeerConnectionConstants","ZenonSCTPConstants","ZenonTransportType","gkx","justknobx","performanceNow","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=1*d("DateConsts").MS_PER_SEC;function a(a,b){if(b.type!=="addParticipants")return;var e=!1,f=b.payload,g=f.groupThreadId,h=f.usersToRing;a.updateConnectionModel(function(a){var b=a.getConsolidatedParticipantStates();h.forEach(function(c){O(c,b)||(a.updateParticipantState(c,d("ZenonParticipantState").ZenonParticipantState.CONTACTING),e=!0)})});e?c("promiseDone")(a.signalingClient.sendAddParticipantsMessage(h,g),b.onSuccess,b.onError):b.onSuccess()}function e(a,b){if(b.type!=="answerReady")return;b=b.payload;var d=b.mediaStates;b=b.sdp;a.logEvent({name:"answerSent"});c("promiseDone")(a.signalingClient.sendSdp(b,d))}function f(a,b){if(b.type!=="capabilitiesReceived")return;var c=b.payload.capabilities;a.updateConnectionModel(function(a){a.updateCurrentUserCapabilities(c)})}function k(a,b){if(b.type!=="clientInfoReceived")return;b=b.payload;var c=b.actorRepresentatives,e=b.mediaPath,f=b.userCapabilities;a.updateConnectionModel(function(a){a.updateAllParticipantsCapabilities(f)});a.updateConnectionModel(function(a){c.forEach(function(b,c){a.actorRepresentatives.set(c,b)})});e!==d("ZenonMWMessageTypes").ZenonMWMediaPath.UNKNOWN&&a.logEvent({mediaPath:e,name:"setMediaPath"})}function l(a,b){if(b.type!=="connectionDestroyed"||b.payload.error===null)return;var e=d("ZenonDismissReason").mediaErrorToDismissReason(b.payload.error);a.updateConnectionModel(function(a){a.updateParticipantState(a.selfParticipantID,d("ZenonParticipantState").ZenonParticipantState.DISCONNECTED),a.dismissDetails={dismissReason:e}});c("promiseDone")(c("ZenonE2ee").freeCallScopedResources());c("promiseDone")(a.signalingClient.sendDismiss(e));a.logEvent({name:"connectionDestroyed"});a.logEvent({endCallReason:e,endCallSubreason:b.payload.error?b.payload.error:"",isRemoteEnded:!1,name:"callEnded"})}function m(a,b){if(b.type!=="connectionDropped")return{};b=(i||(i=c("performanceNow")))();a.updateConnectionModel(function(a){O(a.selfParticipantID,a.getConsolidatedParticipantStates())&&a.updateParticipantState(a.selfParticipantID,d("ZenonParticipantState").ZenonParticipantState.CONNECTING)});return{disconnectTime:b}}function n(a,b){if(b.type!=="createDataMessageSubscription")return{};var d=b.payload.dataChannelLabel,e=b.payload.messageHandler,f=b.payload.onSctpChannelOpenCallback,g=new Map(a.dataMessageSubscriptions),h=new Set(g.get(d));h.add(e);g.set(d,h);e=a.signalingClient.getSignalingModel().getMediaModeManager().getMediaMode();h=a.peerConnectionManager.getDataChannelOpenCount()>0;h=e==="sfu"||e==="p2p"&&c("gkx")("25204")||h;h&&c("promiseDone")(a.peerConnectionManager.createDataChannel(d,e,b.payload.dataChannelOptions));f!=null&&a.peerConnectionManager.subscribeDataChannelOpen(f,d);b.onSuccess();return{dataMessageSubscriptions:g}}function o(a,b){if(b.type!=="dataMessageReceived")return;var c=a.signalingClient.getSignalingModel().getMediaModeManager().getMediaMode();b=b.payload;var e=b.dataChannelLabel,f=b.dataMessage;b=b.peerConnectionRole;if(c==="p2p"&&b!=null&&!d("ZenonSCTPConstants").P2P_ALLOWED_DATA_CHANNELS.has(e))return;c=a.dataMessageSubscriptions.get(e);c&&c.forEach(function(a){return a(f)})}function p(a,e){if(e.type!=="endConnection")return;var f=(i||(i=c("performanceNow")))(),g=e.payload,k=g.detailedReasonFromMW,l=g.dismissReason,m=g.dismissReasonSetByRemote,n=g.dismissSubreason;g=g.shouldInformPeer;a.updateConnectionModel(function(a){a.getConsolidatedParticipantStates().forEach(function(b,c){a.updateParticipantState(c,d("ZenonParticipantState").ZenonParticipantState.DISCONNECTED)}),a.dismissDetails={detailedReasonFromMW:k,dismissReason:l,dismissSubreason:n}});var o=[];o.push(c("ZenonE2ee").freeCallScopedResources());g&&o.push(a.signalingClient.sendDismiss(l));g=n;f-a.disconnectTime<j&&(g=g!=null?g.concat(", disconnect less than 1 second"):"disconnect less than 1 second");a.logEvent({endCallReason:l,endCallSubreason:g,isRemoteEnded:m,name:"callEnded"});c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"Issuing end call to peer connection due to dismiss received"});o.push(a.peerConnectionManager.end(!0));c("promiseDone")((h||(h=b("Promise"))).all(o),e.onSuccess,e.onError)}function q(a,b){if(b.type!=="forceEncodingEnabled")return;c("promiseDone")(a.peerConnectionManager.forceEncodingEnabled(b.payload.enabled),b.onSuccess,b.onError)}function r(a,b){var d;if(b.type!=="iceCandidateReady")return;b=b.payload.candidate;b={candidateSdpString:b.candidate,sdpMid:(d=b.sdpMid)!=null?d:"",sdpMLineIndex:(d=b.sdpMLineIndex)!=null?d:0};c("promiseDone")(a.signalingClient.sendIceCandidate(b))}function s(a,b){if(b.type!=="iceCandidateReceived")return;b=b.payload;b={candidate:b.candidateSdpString,sdpMid:b.sdpMid,sdpMLineIndex:b.sdpMLineIndex};var d=a.activePeerConnection,e=a.peerConnectionManager;a=a.secondaryPeerConnectionManager;d=d==="primary"?e:a;c("promiseDone")(d.applyRemoteIceCandidate(new(c("RTCIceCandidate"))(b)))}function t(a,b){if(b.type!=="mediaStateUpdateProcessing")return;var d=b.payload,e=d.enabled,f=d.isRemote;d=d.trackID;f?c("promiseDone")(e?a.peerConnectionManager.unmuteRemoteTrack(d):a.peerConnectionManager.muteRemoteTrack(d),b.onSuccess,b.onError):c("promiseDone")(e?a.peerConnectionManager.unmuteLocalTrack(d):a.peerConnectionManager.muteLocalTrack(d),b.onSuccess,b.onError)}function u(a,b){if(b.type!=="localMediaStateUpdateReady")return;c("promiseDone")(a.signalingClient.sendMediaUpdate(b.payload.mediaStates),b.onSuccess,b.onError)}function v(a,b){if(b.type!=="mediaUpdateReceived")return;c("promiseDone")(a.peerConnectionManager.applyMediaUpdate(b.payload.mediaStates))}function w(a,b){if(b.type!=="mediaUpdateResponseReceived")return;b=b.payload;var e=b.cancelNegotiations,f=b.responseStatusCode,g=b.responseSubCode;b=b.retryAfter;if(g!=null&&f!==d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.OK){e&&c("promiseDone")(a.peerConnectionManager.cancelPendingNegotiation());f=new Set([d("ZenonMWMessageTypes").ZenonMWResponseSubCode.REJECTING_CMU_WHEN_SMU_PENDING,d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFLICTING_MEDIA_PATH,d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFLICTING_MEDIA_STATUS,d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFLICTING_SESSION_DESCRIPTION,d("ZenonMWMessageTypes").ZenonMWResponseSubCode.UNKNOWN]);if(f.has(g)){c("promiseDone")(a.peerConnectionManager.localMediaStateUpdateRetry((e=b)!=null?e:0))}}else a.peerConnectionManager.clearRetryCount()}function x(a,b){if(b.type==="addLocalTracks"){var d=b.onError,e=b.onSuccess,f=b.payload;d={onError:d,onSuccess:e,payload:f,type:"initiateAddLocalTracks"};c("promiseDone")(a.signalingClient.initiateClientRenegotiation(d))}else if(b.type==="removeLocalTrack"){e=b.onError;f=b.onSuccess;d=b.payload;b={onError:e,onSuccess:f,payload:d,type:"initiateRemoveLocalTrack"};c("promiseDone")(a.signalingClient.initiateClientRenegotiation(b))}}function y(a,b){if(b.type!=="offerReady")return;b.payload.connectionDirection==="incoming"&&a.logEvent({name:"answerSent"});c("promiseDone")(a.signalingClient.sendSdp(b.payload.sdp,b.payload.mediaStates))}function z(a,b){if(b.type!=="offerReady")return;c("promiseDone")(a.peerConnectionManager.cancelPendingNegotiation());c("promiseDone")(a.peerConnectionManager.localMediaStateUpdateRetry(0))}function A(a,b){if(b.type!=="participantUpdateReceived")return;b=b.payload;var c=b.participantStates,d=b.sctpUserIdNodeIdMap;a.updateConnectionModel(function(b){b.updateFromUserIdToNodeIdMap(d),c.forEach(function(c,d){d!==b.selfParticipantID&&(b.updateParticipantState(d,c),P(c)&&a.logEvent({name:"atLeastOneParticipantAlerted"}),Q(c)&&(a.logEvent({name:"atLeastOneParticipantAnswered"}),b.updatePreferredCaptureConfigs()))})});S(a.getConnectionModel())}function B(a,b){if(b.type!=="removeDataMessageSubscription")return{};var c=b.payload.dataChannelLabel,d=b.payload.messageHandler;a=new Map(a.dataMessageSubscriptions);var e=new Set(a.get(c));e["delete"](d);a.set(c,e);b.onSuccess();return{dataMessageSubscriptions:a}}function C(a,b){if(b.type!=="removeParticipants")return;var d=b.payload.usersToRemove;c("promiseDone")(a.signalingClient.sendRemoveParticipantsRequest(d),b.onSuccess,b.onError)}function D(a,b){if(b.type!=="connectionRoomUpdateReceived")return;var c=b.payload.context;a.updateConnectionModel(function(a){a.collisionContext=c})}function E(a,b){if(b.type!=="sdpReceived")return;var d=b.payload,e=d.e2eeServerState,f=d.mediaStates,g=d.messageID,h=d.onProcessed,i=d.renegotiationOffer,j=d.sdp,k=d.sdpOriginLocalId;d=d.source;c("promiseDone")(a.peerConnectionManager.applyRemoteSdp(j,f,d,i,k,h,g,e));a.updateConnectionModel(function(a){a.updateTrackMapFromMediaStates(f.tracks,j.type==="pranswer");a.updateExistingParticipantsFromMediaStateTracks(f.tracks);var b=[],c=a.getRemoteUserToTracksMap();c.forEach(function(a,c){a=Array.from(a.entries());a=a.filter(function(a){a[0];a=a[1];return a.type!=="audio"});a.length>0&&b.push(c)});N(a,b)});j.type==="answer"?a.logEvent({name:"answerSdpReceived"}):j.type==="offer"?a.logEvent({name:"offerSdpReceived"}):j.type==="pranswer"&&a.logEvent({name:"prAnswerSdpReceived"});d=R(a.currentSubscriptionRequest,a);V(d,a,b)}function F(a,b){if(b.type!=="sendGenericDataMessage")return;var e=b.onError,f=b.onSuccess;b=b.payload;var g=b.data,h=b.recipients,i=b.topic;b=b.transportType;switch(b){case d("ZenonTransportType").ZenonTransportType.SIGNALING:c("promiseDone")(L(a,i,g,(b=h.recipientIDs)!=null?b:[],(b=h.serviceRecipients)!=null?b:[]),f,e);break;case d("ZenonTransportType").ZenonTransportType.SCTP:c("promiseDone")(M(a,i,g,h),f,e);break;case d("ZenonTransportType").ZenonTransportType.SIGNALING_AND_SCTP:c("promiseDone")(L(a,i,g,(b=h.recipientIDs)!=null?b:[],(b=h.serviceRecipients)!=null?b:[]),f,e);void M(a,i,g,h);break}}function G(a,b){if(b.type!=="stateSyncUnsubscribe")return;var d=b.payload.topic;c("promiseDone")(a.signalingClient.sendStateSyncUnsubscribe(d),b.onSuccess,b.onError)}function H(a,b){if(b.type!=="stateSyncUpdate")return;var d=b.payload,e=d.inputData;d=d.topic;c("promiseDone")(a.signalingClient.sendStateSyncUpdate(d,e),b.onSuccess,b.onError)}function I(a,b){if(b.type!=="stopLocalTrack")return;var d=b.payload.trackID;c("promiseDone")(a.peerConnectionManager.stopLocalTrack(d),b.onSuccess,b.onError)}function J(a,b){if(b.type!=="subscriptionRequest")return{};var c=b.payload;if(JSON.stringify(c)!==JSON.stringify(a.currentSubscriptionRequest)){var d=[];c.subscriptions.forEach(function(a){d.push(a.user)});a.updateConnectionModel(function(a){N(a,d)})}var e=R(c,a);V(e,a,b);return{currentSubscriptionRequest:c}}function K(a,b){if(b.type!=="userApprovalRequest")return;var d=b.payload,e=d.approvalStatus;d=d.targetUsers;c("promiseDone")(a.signalingClient.sendUsersApprovalRequest(e,d),b.onSuccess,b.onError)}function L(a,b,c,d,e){return a.signalingClient.sendGenericDataMessage(b,c,d,e)}function M(a,c,e,f){return W(c,a)?a.peerConnectionManager.sendDataMessage(c,{message:e,recipients:f,sender:d("ZenonActorHooks").ZenonActor.getID()}):(h||(h=b("Promise"))).resolve()}function N(a,b){a.clearAllUserVideoSubscriptions(),b.forEach(function(b){a.updateUserVideoSubscription(b,!0)})}function O(a,b){b=b.get(a);return b===d("ZenonParticipantState").ZenonParticipantState.CONNECTED}function P(a){switch(a){case d("ZenonParticipantState").ZenonParticipantState.UNKNOWN:case d("ZenonParticipantState").ZenonParticipantState.CONTACTING:case d("ZenonParticipantState").ZenonParticipantState.UNREACHABLE:case d("ZenonParticipantState").ZenonParticipantState.PARTICIPANT_LIMIT_REACHED:case d("ZenonParticipantState").ZenonParticipantState.RING_TYPE_UNSUPPORTED:return!1;case d("ZenonParticipantState").ZenonParticipantState.RINGING:case d("ZenonParticipantState").ZenonParticipantState.CONNECTING:case d("ZenonParticipantState").ZenonParticipantState.CONNECTED:case d("ZenonParticipantState").ZenonParticipantState.DISCONNECTED:case d("ZenonParticipantState").ZenonParticipantState.IN_ANOTHER_CALL:case d("ZenonParticipantState").ZenonParticipantState.NO_ANSWER:case d("ZenonParticipantState").ZenonParticipantState.REJECTED:case d("ZenonParticipantState").ZenonParticipantState.CONNECTION_DROPPED:case d("ZenonParticipantState").ZenonParticipantState.PENDING_APPROVAL:case d("ZenonParticipantState").ZenonParticipantState.APPROVED:case d("ZenonParticipantState").ZenonParticipantState.FAILED_APPROVAL:case d("ZenonParticipantState").ZenonParticipantState.HANGUP_IN_WAITING_ROOM:case d("ZenonParticipantState").ZenonParticipantState.ACCEPTING:case d("ZenonParticipantState").ZenonParticipantState.ADDING:case d("ZenonParticipantState").ZenonParticipantState.APPROVING:case d("ZenonParticipantState").ZenonParticipantState.DENYING:case d("ZenonParticipantState").ZenonParticipantState.PRECONNECTING:case d("ZenonParticipantState").ZenonParticipantState.REMOVING:case d("ZenonParticipantState").ZenonParticipantState.RECONNECTING:return!0}}function Q(a){switch(a){case d("ZenonParticipantState").ZenonParticipantState.UNKNOWN:case d("ZenonParticipantState").ZenonParticipantState.CONTACTING:case d("ZenonParticipantState").ZenonParticipantState.UNREACHABLE:case d("ZenonParticipantState").ZenonParticipantState.PARTICIPANT_LIMIT_REACHED:case d("ZenonParticipantState").ZenonParticipantState.RING_TYPE_UNSUPPORTED:case d("ZenonParticipantState").ZenonParticipantState.RINGING:case d("ZenonParticipantState").ZenonParticipantState.DISCONNECTED:case d("ZenonParticipantState").ZenonParticipantState.IN_ANOTHER_CALL:case d("ZenonParticipantState").ZenonParticipantState.NO_ANSWER:case d("ZenonParticipantState").ZenonParticipantState.REJECTED:case d("ZenonParticipantState").ZenonParticipantState.PENDING_APPROVAL:case d("ZenonParticipantState").ZenonParticipantState.APPROVED:case d("ZenonParticipantState").ZenonParticipantState.FAILED_APPROVAL:case d("ZenonParticipantState").ZenonParticipantState.HANGUP_IN_WAITING_ROOM:case d("ZenonParticipantState").ZenonParticipantState.ACCEPTING:case d("ZenonParticipantState").ZenonParticipantState.ADDING:case d("ZenonParticipantState").ZenonParticipantState.APPROVING:case d("ZenonParticipantState").ZenonParticipantState.DENYING:case d("ZenonParticipantState").ZenonParticipantState.PRECONNECTING:case d("ZenonParticipantState").ZenonParticipantState.REMOVING:return!1;case d("ZenonParticipantState").ZenonParticipantState.CONNECTING:case d("ZenonParticipantState").ZenonParticipantState.RECONNECTING:case d("ZenonParticipantState").ZenonParticipantState.CONNECTED:case d("ZenonParticipantState").ZenonParticipantState.CONNECTION_DROPPED:return!0}}function R(a,b){b=b.getConnectionModel();var e=a==null?void 0:a.subscriptions;a=(a=a==null?void 0:a.includeDominantSpeaker)!=null?a:!0;var f;e==null?f=T(b):f=U(e,b);e=f;b=e.trackSubscriptions;f=e.warnings;f.length>0&&c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"[ZP] Subscription request warnings: "+JSON.stringify(f),errorDomain:"ZenonConnectionSharedActions_makeSubscriptionList"});a&&b.push({type:d("ZenonMWMessageTypes").ZenonMWSubscriptionType.DOMINANT_SPEAKER});return b}function S(a){a=a.getConsolidatedParticipantStates();try{a=Object.fromEntries(a);a="[ZP] Consolidated participant states are: "+JSON.stringify(a);c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:a})}catch(a){c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"[ZP] failed to stringify consolidated state"})}}function T(a){var b=a.getRemoteUserToTracksMap();b.forEach(function(a,b){var d=b+": \n\t";a.forEach(function(a,b){d+=JSON.stringify(Object.entries(a))+"\n"});c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"[ZP] usersToTracksMap in subscribe to All Users "+d})});var e=[],f=[];b.forEach(function(b,c){a.clearFailedSubscriptionTimer(c);c=Array.from(b.entries());c=c.filter(function(a){a[0];a=a[1];return a.type!=="audio"});c.forEach(function(a){var b=a[0];a[1];e.push({options:{videoQuality:d("ZenonMWMessageTypes").ZenonMWVideoQuality.MEDIUM},trackId:b,type:d("ZenonMWMessageTypes").ZenonMWSubscriptionType.TRACK})})});return{trackSubscriptions:e,warnings:f}}function U(a,b){var e=b.getRemoteUserToTracksMap();e.forEach(function(a,b){var d=b+": \n\t";a.forEach(function(a,b){d+=JSON.stringify(Object.entries(a))+"\n"});c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"[ZP] usersToTracksMap in subscribe to Remote Users "+d})});var f=[],g=[];a.forEach(function(a){var h=a.user,i=a.videoQuality;if(h===b.selfParticipantID){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"[ZP] Forfeiting subscription request for self user ID: "+h});return}a=e.get(h);if(!a){f.push({msg:"userToTrackMap not found",user:h});b.startFailedSubscriptionTimer(h);return}if(a.size===0){f.push({msg:"userToTrackMap is empty",user:h});b.startFailedSubscriptionTimer(h);return}b.clearFailedSubscriptionTimer(h);h=Array.from(a.entries());a=h.filter(function(a){a[0];a=a[1];return a.type!=="audio"&&a.enabled===!1});a.length>0&&c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"[ZP] Subscribing to muted video track: "+JSON.stringify(a)});h=h.filter(function(a){a[0];a=a[1];return a.type!=="audio"});h.forEach(function(a){var b=a[0];a[1];g.push({options:{videoQuality:i},trackId:b,type:d("ZenonMWMessageTypes").ZenonMWSubscriptionType.TRACK})})});return{trackSubscriptions:g,warnings:f}}function V(a,b,e){if(d("ZenonAppProvider").isOculusCastingSite()&&c("justknobx")._("1974")){c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__E2EE,checkpoint:"[ZP] dropping subscription request"});return}var f=b.peerConnectionManager.getDataChannelState(d("ZenonSCTPConstants").SCTP_MEDIA_SUBSCRIPTIONS)==="open";f=f&&W(d("ZenonSCTPConstants").SCTP_MEDIA_SUBSCRIPTIONS,b);if(f){var g=JSON.stringify({subscriptionMessagePayload:a}),h={message:g,recipients:{recipientIDs:[d("ZenonPeerConnectionConstants").SCTP_MEDIA_SERVER_ID]},sender:b.getConnectionModel().selfParticipantID};c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__E2EE,checkpoint:"[ZP][SCTP] sending subscription request: "+g});c("promiseDone")(b.peerConnectionManager.sendDataMessage(d("ZenonSCTPConstants").SCTP_MEDIA_SUBSCRIPTIONS,h),e.onSuccess,e.onError)}f||c("promiseDone")(b.signalingClient.sendSubscriptionRequest(a),e.onSuccess,e.onError)}function W(a,b){var c=b.signalingClient.getSignalingModel().getMediaModeManager().getMediaMode();b=b.activePeerConnection==="primary";a=d("ZenonSCTPConstants").SFU_ONLY_DATA_CHANNELS.has(a);var e=a&&c==="p2p";a=a&&!b&&c==="sfu";return!(e||a)}g.onAddParticipants=a;g.onAnswerReady=e;g.onCapabilitiesReceived=f;g.onClientInfoReceived=k;g.onConnectionDestroyed=l;g.onConnectionDropped=m;g.onCreateDataMessageSubscription=n;g.onDataMessageReceived=o;g.onEndConnection=p;g.onForceEncodingEnabled=q;g.onIceCandidateReady=r;g.onIceCandidateReceived=s;g.onMediaStateUpdateProcessing=t;g.onLocalMediaStateUpdateReady=u;g.onMediaUpdateReceived=v;g.onMediaUpdateResponseReceived=w;g.initiateClientRenegotiation=x;g.onOfferReady=y;g.onOfferReadyCancel=z;g.onParticipantUpdateReceivedEvent=A;g.onRemoveDataMessageSubscription=B;g.onRemoveParticipants=C;g.onRoomContextUpdateReceived=D;g.onSdpReceived=E;g.onSendGenericDataMessage=F;g.onStateSyncUnsubscribe=G;g.onStateSyncUpdate=H;g.onStopLocalTrack=I;g.onSubscriptionRequest=J;g.onUserApprovalRequest=K;g.makeSubscriptionList=R;g.sendSubscriptions=V}),98);
__d("ZenonConnectionTerminatedState",["ODS"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){if(b.type!=="sdpReceived")return;(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_signaling","received_sdp_request_in_connection_terminated_state")}g.onSdpReceived=a}),98);
__d("ZenonDeferrableStateMachine",["DateConsts","clearTimeout","setTimeout","xstate"],(function(a,b,c,d,e,f,g){"use strict";var h=30*d("DateConsts").MS_PER_SEC;function a(a,b){b=b===void 0?{}:b;var e=b.deferTimeout,f=b.onDeferTimeout,g=[],i=new Map(),j=d("xstate").interpret(a.withConfig({actions:{defer:function(a,b){g.push(b);if(f){i.set(b,c("setTimeout")(function(){f(b)},(a=e)!=null?a:h))}}}})).onTransition(function(a){if(a.value!==((a=a.history)==null?void 0:a.value)){a=g;g=[];while(a.length>0){var b=a.shift();j.send(b);c("clearTimeout")(i.get(b));i["delete"](b)}}}).start();return j}g.interpret=a}),98);
__d("ZenonStateMachineBase",["ZenonAuditedCheckpointLogId","ZenonDebugLogger","ZenonDeferrableStateMachine","ZenonInfraActionsLogger","ZenonMWMessageReliabilityLogTypes","ZenonMWMessageReliabilityLogger","ZenonMWThriftMessageReliabilityLogger","xstate"],(function(a,b,c,d,e,f,g){"use strict";a={actions:["defer"]};b=function(){function a(a){var b=a.base,e=a.logging;a=a.machine;this.$1=e.name;this.$2=b.initState;this.loggingId=e.loggingId;this.$3=e.getTransactionId;this.$4=e.loggingStateName;this.$5=e.loggableEvents;a={context:a.context,initial:a.initialState,states:a.states};b={guards:b.guards};var f={onDeferTimeout:function(a){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"["+e.shortname+"] "+a.type+" was deferred for too long"})}};a=d("xstate").Machine(a,b);this.sm=d("ZenonDeferrableStateMachine").interpret(a,f)}var b=a.prototype;b.processEvent=function(a){this.logEvent(a),this.sm.send(a)};b.logEvent=function(a,b){c("ZenonDebugLogger").getInstance().logStateMachine(this.$1,this.getState(),a.type,this.loggingId.toString(),b);if(this.$5.includes(a.type)){b=this.$3(a);if(b!=null){a={smEvent:this.$1+"."+a.type};d("ZenonMWMessageReliabilityLogger").logEventForTxid(b,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_SM_EVENT,a);d("ZenonMWThriftMessageReliabilityLogger").logEventForTxid(b,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_SM_EVENT,a)}}};b.logTransaction=function(a,b){var c;d("ZenonMWMessageReliabilityLogger").updateState((c={},c[this.$4]=this.getState(),c));d("ZenonMWThriftMessageReliabilityLogger").updateState((c={},c[this.$4]=this.getState(),c));if(this.$5.includes(a.type)){c=this.$3(a);if(c!=null){a={smEvent:this.$1+"."+a.type};d("ZenonMWMessageReliabilityLogger").logEventForTxid(c,b,a);d("ZenonMWThriftMessageReliabilityLogger").logEventForTxid(c,b,a)}}};b.logTransition=function(a,b){var d;c("ZenonDebugLogger").getInstance().logStateMachineTransition(this.$1,a.changed,a.value,(d=a.history)==null?void 0:d.value,a.event.type,a.actions,this.loggingId.toString(),b)};b.getContext=function(){return this.sm.state.context};b.getState=function(){var a=this.sm.state.toStrings();return a.length>0?a[0]:this.$2};b.ifDroppedEvent=function(a,b){var c=a.actions,d=a.changed,e=a.event,f=a.value;a=(a=a.history)==null?void 0:a.value;(c==null||c.length===0)&&f===a&&!d&&b(e)};return a}();g.defer=a;g.ZenonStateMachineBase=b}),98);
__d("ZenonConnectionStateMachine",["ZenonConnectionInitState","ZenonConnectionPeerConnectionRestartingState","ZenonConnectionSMGuards","ZenonConnectionSdpNegotiatedState","ZenonConnectionSdpSetState","ZenonConnectionSharedActions","ZenonConnectionTerminatedState","ZenonDebugLogger","ZenonInfraActionsLogger","ZenonMWMessageReliabilityLogTypes","ZenonRequestedMediaType","ZenonStateMachineBase","err","qpl","xstate"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k={activePeerConnection:"primary",bufferTimeout:null,callMedia:c("ZenonRequestedMediaType").Unknown,currentSubscriptionRequest:null,dataMessageSubscriptions:new Map(),disconnectTime:0},l={loggingStateName:"connectionState",name:"ConnectionStateMachine",shortname:"Connection"};b=function(a){babelHelpers.inheritsLoose(b,a);function b(b,e){var f;e===void 0&&(e="init");f=a.call(this,{base:{guards:d("ZenonConnectionSMGuards"),initState:"init"},logging:babelHelpers["extends"]({},l,{eventToLogTimeoutsOn:"sdpReceived",getTransactionId:function(a){return(a=a.payload)==null?void 0:a.messageID},loggableEvents:["sdpReceived"],loggingId:+b.signalingClient.getSignalingModel().getSignalingID()}),machine:{context:babelHelpers["extends"]({},k,b),initialState:e,states:M}})||this;f.sm.onTransition(function(a){var e;c("ZenonInfraActionsLogger").updateCachedValues({connectionState:a.value});f.logTransition(a);((e=a.history)==null?void 0:e.value)!==a.value&&b.updateConnectionModel(function(b){b.updateConnectionState(a.value)});f.logTransaction(a.event,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSED_SM_EVENT);f.ifDroppedEvent(a,function(a){return a.onError(c("err")("event was dropped: "+a.type))})});c("ZenonDebugLogger").getInstance().startQPL(c("qpl")._(64243854,"2452"),f.loggingId);return f}return b}((a=d("ZenonStateMachineBase")).ZenonStateMachineBase);f={actions:[(e=d("ZenonConnectionSharedActions")).onAddParticipants]};var m={actions:[e.onMediaStateUpdateProcessing]},n={actions:[e.onMediaUpdateReceived]},o={actions:[e.onMediaUpdateResponseReceived]},p={actions:[e.onStopLocalTrack]},q={actions:[e.onLocalMediaStateUpdateReady]},r={actions:[e.onEndConnection],target:"terminated"},s={actions:[e.onCapabilitiesReceived]},t={actions:[e.onClientInfoReceived]},u={actions:[e.onParticipantUpdateReceivedEvent]},v={actions:[e.onRemoveParticipants]},w={actions:[e.onIceCandidateReady]},x={actions:[(h=d("xstate")).assign(e.onCreateDataMessageSubscription)]},y={actions:[h.assign(e.onRemoveDataMessageSubscription)]},z={actions:[e.onDataMessageReceived]},A={actions:[e.onRoomContextUpdateReceived]},B={actions:[e.onIceCandidateReceived]},C={actions:[e.onConnectionDestroyed],cond:(i=d("ZenonConnectionSMGuards")).activePeerConnectionGuard,target:"terminated"},D={actions:[h.assign(e.onConnectionDropped)],cond:i.activePeerConnectionGuard},E={actions:[d("ZenonConnectionSdpSetState").onConnectionEstablished]},F={actions:[e.onStateSyncUnsubscribe]},G={actions:[e.onStateSyncUpdate]},H={actions:[h.assign(e.onSubscriptionRequest)]},I={actions:[e.onSendGenericDataMessage]},J={actions:[e.onUserApprovalRequest]},K={actions:[e.onForceEncodingEnabled]},L={actions:[h.assign((j=d("ZenonConnectionSdpNegotiatedState")).onInitiatePeerConnectionRestarting)],target:"peerConnectionRestarting"},M={init:{on:{connectionDestroyed:C,createConnection:[{actions:[h.assign(d("ZenonConnectionInitState").onCreateConnection)],cond:i.outgoingConnectionGuard,target:"creatingSdp"},{actions:[h.assign(d("ZenonConnectionInitState").onCreateConnection)],cond:i.incomingConnectionGuard,target:"waitingForIncoming"}],endConnection:r,capabilitiesReceived:s,clientInfoReceived:t,connectionRoomUpdateReceived:A,dataMessageReceived:z,forceEncodingEnabled:K,iceCandidateReady:w,iceCandidateReceived:B,mediaStateUpdateProcessing:m,localMediaStateUpdateReady:q,mediaUpdateReceived:n,participantUpdateReceived:u,removeDataMessageSubscription:y,removeParticipants:v,sendGenericDataMessage:I,stateSyncUnsubscribe:F,stateSyncUpdate:G,stopLocalTrack:p,userApprovalRequest:J,addLocalTracks:a.defer,addParticipants:a.defer,createDataMessageSubscription:a.defer,mediaUpdateResponseReceived:a.defer,removeLocalTrack:a.defer,replaceLocalTrack:a.defer,sdpReceived:a.defer,subscriptionRequest:a.defer}},waitingForIncoming:{on:{connectionDestroyed:C,endConnection:r,sdpReceived:[{actions:[e.onSdpReceived],cond:i.sdpOfferReceiveGuard,target:"creatingSdp"}],offerReady:[{actions:[e.onOfferReady],target:"sdpSet"}],capabilitiesReceived:s,clientInfoReceived:t,connectionRoomUpdateReceived:A,createDataMessageSubscription:x,dataMessageReceived:z,forceEncodingEnabled:K,iceCandidateReady:w,iceCandidateReceived:B,mediaStateUpdateProcessing:m,localMediaStateUpdateReady:q,mediaUpdateReceived:n,participantUpdateReceived:u,removeDataMessageSubscription:y,removeParticipants:v,sendGenericDataMessage:I,stateSyncUnsubscribe:F,stateSyncUpdate:G,stopLocalTrack:p,userApprovalRequest:J,addLocalTracks:a.defer,addParticipants:a.defer,initiateAddLocalTracks:a.defer,initiateRemoveLocalTrack:a.defer,mediaUpdateResponseReceived:a.defer,removeLocalTrack:a.defer,replaceLocalTrack:a.defer,subscriptionRequest:a.defer}},creatingSdp:{on:{answerReady:[{actions:[e.onAnswerReady],target:"sdpNegotiated"}],connectionDestroyed:C,endConnection:r,offerReady:[{actions:[e.onOfferReady],target:"sdpSet"}],capabilitiesReceived:s,clientInfoReceived:t,connectionRoomUpdateReceived:A,createDataMessageSubscription:x,dataMessageReceived:z,forceEncodingEnabled:K,iceCandidateReady:w,iceCandidateReceived:B,mediaStateUpdateProcessing:m,localMediaStateUpdateReady:q,mediaUpdateReceived:n,participantUpdateReceived:u,removeDataMessageSubscription:y,removeParticipants:v,sendGenericDataMessage:I,stateSyncUnsubscribe:F,stateSyncUpdate:G,stopLocalTrack:p,userApprovalRequest:J,addLocalTracks:a.defer,addParticipants:a.defer,initiateAddLocalTracks:a.defer,initiateRemoveLocalTrack:a.defer,mediaUpdateResponseReceived:a.defer,removeLocalTrack:a.defer,replaceLocalTrack:a.defer,sdpReceived:a.defer,subscriptionRequest:a.defer}},sdpSet:{on:{connectionDestroyed:C,endConnection:r,initiatePeerConnectionRestarting:L,pendingApproval:[{target:"pendingApproval"}],remoteSdpSet:{target:"sdpNegotiated"},capabilitiesReceived:s,clientInfoReceived:t,connectionDropped:D,connectionEstablished:[{actions:[d("ZenonConnectionSdpSetState").onConnectionEstablished]}],connectionRoomUpdateReceived:A,createDataMessageSubscription:x,dataMessageReceived:z,forceEncodingEnabled:K,iceCandidateReady:w,iceCandidateReceived:B,mediaStateUpdateProcessing:m,localMediaStateUpdateReady:q,mediaUpdateReceived:n,mediaUpdateResponseReceived:o,participantUpdateReceived:u,removeDataMessageSubscription:y,removeParticipants:v,sdpReceived:[{actions:[e.onSdpReceived],cond:i.sdpAnswerReceiveGuard},{actions:[e.onSdpReceived],cond:i.sdpPrAnswerReceiveGuard},babelHelpers["extends"]({},a.defer,{cond:i.sdpOfferReceiveGuard})],sendGenericDataMessage:I,stateSyncUnsubscribe:F,stateSyncUpdate:G,stopLocalTrack:p,userApprovalRequest:J,addLocalTracks:a.defer,addParticipants:a.defer,replaceLocalTrack:a.defer,removeLocalTrack:a.defer,initiateAddLocalTracks:a.defer,initiateRemoveLocalTrack:a.defer,subscriptionRequest:a.defer}},pendingApproval:{on:{connectionDestroyed:C,endConnection:r,initiatePeerConnectionRestarting:L,mediaUpdateReceived:n,stateSyncUnsubscribe:F,stateSyncUpdate:G,addLocalTracks:a.defer,addParticipants:a.defer,capabilitiesReceived:a.defer,clientInfoReceived:a.defer,connectionRoomUpdateReceived:a.defer,createDataMessageSubscription:a.defer,dataMessageReceived:a.defer,forceEncodingEnabled:a.defer,iceCandidateReady:a.defer,iceCandidateReceived:a.defer,initiateAddLocalTracks:a.defer,initiateRemoveLocalTrack:a.defer,mediaStateUpdateProcessing:a.defer,localMediaStateUpdateReady:a.defer,mediaUpdateResponseReceived:a.defer,participantUpdateReceived:a.defer,removeDataMessageSubscription:a.defer,removeLocalTrack:a.defer,replaceLocalTrack:a.defer,stopLocalTrack:a.defer,subscriptionRequest:a.defer}},sdpNegotiated:{on:{connectionDestroyed:C,endConnection:r,initiatePeerConnectionRestarting:L,initiateAddLocalTracks:{actions:[j.onAddLocalTracks],target:"clientInitiatedRenegotiation"},initiateRemoveLocalTrack:{actions:[j.onRemoveLocalTrack],target:"clientInitiatedRenegotiation"},offerReady:{actions:[e.onOfferReady],target:"clientInitiatedRenegotiation"},sdpReceived:{actions:[e.onSdpReceived],cond:i.sdpOfferReceiveGuard,target:"serverInitiatedRenegotiating"},addLocalTracks:[{actions:[j.onAddScreenShareLocalTrack],cond:i.addScreenShareTrackWithReplaceGuard},{actions:[e.initiateClientRenegotiation]}],addParticipants:f,capabilitiesReceived:s,clientInfoReceived:t,connectionDropped:D,connectionEstablished:E,connectionRoomUpdateReceived:A,createDataMessageSubscription:x,dataMessageReceived:z,forceEncodingEnabled:K,iceCandidateReady:w,iceCandidateReceived:B,mediaStateUpdateProcessing:m,localMediaStateUpdateReady:q,mediaUpdateReceived:n,mediaUpdateResponseReceived:o,participantUpdateReceived:u,removeDataMessageSubscription:y,removeLocalTrack:[{actions:[j.onRemoveScreenShareLocalTrack],cond:i.removeScreenShareTrackWithReplaceGuard},{actions:[e.initiateClientRenegotiation]}],removeParticipants:v,replaceLocalTrack:{actions:[j.onReplaceLocalTrack]},sendGenericDataMessage:I,stateSyncUnsubscribe:F,stateSyncUpdate:G,stopLocalTrack:p,subscriptionRequest:H,userApprovalRequest:J}},serverInitiatedRenegotiating:{on:{connectionDestroyed:C,endConnection:r,serverRenegotiationFinished:[{target:"sdpNegotiated"}],answerReady:[{actions:[e.onAnswerReady]}],connectionDropped:D,connectionEstablished:E,connectionRoomUpdateReceived:A,dataMessageReceived:z,iceCandidateReady:w,iceCandidateReceived:B,mediaStateUpdateProcessing:m,localMediaStateUpdateReady:q,offerReady:{actions:[e.onOfferReadyCancel]},sendGenericDataMessage:I,stopLocalTrack:p,userApprovalRequest:J,addLocalTracks:a.defer,addParticipants:a.defer,capabilitiesReceived:a.defer,clientInfoReceived:a.defer,createDataMessageSubscription:a.defer,forceEncodingEnabled:a.defer,initiateAddLocalTracks:a.defer,initiatePeerConnectionRestarting:a.defer,initiateRemoveLocalTrack:a.defer,mediaUpdateReceived:a.defer,mediaUpdateResponseReceived:a.defer,participantUpdateReceived:a.defer,removeDataMessageSubscription:a.defer,removeLocalTrack:a.defer,removeParticipants:a.defer,replaceLocalTrack:a.defer,stateSyncUnsubscribe:a.defer,stateSyncUpdate:a.defer,subscriptionRequest:a.defer}},clientInitiatedRenegotiation:{on:{connectionDestroyed:C,endConnection:r,mediaUpdateResponseReceived:[{actions:[e.onMediaUpdateResponseReceived],cond:i.cancelNegotiationsGuard,target:"sdpNegotiated"},{actions:[e.onMediaUpdateResponseReceived]}],remoteSdpSet:{target:"sdpNegotiated"},capabilitiesReceived:s,clientInfoReceived:t,connectionDropped:D,connectionEstablished:[{actions:[d("ZenonConnectionSdpSetState").onConnectionEstablished]}],connectionRoomUpdateReceived:A,createDataMessageSubscription:x,dataMessageReceived:z,forceEncodingEnabled:K,iceCandidateReady:w,iceCandidateReceived:B,mediaUpdateReceived:n,offerReady:{actions:[e.onOfferReady]},participantUpdateReceived:u,removeDataMessageSubscription:y,removeParticipants:v,sdpReceived:[{actions:[e.onSdpReceived],cond:i.sdpAnswerReceiveGuard},a.defer],sendGenericDataMessage:I,stateSyncUnsubscribe:F,stateSyncUpdate:G,userApprovalRequest:J,addLocalTracks:a.defer,addParticipants:a.defer,initiateAddLocalTracks:a.defer,initiatePeerConnectionRestarting:a.defer,initiateRemoveLocalTrack:a.defer,mediaStateUpdateProcessing:a.defer,localMediaStateUpdateReady:a.defer,removeLocalTrack:a.defer,replaceLocalTrack:a.defer,stopLocalTrack:a.defer,subscriptionRequest:a.defer}},peerConnectionRestarting:{on:{connectionDestroyed:babelHelpers["extends"]({},C,{cond:i.secondaryPeerConnectionGuard}),connectionEstablished:{actions:[h.assign(d("ZenonConnectionPeerConnectionRestartingState").onSecondaryConnectionEstablished)],cond:i.secondaryPeerConnectionGuard,target:"sdpNegotiated"},endConnection:r,initiatePeerConnectionRestarting:L,addParticipants:f,answerReady:{actions:[e.onAnswerReady]},capabilitiesReceived:s,clientInfoReceived:t,connectionDropped:D,connectionRoomUpdateReceived:A,dataMessageReceived:babelHelpers["extends"]({},z,{cond:i.secondaryPeerConnectionGuard}),iceCandidateReady:babelHelpers["extends"]({},w,{cond:i.secondaryPeerConnectionGuard}),iceCandidateReceived:B,mediaStateUpdateProcessing:m,localMediaStateUpdateReady:babelHelpers["extends"]({},q,{cond:i.secondaryPeerConnectionGuard}),offerReady:{actions:[e.onOfferReady],cond:i.secondaryPeerConnectionGuard},participantUpdateReceived:u,removeDataMessageSubscription:y,removeParticipants:v,sdpReceived:[{actions:[d("ZenonConnectionPeerConnectionRestartingState").onSdpReceived],cond:i.sdpAnswerOrP2POfferReceiveGuard},a.defer],sendGenericDataMessage:I,stateSyncUnsubscribe:F,stateSyncUpdate:G,stopLocalTrack:p,userApprovalRequest:J,addLocalTracks:a.defer,createDataMessageSubscription:a.defer,forceEncodingEnabled:a.defer,initiateAddLocalTracks:a.defer,initiateRemoveLocalTrack:a.defer,mediaUpdateReceived:a.defer,mediaUpdateResponseReceived:a.defer,removeLocalTrack:a.defer,replaceLocalTrack:a.defer,subscriptionRequest:a.defer}},terminated:{on:{sdpReceived:[{actions:[d("ZenonConnectionTerminatedState").onSdpReceived]}]}}};g["default"]=b}),98);
__d("ZenonConnectionStateModel",["DateConsts","ZenonAppProvider","ZenonAuditedCheckpointLogId","ZenonBrowsers","ZenonConnectionStateTypes","ZenonInfraActionsLogger","ZenonNetworkQualityMonitor","ZenonParticipantState","ZenonPeerConnectionConstants","ZenonRTWebBrowserFeatureSupport","ZenonScreenShare","ZenonScreenSharingAvailabilityType"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,e,f,g,h,i,j){var k;i===void 0&&(i={groupThreadID:null,peerID:null,serverInfoData:null});j===void 0&&(j="init");this.$13=new Map();this.$15=new Map();this.$16=new Map();this.$17=new Map([[d("ZenonPeerConnectionConstants").SCTP_MEDIA_SERVER_ID,-1]]);this.$18=new Map([[-1,d("ZenonPeerConnectionConstants").SCTP_MEDIA_SERVER_ID]]);this.selfParticipantID=(k=a.getActorID())!=null?k:a.getUserInfo().userID;this.collisionContext=i;this.clientEndpointId=e;this.localCallId=f;this.connectionDirection=g;this.connectionState=j;this.actorRepresentatives=new Map();this.duplicatedParticipantsProcessingMode=(k=d("ZenonConnectionStateTypes").ZenonDuplicatedParticipantsProcessingMode.cast(h.getZenonGeneralizedIdentityConfig().getDuplicatedParticipantsProcessingMode()))!=null?k:d("ZenonConnectionStateTypes").ZenonDuplicatedParticipantsProcessingMode.REMOVE_DUPLICATED;this.currentUserCapabilities={canAddParticipants:!1,canApproveCollaborationSpaceJoinRequests:!0,cowatchEnabled:!0,cowatchGroupEnabled:!0,dominantSpeaker:null,multiwayVideoEscalation:h.getZenonPlatformSupportConfig().isMultiwayAvEscalationEnabled()&&d("ZenonBrowsers").supportsMWAVEscalation(),networkStatus:{local:d("ZenonNetworkQualityMonitor").ZenonNetworkQuality.Good,remote:new Map()},screenSharingAvailability:d("ZenonRTWebBrowserFeatureSupport").isReplaceTrackSupported()?c("ZenonScreenSharingAvailabilityType").Available:c("ZenonScreenSharingAvailabilityType").Unknown,screenSharingEnabled:(i=d("ZenonAppProvider").isInstagramApp())!=null?i:void 0,supportConstrainedDevices:{frameRate:null,height:null,isEnabled:!1,width:null},supportMultipleStreams:!d("ZenonScreenShare").screenShareWithReplaceTrack()};this.$1=h;this.$6=function(){return new Map()};this.$7=function(){return[]};this.$8=function(){return[]};this.$9=function(){return a.getStateSyncStore().getInputStates()};this.$10=function(){return a.getStateSyncStore().getOutputStates()};this.$11=new Map();this.$2=b;this.$2.set(this.selfParticipantID,d("ZenonParticipantState").ZenonParticipantState.DISCONNECTED);this.$3=new Set();this.$5=new Map(this.$2);this.$12=null;this.$14=new Map();this.$4=new Map();this.$19=a}var b=a.prototype;b.overrideCurrentUserCapabilities=function(a){this.currentUserCapabilities=a};b.startFailedSubscriptionTimer=function(a){if(this.$13.get(a)!=null)return;var b=15;this.$13.set(a,window.setTimeout(function(){c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,callType:"mw",checkpoint:"[ZP] Failed subscription request for user: "+a+"\n            was never retried after "+b+" seconds",errorDomain:"ZenonConnectionStateModel_startFailedSubscriptionTimer"})},b*d("DateConsts").MS_PER_SEC))};b.clearFailedSubscriptionTimer=function(a){var b=this.$13.get(a);b!=null&&(window.clearTimeout(b),this.$13["delete"](a))};b.getConsolidatedParticipantStates=function(){return this.$5};b.getConnectedParticipantIDs=function(){var a=this;return new Set(Array.from(this.$5.keys()).filter(function(b){return a.$5.get(b)===d("ZenonParticipantState").ZenonParticipantState.CONNECTED}))};b.getRemoteConnectedParticipantIDs=function(){var a=this;return new Set(Array.from(this.$5.keys()).filter(function(b){return b!==a.selfParticipantID&&a.$5.get(b)===d("ZenonParticipantState").ZenonParticipantState.CONNECTED}))};b.updateParticipantState=function(a,b){this.$2.set(a,b);if(!this.$3.has(a)){this.$5=this.$5.set(a,b);if(b!==d("ZenonParticipantState").ZenonParticipantState.CONNECTED&&this.$12!=null&&this.$12.has(a)){(b=this.$12)==null?void 0:b["delete"](a)}}};b.updateConnectionState=function(a){this.connectionState=a};b.updatePreferredCaptureConfigs=function(){var a=this.$1.getPreferredCaptureConfig();a.isEnabledForZenon()&&(this.currentUserCapabilities=babelHelpers["extends"]({},this.currentUserCapabilities,{supportConstrainedDevices:{frameRate:a.getFps(),height:a.getHeightPx(),isEnabled:a.isEnabled(),width:a.getWidthPx()}}))};b.updateCurrentUserCapabilities=function(a){a.addParticipantEnabled!=null&&(this.currentUserCapabilities=babelHelpers["extends"]({},this.currentUserCapabilities,{canAddParticipants:a.addParticipantEnabled})),a.cowatchEnabled!=null&&(this.currentUserCapabilities=babelHelpers["extends"]({},this.currentUserCapabilities,{cowatchEnabled:a.cowatchEnabled})),a.cowatchGroupEnabled!=null&&(this.currentUserCapabilities=babelHelpers["extends"]({},this.currentUserCapabilities,{cowatchGroupEnabled:a.cowatchGroupEnabled})),a.multipleVideoStreamsAllowed!=null&&(this.currentUserCapabilities=babelHelpers["extends"]({},this.currentUserCapabilities,{supportMultipleStreams:a.multipleVideoStreamsAllowed})),a.multiwayVideoEscalation!=null&&(this.currentUserCapabilities=babelHelpers["extends"]({},this.currentUserCapabilities,{multiwayVideoEscalation:a.multiwayVideoEscalation})),a.screenSharingEnabled!=null&&(this.currentUserCapabilities=babelHelpers["extends"]({},this.currentUserCapabilities,{screenSharingEnabled:a.screenSharingEnabled}))};b.updateAllParticipantsCapabilities=function(a){for(a of a){var b=a[0],c=a[1];this.$4.set(b,c)}};b.getUserCapabilities=function(a){return(a=this.$4.get(a))!=null?a:""};b.updateNetworkStatus=function(a){this.currentUserCapabilities=babelHelpers["extends"]({},this.currentUserCapabilities,{networkStatus:a})};b.updateConsolidatedParticipantStates=function(){var a=new Map(this.$2);this.$3.forEach(function(b){a.set(b,d("ZenonParticipantState").ZenonParticipantState.CONNECTED)});this.$5=a};b.getTracks=function(){return this.$6()};b.registerTrackFetcher=function(a){this.$6=a};b.getRtpSenders_I_KNOW_WHAT_I_AM_DOING=function(){return this.$7()};b.registerRtpSendersFetcher=function(a){this.$7=a};b.getRtpReceivers_I_KNOW_WHAT_I_AM_DOING=function(){return this.$8()};b.registerRtpReceiversFetcher=function(a){this.$8=a};b.getStateSyncInputs=function(){return this.$9()};b.getStateSyncOutputs=function(){return this.$10()};b.getUserToTracksMap=function(){return this.$11};b.getRemoteUserToTracksMap=function(){var a=this;return new Map(Array.from(this.$11.entries()).filter(function(b){b=b[0];return b!==a.selfParticipantID}))};b.getExistingParticipantIds=function(){return this.$12||new Set()};b.addLocalTrackToTrackMap=function(a){this.$20(a,this.selfParticipantID)};b.$20=function(a,b){var c;c=(c=this.$11.get(b))!=null?c:new Map();c.set(a.trackID,a);this.$11.set(b,c)};b.removeLocalTrackFromTrackMap=function(a){var b;b=(b=this.$11.get(this.selfParticipantID))!=null?b:new Map();b["delete"](a)};b.updateTrackMapFromMediaStates=function(a,b){var c=this;b===void 0&&(b=!1);this.$3=new Set();a.forEach(function(a){var d=a.participantID;d!=null&&(c.$20(a,d),b||c.$3.add(d))});this.updateConsolidatedParticipantStates()};b.updateExistingParticipantsFromMediaStateTracks=function(a){if(this.$12==null){var b=new Set();a.forEach(function(a){a=a.participantID;a!=null&&b.add(a)});this.$12=b}};b.getIsUserVideoSubscribed=function(a){return(a=this.$14.get(a))!=null?a:!1};b.updateUserVideoSubscription=function(a,b){this.$14.set(a,b)};b.clearAllUserVideoSubscriptions=function(){this.$14=new Map()};b.getRemoteSignalingId=function(){return this.$19.getRemoteSignalingID()};b.updateFromUserIdToNodeIdMap=function(a){this.$15=a,this.$16=new Map(Array.from(this.$15,function(a){return[a[1],a[0]]}))};b.updateFromNodeIdToUserIdMap=function(a){this.$16=a,this.$15=new Map(Array.from(this.$16,function(a){return[a[1],a[0]]}))};b.getUserIdToNodeIdMap=function(){return this.$15};b.registerDataMessageService=function(a,b){this.$17.set(a,b),this.$18.set(b,a)};b.convertServiceIdToNodeId=function(a){return this.$17.get(a)};b.convertUserIdToNodeId=function(a){return this.$15.get(a)};b.convertNodeIdtoUserId=function(a){var b;return(b=this.$16.get(a))!=null?b:this.$18.get(a)};b.userIds=function(){return Array.from(this.$15.keys())};return a}();g["default"]=a}),98);
__d("ZenonConnectionStatePeerConnectionDelegate",["Promise","ZenonLogPromiseRejection"],(function(a,b,c,d,e,f,g){"use strict";var h,i={connectionDestroyed:function(a,d,e){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){a.processEvent({onError:c,onSuccess:b,payload:{error:e,peerConnectionRole:d},type:"connectionDestroyed"})}))},connectionDropped:function(a,d){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){a.processEvent({onError:c,onSuccess:b,payload:{peerConnectionRole:d},type:"connectionDropped"})}))},connectionEstablished:function(a,d){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){a.processEvent({onError:c,onSuccess:b,payload:{peerConnectionRole:d},type:"connectionEstablished"})}))},createDataMessageSubscription:function(a,d,e){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){a.processEvent({onError:c,onSuccess:b,payload:{dataChannelLabel:d,messageHandler:e},type:"createDataMessageSubscription"})}))},dataChannelMesageReceived:function(a,d,e,f){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){a.processEvent({onError:c,onSuccess:b,payload:{dataChannelLabel:e,dataMessage:f,peerConnectionRole:d},type:"dataMessageReceived"})}))},removeDataMessageSubscription:function(a,d,e){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){a.processEvent({onError:c,onSuccess:b,payload:{dataChannelLabel:d,messageHandler:e},type:"removeDataMessageSubscription"})}))},sendIceCandidate:function(a,d,e){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){a.processEvent({onError:c,onSuccess:b,payload:{candidate:e,peerConnectionRole:d},type:"iceCandidateReady"})}))},sendLocalMediaStateUpdate:function(a,d,e){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){a.processEvent({onError:c,onSuccess:b,payload:{mediaStates:e,peerConnectionRole:d},type:"localMediaStateUpdateReady"})}))},sendRemoteSdpSet:function(a,d){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){a.processEvent({onError:c,onSuccess:b,payload:{peerConnectionRole:d},type:"remoteSdpSet"})}))},sendSdpReady:function(a,d,e,f,g,i){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){var h={tracks:[],version:e.version};f.forEach(function(a){a={enabled:a.enabled,participantID:g,trackID:a.trackId,type:a.contentType};h.tracks.push(a)});var j={connectionDirection:i,mediaStates:h,peerConnectionRole:d,sdp:e};e.type==="offer"?a.processEvent({onError:c,onSuccess:b,payload:j,type:"offerReady"}):a.processEvent({onError:c,onSuccess:b,payload:j,type:"answerReady"})}))},setPeerConnectionEventHandlers:function(a,b,c,d,e){a.setPeerConnectionEventHandlers({onConnectionDestroyed:function(a){return i.connectionDestroyed(b,c,a)},onConnectionDropped:function(){return i.connectionDropped(b,c)},onConnectionEstablished:function(){return i.connectionEstablished(b,c)},onCreateDataMessageSubscription:function(a,c){return i.createDataMessageSubscription(b,a,c)},onDataChannelMessageReceived:function(a,d){return i.dataChannelMesageReceived(b,c,a,d)},onIceCandidateReady:function(a){return i.sendIceCandidate(b,c,a)},onLocalMediaStateUpdate:function(a){return i.sendLocalMediaStateUpdate(b,c,a)},onLocalSdpSet:function(a,f){return i.sendSdpReady(b,c,a,f,d().selfParticipantID,e)},onRemoteSdpSet:function(){return i.sendRemoteSdpSet(b,c)},onRemoveDataMessageSubscription:function(a,c){return i.removeDataMessageSubscription(b,a,c)}})}};a=i;g["default"]=a}),98);
__d("ZenonConnectionStateSignalingDelegate",["Promise","ZenonLogPromiseRejection"],(function(a,b,c,d,e,f,g){"use strict";var h,i={onCapabilitiesReceived:function(a,d,e){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){a.processEvent({onError:c,onSuccess:b,payload:{capabilities:d,escalationConferenceName:e},type:"capabilitiesReceived"})}))},onClientInfoReceived:function(a,d,e,f){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){a.processEvent({onError:c,onSuccess:b,payload:{actorRepresentatives:e,mediaPath:f,userCapabilities:d},type:"clientInfoReceived"})}))},onClientRenegotiationReceived:function(a,b){a.processEvent(b)},onDismissReceived:function(a,d,e,f){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){var g;g={detailedReasonFromMW:f,dismissReason:d,dismissReasonSetByRemote:!0,dismissSubreason:"Server sent dismiss message to client: "+((g=e)!=null?g:"null"),shouldInformPeer:!1};a.processEvent({onError:c,onSuccess:b,payload:g,type:"endConnection"})}))},onGenericDataMessageReceived:function(a,d,e){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){var f={dataChannelLabel:d,dataMessage:e};a.processEvent({onError:c,onSuccess:b,payload:f,type:"dataMessageReceived"})}))},onIceCandidateReceived:function(a,d){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){a.processEvent({onError:c,onSuccess:b,payload:d,type:"iceCandidateReceived"})}))},onMediaUpdateReceived:function(a,d){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){a.processEvent({onError:c,onSuccess:b,payload:{mediaStates:d},type:"mediaUpdateReceived"})}))},onMediaUpdateResponseReceived:function(a,d){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){a.processEvent({onError:c,onSuccess:b,payload:d,type:"mediaUpdateResponseReceived"})}))},onParticipantUpdateReceived:function(a,d,e){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){a.processEvent({onError:c,onSuccess:b,payload:{participantStates:d,sctpUserIdNodeIdMap:e},type:"participantUpdateReceived"})}))},onPendingApprovalReceived:function(a){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){a.processEvent({onError:c,onSuccess:b,type:"pendingApproval"})}))},onRenegotiationRequested:function(a,d){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){a.processEvent({onError:c,onSuccess:b,payload:{hasRemoteOffer:d},type:"initiatePeerConnectionRestarting"})}))},onRoomContextUpdateReceived:function(a,d){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){a.processEvent({onError:c,onSuccess:b,payload:{context:d},type:"connectionRoomUpdateReceived"})}))},onSdpReceived:function(a,d,e,f,g,i,j,k,l,m){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){a.processEvent({onError:c,onSuccess:b,payload:{e2eeServerState:m,mediaPath:e,mediaStates:f,messageID:l,onProcessed:k,renegotiationOffer:i,sdp:d,sdpOriginLocalId:j,source:g},type:"sdpReceived"})}))},onServerRenegotiationFinished:function(a){return c("ZenonLogPromiseRejection")(new(h||(h=b("Promise")))(function(b,c){a.processEvent({onError:c,onSuccess:b,type:"serverRenegotiationFinished"})}))},setSignalingEventHandlers:function(a,b){a.setSignalingEventHandlers({onCapabilitiesReceived:function(a,c){return i.onCapabilitiesReceived(b,a,c)},onClientInfoReceived:function(a,c,d){return i.onClientInfoReceived(b,a,c,d)},onClientRenegotiationReceived:function(a){return i.onClientRenegotiationReceived(b,a)},onDismissReceived:function(a,c,d,e){return i.onDismissReceived(b,c,d,e)},onGenericDataMessageReceived:function(a,c){return i.onGenericDataMessageReceived(b,a,c)},onIceCandidateReceived:function(a){return i.onIceCandidateReceived(b,a)},onMediaUpdateReceived:function(a){return i.onMediaUpdateReceived(b,a)},onMediaUpdateResponseReceived:function(a){return i.onMediaUpdateResponseReceived(b,a)},onParticipantUpdateReceived:function(a,c){return i.onParticipantUpdateReceived(b,a,c)},onPendingApprovalReceived:function(){return i.onPendingApprovalReceived(b)},onRenegotiationRequested:function(a){return i.onRenegotiationRequested(b,a)},onRoomContextUpdateReceived:function(a){return i.onRoomContextUpdateReceived(b,a)},onSdpReceived:function(a,c,d,e,f,g,h,j,k){return i.onSdpReceived(b,a,c,d,e,f,g,h,j,k)},onServerRenegotiationFinished:function(){return i.onServerRenegotiationFinished(b)}})}};a=i;g["default"]=a}),98);
__d("ZenonLogRenderResolutionStats",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){b.setRenderResolutionListener({onRenderResolutionChange:function(b){Object.values(b).flatMap(function(a){return Object.values(a)}).filter(function(b){return a.has(b.streamId)}).forEach(function(b){var c=a.get(b.streamId);c&&(c.displayResolutionData=b)})}})}f["default"]=a}),66);
__d("ZenonNodeIdNotificationHandler",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){a=JSON.parse(a.message);var c=new Map();for(var d of Object.entries(a.nodeIdToUserIdMap)){var e=d[0],f=d[1];c.set(parseInt(e,10),String(f))}b.updateFromNodeIdToUserIdMap(c);for(e of Object.entries(a.nodeIdToServiceTypeMap)){f=e[0];d=e[1];b.registerDataMessageService(String(d),parseInt(f,10))}}f.handleNodeIdNotificationMessage=a}),66);
__d("ZenonSctpMessageTranslator",["RequestStreamBodyUtils","ZenonActorHooks","ZenonAuditedCheckpointLogId","ZenonInfraActionsLogger","ZenonPeerConnectionConstants"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,c,d){this.$1=a,this.$2=b,this.$3=c,this.$4=d}var b=a.prototype;b.toSctpDatagram=function(a){var b,e=this,f=this.$1(a.sender);if(f==null){c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,error:"Cannot find node id of SCTP datagram sender "+d("ZenonActorHooks").ZenonActor.getID(),errorDomain:"ZenonSctpMessageTranslator toSctpDatagram"});return}var g=new Set();if(!a.recipients)return{payload:d("RequestStreamBodyUtils").stringToUint8Array(a.message),receivers:g,sender:f};(b=a.recipients.recipientIDs)==null?void 0:b.forEach(function(a){var b=e.$2(a);if(b!=null)g.add(b);else{b=e.$1(a);b==null?c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,error:"Cannot find node id of SCTP datagram receiver "+a,errorDomain:"ZenonSctpMessageTranslator toSctpDatagram"}):g.add(b)}});(b=a.recipients)==null?void 0:(b=b.recipientNodeIDs)==null?void 0:b.forEach(function(a){g.add(a)});(b=a.recipients)==null?void 0:(b=b.serviceRecipients)==null?void 0:b.forEach(function(a){if(a===2){a=e.$2(d("ZenonPeerConnectionConstants").SCTP_MEDIA_SERVER_ID);a!=null&&g.add(a)}});return{payload:d("RequestStreamBodyUtils").stringToUint8Array(a.message),receivers:g,sender:f}};b.toUserId=function(a){return this.$3(a)};b.toNodeId=function(a){return this.$1(a)};b.userIds=function(){return this.$4()};return a}();g["default"]=a}),98);
__d("ZenonConnectionStateManager",["DateConsts","FBLogger","OverlayConfigServerLayer","ZenonAppProvider","ZenonAuditedCheckpointLogId","ZenonCallsModelEmitter","ZenonCallsModelTypes","ZenonConnectionStateMachine","ZenonConnectionStateModel","ZenonConnectionStatePeerConnectionDelegate","ZenonConnectionStateSignalingDelegate","ZenonDismissReason","ZenonE2ee","ZenonEncryptionKeysManagerState","ZenonInfraActionsLogger","ZenonLogPromiseRejection","ZenonLogRenderResolutionStats","ZenonNetworkQualityMonitor","ZenonNodeIdNotificationHandler","ZenonParticipantState","ZenonPeerConnectionManager","ZenonSCTPConstants","ZenonSctpMessageTranslator","ZenonSignalingConstants","deepEquals","err","getZenonMqttChannel","gkx","promiseDone","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h="E2eeState",i=2*d("DateConsts").MS_PER_MIN,j=new Set([(a=d("ZenonSCTPConstants")).SCTP_DATA_TOPIC,a.SCTP_FAILOVER_TOPIC,a.SCTP_MEDIA_SUBSCRIPTIONS,a.E2EE_DATA_MESSAGE_MEDIA_CHANNEL_TOPIC,a.SCTP_SIGNALING_TOPIC,a.SIMULCAST_TOPIC,a.SCTP_RRR]);b=function(){function a(a,b,e,f,g,h,i,j){var k=this;i===void 0&&(i=!1);this.$7={local:d("ZenonNetworkQualityMonitor").ZenonNetworkQuality.Good,remote:new Map()};this.$8=new(c("ZenonSctpMessageTranslator"))(function(a){return k.$3.convertUserIdToNodeId(a)},function(a){return k.$3.convertServiceIdToNodeId(a)},function(a){return k.$3.convertNodeIdtoUserId(a)},function(){return k.$3.userIds()});this.$11=function(){return k.$3};this.$9=function(a){a(k.$3),k.$10(),k.$18()};this.$5=g;this.$5.log({isIncomingConnection:e==="incoming",name:"connectionStart"});this.$1=a;a=c("uuidv4")();var l=g.getLogIdentifiers().localCallID,m=b.getSignalingModel();this.$2=b.getSignalingModel().getSignalingID();m.setNotifyCallback(function(){k.$9(function(a){a.collisionContext.serverInfoData=m.getRemoteSignalingID()});var a=m.getOverlayConfigServerLayer();a&&f.setServerLayer(a)});this.$3=new(c("ZenonConnectionStateModel"))(m,new Map(),a,l,e,f,{groupThreadID:null,peerID:null,serverInfoData:b.getSignalingModel().getRemoteSignalingID()});this.$5.log({name:"peerConnectionManagerCreated"});a=new Map();j&&c("ZenonLogRenderResolutionStats")(a,j);l={configManager:f,dataMessageTranslator:this.$8,loggingEventHandler:function(a){return g.log(a)},mediaStats:a,shouldUseSimulcast:i};var n=new(c("ZenonPeerConnectionManager"))(l);a=m.getMediaModeManager().getMediaMode()==="sfu"||((j=m.getRoomInfo().context)==null?void 0:j.peerID)!=null&&e==="outgoing";n.setIceRestartEligible(a);n.registerTrackListener(function(){k.$10()});n.setNetworkStatusListener(function(a){var b=k.$7;if(c("deepEquals")(b,a))return;k.$3.updateNetworkStatus(a);k.$10();k.$7=a;n.onNetworkUpdate(a);a.local!==b.local&&c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"ZenonNetworkQuality: "+a.local})});var o=new(c("ZenonPeerConnectionManager"))(l);o.setNetworkStatusListener(function(a){var b=k.$7;if(c("deepEquals")(b,a))return;k.$3.updateNetworkStatus(a);k.$10();k.$7=a;o.onNetworkUpdate(a);a.local!==b.local&&c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"ZenonNetworkQuality: "+a.local})});h.setupSctpChannelApi(b.getSignalingModel().getSignalingID(),b.getSignalingModel().getMediaModeManager(),n);this.$4=new(c("ZenonConnectionStateMachine"))({getConnectionModel:this.$11,logEvent:function(a){return g.log(a)},peerConnectionManager:n,sctpHelper:h,sctpMessageTranslator:this.$8,secondaryPeerConnectionManager:o,signalingClient:b,updateConnectionModel:this.$9});c("ZenonConnectionStateSignalingDelegate").setSignalingEventHandlers(b,this.$4);c("ZenonConnectionStatePeerConnectionDelegate").setPeerConnectionEventHandlers(n,this.$4,"primary",this.$11,e);c("ZenonConnectionStatePeerConnectionDelegate").setPeerConnectionEventHandlers(o,this.$4,"secondary",this.$11,e);c("promiseDone")(this.createDataMessageSubscription(d("ZenonSCTPConstants").SIMULCAST_TOPIC,function(a){try{n.maybeHandleSignalingSimulcastDataMessage(a)}catch(a){c("FBLogger")("rtc_www").warn("maybeHandleVideouploadRequest failed:",a)}}));this.$12();c("ZenonE2ee").isE2eeStackReady()&&this.$13(b);c("gkx")("25202")&&this.$14(b);b.setLoggingEventHandler(function(a){return g.log(a)});this.$6=0}var b=a.prototype;b.getSctpMessageTranslator=function(){return this.$8};b.start=async function(a){var b=this;try{this.$5.log({name:"mqttConnectionState",pending:!0});var e=c("getZenonMqttChannel")();await this.$15(e);this.$5.log({name:"mqttConnectionState",pending:!1})}catch(a){c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,callType:"mw",checkpoint:"[ZP] Attempting to establish MQTT connection",error:a.message,errorDomain:"ZenonConnectionStateManager_start"});c("promiseDone")(this.end(d("ZenonDismissReason").ZenonDismissReason.ClientError,"MQTT did not connect"));return}e=a.appMessages;var f=a.callMedia,g=a.initialSyncStates,h=a.isSecondaryJoinRole,i=a.localMedia,k=a.mwThriftRingRequest,l=a.usersToRing,m=k!=null;m=m?"incoming":"outgoing";k=(k=k==null?void 0:k.messageBody)!=null?k:{};k=k.ringRequest;var n,o;if(k){n=Array.from(k.otherParticipants);o=((k=k.offer)==null?void 0:k.sdpString)!=null}var p=(k=a.dataChannels)!=null?k:new Set();j.forEach(function(a){return p.add(a)});a=await this.$16();var q={appMessages:e,callMedia:f,dataChannels:p,direction:m,hasOfferInRing:o,initialSyncStates:(k=g)!=null?k:new Map(),isSecondaryJoinRole:h,serializedInitialSyncStates:a,tracks:i,usersToRing:l,usersToRingFromRingRequest:n};return c("ZenonLogPromiseRejection")(new Promise(function(a,c){b.$4.processEvent({onError:c,onSuccess:a,payload:q,type:"createConnection"})}))};b.muteTrack=function(a,b){b===void 0&&(b=!1);return c("ZenonLogPromiseRejection")(this.$17(a,!1,b))};b.unmuteTrack=function(a,b){b===void 0&&(b=!1);return c("ZenonLogPromiseRejection")(this.$17(a,!0,b))};b.$17=function(a,b,c){var d=this;c===void 0&&(c=!1);return new Promise(function(e,f){var g={enabled:b,isRemote:c,trackID:a};d.$4.processEvent({onError:f,onSuccess:e,payload:g,type:"mediaStateUpdateProcessing"})})};b.stopLocalTrack=function(a){var b=this;return c("ZenonLogPromiseRejection")(new Promise(function(c,d){var e={trackID:a};b.$4.processEvent({onError:d,onSuccess:c,payload:e,type:"stopLocalTrack"})}))};b.end=function(a,b){var d=this;return c("ZenonLogPromiseRejection")(new Promise(function(c,e){var f={dismissReason:a,dismissReasonSetByRemote:!1,dismissSubreason:b,shouldInformPeer:!0};d.$4.processEvent({onError:e,onSuccess:c,payload:f,type:"endConnection"})}))};b.addParticipants=function(a,b){var d=this;return c("ZenonLogPromiseRejection")(new Promise(function(c,e){var f={groupThreadId:b,usersToRing:a};d.$4.processEvent({onError:e,onSuccess:c,payload:f,type:"addParticipants"})}))};b.removeParticipants=function(a){var b=this;return c("ZenonLogPromiseRejection")(new Promise(function(c,d){var e={usersToRemove:a};b.$4.processEvent({onError:d,onSuccess:c,payload:e,type:"removeParticipants"})}),d("ZenonAppProvider").isCastingCenterApp())};b.addLocalTrack=function(a){var b=this;return c("ZenonLogPromiseRejection")(new Promise(function(c,d){b.$4.processEvent({onError:d,onSuccess:c,payload:{tracks:[a]},type:"addLocalTracks"})}))};b.replaceLocalTrack=function(a,b,d){var e=this;d===void 0&&(d=!1);return c("ZenonLogPromiseRejection")(new Promise(function(c,f){e.$4.processEvent({onError:f,onSuccess:c,payload:babelHelpers.extends({},d?{preserveOriginal:d}:{},{replacementTrack:b,trackIDToReplace:a}),type:"replaceLocalTrack"})}))};b.removeLocalTrack=function(a){var b=this;return c("ZenonLogPromiseRejection")(new Promise(function(c,d){b.$4.processEvent({onError:d,onSuccess:c,payload:{trackID:a},type:"removeLocalTrack"})}))};b.createDataMessageSubscription=function(a,b,d,e){var f=this;return c("ZenonLogPromiseRejection")(new Promise(function(c,g){f.$4.processEvent({onError:g,onSuccess:c,payload:{dataChannelLabel:a,dataChannelOptions:e,messageHandler:b,onSctpChannelOpenCallback:d},type:"createDataMessageSubscription"})}))};b.removeDataMessageSubscription=function(a,b){var d=this;return c("ZenonLogPromiseRejection")(new Promise(function(c,e){d.$4.processEvent({onError:e,onSuccess:c,payload:{dataChannelLabel:a,messageHandler:b},type:"removeDataMessageSubscription"})}))};b.sendGenericDataMessage=function(a,b,d,e){var f=this;return c("ZenonLogPromiseRejection")(new Promise(function(c,g){var h={data:b,recipients:d,topic:a,transportType:e};f.$4.processEvent({onError:g,onSuccess:c,payload:h,type:"sendGenericDataMessage"})}))};b.registerDataMessageService=function(a,b){var d=this;return c("ZenonLogPromiseRejection")(new Promise(function(c,e){d.$3.registerDataMessageService(a,b),c()}))};b.updateStateSyncTopic=function(a,b){var d=this;return c("ZenonLogPromiseRejection")(new Promise(function(c,e){var f={inputData:b,topic:a};d.$4.processEvent({onError:e,onSuccess:c,payload:f,type:"stateSyncUpdate"})}))};b.unsubscribeFromStateSyncTopic=function(a){var b=this;return c("ZenonLogPromiseRejection")(new Promise(function(c,d){var e={topic:a};b.$4.processEvent({onError:d,onSuccess:c,payload:e,type:"stateSyncUnsubscribe"})}))};b.subscribeToRemoteVideo=function(a,b){var d=this;return c("ZenonLogPromiseRejection")(new Promise(function(c,e){var f={includeDominantSpeaker:b,subscriptions:a};d.$4.processEvent({onError:e,onSuccess:c,payload:f,type:"subscriptionRequest"})}))};b.approveParticipants=function(a){var b=this;return c("ZenonLogPromiseRejection")(new Promise(function(c,d){b.$4.processEvent({onError:d,onSuccess:c,payload:{approvalStatus:1,targetUsers:a},type:"userApprovalRequest"})}))};b.denyParticipants=function(a){var b=this;return c("ZenonLogPromiseRejection")(new Promise(function(c,d){b.$4.processEvent({onError:d,onSuccess:c,payload:{approvalStatus:0,targetUsers:a},type:"userApprovalRequest"})}))};b.forceEncodingEnabled=function(a){var b=this;return c("ZenonLogPromiseRejection")(new Promise(function(c,d){b.$4.processEvent({onError:d,onSuccess:c,payload:{enabled:a},type:"forceEncodingEnabled"})}))};b.getConnectionState=function(){return this.$3.connectionState};b.getSCTPDataChannelState=function(a){return this.$4.getContext().peerConnectionManager.getDataChannelState(a)};b.getClientCallID=function(){return this.$1};b.getSignalingID=function(){return this.$2};b.getRemoteSignalingID=function(){return this.$3.collisionContext.serverInfoData};b.getEncryptionKeysManagerState=function(){var a;return(a=c("ZenonE2ee").getEncryptionKeysManagerState())!=null?a:d("ZenonEncryptionKeysManagerState").ZenonEncryptionKeysManagerState$DefaultConstructor()};b.checkAllRemoteUsersHaveCapability=function(a){var b=this,d=this.$3.getRemoteConnectedParticipantIDs(),e=d.size>0;d.forEach(function(d){d=b.$3.getUserCapabilities(d);try{d=JSON.parse(d);e=e&&((d=d[a])!=null?d:!1)}catch(a){c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"Failed to parse capabilities String"}),e=!1}});return e};b.$12=function(){var a=this;c("promiseDone")(this.createDataMessageSubscription(d("ZenonSCTPConstants").NODEID_NOTIFICATION_TOPIC,function(b){d("ZenonNodeIdNotificationHandler").handleNodeIdNotificationMessage(b,a.$3)}))};b.$14=function(a){var b=a.getSignalingModel().getStateSyncStore();b.addTopicHandler(d("ZenonSignalingConstants").CONFIG_ENGINE_STATE_SYNC_TOPIC,function(b){b=(b=b==null?void 0:(b=b.overlayConfigServerLayer)==null?void 0:b.values)!=null?b:null;if(b==null)return Promise.resolve();b=new(c("OverlayConfigServerLayer"))(b);a.getSignalingModel().updateOverlayConfigServerLayer(b);return Promise.resolve()})};b.$13=function(a){var b=this;a=a.getSignalingModel().getStateSyncStore();a.addTopicHandler(h,async function(a){await c("ZenonE2ee").processE2eeServerState(a==null?void 0:a.data);if(((a=c("ZenonE2ee").getEncryptionKeysManagerState())==null?void 0:a.sfuE2eeNegotiationState)===0){b.$5.log({name:"sfuE2eeNegotiationComplete"});return}});c("promiseDone")(this.createDataMessageSubscription(d("ZenonSCTPConstants").E2EE_DATA_MESSAGE_TOPIC,function(a){return void c("ZenonE2ee").processE2eeMessage(a)}));c("promiseDone")(this.createDataMessageSubscription(d("ZenonSCTPConstants").E2EE_DATA_MESSAGE_MEDIA_CHANNEL_TOPIC,function(a){return void c("ZenonE2ee").processE2eeMessage(a)},function(){return c("ZenonE2ee").onMediaDataChannelReady()}))};b.$16=async function(){var a,b=await c("ZenonE2ee").getSerializedE2eeClientState();b!=null&&(b.byteLength===0&&c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"E2ee client state is empty"}),a=new Map(),a.set(h,{data:b,version:1}));return a};b.$10=function(){d("ZenonCallsModelEmitter").CallsModelEmitterInstance.emitCallsModel(this.$1,this.$3)};b.$18=function(){if(d("ZenonCallsModelEmitter").CONNECTION_STATE_TO_CALL_STATE_MAP[this.$3.connectionState]!==d("ZenonCallsModelTypes").ZenonCallState.Connected)return;var a=this.$3.getConsolidatedParticipantStates();if(a){a=Array.from(a.values());a=a.filter(function(a){return a===d("ZenonParticipantState").ZenonParticipantState.CONNECTED});a=a.length;a>this.$6&&(this.$5.log({connectedParticipantsCount:a,name:"setMaxConnectedParticipants"}),this.$6=a)}};b.$15=function(a){return new Promise(function(b,d){if(a.getConnectionState()==="Connected")b();else{c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"MQTT not connected, deferring call start"});var e={onMQTTStateChanged:function(c){c==="Connected"&&(a.unsubscribeChannelEvents(e),window.clearTimeout(f),b())}},f=window.setTimeout(function(){a.unsubscribeChannelEvents(e),c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"MQTT never connected. Current status: "+a.getConnectionState()}),d(c("err")("timeout"))},i);a.subscribeChannelEvents(e)}})};return a}();g.default=b}),98);
__d("ZenonMediaTypes",[],(function(a,b,c,d,e,f){"use strict";a="text";b="detail";c="motion";d={audio:"audio",screen:"screen",screen_audio:"screen_audio",video:"video"};e="audioinput";var g="audiooutput",h="videoinput";f.TEXT_VIDEO_CONTENT_HINT=a;f.DETAIL_VIDEO_CONTENT_HINT=b;f.MOTION_VIDEO_CONTENT_HINT=c;f.STRING_TO_MEDIA_TYPE=d;f.AUDIO_INPUT_DEVICE_KIND=e;f.AUDIO_OUTPUT_DEVICE_KIND=g;f.VIDEO_INPUT_DEVICE_KIND=h}),66);
__d("ZenonInsertableStreamsManager",["FrameEncryptionWasmTypes","ODS","ZenonE2ee","ZenonE2eeWasmWorkerClient","ZenonInsertableStreamsMessage","ZenonMediaTypes","ZenonRTWebBrowserFeatureSupport","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i="Insertable Streams not supported in E2ee mandated call";a=function(){function a(){}var b=a.prototype;b.setupSenderTransform=async function(a,b){var e=this.senderReceiverTransformGuards(a);if(e!=null){c("ZenonE2ee").terminateCallIfE2eeViolation(d("FrameEncryptionWasmTypes").ZenonE2eeComponent.INSERTABLE_STREAMS,"Sender "+e);return}if(typeof a.createEncodedStreams==="function"&&a.track!==null){e=a.track.id;var f=a.senderStreams==null?a.createEncodedStreams():a.senderStreams;a.senderStreams=f;c("ZenonE2ee").shouldUseE2eeWorker()?await c("ZenonE2eeWasmWorkerClient").transformStream(new(c("ZenonInsertableStreamsMessage"))(null,b,"encode",f.readable,e,f.writable)):this.$2(e,b,f.readable,f.writable)}};b.setupReceiverTransform=async function(a,b){var e=this.senderReceiverTransformGuards(b);if(e!=null){c("ZenonE2ee").terminateCallIfE2eeViolation(d("FrameEncryptionWasmTypes").ZenonE2eeComponent.INSERTABLE_STREAMS,"Receiver "+e);return}if(typeof b.createEncodedStreams==="function"&&b.track!==null){e=b.track.id;var f=d("ZenonMediaTypes").STRING_TO_MEDIA_TYPE[b.track.kind],g=b.receiverStreams==null?b.createEncodedStreams():b.receiverStreams;b.receiverStreams=g;c("ZenonE2ee").shouldUseE2eeWorker()?await c("ZenonE2eeWasmWorkerClient").transformStream(new(c("ZenonInsertableStreamsMessage"))(a,f,"decode",g.readable,e,g.writable)):this.$3(a,e,f,g.readable,g.writable)}};b.senderReceiverTransformGuards=function(a){if(!d("ZenonRTWebBrowserFeatureSupport").isInsertableStreamsSupported())return i;if(typeof a.createEncodedStreams!=="function")return"createEncodedStreams is not a function";if(a.track===null)return"has no track"};b.$2=function(a,b,e,f){var g=this;e=e;f=f;var i=c("ZenonE2ee").getSecureFrameManager();i==null?void 0:i.createEncryptorWithId(a,b);b=new TransformStream({transform:function(b,e){g.$1==null&&(g.$1=c("ZenonE2ee").canSkipFrameEncryption()),g.$1?void e.enqueue(b):i?(b.data=i.encrypt(a,b),void e.enqueue(b)):(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_e2ee","secure_frame_manager_null_at_encrypt_transform")}});c("promiseDone")(e.pipeThrough(b).pipeTo(f))};b.$3=function(a,b,e,f,g){var i=this;f=f;g=g;var j=c("ZenonE2ee").getSecureFrameManager();j==null?void 0:j.createDecryptorWithId(b,a,e);a=new TransformStream({transform:function(a,e){i.$1==null&&(i.$1=c("ZenonE2ee").canSkipFrameEncryption());if(i.$1)void e.enqueue(a);else if(j){var f=j.decrypt(b,a);a.data=f.data;f.hasError||void e.enqueue(a)}else(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_e2ee","secure_frame_manager_null_at_decrypt_transform")}});c("promiseDone")(f.pipeThrough(a).pipeTo(g))};return a}();g.default=a}),98);
__d("ZenonRTCVideoResolutionHelper",["Promise","gkx","promiseDone","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h,i=!1,j=10;a=function(){function a(){}a.getMaxParticipants180=function(){return 100};a.getMaxParticipants360=function(){return 100};a.getMaxParticipants720=function(){return 2};a.shouldUseSupportedScaleFactorList=function(){return!1};a.shouldUseConservativeWayWhenSearchingForScalingRatio=function(){return!1};a.encoderScalingEnabled=function(){return c("gkx")("25156")};a.bitrateCappingEnabled=function(){return!0};a.getMaxBitrate720=function(){return 3e6};a.getMaxBitrate360=function(){return 1e6};a.getMaxBitrate180=function(){return 3e5};a.getMaxBitrateForResolution=function(b){if(!a.bitrateCappingEnabled())return 0;if(b===180)return a.getMaxBitrate180();if(b===360)return a.getMaxBitrate360();return b===720?a.getMaxBitrate720():0};a.getMaxEncResolution=function(b){if(!a.encoderScalingEnabled())return null;var c=a.getMaxParticipants720(),d=a.getMaxParticipants360(),e=a.getMaxParticipants180(),f={height:720,width:1280},g={height:360,width:640},h={height:180,width:320};if(c>0&&b<=c)return f;if(d>0&&b<=d)return g;if(e>0&&b<=e)return h;if(e>0)return h;if(d>0)return g;return c>0?f:null};a.getMaxEncResolutionSimulcast=function(b,d,e,f){var g={height:720,width:1280},h={height:360,width:640},i={height:180,width:320};if(d<=e&&e<=2&&d>=0&&d<f){if(f===1)return a.getMaxEncResolution(b);if(f===2)if(d===0)return i;else return b>2?h:g;if(f===3)if(d===0)return i;else if(d===1)return h;else if(d===2)return g}c("recoverableViolation")("Unsupported simulcast parameters passed to getMaxEncResolutionSimulcast","rtc_www");return null};a.getScalingFactor=function(b,c,d,e,f){f===void 0&&(f=!1);if(b.width==null||b.width<=0||b.height==null||b.height<=0||c.width==null||c.width<=0||c.height==null||c.height<=0)return null;var g=c.width;c=c.height;var h=b.width;b=b.height;if(f){f=[1,2,4];var i=Math.sqrt(g*c/(h*b));if(i<1+e)return 1;var j=1,k=Number.MAX_VALUE;for(f of f){var l=Math.abs(f-i);(a.shouldUseConservativeWayWhenSearchingForScalingRatio()?l<k:l<=k)&&Math.floor(g/f)%2===0&&Math.floor(c/f)%2===0&&(j=f,k=Math.abs(f-i))}return j}else{l=Math.sqrt(g*c/(h*b));if(l<1+e)return 1;return d?Math.floor(l+e):l}};a.maybeLimitEncodingResolutionByParticipantCountHelper=function(b,c,d,e,f,g){g===void 0&&(g=!1);if(!a.encoderScalingEnabled()||f)return;if(d!=null&&d.length>0){f=d.filter(function(a){var b;return((b=a.receiver.track)==null?void 0:b.kind)==="video"&&a.currentDirection!=="inactive"&&((b=a.receiver.track)==null?void 0:b.readyState)==="live"});d=f.length;g&&(d-=1)}else{f=c.filter(function(a){return((a=a.track)==null?void 0:a.kind)==="video"});g=f.length;d=g+1}c=a.getMaxEncResolution(d);if(!c)return;f=[c];a.maybeLimitEncodingResolution(b,f,i,j/100,e,a.shouldUseSupportedScaleFactorList())};a.maybeLimitEncodingResolution=function(d,e,f,g,i,j){j===void 0&&(j=!1);d=d.filter(function(a){return((a=a.track)==null?void 0:a.kind)==="video"});if(d.length>0){var k;d=d[0];var l=d.getParameters==null?void 0:d.getParameters();k=(k=d.track)==null?void 0:k.getSettings();if(k==null||l==null||l.encodings==null||e.length!==l.encodings.length)return;for(e of e.entries()){var m=e[0],n=e[1],o=i?1:a.getScalingFactor(n,{height:k.height,width:k.width},f,g,j);if(o==null)continue;o===1?delete l.encodings[m].scaleResolutionDownBy:l.encodings[m].scaleResolutionDownBy=o;if(!i&&n.width!=null&&n.height!=null){o=Math.min(n.width,n.height);n=a.getMaxBitrateForResolution(o);n>0&&(l.encodings[m].maxBitrate=n)}else i&&delete l.encodings[m].maxBitrate}c("promiseDone")((o=d.setParameters==null?void 0:d.setParameters(l))!=null?o:(h||(h=b("Promise"))).resolve())}};a.maybeLimitEncodingResolutionByParticipantCount=function(b,c,d,e,f){f===void 0&&(f=!1);return a.maybeLimitEncodingResolutionByParticipantCountHelper(b,c,d,a.$1>0,e,f)};a.handleStartScreenSharing=function(b,c,d,e){a.$1++;return a.maybeLimitEncodingResolutionByParticipantCountHelper(b,c,d,a.$1>0,e)};a.handleStopScreenSharing=function(b,c,d,e){a.$1--;return a.maybeLimitEncodingResolutionByParticipantCountHelper(b,c,d,a.$1>0,e)};return a}();a.$1=0;g["default"]=a}),98);
__d("ZenonSimulcastManager",["ZenonRTCVideoResolutionHelper"],(function(a,b,c,d,e,f,g){"use strict";var h=25e5,i=25e6,j=15,k=15e4,l=3e4,m=180*320,n=90*160;e=!1;f=0;var o=3,p=3;function a(a,b,c,d,e,f,g,k,l){e===void 0&&(e=!1);f===void 0&&(f=2);g===void 0&&(g={height:720,width:1280});k===void 0&&(k=!0);l===void 0&&(l=0);d=q(b.perSsrcTargetBitrateBpsMap,d);var m=0,n=[],o=[];for(var p=0;p<a.encodings.length;p++)if(t(p,b.qualityMask)){m++;var s=d.get(p);s!=null?o.push(s):o.push(h);if(m>=f)break}while(m<l)m++,o.push(h);for(s=0;s<m;s++)n.push(r(s,o[s],a.encodings.length-1,c,m,g,e));for(p=0;p<a.encodings.length;p++)p<m?(a.encodings[p].active=!0,a.encodings[p].scaleResolutionDownBy=n[p],m===1?(a.encodings[p].maxBitrate=h,delete a.encodings[p].maxFramerate):(a.encodings[p].maxBitrate=o[p],p===0&&(a.encodings[p].maxFramerate=j))):(a.encodings[p].active=!1,a.encodings[p].maxBitrate=i);e&&!k&&u(a);return{params:a}}function b(a){for(var b=0;b<a.encodings.length;b++)b===0?(a.encodings[b].active=!0,a.encodings[b].scaleResolutionDownBy=1,a.encodings[b].maxBitrate=h):(a.encodings[b].active=!1,a.encodings[b].maxBitrate=i);return a}function q(a,b){var c=new Map();if(a==null||b==null)return c;for(b of b){var d=b[0],e=b[1];d=a.get(d);d!=null&&c.set(e,d)}return c}function r(a,b,d,e,f,g,h){g===void 0&&(g={height:720,width:1280});h===void 0&&(h=!1);if(h)return 1;h=c("ZenonRTCVideoResolutionHelper").getMaxEncResolutionSimulcast(e,a,d,f);if(!h)return 1;h=s(a,b,h,f);return(e=c("ZenonRTCVideoResolutionHelper").getScalingFactor(h,g,!0,0,c("ZenonRTCVideoResolutionHelper").shouldUseSupportedScaleFactorList()))!=null?e:1}function s(a,b,c,d){if(d>=2&&a===0){d=c.height!=null&&c.width!=null&&c.height*c.width>n;if(d&&b<l)return{height:90,width:160};a=c.height!=null&&c.width!=null&&c.height*c.width>m;if(a&&b<k)return{height:180,width:320}}return c}function t(a,b){return(1<<a&b)!==0}function u(a){for(var b=1;b<a.encodings.length;b++)a.encodings[b].active=!1,a.encodings[b].maxBitrate=i}function d(a){var b=new Map(),c="\r\n";a=a.split(c).filter(function(a){return a.startsWith("a=ssrc-group:SIM")});if(a.length===0)return b;c=a[0].split(" ").slice(1);for(a=0;a<c.length;a++)b.set(c[a],a);return b}g.ALLOW_SCREENSHARE_SIMULCAST=e;g.MIN_NUM_ACTIVE_LAYERS=f;g.MAX_NUM_ACTIVE_LAYERS=o;g.NUM_LAYERS=p;g.getSimulcastEncodingParameters=a;g.getSimulcastSingleLayerParameters=b;g.getSimulcastLayerToTargetBitrateMap=q;g.getSimulcastSsrcToLayerMap=d}),98);
__d("ZenonVideoDurationTracker",["performanceNow"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a){a.startedAt==null&&(a.startedAt=(h||(h=c("performanceNow")))())}function j(a){a.startedAt!=null&&(a.duration=l(a),a.startedAt=null)}function k(a,b){b=b.filter(function(a){return a.enabled&&a.webrtcTrack.readyState!=="ended"});b.length>0?i(a):j(a)}function l(a){var b=a.startedAt;return b!=null?a.duration+(h||(h=c("performanceNow")))()-b:a.duration}a=function(){function a(){this.$1={localScreenShareDuration:{duration:0,startedAt:null},localVideoBlurDuration:{duration:0,startedAt:null},localVideoDuration:{duration:0,startedAt:null},remoteScreenShareDuration:{duration:0,startedAt:null},remoteVideoDuration:{duration:0,startedAt:null}}}var b=a.prototype;b.getLocalVideoDuration=function(){return l(this.$1.localVideoDuration)};b.getLocalVideoBlurDuration=function(){return l(this.$1.localVideoBlurDuration)};b.getLocalScreenShareDuration=function(){return l(this.$1.localScreenShareDuration)};b.getRemoteScreenShareDuration=function(){return l(this.$1.remoteScreenShareDuration)};b.getRemoteVideoDuration=function(){return l(this.$1.remoteVideoDuration)};b.update=function(a){var b=this.$1.localVideoDuration,c=Array.from(a.values()).filter(function(a){var b=a.contentType==="video"||a.contentType==="screen";return b&&!a.remote});k(b,c);b=this.$1.localVideoBlurDuration;c=Array.from(a.values()).filter(function(a){var b=a.contentType==="video",c="canvas"in a.webrtcTrack;return b&&c&&!a.remote});k(b,c);b=this.$1.localScreenShareDuration;c=Array.from(a.values()).filter(function(a){var b=a.contentType==="screen";return b&&!a.remote});k(b,c);b=this.$1.remoteVideoDuration;c=Array.from(a.values()).filter(function(a){var b=a.contentType==="video"||a.contentType==="screen";return b&&a.remote});k(b,c);b=this.$1.remoteScreenShareDuration;c=Array.from(a.values()).filter(function(a){var b=a.contentType==="screen";return b&&a.remote});k(b,c)};return a}();g["default"]=a}),98);
__d("RefCountedAudioContextSingleton",["ZenonDebugLogger","emptyFunction","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h=window.AudioContext||window.webkitAudioContext||window.mozAudioContext,i=null,j=new Set(),k=0;function a(){if(c("gkx")("25226"))return{audioContext:null,destroy:c("emptyFunction")};(i===null||i.state==="closed")&&(i=new h());var a=k++;j.add(a);return{audioContext:i,destroy:function(){j["delete"](a),i!==null&&j.size<1&&(i.state!=="closed"&&void i.close(),i=null)}}}g.get=a}),98);
__d("ZenonNoiseSuppressionAudioWorkletNode",["FBLogger","NoiseSuppressionConfig","RefCountedAudioContextSingleton","expectationViolation"],(function(a,b,c,d,e,f,g){"use strict";var h,i=!1;b=null;var j=null;function a(a){if(h==null){if(!a)return;c("expectationViolation")("Unable to toggle Noise Suppression. Make sure you initialize the AudioWorkletNode first by calling getNoiseSuppressionNodeInstance");return}if(i&&a){c("FBLogger")("rtc_www").mustfix("Failed to enable noise suppression node because it is permanently disabled");return}h.port.postMessage({enabledByUser:a});a===!1&&(j==null?void 0:j(),b=null,j=null,h=null)}function k(){return h!=null}async function e(a,e){if(i){c("FBLogger")("rtc_www").mustfix("Failed to get noise suppression node because it is permanently disabled");return a}if(!k()){var f=d("RefCountedAudioContextSingleton").get();b=f.audioContext;j=f.destroy;if(b==null)return a;await b.audioWorklet.addModule(c("NoiseSuppressionConfig").module_url);h=new AudioWorkletNode(b,"noise-suppression");h.onprocessorerror=function(a){i=!0,c("FBLogger")("rtc_www").mustfix("Noise suppression node failed with error",a.message),c("FBLogger")("rtc_www").catching(a),e(h)}}a.connect(h);return h}g.toggleNoiseSuppressionNode=a;g.isNoiseSuppressionNodeInitialized=k;g.connectNoiseSuppressionNode=e}),98);
__d("ZenonWebAudioManager",["FBLogger","RefCountedAudioContextSingleton","ZenonMediaActionLogger","ZenonMediaLoggingUtils","ZenonNoiseSuppressionAudioWorkletNode"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1=null,this.$2=null}var b=a.prototype;b.setupProcessedTrack=function(a,b){if(a.label==="MediaStreamAudioDestinationNode")return a;if(this.$3(b)!==!0){d("ZenonNoiseSuppressionAudioWorkletNode").toggleNoiseSuppressionNode(b.wasmNoiseSuppression===!0);this.$4();return a}if(b.wasmNoiseSuppression!=null)return a;if(!this.$1){this.$1=this.$5();if(this.$1==null)return a}var e=this.$1,f=e.createMediaStreamSource(a.webrtcStream);e=e.createMediaStreamDestination();f.connect(e);this.connectFeatureNodesToSink(b,f,e);if(e.stream.getAudioTracks().length<=0){c("FBLogger")("rtc_www").warn("Web Audio destinationNode did not contain a media track");this.$4();return a}b=e.stream.getAudioTracks()[0];f=c("ZenonMediaLoggingUtils").serializeMediaStreamTrack(b);var g=c("ZenonMediaLoggingUtils").serializeMediaStreamTrack(a.webrtcTrack);c("ZenonMediaActionLogger").logEvent({checkpoint:"Returning processedTrack: "+f+", sourceTrack: "+g});return babelHelpers.extends({},a,{label:"MediaStreamAudioDestinationNode",trackId:b.id,webrtcStream:e.stream,webrtcTrack:b})};b.$3=function(a){return Object.values(a).some(function(a){return a})};b.buildFeatureNodes=async function(a,b,c){b=await d("ZenonNoiseSuppressionAudioWorkletNode").connectNoiseSuppressionNode(b,c);d("ZenonNoiseSuppressionAudioWorkletNode").toggleNoiseSuppressionNode(a.wasmNoiseSuppression===!0);return b};b.connectFeatureNodesToSink=async function(a,b,d){a=await this.buildFeatureNodes(a,b,function(a){c("FBLogger")("rtc_www").mustfix("Web Audio pipeline reset due to processor error. One or more AudioWorkletNode might be failing"),a.disconnect(d),b.connect(d)});b.disconnect(d);a.connect(d)};b.$5=function(){var a=d("RefCountedAudioContextSingleton").get(),b=a.audioContext;a=a.destroy;this.$1=b;this.$2=a;return b};b.$4=function(){this.$2==null?void 0:this.$2(),this.$1=null,this.$2=null};return a}();g.default=a}),98);
__d("ZenonMediaChannelManager",["FBLogger","ODS","ZenonBrowsers","ZenonE2ee","ZenonE2eeMandatedStateManager","ZenonE2eeWasmWorkerClient","ZenonInsertableStreamsManager","ZenonMediaActionLogger","ZenonMediaStatsManager","ZenonMediaUtils","ZenonRTCVideoResolutionHelper","ZenonScreenShare","ZenonSimulcastManager","ZenonVideoDurationTracker","ZenonWebAudioManager","err","gkx","promiseDone","shouldUseInsertableStreams"],(function(a,b,c,d,e,f,g){"use strict";var h,i="negotiationOffStreamId",j="MediaChannelManager";a=function(){function a(a){var b=this;this.$1=null;this.$13=!1;this.$2=a.peerConnection;this.$4=new Map();this.$9=new Map();this.$10=new Map();this.$15=new Map();this.$7=[];this.$6=new(c("ZenonVideoDurationTracker"))();this.$5=new(c("ZenonMediaStatsManager"))({areTslogsEnabled:a.areTslogsEnabled,dataMessageTranslator:a.dataMessageTranslator,mediaStats:a.mediaStats,onFirstMediaPacket:a.onFirstMediaPacket,onFirstSentMediaPacket:a.onFirstSentMediaPacket,onMediaStatUpdate:a.onMediaStatUpdate,peerConnection:this.$2,tracks:this.$4,trackToSenderMap:this.$15,videoDurationTracker:this.$6});this.$14=new(c("ZenonWebAudioManager"))();this.$5.listen();this.$2.addEventListener("track",function(a){void b.transformReceiverFromEvent(a),b.addRemoteTrackFromEvent(a),b.$17(),c("promiseDone")(b.$18())});this.$2.addEventListener("signalingstatechange",function(){c("promiseDone")(b.$18()),b.$19(),b.getCodecFromEvent()});this.$2.addEventListener("removestream",function(){b.$17(!0)});this.$11=!0;this.$12=new Map();c("shouldUseInsertableStreams")()&&(this.$3=c("ZenonE2ee").getSecureFrameManager(),this.$1=new(c("ZenonInsertableStreamsManager"))(),this.$3||(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_e2ee","secure_frame_manager_null, E2EE MANDATED:"+c("ZenonE2eeMandatedStateManager").isInfraE2eeMandated().toString()));this.$16=c("gkx")("11503")}var b=a.prototype;b.onLocalSdpSet=function(a){c("ZenonE2ee").onLocalSdpSet(a)};b.stopStatsPolling=function(){this.$5.stopPolling()};b.getTracks=function(){return this.$4};b.clearTracks=function(){this.$4.clear(),this.$15.clear(),this.$19()};b.$17=function(a){a===void 0&&(a=!1),c("ZenonRTCVideoResolutionHelper").maybeLimitEncodingResolutionByParticipantCount(this.$2.getSenders(),this.$2.getReceivers(),this.$2.getTransceivers(),this.$2.supportsSimulcast(),a)};b.removeMissingTracks=function(a){var b=this;this.$4.forEach(function(c,d){c.remote&&a.find(function(a){return a===d})==null&&b.removeTrack(d)})};b.updateTrackInfo_DEPRECATED=function(a){var b=this.$4.get(a.trackID);if(b==null){this.$12.set(a.trackID,a);return}b=this.$20(b,a);this.$4.set(a.trackID,b);this.$19()};b.updateTrackInfos=function(a){var b=this;a.tracks.forEach(function(a){var c=a.trackID;if(c==="data"||c==="stream_label")return;var d=b.$4.get(c);if(d==null){b.$12.set(c,a);return}d=b.$20(d,a);b.$4.set(c,d)});this.$19()};b.updateMuteStates=function(a){var b=this;a.tracks.forEach(function(a){var c=a.enabled;a=a.trackID;c?b.unmuteTrack(a,!1):b.muteTrack(a,!1)});this.$19()};b.$20=function(a,b){if(a.contentType==="audio"&&b.type!=="screen_audio"||d("ZenonScreenShare").screenShareWithReplaceTrack())return a;var e=a.webrtcStream,f=e.getVideoTracks().length>1;b.type==="screen"&&f&&(e=c("ZenonMediaUtils").createStreamWithTrack(a.webrtcTrack),a.webrtcStream.removeTrack(a.webrtcTrack));return{contentHint:a.contentHint,contentType:(f=b.type)!=null?f:a.contentType,enabled:a.enabled,flags:Object.freeze({}),label:a.label,name:"",pausedDownlink:!1,remote:a.remote,trackId:b.trackID,userMuted:!1,webrtcStream:e,webrtcTrack:a.webrtcTrack}};b.getLocalTracksForMWS=function(){var a=this,b=new Map(),c=this.$2.getTransceivers();this.$4.forEach(function(d,e){if(!d.remote){var f,g=(f=(f=a.$15.get(e))==null?void 0:f.trackId)!=null?f:e;f=(f=(f=c.find(function(a){return((a=a.sender.track)==null?void 0:a.id)===g}))==null?void 0:f.mid)!=null?f:null;f=(f=a.$2.getLocalMWTrackId(f))!=null?f:e;e=babelHelpers.extends({},d,{trackId:f});b.set(f,e)}});return b};b.addTrack=async function(a,b){a.contentType==="video"&&a.remote===!1&&(this.$8=a),await this.$21(a,b),this.$19()};b.transformSender=async function(a,b){if(this.$1==null)return;await this.$1.setupSenderTransform(a,b)};b.transformReceiverFromEvent=async function(a){var b=a.receiver,d=this.$2.getCnameFromTrackId(a.track.id);if(this.$1==null)return;d==null&&c("ZenonMediaActionLogger").logCheckpoint("Failed to find Cname for the remote track: "+a.track.id);await ((a=this.$1)==null?void 0:a.setupReceiverTransform((a=d)!=null?a:i,b))};b.addReceiveOnlyVideoTransceiverIfMissing=function(){this.$22("video","recvonly")};b.addAudioTrackOrRecvOnlyTransceiverIfMissing=async function(a){var b=0;this.$4.forEach(function(a,c){a.remote||b++});if(b===0){var d=c("ZenonMediaUtils").createSilentTrack();await this.addTrack(d,a)}else this.addReceiveOnlyAudioTransceiverIfMissing()};b.addReceiveOnlyAudioTransceiverIfMissing=function(){this.$22("audio","recvonly")};b.$22=function(a,b){var c=!1;this.$4.forEach(function(b,d){if(b.contentType===a||a==="video"&&b.contentType==="screen"){c=!0;return}});if(c)return;this.$2.addTransceiver(a,{direction:b})};b.addReceiveOnlyVideoTransceiverIfNeeded=function(a,b){this.$23("video","recvonly",a,b)};b.addInactiveAudioTransceiverIfNeeded=function(){this.$23("audio","inactive")};b.$23=function(a,b,c,e){var f=!1;this.$4.forEach(function(b,c){if(b.contentType===a){f=!0;return}});if(f||d("ZenonBrowsers").noTransceiverForNegotiations()&&e!==!0&&c==="p2p")return;this.$2.addTransceiver(a,{direction:b})};b.removeTrack=function(a){var b=this.$4.get(a);if(b==null)return;this.$24(b);this.$19();if(c("ZenonE2ee").shouldUseE2eeWorker())void c("ZenonE2eeWasmWorkerClient").freeEncryptorAndDecryptorForId(a);else{(b=this.$3)==null?void 0:b.freeEncryptorAndDecryptorForId(a)}};b.replaceTrack=async function(a,b,e){e===void 0&&(e=!1);var f=this.$4.get(a);if(f==null)return;if(d("ZenonScreenShare").isScreenSharingTrack([f])&&!d("ZenonScreenShare").isScreenSharingTrack([b])&&this.$8!=null){await this.$25(f,this.$8);if(this.$11){var g;this.unmuteTrack((g=(g=this.$8)==null?void 0:g.trackId)!=null?g:"")}else{this.muteTrack((g=(g=this.$8)==null?void 0:g.trackId)!=null?g:"")}c("ZenonRTCVideoResolutionHelper").handleStopScreenSharing(this.$2.getSenders(),this.$2.getReceivers(),this.$2.getTransceivers(),this.$2.supportsSimulcast());f.webrtcTrack.stop();f.webrtcTrack.readyState!=="ended"&&c("ZenonMediaActionLogger").logErrorToFbLogger("ZenonMediaChannelManager: Stopping trackToReplace failed: "+f.label,j,c("err")("Stopping trackToReplace failed: "+f.label),"warn")}else if(b!=null&&d("ZenonScreenShare").isScreenSharingTrack([b])&&a===((g=this.$8)==null?void 0:g.trackId)&&this.$8!=null)this.$11=this.$8.enabled&&this.$8.webrtcTrack.enabled,await this.$25(this.$8,b),this.unmuteTrack(b.trackId),c("ZenonRTCVideoResolutionHelper").handleStartScreenSharing(this.$2.getSenders(),this.$2.getReceivers(),this.$2.getTransceivers(),this.$2.supportsSimulcast());else if(b!=null){(this.$8==null&&b.contentType==="video"||((g=this.$8)==null?void 0:g.trackId)===a)&&(this.$8=b);await this.$25(f,b);f.trackId!==b.trackId&&!e&&(f.webrtcTrack.stop(),f.webrtcTrack.readyState!=="ended"&&c("ZenonMediaActionLogger").logErrorToFbLogger("ZenonMediaChannelManager: Stopping trackToReplace failed: "+f.label,j,c("err")("Stopping trackToReplace failed: "+f.label),"warn"))}this.$17();this.$19()};b.addRemoteTrackFromEvent=function(a){var b=a.transceiver;b=this.$2.getRemoteMWTrackId(b.mid);a=c("ZenonMediaUtils").convertToZenonImmutableMediaTrack(a.track,{isRemote:!0,isUserMuted:!1,stream:a.streams?a.streams[0]:null},b);b=this.$12.get(a.trackId);b!=null&&(a=this.$20(a,b),this.$12.delete(a.trackId));b=this.$9.get(a.trackId);b!=null&&(a.contentType!=="audio"&&(a.webrtcTrack.enabled=b.enabled,a=babelHelpers.extends({},a,{enabled:b.enabled})),a=babelHelpers.extends({},a,{userMuted:b.userMuted}),this.$9.delete(a.trackId));this.$4.set(a.trackId,a);this.$19();this.$5.onRemoteTrackAdded(a)};b.createDataChannel=function(a,b,c,d,e){this.$2.createDataChannel(a,b,c,d,e)};b.muteTrack=function(a,b){b===void 0&&(b=!0),this.$26(a,!0,b)};b.$26=function(a,b,c){var d=this.$4.get(a),e=d===this.$8;if(d==null){this.$9.set(a,{enabled:!b,userMuted:b});return}a=d;d.userMuted!==b&&(a=babelHelpers.extends({},a,{userMuted:b}));var f=!Boolean((d==null?void 0:d.remote)&&d.contentType==="audio");((f||this.$16)&&b?!(!a.enabled&&!a.webrtcTrack.enabled):!(a.enabled&&a.webrtcTrack.enabled))&&(a.webrtcTrack.enabled=!b,a=babelHelpers.extends({},a,{enabled:!b}));e&&(this.$8=a);d!==a&&(this.$4.set(a.trackId,a),c&&this.$19())};b.unmuteTrack=function(a,b){b===void 0&&(b=!0),this.$26(a,!1,b)};b.forceEncodingEnabled=function(a){if(a===this.$13)return Promise.resolve();this.$13=a;return this.$18()};b.setSimulcastSingleLayerParams=function(){if(this.$2.supportsSimulcast()&&!this.$2.getSimulcastInitialized()){var a=this.$2.getSenders().filter(function(a){return a.track&&a.track.kind==="video"});if(a.length!==0){a=a[0];if("getParameters"in a&&"setParameters"in a){var b=d("ZenonSimulcastManager").getSimulcastSingleLayerParameters(a.getParameters());if(this.$27(a))return;c("promiseDone")(a.setParameters(b));this.$2.setSimulcastInitialized(!0)}}}};b.stopLocalTracks=function(){this.$4.forEach(function(a){a.remote===!1&&(c("ZenonMediaActionLogger").logCheckpoint("stopping track: "+a.label),a.webrtcTrack.stop(),a.webrtcTrack.readyState!=="ended"&&c("ZenonMediaActionLogger").logErrorToFbLogger("ZenonMediaChannelManager: Stopping track failed: "+a.label,j,c("err")("Stopping track failed: "+a.label),"warn"))});if(this.$8!=null&&!this.$4.has(this.$8.trackId)){var a;c("ZenonMediaActionLogger").logCheckpoint("stopping local video track: "+((a=(a=this.$8)==null?void 0:a.label)!=null?a:""));(a=this.$8)==null?void 0:a.webrtcTrack.stop();this.$8&&this.$8.webrtcTrack.readyState!=="ended"&&c("ZenonMediaActionLogger").logErrorToFbLogger("ZenonMediaChannelManager: Stopping local video track failed: "+this.$8.label,j,c("err")("Stopping local video track failed: "+this.$8.label),"warn")}this.$19();if(c("ZenonE2ee").shouldUseE2eeWorker())void c("ZenonE2eeWasmWorkerClient").freeAllEncryptorsAndDecryptors();else{(a=this.$3)==null?void 0:a.freeAllEncryptorsAndDecryptors()}};b.stopLocalTrack=function(a){a=this.$4.get(a);if(a==null)return;if(a.remote)return;a.webrtcTrack.stop();a.webrtcTrack.readyState!=="ended"&&c("ZenonMediaActionLogger").logErrorToFbLogger("ZenonMediaChannelManager: Stopping local track failed: "+a.label,j,c("err")("Stopping local track failed: "+a.label),"warn")};b.setNetworkStatusListener=function(a){this.$5.setNetworkStatusListener(a)};b.registerTrackListener=function(a){this.$7.push(a)};b.setTrackListenersFromManager=function(a){this.$7=a.$7};b.timeSeries=function(){return this.$5.timeSeries()};b.resetTimeSeries=function(){this.$5.resetTimeSeries()};b.$21=async function(a,b){var c=a;if(a.contentType==="audio"){var d;c=this.$14.setupProcessedTrack(a,{wasmNoiseSuppression:(d=(d=a.flags)==null?void 0:d.wasmNoiseSuppression)!=null?d:!1})}this.$10.set(a.trackId,c.trackId);this.$15.set(a.trackId,c);d=await this.$28(c,b);await this.transformSender(d,c.contentType);this.$4.set(a.trackId,a)};b.$28=async function(a,b){if(b==="p2p"){b=this.$2.getTransceivers().find(function(b){var c=b.sender.track,d=b.receiver.track;if(b.currentDirection==="inactive")return!1;if(c!==null&&d==null&&c.kind===a.contentType&&a.remote)return!0;else if(d!==null&&c==null&&d.kind===a.contentType&&a.remote===!1)return!0;return!1});if(b!=null){b.direction="sendrecv";await b.sender.replaceTrack(a.webrtcTrack);return b.sender}return this.$2.addTrack(a.webrtcTrack,a.webrtcStream)}return this.$2.addTransceiver(a.webrtcTrack,{direction:"sendonly",streams:[a.webrtcStream]}).sender};b.$24=function(a){this.$4.delete(a.trackId),this.$15.delete(a.trackId),a.remote||(this.$2.removeTrack(a.webrtcTrack),a.webrtcTrack.stop())};b.$25=async function(a,b){var d,e=(d=this.$15.get(a.trackId))!=null?d:a;d=this.$2.getSenders().find(function(b){var c;return((c=b.track)==null?void 0:c.id)===a.webrtcTrack.id||e.trackId===((c=b.track)==null?void 0:c.id)});if(d===void 0)throw c("err")("track to be replaced is not found");var f=this.$10.get(a.trackId);f!=null?this.$10.delete(a.trackId):f=a.trackId;this.$15.delete(a.trackId);var g=b;if(g.contentType==="audio"){var h;g=this.$14.setupProcessedTrack(b,{wasmNoiseSuppression:(h=(h=g.flags)==null?void 0:h.wasmNoiseSuppression)!=null?h:!1})}await d.replaceTrack(g.webrtcTrack);this.$10.set(b.trackId,f);this.$15.set(b.trackId,g);this.$4.delete(a.trackId);this.$4.set(b.trackId,b);(h=this.$3)==null?void 0:h.updateLocalTrackIdForStats(f,b.trackId)};b.$19=function(){this.$6.update(this.$4),this.$7.forEach(function(a){a()})};b.$27=function(a){a=this.$2.getTransceiverFromSender(a);return a&&a.stopped?!0:!1};b.$29=function(){var a=!1,b=this.getTracks().values(),c=b.next();while(!c.done&&!a)a=c.value.remote,c=b.next();return this.$13||a};b.$18=function(){var a=this,b=this.$29();this.$2.getSenders().forEach(function(d){if(a.$27(d)||!("getParameters"in d)||!("getParameters"in d))return Promise.resolve();var e=d.getParameters(),f=!1;if(e.encodings!=null)for(var g=0;g<e.encodings.length;g++)(g===0||!b)&&e.encodings[g].active!==b&&(e.encodings[g].active=b,f=!0);if(f)return d.setParameters(e).catch(function(a){c("FBLogger")("rtc_www").catching(a).mustfix("Error while trying to toggle encoding")})});return Promise.resolve()};b.getCodecFromEvent=function(){var a=this;if(!c("ZenonE2ee").isE2eeStackReady())return;var b=this.$2.getSignalingState();if(b!=="have-remote-offer"&&b!=="stable")return;this.$2.getReceivers().forEach(function(b){a.$30(b)});this.$2.getSenders().forEach(function(b){var d=a.$31(b);b=b.track;if(b==null||d==null)return;if(c("ZenonE2ee").shouldUseE2eeWorker())void c("ZenonE2eeWasmWorkerClient").setEncryptorCodec(b.id,d);else{var e;(e=a.$3)==null?void 0:e.setFrameDataHandlerOnEncryptor(b.id,d)}})};b.$30=function(a){if("getParameters"in a&&a.track!=null){var b=a.track.id;a=a.getParameters();var d=new Set();if(a.codecs==null||a.codecs.length===0)return;var e=a.codecs[0].mimeType;a.codecs.forEach(function(a){d.add(a.mimeType)});if(c("ZenonE2ee").shouldUseE2eeWorker())void c("ZenonE2eeWasmWorkerClient").setDecryptorCodec(b,d);else{(a=this.$3)==null?void 0:a.setFrameDataHandlerTypesOnDecryptor(b,d)}return e}};b.$31=function(a){if("getParameters"in a&&a.track!=null){a=a.getParameters();if(a.codecs!=null&&a.codecs.length!==0)return a.codecs[0].mimeType}};return a}();g.default=a}),98);
__d("ZenonReceiverRenderedResolutionUtils",[],(function(a,b,c,d,e,f){"use strict";function g(a,b){if(a===b)return!0;var c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(c of c){if(!d.includes(c))return!1;var e=a[c],f=b[c];for(var g of Object.keys(e))if(e[g]!==f[g])return!1}return!0}function h(a){if(!a)return 0;return!a.renderWidth||!a.renderHeight?0:a.renderWidth*a.renderHeight}function a(a,b){if(a===b)return!0;var c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(d of c){if(!Object.prototype.hasOwnProperty.call(b,d))return!1;if(!g(a[d],b[d]))return!1}return!0}function b(a,b){if(!a||!b)return 0;var c=0,d=Object.keys(a);for(d of d){var e=a[d],f=b[d];if(e&&f){var g=Object.keys(e);for(g of g){var i=e[g],j=f[g],k=0;if(i&&j){i=h(i);j=h(j);i>0&&j>0?k=i>j?i/j:j/i:k=i+i}k>c&&(c=k)}}}return c}f.areEqualRenderResolutionMaps=a;f.getMaxResolutionChangeMultiplier=b}),66);
__d("ZenonRenderResolutionTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({Unknown:0,Default:1,ScreenShare:2});f.StreamType=a}),66);
__d("ZenonReceiverRenderedResolutionManager",["CompactSerializer","DataMessageSerializers","RequestStreamBodyUtils","ZenonCallsContext","ZenonReceiverRenderedResolutionUtils","ZenonRenderResolutionTypes","ZenonSCTPConstants","ZenonTransportType","immutable","promiseDone","react"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");var i=b.useContext,j=b.useMemo,k=200,l=function(a){switch(a){case"video":return d("ZenonRenderResolutionTypes").StreamType.Default;case"screen":return d("ZenonRenderResolutionTypes").StreamType.ScreenShare;default:return d("ZenonRenderResolutionTypes").StreamType.Unknown}},m=function(){function a(a,b,e){var f=this;this.$4=c("immutable").Map();this.$5=new Map();this.$6={};this.updateTrackIdToUserIdMap=function(a){var b;if(!a||!a.get(f.$1))return;b=(b=(b=a.get(f.$1))==null?void 0:b.participants)!=null?b:c("immutable").Map();var d=(a=(a=a.get(f.$1))==null?void 0:a.mediaTracks)!=null?a:new Map();if(b===f.$4)return;f.$4=(a=b)!=null?a:c("immutable").Map();f.$5.clear();b.forEach(function(a,b,c){a.trackIDs.forEach(function(a){var c=d.get(a);if(!(c==null?void 0:c.remote))return;f.$5.set(a,b)})})};this.updateRenderedResolutions=function(a){var b={};a.forEach(function(a,c){var e=l(a.contentType);if(e===d("ZenonRenderResolutionTypes").StreamType.Unknown)return;var g=f.$5.get(c);if(g==null)return;a={renderHeight:a.renderHeight,renderWidth:a.renderWidth,streamId:c,streamType:e,userId:g};c=b[g];if(c)c[String(e)]=a;else{b[g]=(c={},c[String(e)]=a,c)}});f.updateRenderedResolutionMap(b)};this.$1=a;this.$2=b;this.$3=e;this.$2.addListener("callsModelUpdate",this.updateTrackIdToUserIdMap);this.updateTrackIdToUserIdMap(this.$2.getCurrentCallsModel())}var b=a.prototype;b.updateRenderedResolutionMap=function(a){var b=this;if(d("ZenonReceiverRenderedResolutionUtils").areEqualRenderResolutionMaps(a,this.$6))return;this.$2.updateRenderedResolutionMap(a);var e=2;if(Object.keys(this.$6||{}).length>0&&Object.keys(a||{}).length>0&&d("ZenonReceiverRenderedResolutionUtils").getMaxResolutionChangeMultiplier(a,this.$6)<e)return;this.$6=a;var f=this.serializeSctpRenderResolutionMap({renderResolutionMap:this.$6});window.setTimeout(function(){c("promiseDone")(b.$3.sendGenericDataMessage(d("ZenonSCTPConstants").SCTP_RRR,f,{serviceRecipients:[2]},d("ZenonTransportType").ZenonTransportType.SCTP))},this.getJitterMs())};b.serializeSctpRenderResolutionMap=function(a){return d("RequestStreamBodyUtils").uint8ArrayToString(d("CompactSerializer").serialize(a,d("DataMessageSerializers").serializeRenderResolutionMessageFromClient))};b.getJitterMs=function(){return Math.floor(Math.random()*k)};b.getTrackIdToUserIdMap=function(){return this.$5};b.getRenderedResolutionMap=function(){return this.$6};return a}();function a(){var a=i(c("ZenonCallsContext")),b=a.callSDK,d=a.currentCallInstanceSDK;return j(function(){var a=new m(d.getClientCallID_DEPRECATED(),b,d);return a.updateRenderedResolutions},[b,d])}g.ReceiverRenderedResolutionManager=m;g.useReceiverRenderedResolutionManager=a}),98);
__d("ZenonMediaElementTracker",["FBLogger","ZenonReceiverRenderedResolutionManager","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useEffect,j=new Map(),k;function l(a,b){j.has(a)&&c("FBLogger")("rtc_www").warn("ZenonMediaElementTracker already has a stream associated with the given element"),j.set(a,b)}function m(a){j["delete"](a)||c("FBLogger")("rtc_www").warn("ZenonMediaElementTracker did not have a stream associated with the given element")}function a(a){var b=new Map();for(var d of j){var e=d[0],f=d[1];for(f of f.getTracks()){var g=a.get(f.id);if(g==null)continue;if(f.kind==="video"&&e instanceof HTMLVideoElement){if(e.videoWidth===0||e.videoHeight===0)continue;var h=e.getBoundingClientRect();g.renderedWidth=h.width;g.renderedHeight=h.height;var i=h.width/e.videoWidth,l=h.height/e.videoHeight,m=getComputedStyle(e);m=m.objectFit;var n=1,o=1;switch(m){case"cover":n=Math.max(i,l);o=h.width*h.height/(n*n*e.videoWidth*e.videoHeight);break;case"contain":n=Math.min(i,l);break;default:c("FBLogger")("rtc_www").warn("Unknown object-fit type %s",m)}g.scaleRatio=n*n;g.croppingRatio=o;i=g.contentType;b.set(f.id,{contentType:i||"video",renderHeight:h.height,renderWidth:h.width})}}}k&&k(b)}function b(a,b){k=d("ZenonReceiverRenderedResolutionManager").useReceiverRenderedResolutionManager(),i(function(){var c=a.current;if(!b||!c)return;l(c,b);return function(){m(c)}},[a,b])}g.trackElement=l;g.untrackElement=m;g.updateStats=a;g.useMediaElementTracker=b}),98);
__d("RpGenaiSctpCaptionsCaptionsTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({BOT:1,USER:2});e.exports={SpeakerAttributionRole:a}}),null);
__d("RpGenaiSctpCaptionsCaptionsSerializers",["RpGenaiSctpCaptionsCaptionsTypes","ThriftTypes"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){return{role:d("RpGenaiSctpCaptionsCaptionsTypes").SpeakerAttributionRole.cast(0)}}function j(){return{text:"",language:""}}function a(){return{attribution:i(),caption:j()}}function k(a,b){b.writeStructBegin("SpeakerAttribution");b.writeFieldBegin({fname:"role",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});if(a.role!=null){b.writeI32((a=a.role)!=null?a:0)}else{a=d("RpGenaiSctpCaptionsCaptionsTypes").SpeakerAttributionRole.cast(0);b.writeI32((a=a)!=null?a:0)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function l(a,b){b.writeStructBegin("CaptionPayload");b.writeFieldBegin({fname:"text",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.text!=null)b.writeString(a.text);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"language",ftype:h.STRING,fid:2});if(a.language!=null)b.writeString(a.language);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function b(a,b){b.writeStructBegin("Caption");b.writeFieldBegin({fname:"attribution",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1});if(a.attribution!=null)k(a.attribution,b);else{var d=i();k(d,b)}b.writeFieldEnd();b.writeFieldBegin({fname:"caption",ftype:h.STRUCT,fid:2});if(a.caption!=null)l(a.caption,b);else{d=j();l(d,b)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function m(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.role=d("RpGenaiSctpCaptionsCaptionsTypes").SpeakerAttributionRole.cast(a.readI32()):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.role===void 0&&(b.role=d("RpGenaiSctpCaptionsCaptionsTypes").SpeakerAttributionRole.cast(0));return b}function n(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.text=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.language=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.text===void 0&&(b.text="");b.language===void 0&&(b.language="");return b}function e(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRUCT?b.attribution=m(a):a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRUCT?b.caption=n(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.attribution===void 0&&(b.attribution=i());b.caption===void 0&&(b.caption=j());return b}g.SpeakerAttribution$DefaultConstructor=i;g.CaptionPayload$DefaultConstructor=j;g.Caption$DefaultConstructor=a;g.serializeSpeakerAttribution=k;g.serializeCaptionPayload=l;g.serializeCaption=b;g.deserializeSpeakerAttribution=m;g.deserializeCaptionPayload=n;g.deserializeCaption=e}),98);
__d("RpGenaiSctpCaptionsGenAIBotStateTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";c=(a=b("$InternalEnum"))({AMBIENT:1,LISTENING:2,THINKING:3,RESPONDING:4});d=a({UNKNOWN:0,OPEN:1,TEE:2});f=a({INTERRUPT:1,MESSAGE:2,RESET_TIMEOUTS:3,EVENT:4,STARTER_PROMPT:5,TOOL_RESPONSE:6});b=a({COMPOSER:1});var g=a({VOICE:1,TEXT_ONLY:2}),h=a({NONE:1,VOICE_DIARIZATION_ON:2,VOICE_DIARIZATION_OFF:3,APP_IN_FOREGROUND:4,APP_IN_BACKGROUND:5,IN_APP_BACKGROUND:6,IMAGE_UPLOAD_BEGIN:7,IMAGE_UPLOAD_END:8});a=a({EMPTY:0,THREAD:1,POST:2,E2EE_CONTEXT:3,IG_POST:4});e.exports={BotStateType:c,ClientInputEvent:h,ClientInputMethod:b,ClientInputType:f,ClientOutputType:g,ContextType:a,InfraStackType:d}}),null);
__d("ViewModelSerializers",["ThriftTypes"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return{}}function b(){return{}}function d(){return{}}function e(){return{}}function f(){return{}}function aa(){return{}}function ba(){return{}}function ca(){return{}}function da(){return{}}function ea(){return{}}function fa(){return{}}function ga(){return{}}function ha(){return{}}function ia(){return{}}function ja(){return{}}function ka(){return{}}function la(){return{otid:"",timestamp_ms:""}}function ma(){return{}}function na(){return{}}function oa(){return{}}function pa(){return{}}function qa(){return{}}function ra(){return{}}function sa(){return{}}function ta(){return{}}function ua(){return{}}function va(){return{}}function wa(){return{}}function xa(){return{}}function ya(){return{}}function za(){return{}}function i(a,b){b.writeStructBegin("ImagineData"),a.media_type!=null&&(b.writeFieldBegin({fname:"media_type",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.media_type),b.writeFieldEnd()),a.prompt!=null&&(b.writeFieldBegin({fname:"prompt",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.prompt),b.writeFieldEnd()),a.uri!=null&&(b.writeFieldBegin({fname:"uri",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.uri),b.writeFieldEnd()),a.temporary_handle!=null&&(b.writeFieldBegin({fname:"temporary_handle",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeString(a.temporary_handle),b.writeFieldEnd()),a.request_id!=null&&(b.writeFieldBegin({fname:"request_id",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:5}),b.writeString(a.request_id),b.writeFieldEnd()),a.response_id!=null&&(b.writeFieldBegin({fname:"response_id",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:6}),b.writeString(a.response_id),b.writeFieldEnd()),a.insertion_index!=null&&(b.writeFieldBegin({fname:"insertion_index",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:7}),b.writeString(a.insertion_index),b.writeFieldEnd()),a.avatar_motion_type!=null&&(b.writeFieldBegin({fname:"avatar_motion_type",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:8}),b.writeString(a.avatar_motion_type),b.writeFieldEnd()),a.background_motion_type!=null&&(b.writeFieldBegin({fname:"background_motion_type",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:9}),b.writeString(a.background_motion_type),b.writeFieldEnd()),a.serialized_blob!=null&&(b.writeFieldBegin({fname:"serialized_blob",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:10}),b.writeString(a.serialized_blob),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function j(a,b){b.writeStructBegin("ReelsData"),a.reels_url!=null&&(b.writeFieldBegin({fname:"reels_url",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.reels_url),b.writeFieldEnd()),a.thumbnail_url!=null&&(b.writeFieldBegin({fname:"thumbnail_url",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.thumbnail_url),b.writeFieldEnd()),a.author!=null&&(b.writeFieldBegin({fname:"author",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.author),b.writeFieldEnd()),a.avatar_url!=null&&(b.writeFieldBegin({fname:"avatar_url",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeString(a.avatar_url),b.writeFieldEnd()),a.media_id!=null&&(b.writeFieldBegin({fname:"media_id",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:5}),b.writeString(a.media_id),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function k(a,b){b.writeStructBegin("GenAIImagineViewModel");if(a.imagine_raw_data!=null){b.writeFieldBegin({fname:"imagine_raw_data",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:1});b.writeListBegin({etype:h.STRUCT,size:a.imagine_raw_data.length});for(a of a.imagine_raw_data)i(a,b);b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function l(a,b){b.writeStructBegin("GenAISearchViewModel");if(a.search_result_uri!=null){b.writeFieldBegin({fname:"search_result_uri",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:1});b.writeListBegin({etype:h.STRING,size:a.search_result_uri.length});for(var d of a.search_result_uri)b.writeString(d);b.writeListEnd();b.writeFieldEnd()}a.search_engine!=null&&(b.writeFieldBegin({fname:"search_engine",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.search_engine),b.writeFieldEnd());a.search_query!=null&&(b.writeFieldBegin({fname:"search_query",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.search_query),b.writeFieldEnd());a.attribution_link!=null&&(b.writeFieldBegin({fname:"attribution_link",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeString(a.attribution_link),b.writeFieldEnd());if(a.references_title!=null){b.writeFieldBegin({fname:"references_title",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:5});b.writeListBegin({etype:h.STRING,size:a.references_title.length});for(d of a.references_title)b.writeString(d);b.writeListEnd();b.writeFieldEnd()}a.search_engine_icon_url!=null&&(b.writeFieldBegin({fname:"search_engine_icon_url",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:6}),b.writeString(a.search_engine_icon_url),b.writeFieldEnd());a.source_url!=null&&(b.writeFieldBegin({fname:"source_url",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:7}),b.writeString(a.source_url),b.writeFieldEnd());a.response!=null&&(b.writeFieldBegin({fname:"response",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:8}),b.writeString(a.response),b.writeFieldEnd());if(a.thumbnail_data!=null){b.writeFieldBegin({fname:"thumbnail_data",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:9});b.writeListBegin({etype:h.STRING,size:a.thumbnail_data.length});for(d of a.thumbnail_data)b.writeString(d);b.writeListEnd();b.writeFieldEnd()}if(a.thumbnail_cdn_url!=null){b.writeFieldBegin({fname:"thumbnail_cdn_url",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:10});b.writeListBegin({etype:h.STRING,size:a.thumbnail_cdn_url.length});for(d of a.thumbnail_cdn_url)b.writeString(d);b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function m(a,b){b.writeStructBegin("GenAIReelsViewModel");if(a.reels_urls!=null){b.writeFieldBegin({fname:"reels_urls",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:1});b.writeListBegin({etype:h.STRING,size:a.reels_urls.length});for(var d of a.reels_urls)b.writeString(d);b.writeListEnd();b.writeFieldEnd()}if(a.reels_data!=null){b.writeFieldBegin({fname:"reels_data",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:2});b.writeListBegin({etype:h.STRUCT,size:a.reels_data.length});for(d of a.reels_data)j(d,b);b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function n(a,b){b.writeStructBegin("TeamInfo"),a.name!=null&&(b.writeFieldBegin({fname:"name",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.name),b.writeFieldEnd()),a.logo!=null&&(b.writeFieldBegin({fname:"logo",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.logo),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function o(a,b){b.writeStructBegin("GameInfo"),a.home_team!=null&&(b.writeFieldBegin({fname:"home_team",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1}),n(a.home_team,b),b.writeFieldEnd()),a.away_team!=null&&(b.writeFieldBegin({fname:"away_team",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2}),n(a.away_team,b),b.writeFieldEnd()),a.home_team_score!=null&&(b.writeFieldBegin({fname:"home_team_score",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.home_team_score),b.writeFieldEnd()),a.away_team_score!=null&&(b.writeFieldBegin({fname:"away_team_score",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeString(a.away_team_score),b.writeFieldEnd()),a.match_status!=null&&(b.writeFieldBegin({fname:"match_status",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:5}),b.writeString(a.match_status),b.writeFieldEnd()),a.datetime!=null&&(b.writeFieldBegin({fname:"datetime",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:6}),b.writeString(a.datetime),b.writeFieldEnd()),a.date!=null&&(b.writeFieldBegin({fname:"date",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:7}),b.writeString(a.date),b.writeFieldEnd()),a.time!=null&&(b.writeFieldBegin({fname:"time",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:8}),b.writeString(a.time),b.writeFieldEnd()),a.tournament_name!=null&&(b.writeFieldBegin({fname:"tournament_name",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:9}),b.writeString(a.tournament_name),b.writeFieldEnd()),a.home_records!=null&&(b.writeFieldBegin({fname:"home_records",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:10}),b.writeString(a.home_records),b.writeFieldEnd()),a.away_records!=null&&(b.writeFieldBegin({fname:"away_records",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:11}),b.writeString(a.away_records),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function p(a,b){b.writeStructBegin("SportsSearchData"),a.game_info!=null&&(b.writeFieldBegin({fname:"game_info",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1}),o(a.game_info,b),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function q(a,b){b.writeStructBegin("GenAISportsViewModel"),a.sports_search_data!=null&&(b.writeFieldBegin({fname:"sports_search_data",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1}),p(a.sports_search_data,b),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function r(a,b){b.writeStructBegin("PromptData"),a.text!=null&&(b.writeFieldBegin({fname:"text",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.text),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function Aa(a,b){b.writeStructBegin("GenAITextPromptViewModel");if(a.prompts!=null){b.writeFieldBegin({fname:"prompts",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:1});b.writeListBegin({etype:h.STRUCT,size:a.prompts.length});for(a of a.prompts)r(a,b);b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function s(a,b){b.writeStructBegin("GenAIReminderViewModel"),a.reminder_id!=null&&(b.writeFieldBegin({fname:"reminder_id",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.reminder_id),b.writeFieldEnd()),a.title!=null&&(b.writeFieldBegin({fname:"title",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.title),b.writeFieldEnd()),a.trigger_type!=null&&(b.writeFieldBegin({fname:"trigger_type",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.trigger_type),b.writeFieldEnd()),a.trigger_time!=null&&(b.writeFieldBegin({fname:"trigger_time",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeString(a.trigger_time),b.writeFieldEnd()),a.create_time!=null&&(b.writeFieldBegin({fname:"create_time",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:5}),b.writeString(a.create_time),b.writeFieldEnd()),a.is_deleted!=null&&(b.writeFieldBegin({fname:"is_deleted",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:6}),b.writeBool(a.is_deleted),b.writeFieldEnd()),a.thumbnail_url!=null&&(b.writeFieldBegin({fname:"thumbnail_url",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:7}),b.writeString(a.thumbnail_url),b.writeFieldEnd()),a.full_size_url!=null&&(b.writeFieldBegin({fname:"full_size_url",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:8}),b.writeString(a.full_size_url),b.writeFieldEnd()),a.reminder_media_key!=null&&(b.writeFieldBegin({fname:"reminder_media_key",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:9}),b.writeString(a.reminder_media_key),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function t(a,b){b.writeStructBegin("GenAIStudioTransparencyViewModel"),a.admin_text!=null&&(b.writeFieldBegin({fname:"admin_text",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.admin_text),b.writeFieldEnd()),a.cta_text!=null&&(b.writeFieldBegin({fname:"cta_text",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.cta_text),b.writeFieldEnd()),a.cta_url!=null&&(b.writeFieldBegin({fname:"cta_url",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.cta_url),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function u(a,b){b.writeStructBegin("GenAIMemoryNotificationsViewModel");if(a.memory_notifications_data!=null){b.writeFieldBegin({fname:"memory_notifications_data",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:1});b.writeListBegin({etype:h.STRUCT,size:a.memory_notifications_data.length});for(a of a.memory_notifications_data)v(a,b);b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function v(a,b){b.writeStructBegin("GenAIMemoryNotificationData"),a.admin_text!=null&&(b.writeFieldBegin({fname:"admin_text",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.admin_text),b.writeFieldEnd()),a.cta_text!=null&&(b.writeFieldBegin({fname:"cta_text",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.cta_text),b.writeFieldEnd()),a.cta_url!=null&&(b.writeFieldBegin({fname:"cta_url",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.cta_url),b.writeFieldEnd()),a.identifier!=null&&(b.writeFieldBegin({fname:"identifier",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeString(a.identifier),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function Ba(a,b){b.writeStructBegin("GenAIBizAgentViewModel");if(a.related_product_ids!=null){b.writeFieldBegin({fname:"related_product_ids",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:1});b.writeListBegin({etype:h.STRING,size:a.related_product_ids.length});for(a of a.related_product_ids)b.writeString(a);b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function w(a,b){b.writeStructBegin("MessageIdParams");b.writeFieldBegin({fname:"otid",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.otid!=null)b.writeString(a.otid);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"timestamp_ms",ftype:h.STRING,fid:2});if(a.timestamp_ms!=null)b.writeString(a.timestamp_ms);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function x(a,b){b.writeStructBegin("StoredMemory"),a.memory_id!=null&&(b.writeFieldBegin({fname:"memory_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1}),b.writeI64(BigInt(a.memory_id)),b.writeFieldEnd()),a.memory_text!=null&&(b.writeFieldBegin({fname:"memory_text",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.memory_text),b.writeFieldEnd()),a.message_id_params!=null&&(b.writeFieldBegin({fname:"message_id_params",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:3}),w(a.message_id_params,b),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function y(a,b){b.writeStructBegin("NewMemory"),a.memory_id!=null&&(b.writeFieldBegin({fname:"memory_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1}),b.writeI64(BigInt(a.memory_id)),b.writeFieldEnd()),a.memory_text!=null&&(b.writeFieldBegin({fname:"memory_text",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.memory_text),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function z(a,b){b.writeStructBegin("MemoryUpdate");if(a.added_memories!=null){b.writeFieldBegin({fname:"added_memories",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:1});b.writeListBegin({etype:h.STRUCT,size:a.added_memories.length});for(var d of a.added_memories)y(d,b);b.writeListEnd();b.writeFieldEnd()}if(a.removed_memories!=null){b.writeFieldBegin({fname:"removed_memories",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:2});b.writeListBegin({etype:h.STRUCT,size:a.removed_memories.length});for(d of a.removed_memories)x(d,b);b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function A(a,b){b.writeStructBegin("MemoryDisclosure"),a.disclosure_text!=null&&(b.writeFieldBegin({fname:"disclosure_text",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.disclosure_text),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function B(a,b){b.writeStructBegin("GenAIMemoryUpdateViewModel"),a.memory_update!=null&&(b.writeFieldBegin({fname:"memory_update",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1}),z(a.memory_update,b),b.writeFieldEnd()),a.memory_disclosure!=null&&(b.writeFieldBegin({fname:"memory_disclosure",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2}),A(a.memory_disclosure,b),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function C(a,b){b.writeStructBegin("GenAIStreamingStateViewModel"),a.streaming_state!=null&&(b.writeFieldBegin({fname:"streaming_state",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.streaming_state),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function D(a,b){b.writeStructBegin("GenAIControlTokenViewModel"),a.control_token!=null&&(b.writeFieldBegin({fname:"control_token",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.control_token),b.writeFieldEnd()),a.token_id!=null&&(b.writeFieldBegin({fname:"token_id",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.token_id),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function E(a,b){b.writeStructBegin("ActionPayloadObject"),a.json!=null&&(b.writeFieldBegin({fname:"json",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.json),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function F(a,b){b.writeStructBegin("DialogStateCacheObject"),a.dialog_state_cache_json!=null&&(b.writeFieldBegin({fname:"dialog_state_cache_json",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.dialog_state_cache_json),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function G(a,b){b.writeStructBegin("StructuredResponseInfoObject"),a.structured_response_json!=null&&(b.writeFieldBegin({fname:"structured_response_json",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.structured_response_json),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function H(a,b){b.writeStructBegin("PluginsMetadata");if(a.executed_plugins!=null){b.writeFieldBegin({fname:"executed_plugins",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:1});b.writeListBegin({etype:h.STRING,size:a.executed_plugins.length});for(var d of a.executed_plugins)b.writeString(d);b.writeListEnd();b.writeFieldEnd()}if(a.plugins_response_metadata_json!=null){b.writeFieldBegin({fname:"plugins_response_metadata_json",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:2});b.writeListBegin({etype:h.STRING,size:a.plugins_response_metadata_json.length});for(d of a.plugins_response_metadata_json)b.writeString(d);b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function I(a,b){b.writeStructBegin("SGViewModel"),a.action_payload_object!=null&&(b.writeFieldBegin({fname:"action_payload_object",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1}),E(a.action_payload_object,b),b.writeFieldEnd()),a.dialog_state_cache_object!=null&&(b.writeFieldBegin({fname:"dialog_state_cache_object",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2}),F(a.dialog_state_cache_object,b),b.writeFieldEnd()),a.structured_response_info_object!=null&&(b.writeFieldBegin({fname:"structured_response_info_object",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:3}),G(a.structured_response_info_object,b),b.writeFieldEnd()),a.plugins_metadata!=null&&(b.writeFieldBegin({fname:"plugins_metadata",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:4}),H(a.plugins_metadata,b),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function J(a,b){b.writeStructBegin("GenAIPersonasFeedSummaryViewModel");if(a.owners!=null){b.writeFieldBegin({fname:"owners",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:1});b.writeListBegin({etype:h.STRING,size:a.owners.length});for(var d of a.owners)b.writeString(d);b.writeListEnd();b.writeFieldEnd()}if(a.media_urls!=null){b.writeFieldBegin({fname:"media_urls",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:2});b.writeListBegin({etype:h.STRING,size:a.media_urls.length});for(d of a.media_urls)b.writeString(d);b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function Ca(a,b){b.writeStructBegin("GenAIViewModels"),a.imagine_view_model!=null&&(b.writeFieldBegin({fname:"imagine_view_model",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1}),k(a.imagine_view_model,b),b.writeFieldEnd()),a.search_view_model!=null&&(b.writeFieldBegin({fname:"search_view_model",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2}),l(a.search_view_model,b),b.writeFieldEnd()),a.reels_view_model!=null&&(b.writeFieldBegin({fname:"reels_view_model",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:3}),m(a.reels_view_model,b),b.writeFieldEnd()),a.sports_view_model!=null&&(b.writeFieldBegin({fname:"sports_view_model",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:4}),q(a.sports_view_model,b),b.writeFieldEnd()),a.reminder_view_model!=null&&(b.writeFieldBegin({fname:"reminder_view_model",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:5}),s(a.reminder_view_model,b),b.writeFieldEnd()),a.studio_transparency_view_model!=null&&(b.writeFieldBegin({fname:"studio_transparency_view_model",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:6}),t(a.studio_transparency_view_model,b),b.writeFieldEnd()),a.memory_notifications_view_model!=null&&(b.writeFieldBegin({fname:"memory_notifications_view_model",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:7}),u(a.memory_notifications_view_model,b),b.writeFieldEnd()),a.memory_update_view_model!=null&&(b.writeFieldBegin({fname:"memory_update_view_model",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:8}),B(a.memory_update_view_model,b),b.writeFieldEnd()),a.streaming_state_view_model!=null&&(b.writeFieldBegin({fname:"streaming_state_view_model",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:9}),C(a.streaming_state_view_model,b),b.writeFieldEnd()),a.control_token_view_model!=null&&(b.writeFieldBegin({fname:"control_token_view_model",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:10}),D(a.control_token_view_model,b),b.writeFieldEnd()),a.sg_view_model!=null&&(b.writeFieldBegin({fname:"sg_view_model",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:11}),I(a.sg_view_model,b),b.writeFieldEnd()),a.personas_feed_summary_view_model!=null&&(b.writeFieldBegin({fname:"personas_feed_summary_view_model",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:12}),J(a.personas_feed_summary_view_model,b),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function K(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.media_type=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.prompt=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.uri=a.readString():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRING?b.temporary_handle=a.readString():a.skip(e);break;case 5:e===(h||(h=c("ThriftTypes"))).STRING?b.request_id=a.readString():a.skip(e);break;case 6:e===(h||(h=c("ThriftTypes"))).STRING?b.response_id=a.readString():a.skip(e);break;case 7:e===(h||(h=c("ThriftTypes"))).STRING?b.insertion_index=a.readString():a.skip(e);break;case 8:e===(h||(h=c("ThriftTypes"))).STRING?b.avatar_motion_type=a.readString():a.skip(e);break;case 9:e===(h||(h=c("ThriftTypes"))).STRING?b.background_motion_type=a.readString():a.skip(e);break;case 10:e===(h||(h=c("ThriftTypes"))).STRING?b.serialized_blob=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function L(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.reels_url=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.thumbnail_url=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.author=a.readString():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRING?b.avatar_url=a.readString():a.skip(e);break;case 5:e===(h||(h=c("ThriftTypes"))).STRING?b.media_id=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function M(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).LIST){b.imagine_raw_data=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=K(a);b.imagine_raw_data.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function N(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).LIST){b.search_result_uri=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=a.readString();b.search_result_uri.push(g)}}else a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.search_engine=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.search_query=a.readString():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRING?b.attribution_link=a.readString():a.skip(e);break;case 5:if(e===(h||(h=c("ThriftTypes"))).LIST){b.references_title=[];g=a.readListBegin();for(f=0;f<g.size;f++){d=a.readString();b.references_title.push(d)}}else a.skip(e);break;case 6:e===(h||(h=c("ThriftTypes"))).STRING?b.search_engine_icon_url=a.readString():a.skip(e);break;case 7:e===(h||(h=c("ThriftTypes"))).STRING?b.source_url=a.readString():a.skip(e);break;case 8:e===(h||(h=c("ThriftTypes"))).STRING?b.response=a.readString():a.skip(e);break;case 9:if(e===(h||(h=c("ThriftTypes"))).LIST){b.thumbnail_data=[];d=a.readListBegin();for(f=0;f<d.size;f++){g=a.readString();b.thumbnail_data.push(g)}}else a.skip(e);break;case 10:if(e===(h||(h=c("ThriftTypes"))).LIST){b.thumbnail_cdn_url=[];g=a.readListBegin();for(f=0;f<g.size;f++){d=a.readString();b.thumbnail_cdn_url.push(d)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function O(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).LIST){b.reels_urls=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=a.readString();b.reels_urls.push(g)}}else a.skip(e);break;case 2:if(e===(h||(h=c("ThriftTypes"))).LIST){b.reels_data=[];g=a.readListBegin();for(f=0;f<g.size;f++){d=L(a);b.reels_data.push(d)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function P(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.name=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.logo=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Q(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRUCT?b.home_team=P(a):a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRUCT?b.away_team=P(a):a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.home_team_score=a.readString():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRING?b.away_team_score=a.readString():a.skip(e);break;case 5:e===(h||(h=c("ThriftTypes"))).STRING?b.match_status=a.readString():a.skip(e);break;case 6:e===(h||(h=c("ThriftTypes"))).STRING?b.datetime=a.readString():a.skip(e);break;case 7:e===(h||(h=c("ThriftTypes"))).STRING?b.date=a.readString():a.skip(e);break;case 8:e===(h||(h=c("ThriftTypes"))).STRING?b.time=a.readString():a.skip(e);break;case 9:e===(h||(h=c("ThriftTypes"))).STRING?b.tournament_name=a.readString():a.skip(e);break;case 10:e===(h||(h=c("ThriftTypes"))).STRING?b.home_records=a.readString():a.skip(e);break;case 11:e===(h||(h=c("ThriftTypes"))).STRING?b.away_records=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function R(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRUCT?b.game_info=Q(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function S(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRUCT?b.sports_search_data=R(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function T(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.text=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Da(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).LIST){b.prompts=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=T(a);b.prompts.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function U(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.reminder_id=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.title=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.trigger_type=a.readString():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRING?b.trigger_time=a.readString():a.skip(e);break;case 5:e===(h||(h=c("ThriftTypes"))).STRING?b.create_time=a.readString():a.skip(e);break;case 6:e===(h||(h=c("ThriftTypes"))).BOOL?b.is_deleted=a.readBool():a.skip(e);break;case 7:e===(h||(h=c("ThriftTypes"))).STRING?b.thumbnail_url=a.readString():a.skip(e);break;case 8:e===(h||(h=c("ThriftTypes"))).STRING?b.full_size_url=a.readString():a.skip(e);break;case 9:e===(h||(h=c("ThriftTypes"))).STRING?b.reminder_media_key=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function V(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.admin_text=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.cta_text=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.cta_url=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function W(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).LIST){b.memory_notifications_data=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=X(a);b.memory_notifications_data.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function X(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.admin_text=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.cta_text=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.cta_url=a.readString():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRING?b.identifier=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Ea(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).LIST){b.related_product_ids=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=a.readString();b.related_product_ids.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Y(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.otid=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.timestamp_ms=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.otid===void 0&&(b.otid="");b.timestamp_ms===void 0&&(b.timestamp_ms="");return b}function Z(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I64?b.memory_id=a.readI64().toString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.memory_text=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRUCT?b.message_id_params=Y(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function $(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I64?b.memory_id=a.readI64().toString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.memory_text=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Fa(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).LIST){b.added_memories=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=$(a);b.added_memories.push(g)}}else a.skip(e);break;case 2:if(e===(h||(h=c("ThriftTypes"))).LIST){b.removed_memories=[];g=a.readListBegin();for(f=0;f<g.size;f++){d=Z(a);b.removed_memories.push(d)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Ga(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.disclosure_text=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Ha(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRUCT?b.memory_update=Fa(a):a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRUCT?b.memory_disclosure=Ga(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Ia(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.streaming_state=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Ja(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.control_token=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.token_id=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Ka(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.json=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function La(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.dialog_state_cache_json=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Ma(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.structured_response_json=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Na(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).LIST){b.executed_plugins=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=a.readString();b.executed_plugins.push(g)}}else a.skip(e);break;case 2:if(e===(h||(h=c("ThriftTypes"))).LIST){b.plugins_response_metadata_json=[];g=a.readListBegin();for(f=0;f<g.size;f++){d=a.readString();b.plugins_response_metadata_json.push(d)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Oa(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRUCT?b.action_payload_object=Ka(a):a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRUCT?b.dialog_state_cache_object=La(a):a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRUCT?b.structured_response_info_object=Ma(a):a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRUCT?b.plugins_metadata=Na(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Pa(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).LIST){b.owners=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=a.readString();b.owners.push(g)}}else a.skip(e);break;case 2:if(e===(h||(h=c("ThriftTypes"))).LIST){b.media_urls=[];g=a.readListBegin();for(f=0;f<g.size;f++){d=a.readString();b.media_urls.push(d)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Qa(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRUCT?b.imagine_view_model=M(a):a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRUCT?b.search_view_model=N(a):a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRUCT?b.reels_view_model=O(a):a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRUCT?b.sports_view_model=S(a):a.skip(e);break;case 5:e===(h||(h=c("ThriftTypes"))).STRUCT?b.reminder_view_model=U(a):a.skip(e);break;case 6:e===(h||(h=c("ThriftTypes"))).STRUCT?b.studio_transparency_view_model=V(a):a.skip(e);break;case 7:e===(h||(h=c("ThriftTypes"))).STRUCT?b.memory_notifications_view_model=W(a):a.skip(e);break;case 8:e===(h||(h=c("ThriftTypes"))).STRUCT?b.memory_update_view_model=Ha(a):a.skip(e);break;case 9:e===(h||(h=c("ThriftTypes"))).STRUCT?b.streaming_state_view_model=Ia(a):a.skip(e);break;case 10:e===(h||(h=c("ThriftTypes"))).STRUCT?b.control_token_view_model=Ja(a):a.skip(e);break;case 11:e===(h||(h=c("ThriftTypes"))).STRUCT?b.sg_view_model=Oa(a):a.skip(e);break;case 12:e===(h||(h=c("ThriftTypes"))).STRUCT?b.personas_feed_summary_view_model=Pa(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}g.ImagineData$DefaultConstructor=a;g.ReelsData$DefaultConstructor=b;g.GenAIImagineViewModel$DefaultConstructor=d;g.GenAISearchViewModel$DefaultConstructor=e;g.GenAIReelsViewModel$DefaultConstructor=f;g.TeamInfo$DefaultConstructor=aa;g.GameInfo$DefaultConstructor=ba;g.SportsSearchData$DefaultConstructor=ca;g.GenAISportsViewModel$DefaultConstructor=da;g.PromptData$DefaultConstructor=ea;g.GenAITextPromptViewModel$DefaultConstructor=fa;g.GenAIReminderViewModel$DefaultConstructor=ga;g.GenAIStudioTransparencyViewModel$DefaultConstructor=ha;g.GenAIMemoryNotificationsViewModel$DefaultConstructor=ia;g.GenAIMemoryNotificationData$DefaultConstructor=ja;g.GenAIBizAgentViewModel$DefaultConstructor=ka;g.MessageIdParams$DefaultConstructor=la;g.StoredMemory$DefaultConstructor=ma;g.NewMemory$DefaultConstructor=na;g.MemoryUpdate$DefaultConstructor=oa;g.MemoryDisclosure$DefaultConstructor=pa;g.GenAIMemoryUpdateViewModel$DefaultConstructor=qa;g.GenAIStreamingStateViewModel$DefaultConstructor=ra;g.GenAIControlTokenViewModel$DefaultConstructor=sa;g.ActionPayloadObject$DefaultConstructor=ta;g.DialogStateCacheObject$DefaultConstructor=ua;g.StructuredResponseInfoObject$DefaultConstructor=va;g.PluginsMetadata$DefaultConstructor=wa;g.SGViewModel$DefaultConstructor=xa;g.GenAIPersonasFeedSummaryViewModel$DefaultConstructor=ya;g.GenAIViewModels$DefaultConstructor=za;g.serializeImagineData=i;g.serializeReelsData=j;g.serializeGenAIImagineViewModel=k;g.serializeGenAISearchViewModel=l;g.serializeGenAIReelsViewModel=m;g.serializeTeamInfo=n;g.serializeGameInfo=o;g.serializeSportsSearchData=p;g.serializeGenAISportsViewModel=q;g.serializePromptData=r;g.serializeGenAITextPromptViewModel=Aa;g.serializeGenAIReminderViewModel=s;g.serializeGenAIStudioTransparencyViewModel=t;g.serializeGenAIMemoryNotificationsViewModel=u;g.serializeGenAIMemoryNotificationData=v;g.serializeGenAIBizAgentViewModel=Ba;g.serializeMessageIdParams=w;g.serializeStoredMemory=x;g.serializeNewMemory=y;g.serializeMemoryUpdate=z;g.serializeMemoryDisclosure=A;g.serializeGenAIMemoryUpdateViewModel=B;g.serializeGenAIStreamingStateViewModel=C;g.serializeGenAIControlTokenViewModel=D;g.serializeActionPayloadObject=E;g.serializeDialogStateCacheObject=F;g.serializeStructuredResponseInfoObject=G;g.serializePluginsMetadata=H;g.serializeSGViewModel=I;g.serializeGenAIPersonasFeedSummaryViewModel=J;g.serializeGenAIViewModels=Ca;g.deserializeImagineData=K;g.deserializeReelsData=L;g.deserializeGenAIImagineViewModel=M;g.deserializeGenAISearchViewModel=N;g.deserializeGenAIReelsViewModel=O;g.deserializeTeamInfo=P;g.deserializeGameInfo=Q;g.deserializeSportsSearchData=R;g.deserializeGenAISportsViewModel=S;g.deserializePromptData=T;g.deserializeGenAITextPromptViewModel=Da;g.deserializeGenAIReminderViewModel=U;g.deserializeGenAIStudioTransparencyViewModel=V;g.deserializeGenAIMemoryNotificationsViewModel=W;g.deserializeGenAIMemoryNotificationData=X;g.deserializeGenAIBizAgentViewModel=Ea;g.deserializeMessageIdParams=Y;g.deserializeStoredMemory=Z;g.deserializeNewMemory=$;g.deserializeMemoryUpdate=Fa;g.deserializeMemoryDisclosure=Ga;g.deserializeGenAIMemoryUpdateViewModel=Ha;g.deserializeGenAIStreamingStateViewModel=Ia;g.deserializeGenAIControlTokenViewModel=Ja;g.deserializeActionPayloadObject=Ka;g.deserializeDialogStateCacheObject=La;g.deserializeStructuredResponseInfoObject=Ma;g.deserializePluginsMetadata=Na;g.deserializeSGViewModel=Oa;g.deserializeGenAIPersonasFeedSummaryViewModel=Pa;g.deserializeGenAIViewModels=Qa}),98);
__d("RpGenaiSctpCaptionsGenAIBotStateSerializers",["PsiClientSearchTypesSerializers","RpGenaiSctpCaptionsCaptionsSerializers","RpGenaiSctpCaptionsGenAIBotStateTypes","ThriftTypes","ViewModelSerializers"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return{}}function b(){return{}}function e(){return{}}function f(){return{turnUuid:""}}function i(){return{}}function j(){return{targetStack:d("RpGenaiSctpCaptionsGenAIBotStateTypes").InfraStackType.cast(0)}}function k(){return{state:d("RpGenaiSctpCaptionsGenAIBotStateTypes").BotStateType.cast(0)}}function l(){return{reqId:0}}function m(){return{reqId:0,statusCode:0}}function n(){return{}}function o(){return{}}function p(){return{}}function q(){return{type:d("RpGenaiSctpCaptionsGenAIBotStateTypes").ClientInputType.cast(0),method:d("RpGenaiSctpCaptionsGenAIBotStateTypes").ClientInputMethod.cast(0)}}function r(){return{serverToClientAudioCtpLatencyMs:"0",roundtripAudioCtpLatencyMs:"0"}}function s(){return{ready:!1}}function t(){return{device:"",appName:"",event:""}}function u(){return{Uuid:""}}function v(){return{contextType:d("RpGenaiSctpCaptionsGenAIBotStateTypes").ContextType.cast(0),context:""}}function w(a,b){b.writeStructBegin("UserContent"),a.caption!=null&&(b.writeFieldBegin({fname:"caption",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1}),d("RpGenaiSctpCaptionsCaptionsSerializers").serializeCaptionPayload(a.caption,b),b.writeFieldEnd()),a.otid!=null&&(b.writeFieldBegin({fname:"otid",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.otid),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function x(a,b){b.writeStructBegin("LLMResponseContents"),a.genaiViewModels!=null&&(b.writeFieldBegin({fname:"genaiViewModels",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1}),d("ViewModelSerializers").serializeGenAIViewModels(a.genaiViewModels,b),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function y(a,b){b.writeStructBegin("BotContent"),a.caption!=null&&(b.writeFieldBegin({fname:"caption",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1}),d("RpGenaiSctpCaptionsCaptionsSerializers").serializeCaptionPayload(a.caption,b),b.writeFieldEnd()),a.llmResp!=null&&(b.writeFieldBegin({fname:"llmResp",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2}),x(a.llmResp,b),b.writeFieldEnd()),a.otid!=null&&(b.writeFieldBegin({fname:"otid",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.otid),b.writeFieldEnd()),a.isProactive!=null&&(b.writeFieldBegin({fname:"isProactive",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:4}),b.writeBool(a.isProactive),b.writeFieldEnd()),a.textPrompts!=null&&(b.writeFieldBegin({fname:"textPrompts",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:5}),d("ViewModelSerializers").serializeGenAITextPromptViewModel(a.textPrompts,b),b.writeFieldEnd()),a.captionTimestamps!=null&&(b.writeFieldBegin({fname:"captionTimestamps",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:6}),b.writeString(a.captionTimestamps),b.writeFieldEnd()),a.botResponseId!=null&&(b.writeFieldBegin({fname:"botResponseId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:7}),b.writeString(a.botResponseId),b.writeFieldEnd()),a.bizAgentViewModel!=null&&(b.writeFieldBegin({fname:"bizAgentViewModel",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:8}),d("ViewModelSerializers").serializeGenAIBizAgentViewModel(a.bizAgentViewModel,b),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function z(a,b){b.writeStructBegin("TurnMetaData");b.writeFieldBegin({fname:"turnUuid",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.turnUuid!=null)b.writeString(a.turnUuid);else{var d="";b.writeString(d)}b.writeFieldEnd();a.userSpeechStartTimestamp!=null&&(b.writeFieldBegin({fname:"userSpeechStartTimestamp",ftype:(h||(h=c("ThriftTypes"))).I64,fid:2}),b.writeI64(BigInt(a.userSpeechStartTimestamp)),b.writeFieldEnd());a.userSpeechEndTimestamp!=null&&(b.writeFieldBegin({fname:"userSpeechEndTimestamp",ftype:(h||(h=c("ThriftTypes"))).I64,fid:3}),b.writeI64(BigInt(a.userSpeechEndTimestamp)),b.writeFieldEnd());a.botSpeechStartTimestamp!=null&&(b.writeFieldBegin({fname:"botSpeechStartTimestamp",ftype:(h||(h=c("ThriftTypes"))).I64,fid:4}),b.writeI64(BigInt(a.botSpeechStartTimestamp)),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function A(a,b){b.writeStructBegin("PSIToolRequest"),a.turnId!=null&&(b.writeFieldBegin({fname:"turnId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.turnId),b.writeFieldEnd()),a.requestId!=null&&(b.writeFieldBegin({fname:"requestId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.requestId),b.writeFieldEnd()),a.psiToolQueryPlan!=null&&(b.writeFieldBegin({fname:"psiToolQueryPlan",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:4}),d("PsiClientSearchTypesSerializers").serializePSIToolQueryPlan(a.psiToolQueryPlan,b),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function B(a,b){b.writeStructBegin("PSIToolResponse");a.turnId!=null&&(b.writeFieldBegin({fname:"turnId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.turnId),b.writeFieldEnd());a.requestId!=null&&(b.writeFieldBegin({fname:"requestId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.requestId),b.writeFieldEnd());b.writeFieldBegin({fname:"targetStack",ftype:(h||(h=c("ThriftTypes"))).I32,fid:3});if(a.targetStack!=null){var e;b.writeI32((e=a.targetStack)!=null?e:0)}else{e=d("RpGenaiSctpCaptionsGenAIBotStateTypes").InfraStackType.cast(0);b.writeI32((e=e)!=null?e:0)}b.writeFieldEnd();a.psiToolQueryData!=null&&(b.writeFieldBegin({fname:"psiToolQueryData",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:4}),d("PsiClientSearchTypesSerializers").serializePSIToolQueryData(a.psiToolQueryData,b),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function C(a,b){b.writeStructBegin("StateMessage");b.writeFieldBegin({fname:"state",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});if(a.state!=null){var e;b.writeI32((e=a.state)!=null?e:0)}else{e=d("RpGenaiSctpCaptionsGenAIBotStateTypes").BotStateType.cast(0);b.writeI32((e=e)!=null?e:0)}b.writeFieldEnd();a.userContent!=null&&(b.writeFieldBegin({fname:"userContent",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2}),w(a.userContent,b),b.writeFieldEnd());a.botContent!=null&&(b.writeFieldBegin({fname:"botContent",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:3}),y(a.botContent,b),b.writeFieldEnd());a.padding!=null&&(b.writeFieldBegin({fname:"padding",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeString(a.padding),b.writeFieldEnd());a.turnMetaData!=null&&(b.writeFieldBegin({fname:"turnMetaData",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:5}),z(a.turnMetaData,b),b.writeFieldEnd());a.psiToolRequest!=null&&(b.writeFieldBegin({fname:"psiToolRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:6}),A(a.psiToolRequest,b),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function D(a,b){b.writeStructBegin("UgcBotChangeRequest");b.writeFieldBegin({fname:"reqId",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});if(a.reqId!=null)b.writeI32(a.reqId);else{var d=0;b.writeI32(d)}b.writeFieldEnd();a.ugcBotId!=null&&(b.writeFieldBegin({fname:"ugcBotId",ftype:(h||(h=c("ThriftTypes"))).I64,fid:2}),b.writeI64(BigInt(a.ugcBotId)),b.writeFieldEnd());a.personaId!=null&&(b.writeFieldBegin({fname:"personaId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.personaId),b.writeFieldEnd());a.threadId!=null&&(b.writeFieldBegin({fname:"threadId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeString(a.threadId),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function E(a,b){b.writeStructBegin("UgcBotChangeResponse");b.writeFieldBegin({fname:"reqId",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});if(a.reqId!=null)b.writeI32(a.reqId);else{var d=0;b.writeI32(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"statusCode",ftype:h.I32,fid:2});if(a.statusCode!=null)b.writeI32(a.statusCode);else{d=0;b.writeI32(d)}b.writeFieldEnd();a.error!=null&&(b.writeFieldBegin({fname:"error",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.error),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function F(a,b){b.writeStructBegin("ClientOutputParams");if(a.outputType!=null){b.writeFieldBegin({fname:"outputType",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});b.writeI32((a=a.outputType)!=null?a:0);b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function G(a,b){b.writeStructBegin("ClientInputData");if(a.attachmentEntIds!=null){b.writeFieldBegin({fname:"attachmentEntIds",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:1});b.writeListBegin({etype:h.STRING,size:a.attachmentEntIds.length});for(var e of a.attachmentEntIds)b.writeString(e);b.writeListEnd();b.writeFieldEnd()}a.psiToolResponse!=null&&(b.writeFieldBegin({fname:"psiToolResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2}),B(a.psiToolResponse,b),b.writeFieldEnd());if(a.conversationHistory!=null){b.writeFieldBegin({fname:"conversationHistory",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:3});b.writeListBegin({etype:h.STRUCT,size:a.conversationHistory.length});for(e of a.conversationHistory)d("PsiClientSearchTypesSerializers").serializeChatMessage(e,b);b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function H(a,b){b.writeStructBegin("ClientInputContents");a.text!=null&&(b.writeFieldBegin({fname:"text",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.text),b.writeFieldEnd());a.data!=null&&(b.writeFieldBegin({fname:"data",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2}),G(a.data,b),b.writeFieldEnd());a.otid!=null&&(b.writeFieldBegin({fname:"otid",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.otid),b.writeFieldEnd());if(a.event!=null){var d;b.writeFieldBegin({fname:"event",ftype:(h||(h=c("ThriftTypes"))).I32,fid:4});b.writeI32((d=a.event)!=null?d:0);b.writeFieldEnd()}a.promptId!=null&&(b.writeFieldBegin({fname:"promptId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:5}),b.writeString(a.promptId),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function I(a,b){b.writeStructBegin("ClientInputMessage");b.writeFieldBegin({fname:"type",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});if(a.type!=null){var e;b.writeI32((e=a.type)!=null?e:0)}else{e=d("RpGenaiSctpCaptionsGenAIBotStateTypes").ClientInputType.cast(0);b.writeI32((e=e)!=null?e:0)}b.writeFieldEnd();b.writeFieldBegin({fname:"method",ftype:h.I32,fid:2});if(a.method!=null){b.writeI32((e=a.method)!=null?e:0)}else{e=d("RpGenaiSctpCaptionsGenAIBotStateTypes").ClientInputMethod.cast(0);b.writeI32((e=e)!=null?e:0)}b.writeFieldEnd();a.contents!=null&&(b.writeFieldBegin({fname:"contents",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:3}),H(a.contents,b),b.writeFieldEnd());a.outputParams!=null&&(b.writeFieldBegin({fname:"outputParams",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:4}),F(a.outputParams,b),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function J(a,b){b.writeStructBegin("GenAiMediaStats");b.writeFieldBegin({fname:"serverToClientAudioCtpLatencyMs",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1});if(a.serverToClientAudioCtpLatencyMs!=null)b.writeI64(BigInt(a.serverToClientAudioCtpLatencyMs));else{var d="0";b.writeI64(BigInt(d))}b.writeFieldEnd();b.writeFieldBegin({fname:"roundtripAudioCtpLatencyMs",ftype:h.I64,fid:2});if(a.roundtripAudioCtpLatencyMs!=null)b.writeI64(BigInt(a.roundtripAudioCtpLatencyMs));else{d="0";b.writeI64(BigInt(d))}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function K(a,b){b.writeStructBegin("CreatorBotClientReadyMessage");b.writeFieldBegin({fname:"ready",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:1});if(a.ready!=null)b.writeBool(a.ready);else{a=!1;b.writeBool(a)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function L(a,b){b.writeStructBegin("WearableAppEvent");b.writeFieldBegin({fname:"device",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.device!=null)b.writeString(a.device);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"appName",ftype:h.STRING,fid:2});if(a.appName!=null)b.writeString(a.appName);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"event",ftype:h.STRING,fid:3});if(a.event!=null)b.writeString(a.event);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function M(a,b){b.writeStructBegin("GenAiConnectState");b.writeFieldBegin({fname:"Uuid",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.Uuid!=null)b.writeString(a.Uuid);else{var d="";b.writeString(d)}b.writeFieldEnd();a.msgSentTimestamp!=null&&(b.writeFieldBegin({fname:"msgSentTimestamp",ftype:(h||(h=c("ThriftTypes"))).I64,fid:2}),b.writeI64(BigInt(a.msgSentTimestamp)),b.writeFieldEnd());a.msgRecvTimestamp!=null&&(b.writeFieldBegin({fname:"msgRecvTimestamp",ftype:(h||(h=c("ThriftTypes"))).I64,fid:3}),b.writeI64(BigInt(a.msgRecvTimestamp)),b.writeFieldEnd());a.selecledtModel!=null&&(b.writeFieldBegin({fname:"selecledtModel",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeString(a.selecledtModel),b.writeFieldEnd());a.modelTier!=null&&(b.writeFieldBegin({fname:"modelTier",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:5}),b.writeString(a.modelTier),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function N(a,b){b.writeStructBegin("UserContext");b.writeFieldBegin({fname:"contextType",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});if(a.contextType!=null){var e;b.writeI32((e=a.contextType)!=null?e:0)}else{e=d("RpGenaiSctpCaptionsGenAIBotStateTypes").ContextType.cast(0);b.writeI32((e=e)!=null?e:0)}b.writeFieldEnd();a.fbid!=null&&(b.writeFieldBegin({fname:"fbid",ftype:(h||(h=c("ThriftTypes"))).I64,fid:2}),b.writeI64(BigInt(a.fbid)),b.writeFieldEnd());a.contextId!=null&&(b.writeFieldBegin({fname:"contextId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.contextId),b.writeFieldEnd());b.writeFieldBegin({fname:"context",ftype:h.STRING,fid:4});if(a.context!=null)b.writeString(a.context);else{e="";b.writeString(e)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function O(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRUCT?b.caption=d("RpGenaiSctpCaptionsCaptionsSerializers").deserializeCaptionPayload(a):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRING?b.otid=a.readString():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();return b}function P(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRUCT?b.genaiViewModels=d("ViewModelSerializers").deserializeGenAIViewModels(a):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();return b}function Q(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRUCT?b.caption=d("RpGenaiSctpCaptionsCaptionsSerializers").deserializeCaptionPayload(a):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRUCT?b.llmResp=P(a):a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).STRING?b.otid=a.readString():a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).BOOL?b.isProactive=a.readBool():a.skip(f);break;case 5:f===(h||(h=c("ThriftTypes"))).STRUCT?b.textPrompts=d("ViewModelSerializers").deserializeGenAITextPromptViewModel(a):a.skip(f);break;case 6:f===(h||(h=c("ThriftTypes"))).STRING?b.captionTimestamps=a.readString():a.skip(f);break;case 7:f===(h||(h=c("ThriftTypes"))).STRING?b.botResponseId=a.readString():a.skip(f);break;case 8:f===(h||(h=c("ThriftTypes"))).STRUCT?b.bizAgentViewModel=d("ViewModelSerializers").deserializeGenAIBizAgentViewModel(a):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();return b}function R(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.turnUuid=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).I64?b.userSpeechStartTimestamp=a.readI64().toString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).I64?b.userSpeechEndTimestamp=a.readI64().toString():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).I64?b.botSpeechStartTimestamp=a.readI64().toString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.turnUuid===void 0&&(b.turnUuid="");return b}function S(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRING?b.turnId=a.readString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRING?b.requestId=a.readString():a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).STRUCT?b.psiToolQueryPlan=d("PsiClientSearchTypesSerializers").deserializePSIToolQueryPlan(a):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();return b}function T(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRING?b.turnId=a.readString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRING?b.requestId=a.readString():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I32?b.targetStack=d("RpGenaiSctpCaptionsGenAIBotStateTypes").InfraStackType.cast(a.readI32()):a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).STRUCT?b.psiToolQueryData=d("PsiClientSearchTypesSerializers").deserializePSIToolQueryData(a):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.targetStack===void 0&&(b.targetStack=d("RpGenaiSctpCaptionsGenAIBotStateTypes").InfraStackType.cast(0));return b}function U(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.state=d("RpGenaiSctpCaptionsGenAIBotStateTypes").BotStateType.cast(a.readI32()):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRUCT?b.userContent=O(a):a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).STRUCT?b.botContent=Q(a):a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).STRING?b.padding=a.readString():a.skip(f);break;case 5:f===(h||(h=c("ThriftTypes"))).STRUCT?b.turnMetaData=R(a):a.skip(f);break;case 6:f===(h||(h=c("ThriftTypes"))).STRUCT?b.psiToolRequest=S(a):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.state===void 0&&(b.state=d("RpGenaiSctpCaptionsGenAIBotStateTypes").BotStateType.cast(0));return b}function V(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I32?b.reqId=a.readI32():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).I64?b.ugcBotId=a.readI64().toString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.personaId=a.readString():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRING?b.threadId=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.reqId===void 0&&(b.reqId=0);return b}function W(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I32?b.reqId=a.readI32():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).I32?b.statusCode=a.readI32():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.error=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.reqId===void 0&&(b.reqId=0);b.statusCode===void 0&&(b.statusCode=0);return b}function X(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.outputType=d("RpGenaiSctpCaptionsGenAIBotStateTypes").ClientOutputType.cast(a.readI32()):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();return b}function Y(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:if(f===(h||(h=c("ThriftTypes"))).LIST){b.attachmentEntIds=[];e=a.readListBegin();for(var g=0;g<e.size;g++){var i=a.readString();b.attachmentEntIds.push(i)}}else a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRUCT?b.psiToolResponse=T(a):a.skip(f);break;case 3:if(f===(h||(h=c("ThriftTypes"))).LIST){b.conversationHistory=[];i=a.readListBegin();for(g=0;g<i.size;g++){e=d("PsiClientSearchTypesSerializers").deserializeChatMessage(a);b.conversationHistory.push(e)}}else a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();return b}function Z(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRING?b.text=a.readString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRUCT?b.data=Y(a):a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).STRING?b.otid=a.readString():a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).I32?b.event=d("RpGenaiSctpCaptionsGenAIBotStateTypes").ClientInputEvent.cast(a.readI32()):a.skip(f);break;case 5:f===(h||(h=c("ThriftTypes"))).STRING?b.promptId=a.readString():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();return b}function $(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.type=d("RpGenaiSctpCaptionsGenAIBotStateTypes").ClientInputType.cast(a.readI32()):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).I32?b.method=d("RpGenaiSctpCaptionsGenAIBotStateTypes").ClientInputMethod.cast(a.readI32()):a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).STRUCT?b.contents=Z(a):a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).STRUCT?b.outputParams=X(a):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.type===void 0&&(b.type=d("RpGenaiSctpCaptionsGenAIBotStateTypes").ClientInputType.cast(0));b.method===void 0&&(b.method=d("RpGenaiSctpCaptionsGenAIBotStateTypes").ClientInputMethod.cast(0));return b}function aa(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I64?b.serverToClientAudioCtpLatencyMs=a.readI64().toString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).I64?b.roundtripAudioCtpLatencyMs=a.readI64().toString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.serverToClientAudioCtpLatencyMs===void 0&&(b.serverToClientAudioCtpLatencyMs="0");b.roundtripAudioCtpLatencyMs===void 0&&(b.roundtripAudioCtpLatencyMs="0");return b}function ba(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).BOOL?b.ready=a.readBool():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.ready===void 0&&(b.ready=!1);return b}function ca(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.device=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.appName=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.event=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.device===void 0&&(b.device="");b.appName===void 0&&(b.appName="");b.event===void 0&&(b.event="");return b}function da(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.Uuid=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).I64?b.msgSentTimestamp=a.readI64().toString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).I64?b.msgRecvTimestamp=a.readI64().toString():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRING?b.selecledtModel=a.readString():a.skip(e);break;case 5:e===(h||(h=c("ThriftTypes"))).STRING?b.modelTier=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.Uuid===void 0&&(b.Uuid="");return b}function ea(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.contextType=d("RpGenaiSctpCaptionsGenAIBotStateTypes").ContextType.cast(a.readI32()):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).I64?b.fbid=a.readI64().toString():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).STRING?b.contextId=a.readString():a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).STRING?b.context=a.readString():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.contextType===void 0&&(b.contextType=d("RpGenaiSctpCaptionsGenAIBotStateTypes").ContextType.cast(0));b.context===void 0&&(b.context="");return b}g.UserContent$DefaultConstructor=a;g.LLMResponseContents$DefaultConstructor=b;g.BotContent$DefaultConstructor=e;g.TurnMetaData$DefaultConstructor=f;g.PSIToolRequest$DefaultConstructor=i;g.PSIToolResponse$DefaultConstructor=j;g.StateMessage$DefaultConstructor=k;g.UgcBotChangeRequest$DefaultConstructor=l;g.UgcBotChangeResponse$DefaultConstructor=m;g.ClientOutputParams$DefaultConstructor=n;g.ClientInputData$DefaultConstructor=o;g.ClientInputContents$DefaultConstructor=p;g.ClientInputMessage$DefaultConstructor=q;g.GenAiMediaStats$DefaultConstructor=r;g.CreatorBotClientReadyMessage$DefaultConstructor=s;g.WearableAppEvent$DefaultConstructor=t;g.GenAiConnectState$DefaultConstructor=u;g.UserContext$DefaultConstructor=v;g.serializeUserContent=w;g.serializeLLMResponseContents=x;g.serializeBotContent=y;g.serializeTurnMetaData=z;g.serializePSIToolRequest=A;g.serializePSIToolResponse=B;g.serializeStateMessage=C;g.serializeUgcBotChangeRequest=D;g.serializeUgcBotChangeResponse=E;g.serializeClientOutputParams=F;g.serializeClientInputData=G;g.serializeClientInputContents=H;g.serializeClientInputMessage=I;g.serializeGenAiMediaStats=J;g.serializeCreatorBotClientReadyMessage=K;g.serializeWearableAppEvent=L;g.serializeGenAiConnectState=M;g.serializeUserContext=N;g.deserializeUserContent=O;g.deserializeLLMResponseContents=P;g.deserializeBotContent=Q;g.deserializeTurnMetaData=R;g.deserializePSIToolRequest=S;g.deserializePSIToolResponse=T;g.deserializeStateMessage=U;g.deserializeUgcBotChangeRequest=V;g.deserializeUgcBotChangeResponse=W;g.deserializeClientOutputParams=X;g.deserializeClientInputData=Y;g.deserializeClientInputContents=Z;g.deserializeClientInputMessage=$;g.deserializeGenAiMediaStats=aa;g.deserializeCreatorBotClientReadyMessage=ba;g.deserializeWearableAppEvent=ca;g.deserializeGenAiConnectState=da;g.deserializeUserContext=ea}),98);
__d("ZenonCircularBuffer",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=[],this.$2=0,this.$3=0,this.$4=0,this.$2=a<0?0:a,this.$1=new Array(this.$2).fill(0)}var b=a.prototype;b.add=function(a){if(this.$1.length===0)return;this.$1[this.$3%this.$2]=a;this.$3++;this.$3>this.$2&&(this.$4=(this.$4+1)%this.$2)};b.getAvg=function(){var a=this.$1.length;if(a<=0)return null;a=this.$1.slice(0,this.$3);return a.length>0?Number(a.reduce(function(a,b){return a+b},0).toPrecision(10))/a.length:0};b.getDelta=function(){if(this.$1.length<=0)return null;return this.$3>0?this.$2===1?Number(this.$1[this.$4]):this.$3<this.$2?Number(this.$1[this.$3-1]):Number(this.$1[(this.$3-1)%this.$2]-this.$1[this.$4]):0};return a}();f["default"]=a}),66);
__d("percentile",[],(function(a,b,c,d,e,f){function g(a,b){return(a||0)-(b||0)}function a(a,b){return h(a.slice().sort(g),b)}function h(a,b){b=(a.length-1)*b;var c=Math.floor(b),d=Math.ceil(b);if(c===d)return a[b];var e=a[c]*(d-b);a=a[d]*(b-c);return e+a}a.fromSorted=h;e.exports=a}),null);
__d("median",["percentile"],(function(a,b,c,d,e,f){function a(a){return b("percentile")(a,.5)}e.exports=a}),null);
__d("ZenonDeltaMediaStat",["median"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1=[],this.$2=0,this.$3=null,this.$4=Infinity,this.$5=-Infinity}var b=a.prototype;b.add=function(a){this.$1.push(a),this.$2++,this.$3=a,this.$4=Math.min(this.$4,a),this.$5=Math.max(this.$5,a)};b.getLastAddedValue=function(){return this.$3};b.getTotal=function(){return this.$1.reduce(function(a,b){return a+b},0)};b.getCount=function(){return this.$1.length};b.getAverage=function(){return this.getTotal()/this.getCount()};b.getMin=function(){return this.$4};b.getMax=function(){return this.$5};b.getMedian=function(){return c("median")(this.$1)};return a}();g["default"]=a}),98);
__d("ZenonFirstMediaPacketFinder",["Promise","performanceNow"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=500,k=1e4;a=function(){function a(a,b,c){this.$1={audio:null,screen:null,screen_audio:null,video:null},this.$2={audio:null,screen:null,screen_audio:null,video:null},this.$3={audio:!1,screen:!1,screen_audio:!1,video:!1},this.$4=null,this.$5=a,this.$6=b,this.$7=c,this.$8=Date.now()}var d=a.prototype;d.setUpForTrackType=function(a){var b=this;if(this.$2[a]!=null&&this.$1[a]!=null)return;this.$3[a]=!0;this.$4==null&&(this.$8=Date.now(),this.$4=window.setInterval(function(){b.$9(),Date.now()-b.$8>=k&&(window.clearInterval(b.$4),b.$4=null)},j),this.$9())};d.getFirstPacketTimes=function(){return this.$2};d.getFirstSentPacketTimes=function(){return this.$1};d.$10=function(){var a=this,b=Object.keys(this.$3).some(function(b){return a.$3[b]&&a.$2[b]==null}),c=Object.keys(this.$3).some(function(b){return a.$3[b]&&a.$1[b]==null});return b||c};d.$9=function(){var a=this,d=this.$5.getTransceivers(),e=d.filter(function(a){return a.currentDirection==="sendrecv"||a.currentDirection==="recvonly"}).map(function(a){return a.receiver}).filter(function(a){return a.track!=null});d=d.filter(function(a){return a.currentDirection==="sendrecv"||a.currentDirection==="sendonly"}).map(function(a){return a.sender}).filter(function(a){return a.track!=null});e=[].concat(e,d).map(function(b){var d=b.track;return d!=null?b.getStats().then(function(b){if(b.values)for(b of b.values()){var e=!1;if(b.type==="inbound-rtp"&&Number(b.packetsReceived)>0&&a.$2[d.kind]==null){var f=(i||(i=c("performanceNow")))();a.$2[d.kind]=f;a.$6(d.kind,f);e=!0}if(b.type==="outbound-rtp"&&Number(b.packetsSent)>0&&a.$1[d.kind]==null){f=(i||(i=c("performanceNow")))();a.$1[d.kind]=f;a.$7(d.kind,f);e=!0}e&&a.$4!=null&&!a.$10()&&(window.clearInterval(a.$4),a.$4=null)}}):null});(h||(h=b("Promise"))).all(e)};return a}();g["default"]=a}),98);
__d("ZenonHistogramCounter",[],(function(a,b,c,d,e,f){"use strict";var g=1e4;a=function(){function a(a,b,c){this.$1=[];this.$2=0;this.$3=0;this.$4=0;this.$5=!1;this.$6=1;if(a>b||c<=0)return;(Math.floor(a)!==a||Math.floor(b)!==b||Math.floor(c)!==c)&&(this.$6=g);this.$3=Math.floor(a*this.$6+.5);this.$2=Math.floor(c*this.$6+.5);a=Math.floor((Math.floor(b*this.$6+.5)-this.$3)/this.$2)+2;this.$1=new Array(a).fill(0);this.$4=this.$3+(a-2)*this.$2;this.$5=!0}var b=a.prototype;b.update=function(a){if(!this.$5||this.$1.length===0)return;a=Math.floor(a*this.$6+.5);if(a<this.$3)++this.$1[0];else if(a>=this.$4)this.$1[this.$1.length-1]++;else{a=Math.floor((a-this.$3+.5)/this.$2)+1;this.$1[a]++}};b.getStats=function(){return this.$5?this.$1:null};return a}();f["default"]=a}),66);
__d("ZenonCumulativeMediaStat",["performanceNow"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a){this.$3=this.$5=this.$1=a,this.$7=this.$8=a,this.$9=!1,this.$4=this.$6=this.$2=(h||(h=c("performanceNow")))(),this.$10=1,this.$11=0,this.$12=0}var b=a.prototype;b.$13=function(a){this.$5=this.$1,this.$6=this.$2,this.$1=a,this.$2=(h||(h=c("performanceNow")))(),this.$10++};b.update=function(a){this.$7=this.$8;this.$8=a;a=this.$8-this.$7;a<0?(a=this.$8,this.$9=!0):this.$9=!1;this.$13(this.$1+a)};b.updateLastStretchStartValue=function(a){this.$11=a};b.getLastStretchDelta=function(){return this.$1-this.$11};b.updateNonStrictCumulative=function(a){this.$7=this.$8,this.$8=a,this.$9=!1,this.$13(a)};b.isReset=function(){return this.$9};b.getCurrentValue=function(){return this.$1};b.getDeltaValue=function(){return this.$1-this.$3};b.getDeltaFromLastUpdate=function(){return this.$1-this.$5};b.getTimeSinceLastUpdate=function(){return this.$2-this.$6};b.getElapsedTime=function(){return this.$2-this.$4};b.getPreviousTime=function(){return this.$6};b.getCurrentTime=function(){return this.$2};b.getAverageOverTime=function(){return this.getDeltaValue()/this.getElapsedTime()};b.updateInactiveDuration=function(a){this.$12+=a};b.getActiveDuration=function(){return this.getElapsedTime()-this.$12};b.getAverageOverActiveTime=function(){return this.getDeltaValue()/this.getActiveDuration()};b.getCurrentTimeSinceLastUpdate=function(){return(h||(h=c("performanceNow")))()-this.$2};b.getCount=function(){return this.$10};b.getFirstValue=function(){return this.$3};return a}();g["default"]=a}),98);
__d("ZenonMediaStatsSerializer",["ZenonCallFalcoEventUtils","ZenonCumulativeMediaStat","ZenonMediaStatsConfig","ZenonRenderedView"],(function(a,b,c,d,e,f,g){"use strict";var h=[(b=d("ZenonMediaStatsConfig")).OUTBOUND_AUDIO_STATS_TRACKID,b.OUTBOUND_VIDEO_STATS_TRACKID,b.OUTBOUND_SCREEN_STATS_TRACKID,b.GLOBAL_STATS_TRACKID,b.PINNED_AUDIO_STATS_TRACK_INFO.trackId,b.PINNED_VIDEO_STATS_TRACK_INFO.trackId],i=1e3,j=1e4,k={tet:1e3,tpsd:1e3};function a(a,b,e,f,g,h,i,j){e={CoreAudioMetrics:{isstall:"0",voice_detect_pct:[]},CoreVideoMetrics:{screen:{capture_stall:{is_stall:"0"},encode_stall:{is_stall:"0"},sent_stall:{is_stall:"0"}},video:{capture_stall:{is_stall:"0"},encode_stall:{is_stall:"0"},sent_stall:{is_stall:"0"}}},DebugAudioMetrics:{NetworkReceive:{}},audio:{echo_confidence:{}},dataChannelMetrics:{},ecv:{ecv_neteq_wait_time_ms:"0",ecv_plccng_v2:"0",ecv_rtt_ms:"0"},extraInfo:{mediaPacketTimes:e.getFirstPacketTimes()},receiver:{},receiver_pct:{audio:{}},receiver_stalls:{screen_recv_stalls:{recv_decode_stall:{is_stall:"0"},recv_no_bytes_stall:{is_stall:"0"},recv_render_stall:{is_stall:"0"}},video_recv_stalls:{recv_decode_stall:{is_stall:"0"},recv_no_bytes_stall:{is_stall:"0"},recv_render_stall:{is_stall:"0"}}},sender:{},sender_pct:{screen:{},video:{}},video:{}};var k={};l(j,e);j=b.get(d("ZenonMediaStatsConfig").OUTBOUND_AUDIO_STATS_TRACKID);j!=null&&(x(j,e.sender),F(j,e.CoreAudioMetrics));j=b.get(d("ZenonMediaStatsConfig").OUTBOUND_SCREEN_STATS_TRACKID);j!=null&&(C(f,e.video,j),z(f,e.video,j,k),I(e.sender_pct.screen,j,c("ZenonRenderedView").GRID,"screen"));var o=b.get(d("ZenonMediaStatsConfig").OUTBOUND_VIDEO_STATS_TRACKID);o!=null&&(z(f,e.video,o,k),I(e.sender_pct.video,o,c("ZenonRenderedView").GRID,"video"));(j!=null||o!=null)&&D(e.video,o,j);t(b,e);m(b,e);p(a,b,e,h,i);n(b,e,k,f);v(b,e,k);w(e,k);q(e,g);r(b,e);return e}function l(a,b){a.forEach(function(a){var c=a.label;if(c!=null){var e;b.dataChannelMetrics[c]={bytes_received:(e=d("ZenonCallFalcoEventUtils")).nonNullIntNumber(a.bytesReceived),bytes_sent:e.nonNullIntNumber(a.bytesSent),label:c,messages_received:e.nonNullIntNumber(a.messagesReceived),messages_sent:e.nonNullIntNumber(a.messagesSent)}}})}function m(a,b){a.forEach(function(a){var c=a.localIceCandidateStats;a=a.remoteIceCandidateStats;!b.extraInfo.localIceCandidate&&c&&(b.extraInfo.localIceCandidate=c);!b.extraInfo.remoteIceCandidate&&a&&(b.extraInfo.remoteIceCandidate=a)})}function n(a,b,c,d){a.forEach(function(a,e){!h.includes(e)&&a.remote===!0&&(a.contentType==="audio"?(y(a,e,b,c),E(a,c)):a.contentType==="video"?(A(d,b.video,a,c),o(a,b.receiver_stalls.video_recv_stalls)):a.contentType==="screen"&&(B(d,b.video),o(a,b.receiver_stalls.screen_recv_stalls)))})}function o(a,b){var c=a.cumulativeStat,d=c.videoDecodeStallDuration,e=c.videoDecodeTotalStalls,f=c.videoReceiveStallDuration,g=c.videoReceiveTotalStalls,h=c.videoRenderStallDuration;c=c.videoRenderTotalStalls;var i=a.deltaStat,j=i.videoDecodeIsStalled,k=i.videoReceiveIsStalled;i=i.videoRenderIsStall;b&&(g&&f&&H(b==null?void 0:b.recv_no_bytes_stall,g,f,k),e&&d&&H(b==null?void 0:b.recv_decode_stall,e,d,j),a.contentType==="video"&&c&&h&&H(b==null?void 0:b.recv_render_stall,c,h,i))}function p(a,b,c,d,e){b.forEach(function(b,f){if(b.remote===!1){b=(b=d.get(f))!=null?b:a.get(f);if(b==null)return;b.enabled===!0&&b.webrtcTrack.readyState==="live"&&(b.contentType==="audio"?u(e.audioDevices,b):b.contentType==="video"&&u(e.videoDevices,b));e.audioDevices.length>0&&(c.CoreAudioMetrics.audio_device=e.audioDevices[e.audioDevices.length-1]);e.videoDevices.length>0&&(c.CoreVideoMetrics.video_device=e.videoDevices[e.videoDevices.length-1]);return}})}function q(a,b){b=(b=b.getStats())!=null?b:[];var c=b.some(function(a){return a>0});if(c){a.video.receiver=(c=a.video.receiver)!=null?c:{};a.video.receiver.avhist=b}}function r(a,b){a=a.get(d("ZenonMediaStatsConfig").OUTBOUND_AUDIO_STATS_TRACKID);if(!a)return;s(a,b)}function s(a,b){a=a.deltaStat.audioSendGoldenEchoConfidence;if(!a)return;a=a.getMax();b.audio={echo_confidence:{audio_send_echo_confidence:a.toString()}}}function t(a,b){var c=a.get(d("ZenonMediaStatsConfig").OUTBOUND_VIDEO_STATS_TRACKID);a=a.get(d("ZenonMediaStatsConfig").OUTBOUND_SCREEN_STATS_TRACKID);c!=null&&G(c,b.CoreVideoMetrics.video);a!=null&&G(a,b.CoreVideoMetrics.screen)}function u(a,b){a.length===0?a.push(b.label):b.label!==a[a.length-1]&&a.push(b.label)}function v(a,b,c){c.totalRxLevel!=null&&c.totalRxLevelCount!=null&&c.totalRxLevelCount>0&&(b.CoreAudioMetrics.rx_chan_proc_lvl=d("ZenonCallFalcoEventUtils").nonNullIntNumber(Math.round(c.totalRxLevel/c.totalRxLevelCount)));c=a.get(d("ZenonMediaStatsConfig").GLOBAL_STATS_TRACKID);if(c==null)return;a=c.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOUDNESS_LEVEL];c=c.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOG_LEVEL_COUNT];a&&c&&(b.receiver.rx_sum_lvl=a.getCurrentValue(),b.receiver.taulc=c.getCurrentValue())}function w(a,b){var c={},e=a.receiver,f=e.jbd;e=e.jbec;if(f!=null&&e!=null&&e>0){f=d("ZenonCallFalcoEventUtils").nonNullIntNumber(Math.round(f/e));c.neteq={meanWait:f}}e=b.maxSpeechExpandRate!=null?Math.round(b.maxSpeechExpandRate*j):null;f=b.minSpeechExpandRate!=null?Math.round(b.minSpeechExpandRate*j):null;b=b.countSpeechExpandRate!=null&&b.countSpeechExpandRate>0&&b.sumSpeechExpandRate!=null?Math.round(b.sumSpeechExpandRate*j/b.countSpeechExpandRate):null;(e!=null||b!=null||f!=null)&&(c.speech_expand_rate={M:d("ZenonCallFalcoEventUtils").nonNullIntNumber(e),avg:d("ZenonCallFalcoEventUtils").nonNullIntNumber(b),m:d("ZenonCallFalcoEventUtils").nonNullIntNumber(f)});a.DebugAudioMetrics.NetworkReceive={jb_nm:c}}function x(a,b){var c=a.cumulativeStat,e=c.bytesSent;c=c.packetsSent;var f=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED],g=a.deltaStat.currentRoundTripTime,h=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOUDNESS_LEVEL],j=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOG_LEVEL_COUNT];f=new Map([["bytes",e],["plost",f],["psent",c]]);f.forEach(function(a,c){a!=null&&c!=="codec"&&c!=="ice"&&c!=="ice_g0"&&(b[c]=a.getCurrentValue())});if(e){c=e.getElapsedTime();c>0&&(b.ube_avg=Math.round(e.getDeltaValue()*8/c*i))}if(g){f=g.getTotal()*i;e=g.getCount();if(e>0){b.avgrtt=Math.round(f/e);b.maxrtt=Math.max((c=b.maxrtt)!=null?c:Number.MIN_SAFE_INTEGER,g.getMax()*i);b.minrtt=Math.min((f=b.minrtt)!=null?f:Number.MAX_SAFE_INTEGER,g.getMin()*i)}}a.codec!=null&&a.codec!==""&&(b.codec={www:a.codec});h&&j&&(b.tx_sum_lvl=h.getCurrentValue(),b.taulc=j.getCurrentValue());return b}function y(a,b,e,f){var g=e.receiver;a.codec!=null&&a.codec!==""&&(g.codec==null&&(g.codec={}),g.codec[b]=a.codec);b=a.cumulativeStat;var h=b.audioDecodingNormal,j=b.audioDecodingPLC,k=b.audioDecodingPLCCNG,l=b.bytesReceived,m=b.concealedSamples,n=b.fecPacketsDiscarded,o=b.fecPacketsReceived,p=b.insertedSamplesForDeceleration,q=b.jitterBufferDelay,r=b.jitterBufferEmittedCount,s=b.packetsReceived,t=b.silentConcealedSamples,u=b.totalAudioEnergy,v=b.totalSamplesDuration;b=b.totalSamplesReceived;var w=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED],x=a.deltaStat,y=x.currentRoundTripTime;x=x.jitter;if(l){var z=l.getElapsedTime();if(z>0){var A=K(g.dbe_total_bytes,l.getDeltaValue());g.dbe_total_bytes=A;z=K(g.dbe_total_time,z);g.dbe_total_time=z;g.dbe_avg=Math.round(A*8/z*i)}}if(y){f.sumrtt=((A=f.sumrtt)!=null?A:0)+y.getTotal()*i;f.countrtt=((z=f.countrtt)!=null?z:0)+y.getCount();f.sumrtt!=null&&f.countrtt!=null&&f.countrtt>0&&(g.avgrtt=Math.round(f.sumrtt/f.countrtt));g.maxrtt=Math.max((A=g.maxrtt)!=null?A:Number.MIN_SAFE_INTEGER,y.getMax()*i);g.minrtt=Math.min((z=g.minrtt)!=null?z:Number.MAX_SAFE_INTEGER,y.getMin()*i);J(e.receiver_pct.audio,a,c("ZenonRenderedView").GRID,"audio")}q&&(g.jbd=K(g.jbd,1e3*q.getCurrentValue()));u&&(g.taue=K(g.taue,1e5*u.getCurrentValue()),g.taut=K(g.taut,u.getElapsedTime()));v&&(g.sp_dur=K(g.sp_dur,1e3*v.getCurrentValue()));A=new Map([["dec_plc",j],["dec_plc_cng",k],["dec_normal",h],["neteq_calls",b],["decel_cnt",p],["bytes",l],["plost",w],["precv",s],["fecpd",n],["fecpr",o],["jbec",r],["sp_c",m],["sp_dur",v],["sp_r",b],["sp_sc",t]]);A.forEach(function(a,b){a!=null&&b!=="codec"&&b!=="ice"&&b!=="ice_g0"&&(g[b]=K(g[b],a.getCurrentValue()))});if(x&&s&&g.precv!=null&&g.precv>0){z=g.precv;y=x.getTotal()*s.getCurrentValue();f.weightedJitterSum=((e=f.weightedJitterSum)!=null?e:0)+y;g.jitter=Math.round(1e3*f.weightedJitterSum/z)}return g}function z(a,b,e,f){b.ld=Math.round(a.getLocalVideoDuration());var g=b.sender||{};g.video_blur_dur=Math.round(a.getLocalVideoBlurDuration());e.codec!=null&&e.codec!==""&&(g.ename=e.codec);if(e.histResScale){g.histResScale==null&&(g.histResScale=new Array(5).fill(0));var h=g.histResScale;h.forEach(function(a,b){h[b]+=e.histResScale[b]})}a=e.cumulativeStat;var j=a.bytesSent,l=a.captureFrameCount,m=a.firCount,n=a.framesEncoded,o=a.framesSent,p=a.keyFramesEncoded,q=a.nackCount,r=a.packetsSent,s=a.pliCount,t=a.simulcast_layer_changes,u=a.totalEncodeTime,v=a.totalPacketSendDelay,w=a.videoConvertedQpSum,x=a.videoSumCapturePixel;a=a.videoSumPixel;var y=e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED],z=e.deltaStat,A=z.frameHeight,B=z.frameWidth,C=z.height;z=z.width;j=new Map([["enc_bytes",j],["eiframes",l],["eqps",w],["plost",y],["psent",r],["pli",s],["fcsn",o],["fir",m],["tet",u],["tpsd",v],["fcap",l],["frames",n],["kframes",p],["nack",q],["sim_l_chg",t],["ah",A],["aw",B],["ch",C],["cw",z]]);j.forEach(function(a,b){if(a!=null&&b!=="ename"&&b!=="histResScale"&&b!=="ehist"&&b!=="ss")if(a instanceof c("ZenonCumulativeMediaStat")){var d;d=(d=k[b])!=null?d:1;g[b]=K(g[b],a.getCurrentValue()*d)}else{g[b]=Math.round((d=a.getLastAddedValue())!=null?d:0)}});b.ld!=null&&b.ld>0&&g.frames!=null&&g.frames>0&&(g.efrate=Math.round(g.frames*i/b.ld));if(x&&g.fcap!=null&&g.fcap>0){w=g.fcap;f.videoSumCapturePixel=K((y=f.videoSumCapturePixel)!=null?y:void 0,x.getCurrentValue());g.video_sum_capture_pixel=f.videoSumCapturePixel;g.eipxl=Math.round(f.videoSumCapturePixel/w)}if(a&&g.frames!=null&&g.frames>0){r=g.frames;f.videoSumPixel=K((s=f.videoSumPixel)!=null?s:void 0,a.getCurrentValue());g.video_sum_encoded_pixel=f.videoSumPixel;g.eopxl=Math.round(f.videoSumPixel/r)}e.codecHistory!=null&&(g.ehist=Object.fromEntries(e.codecHistory.map(function(a){var b=a.codec;a=a.updateTime;return[Math.round(a).toString(),b]})));b.sender=g}function A(a,b,e,f){b.rd=Math.round(a.getRemoteVideoDuration());a=b.receiver;var g=a===void 0?{}:a;e.codec!=null&&e.codec!==""&&e.lastUpdate>((a=f.lastCodecUpdate)!=null?a:Number.MIN_SAFE_INTEGER)&&(g.dname=e.codec,f.lastCodecUpdate=e.lastUpdate);a=e.cumulativeStat;var h=a.bytesReceived,i=a.firCount,j=a.framesDecoded,k=a.framesReceived,l=a.jitterBufferDelay,m=a.jitterBufferEmittedCount,n=a.jitterBufferFramesSentToDecoder,o=a.keyFramesDecoded,p=a.nackCount,q=a.packetsReceived,r=a.pliCount,s=a.timestamp,t=a.totalDecodeTime,u=a.videoConvertedQpSum,v=a.videoDecodedBytes,w=a.videoDecodeTime,x=a.videoFreezeCount,y=a.videoFreezeDuration,z=a.videoFreezeDuration500ms,A=a.videoPauseCount,B=a.videoPauseDuration;a=a.videoSumPixel;var C=e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED],D=e.deltaStat,E=D.avSync,F=D.avSyncAbs,G=D.frameHeight;D=D.frameWidth;if(j){if(e.maxTotalDecodeTime!=null){var H;g.dec_time=Math.round(Math.max(e.maxTotalDecodeTime,(H=g.dec_time)!=null?H:0))}H=K(g.frd,j.getCurrentValue());if(H>0){var I;g.frd=(I=g.frd)!=null?I:0}if(a!=null&&H>0){I=((I=f.aggVideoSumPixel)!=null?I:0)+a.getCurrentValue();g.dpxl=Math.round(I/H);f.aggVideoSumPixel=I;g.agg_video_sum_decoded_pixel=I}if(E!=null&&F!=null&&H>0){I=((a=f.weigtedAvSync)!=null?a:0)+E.getAverage()*j.getCurrentValue();E=((a=f.weigtedAvSyncAbs)!=null?a:0)+F.getAverage()*j.getCurrentValue();g.av=Math.round(I/H);g.avabs=Math.round(E/H);f.weigtedAvSync=I;f.weigtedAvSyncAbs=E}g.frd=H;g.dec_frame=H}if(e.percentStat.videoReceiverQualityScore!=null){a=e.percentStat.videoReceiverQualityScore.getAvgAndPercentile(d("ZenonMediaStatsConfig").PERCENTILES_REQUESTED,c("ZenonRenderedView").GRID,"video");a!=null&&a.avg!=null&&(g.vqs={avg:a.avg})}if(D&&G&&s&&s.getCurrentTime()>((F=f.lastFrameUpdate)!=null?F:Number.MIN_SAFE_INTEGER)){g.rh=(j=G.getLastAddedValue())!=null?j:0;g.rw=(I=D.getLastAddedValue())!=null?I:0;f.lastFrameUpdate=s.getCurrentTime()}t&&(g.tdt=K(g.tdt,1e3*t.getCurrentValue()));l&&(g.jbd=K(g.jbd,1e3*l.getCurrentValue()));E=new Map([["recv",h],["qps",u],["plost",C],["precv",q],["pli",r],["pact",A],["padur",B],["jbec",m],["jtasb",k],["jtfrm",n],["jtkey",o],["nack",p],["fir",i],["frcnt",x],["frdur",y],["frdur500",z],["dec_time_all_streams",w],["dec_bytes",v]]);E.forEach(function(a,b){a!=null&&b!=="dname"&&b!=="avhist"&&b!=="ss_recv"&&b!=="vqs"&&(g[b]=K(g[b],a.getCurrentValue()))});g.jbd!=null&&g.jbec!=null&&g.jbec>0&&(g.recjbl=Math.round(g.jbd/g.jbec));b.receiver=g}function B(a,b){var c;c=((c=b.receiver)==null?void 0:c.ss_recv)||{};c.ss_recv_dur=Math.round(a.getRemoteScreenShareDuration());b.receiver=(a=b.receiver)!=null?a:{};b.receiver.ss_recv=c}function C(a,b,c){var d,e=((d=b.sender)==null?void 0:d.ss)||{};e.dur=Math.round(a.getLocalScreenShareDuration());d=c.cumulativeStat;a=d.captureFrameCount;var f=d.framesEncoded,g=d.videoBytesSent,h=d.videoConvertedQpSum,i=d.videoSumCapturePixel;d=d.videoSumPixel;c=c.deltaStat.availableOutgoingBitrate;a=new Map([["eiframes",a],["eqps",h],["frames",f]]);a.forEach(function(a,b){a!=null&&(e[b]=a.getCurrentValue())});if(i!=null&&e.eiframes!=null&&e.eiframes>0){h=e.eiframes;e.video_sum_capture_pixel=i.getCurrentValue();e.eipxl=Math.round(i.getCurrentValue()/h)}if(d!=null&&e.frames!=null&&e.frames>0){f=e.frames;e.video_sum_encoded_pixel=d.getCurrentValue();e.eopxl=Math.round(d.getCurrentValue()/f)}c&&(e.avbw=Math.round(c.getAverage()));if(g&&e.dur!=null&&e.dur>0){a=e.dur;e.avbr=Math.round(g.getCurrentValue()*8/a)}b.sender=(i=b.sender)!=null?i:{};b.sender.ss=e}function D(a,b,c){var e=d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_ACTUAL_ENCODED_BITRATE;b=(b=b==null?void 0:b.deltaStat)!=null?b:{};b=b[e];c=(c=c==null?void 0:c.deltaStat)!=null?c:{};c=c[e];e=0;var f=0,g=0,h=0;b!=null&&(e+=b.getTotal(),f+=b.getCount());c!=null&&(g+=c.getTotal(),h+=c.getCount(),e+=g,f+=h);f!==0&&(a.bwe={avg_enc_bitrate:Math.round(e/f)});h!==0&&(a.bwe=babelHelpers["extends"]({},a.bwe,{avg_enc_bitrate_ss:Math.round(g/h)}))}function E(a,b){var c=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOG_LEVEL];a=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOG_LEVEL_COUNT];if(c&&a){var e;b.totalRxLevel=((e=b.totalRxLevel)!=null?e:0)+c.getCurrentValue();b.totalRxLevelCount=((e=b.totalRxLevelCount)!=null?e:0)+a.getCurrentValue()}}function F(a,b){var c=a.cumulativeStat,e=c.audioDevRecStalls,f=c.audioDevStallDuration;c=c.audioDevTotalStalls;var g=a.deltaStat.audioDevIsStalled;c=new Map([["astall",c],["sdur",f],["rstall",e]]);c.forEach(function(a,c){a!=null&&c!=="audio_device"&&c!=="rx_chan_proc_lvl_hist"&&c!=="voice_detect_pct"&&(b[c]=d("ZenonCallFalcoEventUtils").nonNullIntNumber(Math.round(a.getCurrentValue())))});if(g){b.isstall=d("ZenonCallFalcoEventUtils").nonNullIntNumber((f=g.getLastAddedValue())!=null?f:0)}e=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOUDNESS_LEVEL];c=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOG_LEVEL_COUNT];c!=null&&c.getCurrentValue()>0&&e!=null&&(b.captured_lvl=d("ZenonCallFalcoEventUtils").nonNullIntNumber(Math.round(e.getCurrentValue()/c.getCurrentValue())),b.loudness_level=String(e.getCurrentValue()),b.loudness_level_count=String(c.getCurrentValue()))}function G(a,b){var c=a.cumulativeStat,d=c.videoCaptureStallDuration,e=c.videoCaptureTotalStalls,f=c.videoEncodeStallDuration,g=c.videoEncodeTotalStalls,h=c.videoSentStallDuration;c=c.videoSentTotalStalls;a=a.deltaStat;var i=a.videoCaptureIsStalled,j=a.videoEncodeIsStalled;a=a.videoSentIsStalled;d&&e&&H(b.capture_stall,e,d,i);g&&f&&H(b.encode_stall,g,f,j);c&&h&&H(b.sent_stall,c,h,a)}function H(a,b,c,e){b=new Map([["nstall",b],["sdur",c]]);b.forEach(function(b,c){b!=null&&c!=="video_device"&&(a[c]=d("ZenonCallFalcoEventUtils").nonNullIntNumber(Math.round(b.getCurrentValue())))});(c==null?void 0:c.getLastStretchDelta())&&(a.last_sdur=d("ZenonCallFalcoEventUtils").nonNullIntNumber(Math.round(c.getLastStretchDelta())));if(e){a.is_stall=d("ZenonCallFalcoEventUtils").nonNullIntNumber((b=e.getLastAddedValue())!=null?b:0)}}function I(a,b,c,e){if(a!=null){b=b.percentStat;var f=b.encodedFrameRate,g=b.roundTripTime,h=b.videoQP;b=b.videoQuality;f=new Map([["efr",f],["vqs",b],["vrtt",g],["qp",h]]);f.forEach(function(b,f){if(b!=null){b=b.getAvgAndPercentile(d("ZenonMediaStatsConfig").PERCENTILES_REQUESTED,c,e);a[f]={};b.avg!=null&&a[f]!=null&&(a[f].avg=b.avg);b.percentiles!=null&&a[f]!=null&&(a[f].p5=b.percentiles[0],a[f].p50=b.percentiles[1],a[f].p95=b.percentiles[2])}})}}function J(a,b,c,e){if(a==null)return;b=b.percentStat;var f=b.jitterBufferDelay;b=b.roundTripTime;f=new Map([["jbd",f],["rtt",b]]);f.forEach(function(b,f){if(b!=null){b=b.getAvgAndPercentile(d("ZenonMediaStatsConfig").PERCENTILES_REQUESTED,c,e);a[f]={};b.avg!=null&&a[f]!=null&&(a[f].avg=b.avg);b.percentiles!=null&&a[f]!=null&&(a[f].p5=b.percentiles[0],a[f].p50=b.percentiles[1],a[f].p95=b.percentiles[2])}})}function K(a,b){return a===void 0?Math.round(b):Math.round(a+b)}g.getMediaStats=a;g.addAudioReceiverPercentStats=J}),98);
__d("ZenonSimulcastStats",["invariant"],(function(a,b,c,d,e,f,g,h){"use strict";b=function(){function a(){this.$1=0,this.$2=new Map(),this.$3=new Map()}var b=a.prototype;b.update=function(a){a=i(a,this.$2,this.$3);var b=0;for(var c of a){c[0];var d=c[1];d&&b++}if(this.$3.size===0)b>0&&this.$1++;else{d=!1;for(c of a){b=c[0];var e=c[1];(!this.$3.has(b)||this.$3.get(b)!==e)&&(d=!0)}d&&this.$1++}this.$3=a};b.getNumLayerChanges=function(){return this.isSimulcastCall()?this.$1:0};b.isSimulcastCall=function(){return this.$3.size>1};return a}();function i(a,b,c){var d=new Map();for(a of a.values()){a.type==="outbound-rtp"||h(0,64939);if(a.ssrc===void 0||a.framesSent===void 0)continue;var e=String(a.ssrc),f=Number(a.framesSent);if(b.has(e)){var g=b.get(e);g!==void 0&&d.set(e,f>g)}else d.set(e,f>0);b.set(e,f)}for(g of c){e=g[0];g[1];d.has(e)||d.set(e,!1)}return d}function a(a){if(a.length===1)return a[0];var b=null,c=null,d=0;for(a of a)if(a.frameWidth!=null){var e=Number(a.frameWidth),f=!1;(c==null||e<c)&&(c=e,f=!0);var g=!1;if(a.framesEncoded!=null){var h=Number(a.framesEncoded);h>d&&(g=!0,d=h)}(f||e===c&&g)&&(b=a)}return b}g.ZenonSimulcastStats=b;g.getBaseLayerReport=a}),98);
__d("ZenonVideoScaleHistogram",[],(function(a,b,c,d,e,f){"use strict";function g(a){if(a>=.765625)return 0;else if(a>=.390625)return 1;else if(a>=.19140625)return 2;else if(a>=.09765625)return 3;return 4}function a(a,b){var c=["video","screen"];a.filter(function(a){return c.includes(a.contentType)&&a.remote===!1}).forEach(function(a){a=b.get(a.trackId);if(!a||!a.cumulativeStat||!a.histResScale)return;var c=a.cumulativeStat,d=c.framesEncoded;c=c.timestamp;var e=a.deltaStat,f=e.frameHeight,h=e.frameWidth,i=e.height;e=e.width;if(d!=null&&e!=null&&i!=null&&h!=null&&f!=null&&c!=null&&d.getDeltaFromLastUpdate()>0&&c.getCurrentValue()>a.lastUpdate){c=d.getDeltaFromLastUpdate();d=((d=e.getLastAddedValue())!=null?d:0)*((e=i.getLastAddedValue())!=null?e:0);h=((i=h.getLastAddedValue())!=null?i:0)*((e=f.getLastAddedValue())!=null?e:0);if(d>0){i=h/d;f=g(i);a.histResScale[f]+=c}}})}f.getBinFromScale=g;f.updateTrackerWithScaleHistogram=a}),66);
__d("ZenonMediaStatsParser",["invariant","ZenonCumulativeMediaStat","ZenonDeltaMediaStat","ZenonMediaStatsConfig","ZenonSimulcastStats","ZenonVideoScaleHistogram","isStringNullOrEmpty","isTruthy","performanceNow"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=["inbound-rtp","outbound-rtp","track","media-source","candidate-pair"];function k(a,b){var c=new Map();b.forEach(function(b,d){(b.type==="ssrc"&&b.googTrackId!=null&&b.googTrackId===a.webrtcTrack.id||b.type==="VideoBwe")&&c.set(d,b)});return c}function a(a){var b=new Map();for(a of a){var c=a[0],d=a[1];j.includes(d.type)&&b.set(c,d)}return b}function l(a,b){var e=b.contentType,f=b.remote;b=b.trackId;var g=a.get(b);g==null&&(g={codec:null,contentType:e,cumulativeStat:{},deltaStat:{},duration:0,histResScale:new Array(d("ZenonVideoScaleHistogram").getBinFromScale(0)+1).fill(0),lastUpdate:0,maxTotalDecodeTime:0,percentStat:{},remote:f,startTime:(i||(i=c("performanceNow")))()},a.set(b,g));return g}function m(a){return d("ZenonMediaStatsConfig").CUMULATIVE_STATS.includes(a)}function n(a){return d("ZenonMediaStatsConfig").DELTA_STATS.includes(a)}function b(a){if(a instanceof Map)return a;var b=new Map();if(a.result!=null)for(var c of a.result()){var d={id:c.id,timestamp:c.timestamp,type:c.type};for(var e of c.names())d[e]==null&&(d[e]=c.stat(e));b.set(d.id,d)}else for(e of a.values())b.set(e.id,e);return b}function e(a,b,c){c=k(a,c);for(c of c.values()){var d=l(b,a);r(a,d,c);var e=p(c);e!=null&&(d.codec=e)}}function f(a,b,e){var f=null,g=[];for(e of e.values()){e.type==="outbound-rtp"&&e.trackId!=null&&(f=l(b,a),typeof e.trackId==="string"&&(f.sender=e.trackId));switch(e.type){case"inbound-rtp":f=l(b,a);s(f,e,d("ZenonMediaStatsConfig").getInboundRtpStats().concat(d("ZenonMediaStatsConfig").getRtpStats()));break;case"outbound-rtp":e.kind==="video"?g.push(e):(f=l(b,a),s(f,e,d("ZenonMediaStatsConfig").getOutboundRtpStats().concat(d("ZenonMediaStatsConfig").getRtpStats())));break;case"remote-outbound-rtp":e.kind==="audio"&&(f=l(b,a),s(f,e,d("ZenonMediaStatsConfig").getRemoteOutboundRtpStats()));break;case"media-source":f=l(b,a);s(f,e,d("ZenonMediaStatsConfig").getMediaSourceStats());break;case"candidate-pair":f=l(b,a);s(f,e,d("ZenonMediaStatsConfig").getCandidatePairStats());break;case"codec":var h=String(e.mimeType).split("/")[1];c("isStringNullOrEmpty")(h)||(f=l(b,a),q(f,h));break;case"local-candidate":f=l(b,a);f.localIceCandidateStats=u(e);break;case"remote-candidate":f=l(b,a);f.remoteIceCandidateStats=u(e);break;default:break}}if(g.length>0){f=l(b,a);t(f,g);h=d("ZenonSimulcastStats").getBaseLayerReport(g);h!=null&&s(f,h,d("ZenonMediaStatsConfig").getOutboundRtpStats().concat(d("ZenonMediaStatsConfig").getRtpStats()))}}function o(a,b,c){b=l(b,a);if(typeof c.getParameters==="function"){var d=c.getParameters();d=d.encodings;var e=b.audioEncoding,f=b.videoEncoding;if(Array.isArray(d)){d=d.some(function(a){return a.active});a.contentType==="audio"?!e?b.audioEncoding={enabled:d,prevState:null}:(e.prevState=e.enabled,e.enabled=d):!f?b.videoEncoding={enabled:d,prevState:null}:(f.prevState=f.enabled,f.enabled=d)}if((a=c.transport)==null?void 0:a.iceTransport){e=c.transport.iceTransport.state;b.transportIceState=e}}}function p(a){var b=null;a.googCodecName!=null&&a.googCodecName!==""&&(b=String(a.googCodecName),a.codecImplementationName!=null&&(b+=String(a.codecImplementationName)));return b}function q(a,b){a.startTime==null&&(a.startTime=(i||(i=c("performanceNow")))());var d=a.startTime;a.codecHistory==null&&(a.codecHistory=[]);b.length>0&&(a.codecHistory.length===0||a.codecHistory[a.codecHistory.length-1].codec!==b)&&a.codecHistory.push({codec:b,updateTime:(i||(i=c("performanceNow")))()-d});a.codec=b}function r(a,b,e){Object.entries(e).forEach(function(f){var g=f[0];f=Number(f[1]);if(e.type==="ssrc"&&d("ZenonMediaStatsConfig").STATS_REQUESTED.includes(g)&&d("ZenonMediaStatsConfig").getSsrcStats().includes(g)||e.type==="VideoBwe"&&d("ZenonMediaStatsConfig").getVideoBweStats().includes(g)&&a.contentType!=="audio"&&a.remote===!1)if(d("ZenonMediaStatsConfig").CUMULATIVE_STATS.includes(g)){if(g==="packetsLost"&&a.remote)return;b.cumulativeStat[g]!=null?g==="packetsLost"?b.cumulativeStat[g].updateNonStrictCumulative(f):b.cumulativeStat[g].update(f):b.cumulativeStat[g]=new(c("ZenonCumulativeMediaStat"))(f)}else d("ZenonMediaStatsConfig").DELTA_STATS.includes(g)&&(b.deltaStat[g]==null&&(b.deltaStat[g]=new(c("ZenonDeltaMediaStat"))()),b.deltaStat[g].add(f))})}function s(a,b,e){Object.entries(b).forEach(function(f){var g=f[0];f=Number(f[1]);if(!e||e.includes(g))if(m(g))a.cumulativeStat[g]!=null?g==="packetsLost"?a.cumulativeStat[g].updateNonStrictCumulative(f):a.cumulativeStat[g].update(f):a.cumulativeStat[g]=new(c("ZenonCumulativeMediaStat"))(f);else if(g===d("ZenonMediaStatsConfig").DERIVED_METRICS.FRAME_RATE_MEAN){var h=null;b.framesEncoded!=null?h=Number(b.framesEncoded):b.framesDecoded!=null&&(h=Number(b.framesDecoded));c("isTruthy")(h)&&(a.deltaStat[g]==null&&(a.deltaStat[g]=new(c("ZenonDeltaMediaStat"))()),a.deltaStat[g].add(f))}else n(g)&&(a.deltaStat[g]==null&&(a.deltaStat[g]=new(c("ZenonDeltaMediaStat"))()),a.deltaStat[g].add(f))})}function t(a,b){var e;a.simulcastStats===void 0&&(a.simulcastStats=new(d("ZenonSimulcastStats").ZenonSimulcastStats)());(e=a.simulcastStats)==null?void 0:e.update(b);b=(e=a.simulcastStats)==null?void 0:e.getNumLayerChanges();if(b!=null){e=d("ZenonMediaStatsConfig").DERIVED_METRICS.SIMULCAST_LAYER_CHANGES;a.cumulativeStat[e]!=null?a.cumulativeStat[e].update(b):a.cumulativeStat[e]=new(c("ZenonCumulativeMediaStat"))(b)}}function u(a){a.type==="local-candidate"||a.type==="remote-candidate"||h(0,64948);var b=a.candidateType,c=a.networkType,d=a.protocol;a=a.relayProtocol;var e={};b!=null&&typeof b==="string"&&(e.candidateType=b);c!=null&&typeof c==="string"&&(e.networkType=c);d!=null&&typeof d==="string"&&(e.protocol=d);a!=null&&typeof a==="string"&&(e.relayProtocol=a);return e}g.filterLegacyMediaReports=k;g.filterMediaReports=a;g.getOrCreateTrackerFromMap=l;g.isCumulativeStat=m;g.isDeltaStat=n;g.makeStatsReportMap=b;g.updateTrackStatsWithChromiumLegacyReport=e;g.updateTrackStatsWithReport=f;g.updateTrackStatsFromSender=o}),98);
__d("ZenonTSLogDataUtil",["ZenonAuditedCheckpointLogId","ZenonInfraActionsLogger"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=["recv","inbound"],d=["send","outbound"];if(b.some(function(b){return a.toLowerCase().includes(b)}))return"inbound";if(d.some(function(b){return a.toLowerCase().includes(b)}))return"outbound";c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"TsLogHolder Stream Name: "+a,error:"CANNOT_DETERMINE_STREAM_DIRECTION",errorDomain:"ZenonTSLogDataHelper"});return"inbound"}g.getMediaTrackDirection=a}),98);
__d("ZenonTSLogRegistry",[],(function(a,b,c,d,e,f){"use strict";var g={".":{counters:new Set(["ctime","btime"])},inbound_rtp_audio:{counters:new Set(["packetsLost_delta","packetsReceived_delta","bytesReceived","bytesReceived_delta","totalAudioEnergy_delta","audioLevel"])},inbound_rtp_video:{counters:new Set(["packetsLost_delta","packetsReceived_delta","bytesReceived","bytesReceived_delta","framesDecoded","framesDecoded_delta","frameWidth","frameHeight","framesPerSecond","avSync"])},outbound_rtp_audio:{counters:new Set(["bytesSent","bytesSent_delta","audioLevel","packetsLost_delta","totalAudioEnergy_delta"])},outbound_rtp_video:{counters:new Set(["video_videoCaptureIsStalled","video_videoEncodeIsStalled","video_videoSentIsStalled","packetsSent_delta","bytesSent","bytesSent_delta","framesEncoded","framesEncoded_delta","keyFramesEncoded_delta","frameWidth","frameHeight","framesPerSecond","packetsLost_delta"])}};a=function(){function a(a){this.$1=g,this.$2=a.allAllowed}var b=a.prototype;b.isCounterAllowed=function(a,b){return this.$2||((a=(a=this.$1[a])==null?void 0:a.counters.has(b))!=null?a:!1)};return a}();f["default"]=a}),66);
__d("ZenonVideoQpConversion",[],(function(a,b,c,d,e,f){"use strict";var g=[0,1,2,3,4,5,7,8,9,10,12,13,15,17,18,19,20,21,23,24,25,26,27,28,29,30,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,64,67,70,73,76,79,82,85,88,91,94,97,100,103,106,109,112,115,118,121,124,127],h=[1,5,12,28,42,53,64];function i(a){for(var b=0;b<g.length;b++)if(g[b]>=a)return b;return 63}function j(a){a=i(a);a=Math.max(1,Math.min(63,a));var b=h.length-1;for(var c=0;c<h.length;c++)if(h[c]>a){b=c;break}return Math.min(51,Math.floor(12+6*b+6*(a-h[b-1])/(h[b]-h[b-1])))}function a(a,b,c){if(a===0)return 0;else b=b/a;a=b;c||(a=j(a));return Math.round(a)}f.convertQp=a}),66);
__d("ZenonTSLogDataJSONHolder",["invariant","FBLogger","ZenonAuditedCheckpointLogId","ZenonE2eeMandatedStateManager","ZenonInfraActionsLogger","ZenonMediaStatsConfig","ZenonMediaStatsParser","ZenonTSLogDataUtil","ZenonTSLogRegistry","ZenonVideoQpConversion","pako"],(function(a,b,c,d,e,f,g,h){"use strict";var i={"new":1,checking:2,connected:3,completed:4,failed:5,disconnected:6,closed:7},j=1073741824;a=function(){function a(a){var b;this.$1={iceConnectionState:0,sendParametersState:null};this.$2=(b=a==null?void 0:a.endTimeMs)!=null?b:null;this.$3=(b=a==null?void 0:a.sharedIdx)!=null?b:0;this.$4=(b=a==null?void 0:a.source)!=null?b:"rtc_www";this.$5=(b=a==null?void 0:a.startTimeMs)!=null?b:null;this.$6=(b=a==null?void 0:a.streams)!=null?b:{};this.$7=new(c("ZenonTSLogRegistry"))({allAllowed:!c("ZenonE2eeMandatedStateManager").areBothInfraAndProductE2eeMandated()})}var b=a.prototype;b.getInternalState=function(){return{endTimeMs:this.$2,sharedIdx:this.$3,source:this.$4,startTimeMs:this.$5,streams:this.$6}};b.$8=function(a,b,c){if(c.includes("qp")&&a.counters.qpSum!=null&&(a.counters.framesDecoded!=null||a.counters.framesEncoded!=null)){a.counters.qp==null&&(a.counters.qp=Array(this.$3-a.bucketStart).fill(0));c=0;var e=0,f=this.$3-a.bucketStart;f>0?(a.counters.framesEncoded!=null?c=a.counters.framesEncoded[f]-a.counters.framesEncoded[f-1]:a.counters.framesDecoded!=null&&(c=a.counters.framesDecoded[f]-a.counters.framesDecoded[f-1]),e=a.counters.qpSum[f]-a.counters.qpSum[f-1]):(a.counters.framesEncoded!=null?c=a.counters.framesEncoded[f]:a.counters.framesDecoded!=null&&(c=a.counters.framesDecoded[f]),e=a.counters.qpSum[f]);a.counters.qp[f]=(a=d("ZenonVideoQpConversion").convertQp(c,e,b))!=null?a:0}};b.$9=function(a,b,c,e){var f=this,g=function(c,g){for(c of c)if(b.includes(c))for(var h of a.values())if(h.type===g&&h[c]!==void 0){var i;e.counters[c]==null&&(e.counters[c]=Array(f.$3-e.bucketStart).fill(0));i=(i=d("ZenonMediaStatsConfig").TSLOG_METRIC_SCALE[c])!=null?i:1;e.counters[c][f.$3-e.bucketStart]=Math.round(Number(h[c])*i)}};g(d("ZenonMediaStatsConfig").getTrackStats(),"track");g(d("ZenonMediaStatsConfig").getMediaSourceStats(),"media-source");if(c==="video"&&b.includes("qp")){g=!1;for(c of a.values())c.encoderImplementation!==void 0&&(g=String(c.encoderImplementation).includes("264"));this.$8(e,g,b)}};b.$10=function(a){return a.map(function(b,c){return c===0?0:b-a[c-1]})};b.$11=function(a){if(a.type==="candidate-pair")return a.id;var b="unknown",c=["recv","inbound"],d=["send","outbound"];(c.some(function(b){return a.id.toLowerCase().includes(b)})||c.some(function(b){return a.type.toLowerCase().includes(b)}))&&(b="inbound");(d.some(function(b){return a.id.toLowerCase().includes(b)})||d.some(function(b){return a.type.toLowerCase().includes(b)}))&&(b="outbound");a.type==="inbound-rtp"||a.type==="remote-inbound-rtp"||a.type==="outbound-rtp"||a.type==="remote-outbound-rtp"||a.type==="ssrc"||h(0,64950);c=a.mediaType===void 0?"unknown":a.mediaType.toString();d=a.ssrc===void 0?"unknown":a.ssrc.toString();return b+"_"+c+"_"+d};b.$12=function(a){return a};b.$13=function(a,b){return a+"_rtp_"+b};b.$14=function(a,b,c,d){if(d&&Object.prototype.hasOwnProperty.call(d.counters,"estimatedPlayoutTimestamp")&&Object.prototype.hasOwnProperty.call(b.counters,"estimatedPlayoutTimestamp")){var e=d.counters.estimatedPlayoutTimestamp.length,f=b.counters.estimatedPlayoutTimestamp.length,g="avSync",h="avSyncSign";if(this.$7.isCounterAllowed(a,g)&&this.$7.isCounterAllowed(a,h)){var i=Math.min(f,e),k=new Array(i).fill(0),l=new Array(i).fill(0);for(var m=0;m<i;m++){var n=d.counters.estimatedPlayoutTimestamp[m],o=b.counters.estimatedPlayoutTimestamp[m];n>0&&o>0?n>=o?(l[m]=2,k[m]=Math.min(n-o,j)):(l[m]=1,k[m]=Math.min(o-n,j)):(l[m]=0,k[m]=0)}c.push({data:k,name:g});c.push({data:l,name:h})}o="audioTs";n="videoTs";if(this.$7.isCounterAllowed(a,o)&&this.$7.isCounterAllowed(a,n)){m=22089888e5+1598738e6;i=Math.max(f,e);k=new Array(e).fill(0);g=new Array(f).fill(0);l=null;for(h=0;h<i;h++){a=d.counters.estimatedPlayoutTimestamp[h];e=b.counters.estimatedPlayoutTimestamp[h];l==null&&(a>m&&e>m?l=Math.min(a,e):a>m?l=a:e>m&&(l=e));l!=null&&(a>m&&(k[h]=Math.max(Math.min(a-l,j),-j)),e>m&&(g[h]=Math.max(Math.min(e-l,j),-j)))}c.push({data:k,name:o});c.push({data:g,name:n})}}};b.$15=function(a,b,c,e){var f=[];for(var g in b.counters)!c.includes(g)&&this.$7.isCounterAllowed(a,g)&&f.push({data:b.counters[g],name:g}),d("ZenonMediaStatsParser").isCumulativeStat(g)&&!c.includes(g+"_delta")&&this.$7.isCounterAllowed(a,g+"_delta")&&f.push({data:this.$10(b.counters[g]),name:g+"_delta"});g=b.counters;c=g.fecPacketsDiscarded;g=g.fecPacketsReceived;var h="fecPacketsUsed_delta";if(this.$7.isCounterAllowed(a,h)&&c!=null&&g!=null){var i=Math.min(c.length,g.length),j=[];for(var k=0;k<i;k++)j.push(g[k]-c[k]);f.push({data:this.$10(j),name:h})}this.$16(a,b,f);this.$14(a,b,f,e);return f};b.$16=function(a,b,c){var d="neteqMeanWaitTime";if(this.$7.isCounterAllowed(a,d)&&Object.prototype.hasOwnProperty.call(b.counters,"jitterBufferDelay")&&Object.prototype.hasOwnProperty.call(b.counters,"jitterBufferEmittedCount")){a=Math.min(b.counters.jitterBufferDelay.length,b.counters.jitterBufferEmittedCount.length);var e=new Array(a).fill(0);for(var f=1;f<a;f++){var g=b.counters.jitterBufferDelay[f]-b.counters.jitterBufferDelay[f-1],h=b.counters.jitterBufferEmittedCount[f]-b.counters.jitterBufferEmittedCount[f-1];h===0?e[f]=0:e[f]=Math.round(g*1e3/h)}c.push({data:e,name:d})}};b.addSenderVideoStallData=function(a){var b=this;[[d("ZenonMediaStatsConfig").OUTBOUND_SCREEN_STATS_TRACKID,"screen"],[d("ZenonMediaStatsConfig").OUTBOUND_VIDEO_STATS_TRACKID,"video"]].forEach(function(c){var d=c[0];c=c[1];var e=a.get(d);if(e!=null){d=b.generateTslogStreamName(c,d);var f=b.$6[d];f==null&&(f={bucketEnd:b.$3,bucketStart:b.$3,contentType:c,counters:{},owner:""},b.$6[d]=f);b.updateVideoStallStats(e,f,b.$3,c)}})};b.addDerivedMetricsData=function(a,b){var c=this;b.forEach(function(b){var e=b.trackId,f=a.get(e);if(f==null)return;var g=b.remote?"inbound":"outbound";g=g+"_"+b.contentType+"_"+e;var h=c.$6[g];h==null&&(h={bucketEnd:c.$3,bucketStart:c.$3,contentType:"audio",counters:{},owner:""},c.$6[g]=h);var i=c.$3;d("ZenonMediaStatsConfig").TSLOG_DERIVED_STATS_REQUESTED.forEach(function(a){if(!f.cumulativeStat[a])return;var b=i-h.bucketStart;h.counters[a]==null&&(h.counters[a]=Array(b).fill(0));h.counters[a][b]=(a=(b=f.cumulativeStat[a])==null?void 0:b.getCurrentValue())!=null?a:0;h.bucketEnd=i})})};b.addAudioEchoMetricData=function(a){var b=a.get(d("ZenonMediaStatsConfig").OUTBOUND_AUDIO_STATS_TRACKID);if(!b)return;a=this.generateTslogStreamName("audio",d("ZenonMediaStatsConfig").OUTBOUND_AUDIO_STATS_TRACKID);var c=this.$6[a];c==null&&(c={bucketEnd:this.$3,bucketStart:this.$3,contentType:"audio",counters:{},owner:""},this.$6[a]=c);a=[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_CONFIDENCE,d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_CROSS_CORRELATION,d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_DELAY,d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_ERL,d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_LPB_RMS,d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_RMS,d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_CONFIDENCE,d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_DELAY,d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_DELAY_ENTROPY,d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_ERL,d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_FRAMES_PERCENTAGE,d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_GOLDEN_ECHO_CONFIDENCE];var e=this.$3;a.forEach(function(a){if(!b.deltaStat[a])return;var d="audio_"+a,f=e-c.bucketStart;c.counters[d]==null&&(c.counters[d]=Array(f).fill(0));c.counters[d][f]=(d=b.deltaStat[a].getLastAddedValue())!=null?d:0;c.bucketEnd=e})};b.addRenderedFrameData=function(a,b){var c=this;if(b.size===0)return;b.forEach(function(d){if(d.mediaType!=="video"||d.kind!=="video")return;var e=c.$11(d);e=c.$6[e];if(e==null)return;d=d.trackId!=null?b.get(String(d.trackId)):null;if(d==null||d.trackIdentifier==null||d.remoteSource===!1||d.ended===!0)return;d=d.trackIdentifier?String(d.trackIdentifier):"";if(!d)return;d=a.get(d);if(d){var f;e.counters.renderedWidth==null&&(e.counters.renderedWidth=Array(c.$3-e.bucketStart).fill(0));e.counters.renderedHeight==null&&(e.counters.renderedHeight=Array(c.$3-e.bucketStart).fill(0));var g=c.$3-e.bucketStart;e.counters.renderedWidth[g]=(f=d.renderedWidth)!=null?f:0;e.counters.renderedWidth[g]=Math.round(e.counters.renderedWidth[g]);e.counters.renderedHeight[g]=(f=d.renderedHeight)!=null?f:0;e.counters.renderedHeight[g]=Math.round(e.counters.renderedHeight[g]);c.$17(e,g,d)}})};b.addCallCpuData=function(a,b){var c=this;a=this.$12(a);var d=this.$6[a];d==null&&(d={bucketEnd:this.$3,bucketStart:this.$3,contentType:"client-metrics",counters:{},owner:""},this.$6[a]=d);d.bucketEnd=this.$3;Object.keys(b).forEach(function(a){c.addCounterValue(d,a,b[a])})};b.addHeapMemoryData=function(a,b){var c=this;a=this.$12(a);var d=this.$6[a];d==null&&(d={bucketEnd:this.$3,bucketStart:this.$3,contentType:"client-metrics",counters:{},owner:""},this.$6[a]=d);d.bucketEnd=this.$3;Object.keys(b).forEach(function(a){b[a]!=null&&c.addCounterValue(d,a,b[a])})};b.addCandidatePairStats=function(a){var b=this;if(a.size===0)return;a.forEach(function(a){if(a.type==="candidate-pair"){var c=b.$11(a),e=b.$6[c];e==null&&(e={bucketEnd:b.$3,bucketStart:b.$3,contentType:"candidate-pair",counters:{},owner:""},b.$6[c]=e);(b.$5==null||a.timestamp<b.$5)&&(b.$5=Math.round(a.timestamp));for(c in a)d("ZenonMediaStatsConfig").TSLOG_STATS_REQUESTED_FROM_CANDIDATE_PAIR.includes(c)&&b.addCounterValue(e,c,a[c],d("ZenonMediaStatsConfig").TSLOG_METRIC_SCALE[c]);e.bucketEnd=b.$3;(b.$2==null||a.timestamp>b.$2)&&(b.$2=Math.round(a.timestamp))}})};b.addData=function(a,b,c,e,f){var g=this;if(b.size===0)return;b.forEach(function(i){if(i.type==="track"||i.type==="media-source"||i.type==="candidate-pair"||i.type==="VideoBwe")return;var j=g.$11(i),k=g.$6[j];if(i.type==="ssrc"){if(k==null)return;for(var l in i)c.includes(l)&&d("ZenonMediaStatsConfig").getSsrcStats().includes(l)&&g.addCounterValue(k,l,i[l],d("ZenonMediaStatsConfig").TSLOG_METRIC_SCALE[l])}else{k==null&&(k={bucketEnd:g.$3,bucketStart:g.$3,contentType:e,counters:{},owner:f?f.id:"",ssrc:void 0},g.$6[j]=k);(g.$5==null||i.timestamp<g.$5)&&(g.$5=Math.round(i.timestamp));i.type==="inbound-rtp"||i.type==="outbound-rtp"||h(0,64953);i.ssrc!=null&&(k.ssrc=i.ssrc.toString());g.addCounterValue(k,"trackEnabled",a);for(l in i)c.includes(l)&&g.addCounterValue(k,l,i[l],d("ZenonMediaStatsConfig").TSLOG_METRIC_SCALE[l]);g.$9(b,c,e,k)}k.bucketEnd=g.$3;(g.$2==null||i.timestamp>g.$2)&&(g.$2=Math.round(i.timestamp))})};b.addNonMediaStates=function(){var a=this;this.$6.nonMediaState==null&&(this.$6.nonMediaState={bucketEnd:this.$3,bucketStart:this.$3,contentType:"non-media-state",counters:{},owner:""});var b=this.$6.nonMediaState;Object.keys(this.$1).forEach(function(c){if(c==="sendParametersState"){var d=a.$1[c];if(d!=null)for(var e=0;e<d.encodings.length;e++){var f=d.encodings[e],g="l"+e,h=0;f.active!=null&&(h=f.active?2:1);a.addCounterValue(b,g+"a",h);h=0;f.maxBitrate!=null&&(h=f.maxBitrate);a.addCounterValue(b,g+"mb",h);h=0;f.scaleResolutionDownBy!=null&&(h=f.scaleResolutionDownBy);a.addCounterValue(b,g+"sr",h,100)}}else a.addCounterValue(b,c,a.$1[c])});b.bucketEnd=this.$3};b.advance=function(){var a,b=this.$6["."];b==null&&(b={bucketEnd:this.$3,bucketStart:this.$3,contentType:"time",counters:{btime:[],ctime:[]}},this.$6["."]=b);a=(a=this.$2)!=null?a:0;var c=b.counters,d=c.btime;c=c.ctime;c.push(Math.round(a-((a=this.$5)!=null?a:0)));d.push(Math.round(c[this.$3]-((a=c[this.$3-1])!=null?a:0)));b.bucketEnd=this.$3;this.$3++};b.onIceConnectionStateChange=function(a){this.$1.iceConnectionState=(a=i[a])!=null?a:0};b.onRtpSendParametersStateChange=function(a){this.$1.sendParametersState=a};b.serialize=function(a){if(Object.keys(this.$6).length===0)return{format:"JSON",timeSeries:null};a=(a=a)!=null?a:d("ZenonMediaStatsConfig").TSLOG_STATS_TO_SUPPRESS;var b={source:this.$4,start_time_ms:Math.round(Number(this.$5)),streams:[]},c=new Map(),e=0,f=new Map(),g=["audio","video","screen"];for(var h in this.$6){var i=this.$6[h];if(g.includes(i.contentType)){var j=d("ZenonTSLogDataUtil").getMediaTrackDirection(h);j==="inbound"&&i.owner!=null&&!c.has(i.owner)&&(c.set(i.owner,e.toString()),e++);j=i.owner+i.contentType;f.set(j,h)}}i={};for(j in this.$6){e=this.$6[j];h=void 0;var k=j;if(g.includes(e.contentType)){var l=d("ZenonTSLogDataUtil").getMediaTrackDirection(j);i[l+e.contentType]=i[l+e.contentType]+1||0;k=this.$13(l,e.contentType)}else e.contentType==="candidate-pair"?k="cp":e.contentType==="client-metrics"&&(k="cm");l=f.get(e.owner+"audio");e.contentType==="video"&&l!=null&&(h=this.$6[l]);l={bucket_end:e.bucketEnd,bucket_start:e.bucketStart,counters:this.$15(k,this.$6[j],a,h),name:k,props:{}};c.has(this.$6[j].owner)&&(l.props.seq=c.get(this.$6[j].owner));this.$6[j].ssrc!=null&&(l.props.ssrc=this.$6[j].ssrc);l.props.id=j;b.streams.push(l)}return this.$18(JSON.stringify(b))};b.updateVideoStallStats=function(a,b,c,e){[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CAPTURE_IS_STALLED,d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_ENCODE_IS_STALLED,d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SENT_IS_STALLED].forEach(function(d){var f=e+"_"+d,g=c-b.bucketStart;b.counters[f]==null&&(b.counters[f]=Array(g).fill(0));b.counters[f][g]=(g=(f=a.deltaStat[d])==null?void 0:f.getLastAddedValue())!=null?g:0;b.bucketEnd=c})};b.generateTslogStreamName=function(a,b){return"outbound_"+a+"_"+b};b.addCounterValue=function(a,b,c,d){var e=Math.max(this.$3-a.bucketStart,0);a.counters[b]==null&&(a.counters[b]=Array(e).fill(0));d=Math.round(Number(c)*((c=d)!=null?c:1));a.counters[b][e]=d};b.$18=function(a){try{var b=btoa(c("pako").deflate(a,{to:"string"}));c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"Compressed TSLog data of length "+a.length+" to "+b.length});return{format:"B64_DEFLATE",timeSeries:b}}catch(a){c("FBLogger")("rtc_www").catching(a).warn("Caught exception while compressing TSLog")}c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"Not compressing TSLog data of length "+a.length});return{format:"JSON",timeSeries:a}};b.$17=function(a,b,c){c=c.displayResolutionData;if(!c)return;a.counters.rrrWidth==null&&(a.counters.rrrWidth=Array(this.$3-a.bucketStart).fill(0));a.counters.rrrHeight==null&&(a.counters.rrrHeight=Array(this.$3-a.bucketStart).fill(0));a.counters.rrrStreamType==null&&(a.counters.rrrStreamType=Array(this.$3-a.bucketStart).fill(0));a.counters.rrrWidth[b]=c.renderWidth?Math.round(c.renderWidth):0;a.counters.rrrHeight[b]=c.renderHeight?Math.round(c.renderHeight):0;a.counters.rrrStreamType[b]=(a=c.streamType)!=null?a:0};return a}();g["default"]=a}),98);
__d("ZenonMediaStatsManager",["CompactSerializer","DateConsts","FBLogger","Network","RequestStreamBodyUtils","RpGenaiSctpCaptionsGenAIBotStateSerializers","ZenonAppProvider","ZenonCircularBuffer","ZenonDeltaMediaStat","ZenonFirstMediaPacketFinder","ZenonHistogramCounter","ZenonMediaActionLogger","ZenonMediaStatsConfig","ZenonMediaStatsReportPoller","ZenonMediaStatsSerializer","ZenonNetworkQualityMonitor","ZenonRenderedView","ZenonSCTPConstants","ZenonTSLogDataJSONHolder","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h=5e3,i="[ZenonMediaStatsManager]";a=function(){function a(a){var b;this.$6=new Map();this.$12=null;this.$14="disconnected";this.$24=null;this.$1=a.peerConnection;this.$2=a.tracks;this.$3=a.trackToSenderMap;this.$4=a.mediaStats;this.$8=a.onMediaStatUpdate;this.$5=a.dataMessageTranslator;this.$26=a.areTslogsEnabled;this.$9=this.$26?new(c("ZenonTSLogDataJSONHolder"))():null;this.$10=a.videoDurationTracker;this.$11=(b=a.pollingIntervalMs)!=null?b:h;this.$7=function(){};this.$13=new(d("ZenonNetworkQualityMonitor").ZenonNetworkQualityMonitor)();this.$15={audioDevices:[],videoDevices:[]};this.$16=new(c("ZenonFirstMediaPacketFinder"))(a.peerConnection,a.onFirstMediaPacket,a.onFirstSentMediaPacket);this.$27=new Map();this.$17=new(c("ZenonHistogramCounter"))(200,1e3,200);this.$18=new Map();this.$19=new Map();b=d("DateConsts").MS_PER_MIN/this.$11;try{this.$20=new(c("ZenonCircularBuffer"))(b)}catch(a){c("ZenonMediaActionLogger").logErrorToFbLogger(i+(" Error init circular buffer for ecv RTT "+b),"ZenonCircularBuffer",a,"warn")}try{this.$21=new(c("ZenonCircularBuffer"))(b)}catch(a){c("ZenonMediaActionLogger").logErrorToFbLogger(i+(" Error init circular buffer for ecv neteq wait time "+b),"ZenonCircularBuffer",a,"warn")}try{this.$22=new(c("ZenonCircularBuffer"))(b)}catch(a){c("ZenonMediaActionLogger").logErrorToFbLogger(i+(" Error init circular buffer for ecv plccng "+b),"ZenonCircularBuffer",a,"warn")}try{this.$23=new(c("ZenonCircularBuffer"))(b)}catch(a){c("ZenonMediaActionLogger").logErrorToFbLogger(i+(" Error init circular buffer for ecv Video Freeze "+b),"ZenonCircularBuffer",a,"warn")}try{this.$24=new(c("ZenonCircularBuffer"))(b+1)}catch(a){c("ZenonMediaActionLogger").logErrorToFbLogger(i+(" Error init circular buffer for ecv AV Sync "+(b+1)),"ZenonCircularBuffer",a,"warn")}try{this.$25=new(c("ZenonCircularBuffer"))(b)}catch(a){c("ZenonMediaActionLogger").logErrorToFbLogger(i+(" Error init circular buffer for ecv decoded duration "+b),"ZenonCircularBuffer",a,"warn")}}var b=a.prototype;b.listen=function(){var a=this;this.$1.addEventListener("iceconnectionstatechange",function(b){b=b.target;a.$14=b.iceConnectionState;switch(a.$14){case"connected":c("promiseDone")(a.pollRecurring());break;case"failed":case"disconnected":a.updateNetworkStatus(a.$13.determineNetworkStatus(null,!0));break}})};b.pollOnce=async function(){try{var a=Array.from(new Set([].concat(Array.from(this.$2.values()),Array.from(this.$3.values()))));await d("ZenonMediaStatsReportPoller").updateStatsFromConnection(a,this.$4,this.$17,this.$1,this.$9,this.$11);await d("ZenonMediaStatsReportPoller").updateStatsForDatachannel(this.$1,this.$6);if(this.$12!=null){var b=d("ZenonMediaStatsSerializer").getMediaStats(this.$2,this.$4,this.$16,this.$10,this.$17,this.$3,this.$15,this.$6);this.logEcvSenderRttStats(b);this.logEcvNetEqWaitTimeStats(b);this.logEcvPlccngStats(b);this.logEcvVideoFreezeStats(b);this.logEcvAVSyncStats(b);this.logEcvDecodedDurationStats(b);this.reportEndToEndLatency();this.$8(b)}await d("ZenonMediaStatsReportPoller").updateVideoCodecFromReceivers(a,this.$1,this.$19)}catch(a){c("FBLogger")("rtc_www").catching(a).warn("Error polling media metrics.")}this.updateNetworkStatus(this.$13.determineNetworkStatus(this.$4,this.$14==="failed"||this.$14==="disconnected"));this.updateNetworkHealthStats();this.updateAudioRemoteTimestamp()};b.pollRecurring=async function(){var a=this;if(this.$12!=null)return;this.$12=window.setInterval(function(){return a.pollOnce()},this.$11);await this.pollOnce()};b.stopPolling=function(){this.$12!=null&&(window.clearInterval(this.$12),this.$12=null),this.logNetworkHealthStats(),this.logAudioReceiverStats(),this.logRemoteTimestamps()};b.onRemoteTrackAdded=function(a){this.$16.setUpForTrackType(a.contentType)};b.timeSeries=function(){var a;return(a=(a=this.$9)==null?void 0:a.serialize())!=null?a:null};b.resetTimeSeries=function(){this.$26&&(this.$9=new(c("ZenonTSLogDataJSONHolder"))())};b.setNetworkStatusListener=function(a){this.$7=a};b.updateNetworkStatus=function(a){this.$7(a)};b.updateNetworkHealthStats=function(){if(!c("Network").containsNetworkInformation())return;for(var a of d("ZenonMediaStatsConfig").NETWORK_HEALTH_STATS.values()){var b=this.$18.get(a);b==null&&(b=new(c("ZenonDeltaMediaStat"))(),this.$18.set(a,b));this.$28(a,b)}};b.updateAudioRemoteTimestamp=function(){var a=this;this.$2.forEach(function(b){if(b.contentType==="audio"&&b.remote){var c=a.$4.get(b.trackId);a.$27.has(b.trackId)||a.$27.set(b.trackId,[]);c=c==null?void 0:(c=c.deltaStat.remoteTimestamp)==null?void 0:c.getLastAddedValue();if(c!=null){(b=a.$27.get(b.trackId))==null?void 0:b.push(c.toString())}}})};b.logRemoteTimestamps=function(){this.$27.forEach(function(a,b){c("ZenonMediaActionLogger").logCheckpointEmployeesTestUsersOnly(i+("Audio Remote Timestamps "+b+": "+JSON.stringify(a)))})};b.$28=function(a,b){var e=0;switch(a){case"bandwidth":e=c("Network").getBandwidth();break;case"rtt":e=c("Network").getRTT();break;default:c("FBLogger")("rtc_www").warn(a+" stats collection is not implemented")}e!=null?b.add(e):d("ZenonMediaStatsConfig").isPreChromium86()&&c("FBLogger")("rtc_www").warn(a+" in null. Skipped logging")};b.logNetworkHealthStats=function(){var a;if(((a=this.$18.get("bandwidth"))==null?void 0:a.getAverage())!=null||((a=this.$18.get("rtt"))==null?void 0:a.getAverage())!=null){a=JSON.stringify({bandwidth:(a=this.$18.get("bandwidth"))==null?void 0:a.getAverage(),rtt:(a=this.$18.get("rtt"))==null?void 0:a.getAverage()});c("ZenonMediaActionLogger").logEvent({checkpoint:"Network health stats "+a})}};b.logEcvSenderRttStats=function(a){var b=a.sender.avgrtt;b!=null&&this.$29(b,this.$20,function(b){a.ecv.ecv_rtt_ms=b})};b.logEcvPlccngStats=function(a){var b=a.receiver.dec_plc_cng;b!=null&&this.$29(b,this.$22,function(b){a.ecv.ecv_plccng_v2=b})};b.logEcvNetEqWaitTimeStats=function(a){var b=a.DebugAudioMetrics.NetworkReceive.jb_nm;b=b==null?void 0:(b=b.neteq)==null?void 0:b.meanWait;b!=null&&this.$29(Number(b),this.$21,function(b){a.ecv.ecv_neteq_wait_time_ms=b})};b.logEcvVideoFreezeStats=function(a){var b;b=(b=a.video.receiver)==null?void 0:b.frdur500;b!=null&&this.$29(Number(b),this.$23,function(b){a.ecv.ecv_video_freeze_duration_above_500_ms_v2=b})};b.logEcvAVSyncStats=function(a){var b;b=(b=a.video.receiver)==null?void 0:b.avhist;b&&b.length>0&&(b.length===6?this.$30(Number(b[b.length-1]),this.$24,function(b){a.ecv.ecv_av_sync_above_1000_ms=b}):c("ZenonMediaActionLogger").logCheckpoint(i+" AV Sync Histogram bin size is changed"))};b.logEcvDecodedDurationStats=function(a){var b;b=(b=a.video.receiver)==null?void 0:b.tdt;b!=null&&this.$29(Number(b),this.$25,function(b){a.ecv.ecv_decoded_bitrate_duration_sum=b})};b.$30=function(a,b,c){if(b){b.add(a);a=b.getDelta();a!=null&&a>0&&c(a.toString())}};b.$29=function(a,b,c){b.add(a);a=b.getAvg();a!=null&&c(a.toString())};b.logAudioReceiverStats=function(){var a,b={jbd:{},rtt:{}};this.$4.forEach(function(a){d("ZenonMediaStatsSerializer").addAudioReceiverPercentStats(b,a,c("ZenonRenderedView").GRID,"audio")});if(((a=b.jbd)==null?void 0:a.avg)!=null||((a=b.rtt)==null?void 0:a.avg)!=null){a=JSON.stringify({AudioPercent:b});c("ZenonMediaActionLogger").logEvent({checkpoint:"Audio Receiver Percent Stats "+a})}};b.reportEndToEndLatency=function(){var a;if(!d("ZenonAppProvider").isMetaAI())return;a=(a=this.$4.get("conversation_bot_audio"))==null?void 0:a.lastServerToClientLatency;if(a==null)return;var b={roundtripAudioCtpLatencyMs:"0",serverToClientAudioCtpLatencyMs:"0"};b.serverToClientAudioCtpLatencyMs=Math.trunc(a).toString();a=d("CompactSerializer").serializeNoThrow(b,d("RpGenaiSctpCaptionsGenAIBotStateSerializers").serializeGenAiMediaStats);if(a==null)return;b=this.$5.userIds();if(b==null||b.length===0)return;b=b[0];this.$1.sendDataMessage(d("ZenonSCTPConstants").GENAI_MEDIA_STATS_TOPIC,{message:d("RequestStreamBodyUtils").uint8ArrayToString(a),sender:b})};b.getNetworkHealthStats=function(){return this.$18};return a}();g.default=a}),98);
__d("ZenonAudioDecodingNormalDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){a.filter(function(a){return a.webrtcTrack.enabled===!0&&a.webrtcTrack.readyState==="live"&&a.contentType==="audio"&&a.remote===!0}).forEach(function(a){a=b.get(a.trackId);if(a==null||a.cumulativeStat.totalSamplesReceived==null||a.cumulativeStat.removedSamplesForAcceleration==null)return;var e=a.cumulativeStat,f=e.removedSamplesForAcceleration;e=e.totalSamplesReceived;e=e.getCurrentValue()+f.getCurrentValue();a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DECODING_NORMAL]==null?a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DECODING_NORMAL]=new(c("ZenonCumulativeMediaStat"))(e):a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DECODING_NORMAL].update(e)})}g.updateAudioDecodingNormal=a}),98);
__d("ZenonAudioDecodingPLCCNGDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){a.filter(function(a){return a.webrtcTrack.enabled===!0&&a.webrtcTrack.readyState==="live"&&a.contentType==="audio"&&a.remote===!0}).forEach(function(a){a=b.get(a.trackId);if(a==null||a.cumulativeStat.silentConcealedSamples==null)return;var e=a.cumulativeStat.silentConcealedSamples;e=e.getCurrentValue();a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DECODING_PLCCNG]==null?a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DECODING_PLCCNG]=new(c("ZenonCumulativeMediaStat"))(e):a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DECODING_PLCCNG].update(e)})}g.updateAudioDecodingPLCCNG=a}),98);
__d("ZenonAudioDecodingPLCDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){a.filter(function(a){return a.webrtcTrack.enabled===!0&&a.webrtcTrack.readyState==="live"&&a.contentType==="audio"&&a.remote===!0}).forEach(function(a){a=b.get(a.trackId);if(a==null||a.cumulativeStat.concealedSamples==null||a.cumulativeStat.silentConcealedSamples==null)return;var e=a.cumulativeStat,f=e.concealedSamples;e=e.silentConcealedSamples;f=f.getCurrentValue()-e.getCurrentValue();a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DECODING_PLC]==null?a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DECODING_PLC]=new(c("ZenonCumulativeMediaStat"))(f):a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DECODING_PLC].update(f)})}g.updateAudioDecodingPLC=a}),98);
__d("ZenonAudioEchoConfidenceStatsDeriver",["EchoConfidenceMetricsManager","ZenonDeltaMediaStat","ZenonMediaStatsConfig","ZenonMediaStatsParser"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=c("EchoConfidenceMetricsManager").getAndResetEchoConfidenceMetrics();if(!b)return;a=d("ZenonMediaStatsParser").getOrCreateTrackerFromMap(a,d("ZenonMediaStatsConfig").OUTBOUND_AUDIO_STATS_TRACK_INFO);if(a==null)return;h(a);i(a,b)}function h(a){a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_CONFIDENCE]==null&&(a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_CONFIDENCE]=new(c("ZenonDeltaMediaStat"))()),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_DELAY]==null&&(a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_DELAY]=new(c("ZenonDeltaMediaStat"))()),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_ERL]==null&&(a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_ERL]=new(c("ZenonDeltaMediaStat"))()),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_RMS]==null&&(a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_RMS]=new(c("ZenonDeltaMediaStat"))()),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_LPB_RMS]==null&&(a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_LPB_RMS]=new(c("ZenonDeltaMediaStat"))()),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_CROSS_CORRELATION]==null&&(a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_CROSS_CORRELATION]=new(c("ZenonDeltaMediaStat"))()),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_GOLDEN_ECHO_CONFIDENCE]==null&&(a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_GOLDEN_ECHO_CONFIDENCE]=new(c("ZenonDeltaMediaStat"))()),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_DELAY]==null&&(a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_DELAY]=new(c("ZenonDeltaMediaStat"))()),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_CONFIDENCE]==null&&(a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_CONFIDENCE]=new(c("ZenonDeltaMediaStat"))()),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_DELAY_ENTROPY]==null&&(a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_DELAY_ENTROPY]=new(c("ZenonDeltaMediaStat"))()),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_ERL]==null&&(a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_ERL]=new(c("ZenonDeltaMediaStat"))()),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_FRAMES_PERCENTAGE]==null&&(a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_FRAMES_PERCENTAGE]=new(c("ZenonDeltaMediaStat"))())}function i(a,b){a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_CONFIDENCE]&&a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_CONFIDENCE].add(b.echoConfidence),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_DELAY]&&a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_DELAY].add(b.echoDelay),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_ERL]&&a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_ERL].add(b.echoERL),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_RMS]&&a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_RMS].add(b.echoRMS),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_LPB_RMS]&&a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_LPB_RMS].add(b.echoLpbRMS),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_CROSS_CORRELATION]&&a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_ECHO_CROSS_CORRELATION].add(b.echoCrossCorrelation),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_GOLDEN_ECHO_CONFIDENCE]&&a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_GOLDEN_ECHO_CONFIDENCE].add(b.goldenEchoMetric),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_DELAY]&&a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_DELAY].add(b.ltEchoDelay),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_CONFIDENCE]&&a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_CONFIDENCE].add(b.ltEchoConfidence),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_DELAY_ENTROPY]&&a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_DELAY_ENTROPY].add(b.ltEchoDelayEntropy),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_ERL]&&a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_ERL].add(b.ltEchoERL),a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_FRAMES_PERCENTAGE]&&a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_SEND_LT_ECHO_FRAMES_PERCENTAGE].add(b.ltEchoFramesPercentage)}g.updateStatsWithDerivedMetric=a}),98);
__d("ZenonAudioLevelDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f,g){"use strict";var h=9.5/Math.log(32767);function i(a,b){a=Math.round(20+h*Math.log(a/b));a=Math.max(1,Math.min(a,20));return a}function j(a,b){var c=-127;a>0&&b>0&&(c=Math.round(10*Math.log10(a/b)),c=Math.max(-127,Math.min(c,0)));c+=127;return c}function k(a,b,e){a!=null&&(e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOG_LEVEL]==null?e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOG_LEVEL]=new(c("ZenonCumulativeMediaStat"))(a):e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOG_LEVEL].update(e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOG_LEVEL].getCurrentValue()+a)),b!=null&&(e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOUDNESS_LEVEL]==null?e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOUDNESS_LEVEL]=new(c("ZenonCumulativeMediaStat"))(b):e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOUDNESS_LEVEL].update(e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOUDNESS_LEVEL].getCurrentValue()+b)),e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOG_LEVEL_COUNT]==null?e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOG_LEVEL_COUNT]=new(c("ZenonCumulativeMediaStat"))(1):e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOG_LEVEL_COUNT].update(e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_LOG_LEVEL_COUNT].getCurrentValue()+1)}function a(a,b){var c=0,e=0;a.filter(function(a){return a.webrtcTrack.readyState==="live"&&a.contentType==="audio"}).forEach(function(a){if(a.remote&&a.webrtcTrack.enabled===!1)return;var d=b.get(a.trackId);if(d==null||d.cumulativeStat.totalAudioEnergy==null||d.cumulativeStat.totalSamplesDuration==null)return;var f=d.cumulativeStat,g=f.totalAudioEnergy;f=f.totalSamplesDuration;g=g.getDeltaFromLastUpdate();f=f.getDeltaFromLastUpdate();if(f===0)return;if(a.remote===!0){c+=g;e=Math.max(e,f);a=i(g,f);k(a,null,d)}else{a=j(g,f);k(null,a,d)}});a=b.get(d("ZenonMediaStatsConfig").GLOBAL_STATS_TRACKID);if(a==null||e===0)return;var f=j(c,e);k(null,f,a)}g.computeAudioLevels=a}),98);
__d("ZenonAudioPlaybackIssueLogger",["ZenonMediaActionLogger"],(function(a,b,c,d,e,f,g){"use strict";var h=5e3;a=function(){function a(){this.$1=new Map()}var b=a.prototype;b.detectAudioPlaybackIssue=function(a,b){var c=this;a.filter(function(a){return a.webrtcTrack.enabled&&a.webrtcTrack.readyState==="live"&&a.contentType==="audio"&&a.remote}).forEach(function(a){var d=b.get(a.trackId);if(d==null)return;d=d.cumulativeStat;var e=d.bytesReceived;d=d.totalAudioEnergy;if(e==null||d==null||e.getTimeSinceLastUpdate()===0)return;d=d.getDeltaFromLastUpdate();var f=e.getDeltaFromLastUpdate()*8;e=e.getTimeSinceLastUpdate()/1e3;f=f/e;c.$1.has(a.trackId)||c.$1.set(a.trackId,!1);e=c.$1.get(a.trackId);d===0&&f>h?e===!1&&(c.logAudioPlaybackIssueCheckpoint("start",a.trackId,f,d),c.$1.set(a.trackId,!0)):e===!0&&(c.logAudioPlaybackIssueCheckpoint("end",a.trackId,f,d),c.$1.set(a.trackId,!1))})};b.logAudioPlaybackIssueCheckpoint=function(a,b,d,e){c("ZenonMediaActionLogger").logEvent({checkpoint:(a==="start"?"Detected new":"No longer detecting")+" audio playback issue for track "+b+". Bitrate is "+d+" bps, audio energy delta is "+e+".",mediaID:b})};return a}();b=new a();g["default"]=b}),98);
__d("ZenonHistogram",[],(function(a,b,c,d,e,f){"use strict";function g(a,b){return(a.value||0)-(b.value||0)}a=function(){function a(){this.$1=[],this.$2=!0}var b=a.prototype;b.$3=function(){this.$2===!1&&this.$1.sort(g),this.$2=!0};b.add=function(a){this.$1.push(a),this.$2=!1};b.getAvgAndPercentile=function(a,b){this.$2||this.$3();var c=b?this.$1.filter(b):this.$1;if(c.length===0)return{avg:null,percentiles:null};b=c.reduce(function(a,b){return a+b.value},0)/c.length;a=a.map(function(a){a=Math.min(100,Math.max(0,a));a=(c.length-1)*a/100;var b=Math.floor(a),d=Math.ceil(a);if(b===d)return c[b].value;var e=c[b].value*(d-a);d=c[d].value*(a-b);return e+d});return{avg:b,percentiles:a}};return a}();f["default"]=a}),66);
__d("ZenonPercentMediaStat",["ZenonHistogram","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1=new(c("ZenonHistogram"))()}var b=a.prototype;b.add=function(a,b,c,d){c={contentType:c,value:a,view:b,voiceEnergy:d};this.$1.add(c)};b.getAvgAndPercentile=function(a,b,c,e){var f;e==null?f=function(a){return a.view===b&&a.contentType===c}:f=function(a){var f=a.voiceEnergy>d("ZenonMediaStatsConfig").VOICE_ENERGY_THRESHOLD;return a.view===b&&a.contentType===c&&f===e};return this.$1.getAvgAndPercentile(a,f)};return a}();g["default"]=a}),98);
__d("ZenonAudioReceiverStatsUtils",["ZenonMediaStatsConfig","ZenonPercentMediaStat"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){a.forEach(function(a){a=b.get(a.trackId);a!=null&&(h(a,"roundTripTime",i(a,"currentRoundTripTime",1e3),d("ZenonMediaStatsConfig").GLOBAL_STATS_RENDERED_VIEW,a.contentType?a.contentType:d("ZenonMediaStatsConfig").GLOBAL_STATS_CONTENT_TYPE,0),h(a,"jitterBufferDelay",j(a,"jitterBufferDelay","jitterBufferEmittedCount",1e3),d("ZenonMediaStatsConfig").GLOBAL_STATS_RENDERED_VIEW,a.contentType?a.contentType:d("ZenonMediaStatsConfig").GLOBAL_STATS_CONTENT_TYPE,0))})}function h(a,b,d,e,f,g){if(d==null)return;a.percentStat[b]==null&&(a.percentStat[b]=new(c("ZenonPercentMediaStat"))());a.percentStat[b].add(d,e,f,g)}function i(a,b,c){if(a.deltaStat[b]){a=a.deltaStat[b].getLastAddedValue();return a!=null?a*((b=c)!=null?b:1):null}return null}function j(a,b,c,d){c=((c=a.cumulativeStat[c])==null?void 0:c.getDeltaFromLastUpdate())||0;if(c&&a.cumulativeStat[b]!=null){a=a.cumulativeStat[b].getDeltaFromLastUpdate()/c;return a*((b=d)!=null?b:1)}return null}g.updateTracksWithAudioReceivePercentStats=a;g.addPercentStatToTracker=h;g.getValueFromDelta=i;g.getRateFromCumulative=j}),98);
__d("ZenonAudioStallStatsDeriver",["ZenonCumulativeMediaStat","ZenonDeltaMediaStat","ZenonMediaActionLogger","ZenonMediaStatsConfig","ZenonMediaStatsParser"],(function(a,b,c,d,e,f,g){"use strict";var h=5e3;function i(a){var b=a.audioEncoding;a=a.cumulativeStat;var e=a.bytesSent,f=a.timestamp;a=a[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_STALL_DURATION];var g=(b==null?void 0:b.enabled)===!1||(b==null?void 0:b.enabled)===!0&&(b==null?void 0:b.prevState)===!1;if(!g&&e!=null&&f!=null){if(e.getCurrentTimeSinceLastUpdate()>h&&a!=null){if(a.getCurrentTimeSinceLastUpdate()!==0){c("ZenonMediaActionLogger").logEvent({checkpoint:"[audio stall deriver] calculated a stall due to byteSent update time "+e.getCurrentTimeSinceLastUpdate()+" greater than threshold. audioEncoding: "+JSON.stringify((g=b)!=null?g:{})})}return a.getCurrentTimeSinceLastUpdate()}if((e.getCurrentValue()===0||e.getDeltaFromLastUpdate()===0)&&f.getDeltaFromLastUpdate()!==0){c("ZenonMediaActionLogger").logEvent({checkpoint:"[audio stall deriver] calculated a stall due to no "+(e.getCurrentValue()===0?"current bytes":"delta bytes")+".  audioEncoding: "+JSON.stringify((g=b)!=null?g:{})})}return e.getCurrentValue()===0||e.getDeltaFromLastUpdate()===0?f.getDeltaFromLastUpdate():0}return 0}function j(a){a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_IS_STALLED]==null&&(a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_IS_STALLED]=new(c("ZenonDeltaMediaStat"))()),a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_REC_STALLS]==null&&(a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_REC_STALLS]=new(c("ZenonCumulativeMediaStat"))(0)),a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_TOTAL_STALLS]==null&&(a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_TOTAL_STALLS]=new(c("ZenonCumulativeMediaStat"))(0)),a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_STALL_DURATION]==null&&(a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_STALL_DURATION]=new(c("ZenonCumulativeMediaStat"))(0))}function k(a){var b,c=i(a),e=c===0?0:1;j(a);var f=!m(a)&&e?1:0;(b=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_REC_STALLS])==null?void 0:b.update(a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_REC_STALLS].getCurrentValue()+f);(b=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_TOTAL_STALLS])==null?void 0:b.update(a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_TOTAL_STALLS].getCurrentValue()+f);(b=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_STALL_DURATION])==null?void 0:b.update(a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_STALL_DURATION].getCurrentValue()+c);a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_IS_STALLED].add(e)}function l(a,b){var e;b=b?0:1;var f=!m(a)&&b?1:0;(e=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_REC_STALLS])==null?void 0:e.update(a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_REC_STALLS].getCurrentValue()+f);(e=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_TOTAL_STALLS])==null?void 0:e.update(((e=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_TOTAL_STALLS])==null?void 0:e.getCurrentValue())+f);a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_IS_STALLED].add(b);e=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_STALL_DURATION];b=b&&e?e.getCurrentTimeSinceLastUpdate():0;(e=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_STALL_DURATION])==null?void 0:e.update(a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_STALL_DURATION].getCurrentValue()+b);f!==0&&c("ZenonMediaActionLogger").logEvent({checkpoint:"[audio stall deriver] calculated additional stall due no tracks"})}function m(a){return a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_IS_STALLED]!=null&&a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DEV_IS_STALLED].getLastAddedValue()===1}function a(a,b){var e=0;a.filter(function(a){return a.contentType==="audio"&&!a.remote&&a.webrtcTrack.readyState==="live"}).forEach(function(a){e++;a=b.get(a.trackId);if(a==null)return;if((a==null?void 0:a.transportIceState)!=="connected"){c("ZenonMediaActionLogger").logEvent({checkpoint:"[audio stall deriver] Ignoring stall calculation because transport ice state is not connected"});return}k(a)});a=d("ZenonMediaStatsParser").getOrCreateTrackerFromMap(b,d("ZenonMediaStatsConfig").OUTBOUND_AUDIO_STATS_TRACK_INFO);a!=null&&(j(a),e===0?l(a,!1):l(a,!0))}g.updateStatsWithDerivedMetric=a}),98);
__d("ZenonAvSyncDeriver",["ZenonCumulativeMediaStat","ZenonDeltaMediaStat","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f,g){"use strict";function h(a){a=a.webrtcStream.getAudioTracks();return a!=null&&a.length>0?a[0].id:null}function i(a){var b;if(a.cumulativeStat.totalAudioEnergy!=null&&a.cumulativeStat.totalAudioEnergy.getDeltaFromLastUpdate()<=d("ZenonMediaStatsConfig").VOICE_ENERGY_THRESHOLD){a.isAudioEnergyLow=!0;return!0}b=(b=a.isAudioEnergyLow)!=null?b:!1;a.isAudioEnergyLow=!1;return b}function a(a,b,e){a.filter(function(a){return a.contentType==="video"&&a.remote}).forEach(function(f){var g=h(f),k=a.find(function(a){return a.webrtcTrack.id===g});if(k!=null){k=b.get(k.trackId);var l=b.get(f.trackId);if(k!=null&&k.cumulativeStat.estimatedPlayoutTimestamp!=null&&l!=null&&l.cumulativeStat.estimatedPlayoutTimestamp!=null){var m,n,o;f=l.cumulativeStat.estimatedPlayoutTimestamp;var p=k.cumulativeStat.estimatedPlayoutTimestamp;m=(m=l.lastEstimatedPlayoutTimestamp)!=null?m:0;n=(n=k.lastEstimatedPlayoutTimestamp)!=null?n:0;l.lastEstimatedPlayoutTimestamp=f.getCurrentValue();k.lastEstimatedPlayoutTimestamp=p.getCurrentValue();var q=l.cumulativeStat.packetsReceived?l.cumulativeStat.packetsReceived.getDeltaFromLastUpdate()>0:!1,r=k.cumulativeStat.packetsReceived?k.cumulativeStat.packetsReceived.getDeltaFromLastUpdate()>0:!1;if(((o=l.lastEstimatedPlayoutTimestamp)!=null?o:0)<=m||((o=k.lastEstimatedPlayoutTimestamp)!=null?o:0)<=n||i(k)||!q||!r){j(l,d("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_COUNT,0);j(l,d("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_OOB,0);return}j(l,d("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_COUNT,1);m=p.getCurrentValue()-f.getCurrentValue();o=Math.abs(m);if(o>d("ZenonMediaStatsConfig").AV_SYNC_CUTOFF){j(l,d("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_OOB,1);return}j(l,d("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_OOB,0);n=[{key:d("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC,value:m},{key:d("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_ABS,value:o}];n.forEach(function(a){l.deltaStat[a.key]==null&&(l.deltaStat[a.key]=new(c("ZenonDeltaMediaStat"))()),l.deltaStat[a.key].add(a.value)});e.update(o)}}})}function j(a,b,d){var e;a.cumulativeStat[b]==null&&(a.cumulativeStat[b]=new(c("ZenonCumulativeMediaStat"))(0));(e=a.cumulativeStat[b])==null?void 0:e.update(((e=a.cumulativeStat[b])==null?void 0:e.getCurrentValue())+d)}g.findAssociatedAudioTrackId=h;g.isMutedDuringInterval=i;g.updateTrackerWithAvSync=a}),98);
__d("ZenonMediaStatsUtil",["gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("gkx")("25247")||c("gkx")("25248")||c("gkx")("9676")}g.shouldUseTSLog=a}),98);
__d("ZenonMuteStateDeriver",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){a.forEach(function(a){var c=b.get(a.trackId);if(c==null)return;c.isMuted=!a.enabled||a.webrtcTrack.readyState==="ended"})}f.updateMuteState=a}),66);
__d("ZenonOutboundStatsWriter",["ZenonCumulativeMediaStat","ZenonDeltaMediaStat","ZenonMediaStatsConfig","ZenonMediaStatsParser"],(function(a,b,c,d,e,f,g){"use strict";var h=Object.freeze({audio:(b=d("ZenonMediaStatsConfig")).OUTBOUND_AUDIO_STATS_TRACK_INFO,screen:b.OUTBOUND_SCREEN_STATS_TRACK_INFO,screen_audio:b.OUTBOUND_SCREEN_AUDIO_STATS_TRACK_INFO,video:b.OUTBOUND_VIDEO_STATS_TRACK_INFO});function i(a,b,e){if(e==null)return;a.cumulativeStat[b]==null?a.cumulativeStat[b]=new(c("ZenonCumulativeMediaStat"))(e.getCurrentValue()):b==="packetsLost"||b===d("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED?a.cumulativeStat[b].updateNonStrictCumulative(a.cumulativeStat[b].getCurrentValue()+e.getDeltaFromLastUpdate()):a.cumulativeStat[b].update(a.cumulativeStat[b].getCurrentValue()+e.getDeltaFromLastUpdate())}function j(a,b,d){if(d==null)return;a.deltaStat[b]==null&&(a.deltaStat[b]=new(c("ZenonDeltaMediaStat"))());d=d.getLastAddedValue();d!=null&&a.deltaStat[b].add(d)}function a(a,b){a.filter(function(a){return a.remote===!1&&a.webrtcTrack.readyState==="live"}).forEach(function(a){var c=b.get(a.trackId);if(c!=null){a=h[a.contentType];a=d("ZenonMediaStatsParser").getOrCreateTrackerFromMap(b,a);var e=c.cumulativeStat,f=c.deltaStat,g=c.histResScale;c.percentStat;c.simulcastStats;c=babelHelpers.objectWithoutPropertiesLoose(c,["cumulativeStat","deltaStat","histResScale","percentStat","simulcastStats"]);Object.assign(a,c);a.histResScale=[].concat(g);for(c in e)i(a,c,e[c]);for(g in f)j(a,g,f[g])}})}g.updateOutboundStats=a}),98);
__d("ZenonPacketsLostDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){a.filter(function(a){return a.webrtcTrack.enabled===!0&&a.webrtcTrack.readyState==="live"}).forEach(function(a){var e=b.get(a.trackId);if(e==null||e.cumulativeStat.packetsLost==null)return;var f=e.cumulativeStat.packetsLost;a.remote?a=e.cumulativeStat.packetsReceived:a=e.cumulativeStat.packetsSent;if(e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED]==null)e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED]=new(c("ZenonCumulativeMediaStat"))(f.getCurrentValue());else{a=a!=null&&a.isReset()?f.getCurrentValue():f.getDeltaFromLastUpdate();(f=e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED])==null?void 0:f.updateNonStrictCumulative(e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED].getCurrentValue()+a)}})}g.updatePacketsLost=a}),98);
__d("ZenonVideoQualityDeriver",["ZenonMediaStatsConfig"],(function(a,b,c,d,e,f,g){"use strict";var h=1280*720;b=160*96;var i=Math.log2(h/b);c=51;var j=16,k=c-j,l=k+Math.floor(i*6);function m(a){var b=Math.max(1,Math.min(63,a));a=[1,5,12,28,42,53,64];var c=a.findIndex(function(a){return a>b});return c==null?0:Math.min(51,Math.floor(12+6*c+6*(b-a[c-1])/(a[c]-a[c-1])))}function a(a){var b=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CONVERTED_QP_SUM],c=a.cumulativeStat.framesEncoded,e=a.deltaStat,f=e.frameHeight;e=e.frameWidth;if(b==null||c==null||f==null||e==null)return;c=c.getDeltaFromLastUpdate();b=b.getDeltaFromLastUpdate();e=e.getLastAddedValue();f=f.getLastAddedValue();if(c===0||f==null||e==null||e<=0||f<=0)return;b=b/c;if(b<=0)return;((c=a.codec)==null?void 0:c.indexOf("264"))===-1&&((c=a.codec)==null?void 0:c.indexOf("265"))===-1?a=m(b):a=b;c=Math.max(0,Math.min(k,a-j));b=e*f;a=Math.max(0,Math.min(i,Math.log2(h/b)));return Math.max(0,l-c-a*6)/l*100}g._convertToH264QP=m;g.computeVideoQuality=a}),98);
__d("ZenonPerStreamAggregator",["ZenonAvSyncDeriver","ZenonDeltaMediaStat","ZenonMediaStatsConfig","ZenonMediaStatsParser","ZenonPercentMediaStat","ZenonRenderedView","ZenonVideoQualityDeriver"],(function(a,b,c,d,e,f,g){"use strict";var h=Object.freeze({audio:(b=d("ZenonMediaStatsConfig")).OUTBOUND_AUDIO_STATS_TRACK_INFO,screen:b.OUTBOUND_SCREEN_STATS_TRACK_INFO,screen_audio:b.OUTBOUND_SCREEN_AUDIO_STATS_TRACK_INFO,video:b.OUTBOUND_VIDEO_STATS_TRACK_INFO});function a(a,b){s(a,b),r(a,b),q(a,b)}function i(a,b,d,e,f,g){if(d==null)return;a.percentStat[b]==null&&(a.percentStat[b]=new(c("ZenonPercentMediaStat"))());a.percentStat[b].add(d,e,f,g)}function j(a,b){return a<b?a:b}function k(a,b){var c=b.get(a.trackId),e=0;if(c==null)return e;if(a.contentType==="audio")c.cumulativeStat.totalAudioEnergy!=null&&(e=c.cumulativeStat.totalAudioEnergy.getDeltaFromLastUpdate());else{c=d("ZenonAvSyncDeriver").findAssociatedAudioTrackId(a);if(c!=null){a=b.get(c);a!=null&&a.cumulativeStat.totalAudioEnergy!=null&&(e=a.cumulativeStat.totalAudioEnergy.getDeltaFromLastUpdate(),d("ZenonAvSyncDeriver").isMutedDuringInterval(a)&&(e=0))}}return e}function l(a,b){var e,f=d("ZenonMediaStatsConfig").DERIVED_METRICS.RENDERED_VIEW;b=b.get(a.trackId);if(b==null)return c("ZenonRenderedView").GRID;b.deltaStat[f]==null&&(b.deltaStat[f]=new(c("ZenonDeltaMediaStat"))());a=(a=b.renderedView)!=null?a:c("ZenonRenderedView").GRID;e=(e=c("ZenonRenderedView").cast(b.deltaStat[f].getLastAddedValue()))!=null?e:a;b.deltaStat[f].add(a);return j(a,e)}function m(a,b,c,d){c=((c=a.cumulativeStat[c])==null?void 0:c.getDeltaFromLastUpdate())||0;if(c&&a.cumulativeStat[b]!=null){a=a.cumulativeStat[b].getDeltaFromLastUpdate()/c;return a*((b=d)!=null?b:1)}return null}function n(a){var b,c,e=null,f=d("ZenonMediaStatsConfig").DERIVED_METRICS.PACKETS_LOST_CORRECTED;b=((b=a.cumulativeStat[f])==null?void 0:b.getDeltaFromLastUpdate())||0;c=((c=a.cumulativeStat.packetsReceived)==null?void 0:c.getDeltaFromLastUpdate())||0;b=b+c;a.cumulativeStat.packetsReceived!=null&&a.cumulativeStat[f]!=null&&b&&(e=a.cumulativeStat[f].getDeltaFromLastUpdate()/b);return e}function o(a,b,c){var d;d=((d=a.cumulativeStat[b])==null?void 0:d.getTimeSinceLastUpdate())||0;if(a.cumulativeStat[b]&&d!==0){a=a.cumulativeStat[b].getDeltaFromLastUpdate()/d;return a*((b=c)!=null?b:1)}return null}function p(a,b,c){if(a.deltaStat[b]){a=a.deltaStat[b].getLastAddedValue();return a!=null?a*((b=c)!=null?b:1):null}return null}function q(a,b){var c=d("ZenonMediaStatsParser").getOrCreateTrackerFromMap(b,d("ZenonMediaStatsConfig").GLOBAL_STATS_TRACK_INFO),e=0,f=0,g=0,h=0,j=0,k=0;a.filter(function(a){return a.webrtcTrack.readyState==="live"&&a.webrtcTrack.muted===!1}).forEach(function(a){var c=b.get(a.trackId);if(c!=null)if(a.remote===!1){if(c.cumulativeStat.totalEncodeTime!=null&&c.cumulativeStat.totalEncodeTime.getTimeSinceLastUpdate()>0){var d;h+=((d=c.cumulativeStat.totalEncodeTime)==null?void 0:d.getDeltaFromLastUpdate())||0;j+=((d=c.cumulativeStat.totalEncodeTime)==null?void 0:d.getTimeSinceLastUpdate())||0;k++}}else{d=o(c,"bytesReceived",8e3);if(d==null)return;a.contentType==="audio"?f+=d:g+=d;if(c.cumulativeStat.totalDecodeTime!=null&&c.cumulativeStat.totalDecodeTime.getTimeSinceLastUpdate()>0){h+=((a=c.cumulativeStat.totalDecodeTime)==null?void 0:a.getDeltaFromLastUpdate())||0;j+=((d=c.cumulativeStat.totalDecodeTime)==null?void 0:d.getTimeSinceLastUpdate())||0;k++}}});if(k>0){a=j/k;a=h*1e3/a;i(c,d("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.GLOBAL_CPU_USAGE,a,d("ZenonMediaStatsConfig").GLOBAL_STATS_RENDERED_VIEW,d("ZenonMediaStatsConfig").GLOBAL_STATS_CONTENT_TYPE,e)}if(f+g>0){i(c,(a=d("ZenonMediaStatsConfig")).PER_STREAM_AGG_METRICS.GLOBAL_AUDIO_BITRATE,f,a.GLOBAL_STATS_RENDERED_VIEW,a.GLOBAL_STATS_CONTENT_TYPE,e);i(c,a.PER_STREAM_AGG_METRICS.GLOBAL_VIDEO_BITRATE,g,a.GLOBAL_STATS_RENDERED_VIEW,a.GLOBAL_STATS_CONTENT_TYPE,e)}}function r(a,b){a.filter(function(a){return a.remote===!1&&a.webrtcTrack.readyState==="live"}).forEach(function(a){var c=b.get(a.trackId);if(c!=null){var e,f=h[a.contentType];f=d("ZenonMediaStatsParser").getOrCreateTrackerFromMap(b,f);i(f,(e=d("ZenonMediaStatsConfig")).PER_STREAM_AGG_METRICS.ROUND_TRIP_TIME,p(c,"currentRoundTripTime",1e3),e.GLOBAL_STATS_RENDERED_VIEW,a.contentType,0);var g=d("ZenonVideoQualityDeriver").computeVideoQuality(c);i(f,e.PER_STREAM_AGG_METRICS.VIDEO_QUALITY,g,e.GLOBAL_STATS_RENDERED_VIEW,a.contentType,0);i(f,e.PER_STREAM_AGG_METRICS.VIDEO_ENCODED_FRAME_RATE,o(c,"framesEncoded",1e3),e.GLOBAL_STATS_RENDERED_VIEW,a.contentType,0);i(f,e.PER_STREAM_AGG_METRICS.VIDEO_QP,m(c,e.DERIVED_METRICS.VIDEO_CONVERTED_QP_SUM,"framesEncoded",1),e.GLOBAL_STATS_RENDERED_VIEW,a.contentType,0)}})}function s(a,b){var e=d("ZenonMediaStatsParser").getOrCreateTrackerFromMap(b,d("ZenonMediaStatsConfig").PINNED_AUDIO_STATS_TRACK_INFO),f=d("ZenonMediaStatsParser").getOrCreateTrackerFromMap(b,d("ZenonMediaStatsConfig").PINNED_VIDEO_STATS_TRACK_INFO);a.filter(function(a){return a.webrtcTrack.readyState==="live"&&a.remote===!0}).forEach(function(a){var g=b.get(a.trackId);if(g!=null){var h=k(a,b),j=l(a,b);if(a.contentType==="audio"){var q=j===c("ZenonRenderedView").PINNED?e:g;i(q,d("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.AUDIO_PLC_RATE,m(g,d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DECODING_PLC,"totalSamplesReceived",1e3),j,a.contentType,h);i(q,d("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.AUDIO_PLC_CNG_RATE,m(g,d("ZenonMediaStatsConfig").DERIVED_METRICS.AUDIO_DECODING_PLCCNG,"totalSamplesReceived"),j,a.contentType,h);i(q,d("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.AUDIO_NETEQ_WAIT_TIME,m(g,"jitterBufferDelay","jitterBufferEmittedCount",1e3),j,a.contentType,h);i(q,d("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.AUDIO_PACKET_LOSS_RATE,n(g),j,a.contentType,h)}else if(a.contentType==="video"){q=j===c("ZenonRenderedView").PINNED?f:g;i(q,d("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_NETEQ_WAIT_TIME,m(g,"jitterBufferDelay","jitterBufferEmittedCount",1e3),j,a.contentType,h);if(g.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_COUNT]!=null&&g.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_COUNT].getDeltaFromLastUpdate()>0){var r=0;g.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_OOB]==null||g.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_OOB].getDeltaFromLastUpdate()===0?i(q,d("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_AV_SYNC_ABS,p(g,d("ZenonMediaStatsConfig").DERIVED_METRICS.AV_SYNC_ABS,1),j,a.contentType,h):r=1;i(q,d("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_AV_SYNC_OOB,r,j,a.contentType,h)}i(q,d("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_FRAME_RATE,o(g,"framesDecoded",1e3),j,a.contentType,h);i(q,d("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_FREEZE_COUNT_PER_MIN,o(g,d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_FREEZE_COUNT,6e4),j,a.contentType,h);i(q,d("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_FREEZE_DURATION_PER_MIN,o(g,d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_FREEZE_DURATION,6e4),j,a.contentType,h);i(q,d("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_PACKET_LOSS_RATE,n(g),j,a.contentType,h);i(q,d("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_RENDER_SCALE_RATIO,g.scaleRatio,j,a.contentType,h);i(q,d("ZenonMediaStatsConfig").PER_STREAM_AGG_METRICS.VIDEO_CROPPING_RATIO,g.croppingRatio,j,a.contentType,h)}}})}g.aggregatePerStream=a}),98);
__d("ZenonPerfUsageStatsTracker",["performance"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){if(!(h||(h=c("performance"))).memory)return null;else return{heapSizeLimit:Math.round((h||(h=c("performance"))).memory.jsHeapSizeLimit/Math.pow(10,6)),heapTotalSize:Math.round(h.memory.totalJSHeapSize/Math.pow(10,6)),heapUsedSize:Math.round(h.memory.usedJSHeapSize/Math.pow(10,6))}}g.getHeapMemoryStats=a}),98);
__d("ZenonReceiverVideoQualityScoreDeriver",["ZenonMediaStatsConfig","ZenonPercentMediaStat","ZenonRenderedView","ZenonVideoQpConversion"],(function(a,b,c,d,e,f,g){"use strict";var h=["video"];a=160*96;var i=1280*720,j=Math.log(i/a)/Math.log(2);b=51;var k=16,l=b-k,m=l+Math.floor(j*6),n={getVideoQualityIndex:function(a,b,c,e,f){if(a<=0||c==null||e==null||c===0||e===0)return null;a=d("ZenonVideoQpConversion").convertQp(a,b,!f);b=Math.max(0,Math.min(a-k,l));f=c*e;a=Math.max(0,Math.min(Math.log(i/f)/Math.log(2),j));c=6*1.6;e=100*(m-b-a*c)/m;return Math.max(0,e)},updateStatsWithDerivedMetric:function(a,b){a.filter(function(a){return h.includes(a.contentType)&&a.remote===!0}).forEach(function(a){if(a!==null){var e=b.get(a.trackId);if(e!=null){var f=e.cumulativeStat,g=f.framesDecoded;f=f.qpSum;var h=e.deltaStat,i=h.frameHeight;h=h.frameWidth;if(g==null||f==null||i==null||h==null)return;g=g.getCurrentValue();if(h&&i&&g>0){var j=e.codec,k=!0;if(j==null)return;else j!=="unknown"&&(k=!(j.includes("264")||j.includes("265")));j=n.getVideoQualityIndex(f.getDeltaFromLastUpdate(),g,h.getLastAddedValue(),i.getLastAddedValue(),k);j!=null&&(e.percentStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_RECEIVER_QUALITY_SCORE]==null&&(e.percentStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_RECEIVER_QUALITY_SCORE]=new(c("ZenonPercentMediaStat"))()),e.percentStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_RECEIVER_QUALITY_SCORE].add(j,c("ZenonRenderedView").GRID,a.contentType,0))}}}})}};e=n;g["default"]=e}),98);
__d("ZenonResourceUsageStatsTracker",["FBLogger"],(function(a,b,c,d,e,f,g){"use strict";async function b(){try{return await h()}catch(a){c("FBLogger")("rtc_www").catching(a).info("Exception logging monitor extension stats")}return null}function h(){var b,c="gdpnckbgamaigmkbcklkeoipnfaalgad";b=(b=(b=a.chrome)==null?void 0:b.runtime)!=null?b:null;return b===null?Promise.resolve(null):b.sendMessage(c,"",function(b){var c;if((c=a.chrome)==null?void 0:(c=c.runtime)==null?void 0:c.lastError)return Promise.resolve(null);if(((c=b)!=null?c:null)===null)return Promise.resolve(null);if(Object.keys(b).length===0)return Promise.resolve(null);var d=[];Object.keys(b).forEach(function(a){a=b[a];d.push.apply(d,a)});c=0;var e=0,f=0,g=0;d.length>0&&(d.sort(function(a,b){return a.timestamp>b.timestamp?1:-1}),c=Math.round(d.reduce(function(a,b){return a+b.cpu},0)/d.length),g=Math.round(d[d.length-1].cpu),e=Math.round(Math.max.apply(Math,d.map(function(a){return a.cpu}).concat([0]))),f=Math.round(Math.min.apply(Math,d.map(function(a){return a.cpu}))));c={avgCpu:c,maxCpu:e,minCpu:f,mostRecentCpu:g};return Promise.resolve(c)})}g.getProcessStats=b}),98);
__d("ZenonVideoActualEncodedBitrateDeriver",["ZenonDeltaMediaStat","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f,g){"use strict";var h=8,i=1e3,j=5e3;function a(a,b){a.filter(function(a){return a.webrtcTrack.enabled===!0&&a.webrtcTrack.readyState==="live"&&(a.contentType==="video"||a.contentType==="screen")&&a.remote===!1}).forEach(function(a){a=b.get(a.trackId);if(a==null||a.cumulativeStat.bytesSent==null||a.cumulativeStat.retransmittedBytesSent==null)return;var e=a.cumulativeStat,f=e.bytesSent;e=e.retransmittedBytesSent;if(f&&e){var g=0;f.getCount()===1?g=k(f.getCurrentValue(),e.getCurrentValue(),j):g=k(f.getDeltaFromLastUpdate(),e.getDeltaFromLastUpdate(),f.getTimeSinceLastUpdate());if(!g)return;a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_ACTUAL_ENCODED_BITRATE]==null&&(a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_ACTUAL_ENCODED_BITRATE]=new(c("ZenonDeltaMediaStat"))());a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_ACTUAL_ENCODED_BITRATE].add(g)}})}function k(a,b,c){return!c?0:(a-b)*h*i/c}g.updateVideoActualEncodedBitrate=a}),98);
__d("ZenonVideoAndSSReceiverStallStatsDeriver",["ZenonCumulativeMediaStat","ZenonDeltaMediaStat","ZenonMediaStatsConfig","ZenonMediaStatsParser"],(function(a,b,c,d,e,f,g){"use strict";var h=0,i=0,j=6e3,k=[(b=d("ZenonMediaStatsConfig")).DERIVED_METRICS.VIDEO_RECEIVE_IS_STALLED,b.DERIVED_METRICS.VIDEO_DECODE_IS_STALLED],l=[b.DERIVED_METRICS.VIDEO_RECEIVE_STALL_DURATION,b.DERIVED_METRICS.VIDEO_DECODE_STALL_DURATION],m=[b.DERIVED_METRICS.VIDEO_RECEIVE_TOTAL_STALLS,b.DERIVED_METRICS.VIDEO_DECODE_TOTAL_STALLS],n=function(a){return((a=a==null?void 0:a.getCurrentTimeSinceLastUpdate())!=null?a:0)>j};function o(a,b,c){var d=0;c!=null&&r(a,b)&&(d=c.getDeltaFromLastUpdate());return d}function p(a,b,c){var d=0;c!=null&&q(a,b)&&(d=c.getDeltaFromLastUpdate());return d}function q(a,b){var c=!1;a!=null&&a.getDeltaFromLastUpdate()>0&&a.getElapsedTime()!==0&&b!=null&&b.getElapsedTime()!==0&&(c=n(b)||b.getDeltaFromLastUpdate()===0||b.getCurrentValue()===0);return c}function r(a,b){var c=!1;if(b!=null&&b.getElapsedTime()!==0){var d=h;a.contentType==="screen"&&(d=i);c=n(b)||b.getDeltaFromLastUpdate()<=d||b.getCurrentValue()===0}return c}function s(a){k.forEach(function(b){a.deltaStat[b]==null&&(a.deltaStat[b]=new(c("ZenonDeltaMediaStat"))())}),l.forEach(function(b){a.cumulativeStat[b]==null&&(a.cumulativeStat[b]=new(c("ZenonCumulativeMediaStat"))(0))}),m.forEach(function(b){a.cumulativeStat[b]==null&&(a.cumulativeStat[b]=new(c("ZenonCumulativeMediaStat"))(0))})}function t(a,b){var c=b.cumulativeStat,e=c.bytesReceived,f=c.framesDecoded;c=c.timestamp;if(a.webrtcTrack.enabled===!1||b.transportIceState!=="connected")return;a=o(a,e,c);u(b,a,d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_RECEIVE_IS_STALLED,d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_RECEIVE_STALL_DURATION,d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_RECEIVE_TOTAL_STALLS);a=p(e,f,c);u(b,a,d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_DECODE_IS_STALLED,d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_DECODE_STALL_DURATION,d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_DECODE_TOTAL_STALLS)}function u(a,b,c,d,e){var f,g=b===0?0:1,h=!v(a,c)&&g?1:0;(f=a.cumulativeStat[e])==null?void 0:f.update(a.cumulativeStat[e].getCurrentValue()+h);(f=a.cumulativeStat[d])==null?void 0:f.update(a.cumulativeStat[d].getCurrentValue()+b);a.deltaStat[c].add(g)}function v(a,b){return a.deltaStat[b]!=null&&a.deltaStat[b].getLastAddedValue()===1}function a(a,b){a.filter(function(a){return(a.contentType==="video"||a.contentType==="screen")&&a.remote}).forEach(function(a){var c=d("ZenonMediaStatsParser").getOrCreateTrackerFromMap(b,a);c!=null&&(s(c),t(a,c))})}g.updateReceiverStallStatsWithDerivedMetric=a}),98);
__d("ZenonVideoCaptureMetricDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f,g){"use strict";var h={VIDEO_CAPTURE_FRAME_COUNT_STAT_KEY:d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CAPTURE_FRAME_COUNT,VIDEO_SUM_CAPTURE_PIXEL_STAT_KEY:d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SUM_CAPTURE_PIXEL,calculateVideoCaptureFrameCount:function(a){var b=a.cumulativeStat.timestamp,c=a.deltaStat.framesPerSecond;if(c!=null&&b!=null&&b.getCurrentValue()>a.lastUpdate&&b.getDeltaFromLastUpdate()!==b.getCurrentValue()){a=c.getLastAddedValue();c=b.getDeltaFromLastUpdate();if(typeof a==="number")return Math.round(a*c/1e3)}return 0},calculateVideoSumCapturePixel:function(a,b){var c=a.cumulativeStat,d=c.captureFrameCount;c=c.timestamp;var e=a.deltaStat,f=e.height;e=e.width;if(d!=null&&e!=null&&f!=null&&c!=null&&c.getCurrentValue()>a.lastUpdate){c=b?d.getCurrentValue():d.getDeltaFromLastUpdate();b=(a=e.getLastAddedValue())!=null?a:0;e=(d=f.getLastAddedValue())!=null?d:0;return c*b*e}return 0},updateStatsWithDerivedMetric:function(a,b){var e=["video","screen"];a.filter(function(a){return e.includes(a.contentType)&&a.remote===!1}).forEach(function(a){a=b.get(a.trackId);if(a!=null){if(a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CAPTURE_FRAME_COUNT]!=null){var e=a.cumulativeStat.framesEncoded;if(e!=null)if(e.getDeltaFromLastUpdate()<0){(e=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CAPTURE_FRAME_COUNT])==null?void 0:e.update(0)}else{var f;e=h.calculateVideoCaptureFrameCount(a);((f=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CAPTURE_FRAME_COUNT])==null?void 0:f.getCurrentValue())===0&&(e+=e);(f=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CAPTURE_FRAME_COUNT])==null?void 0:f.update(a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CAPTURE_FRAME_COUNT].getCurrentValue()+e)}}else a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CAPTURE_FRAME_COUNT]=new(c("ZenonCumulativeMediaStat"))(0);if(a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SUM_CAPTURE_PIXEL]!=null){f=a.cumulativeStat.captureFrameCount;e=((f==null?void 0:f.getDeltaFromLastUpdate())||0)<0;f=h.calculateVideoSumCapturePixel(a,e);if(e){(e=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SUM_CAPTURE_PIXEL])==null?void 0:e.update(f)}else{(e=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SUM_CAPTURE_PIXEL])==null?void 0:e.update(a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SUM_CAPTURE_PIXEL].getCurrentValue()+f)}}else{e=h.calculateVideoSumCapturePixel(a,!0);a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SUM_CAPTURE_PIXEL]=new(c("ZenonCumulativeMediaStat"))(e)}}})}};a=h;g["default"]=a}),98);
__d("ZenonVideoConvertedQpDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig","ZenonVideoQpConversion"],(function(a,b,c,d,e,f,g){"use strict";var h=["video","screen"],i={calculateVideoConvertedQP:function(a){var b=a.cumulativeStat,c=b.framesDecoded,e=b.framesEncoded,f=b.qpSum;b=b.timestamp;var g=a.codec;e=e!=null?e:c;if(f!=null&&e!=null&&g!=null&&b!=null&&b.getCurrentValue()>a.lastUpdate){c=e.getCount()===1||f.getCount()===1;c?(b=f.getCurrentValue(),a=e.getCurrentValue()):(b=f.getDeltaFromLastUpdate(),a=e.getDeltaFromLastUpdate());c=g.includes("264");f=d("ZenonVideoQpConversion").convertQp(a,b,c);return f*a}return 0},updateStatsWithDerivedMetric:function(a,b){a.filter(function(a){return h.includes(a.contentType)&&a.webrtcTrack.readyState==="live"&&a.webrtcTrack.muted===!1}).forEach(function(a){a=b.get(a.trackId);if(a!=null){var e=a.cumulativeStat.qpSum;if(e!=null){e=e.getDeltaFromLastUpdate()<0;var f=i.calculateVideoConvertedQP(a),g=d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CONVERTED_QP_SUM;a.cumulativeStat[g]!=null?e?a.cumulativeStat[g].update(f):a.cumulativeStat[g].update(a.cumulativeStat[g].getCurrentValue()+f):a.cumulativeStat[g]=new(c("ZenonCumulativeMediaStat"))(f)}}})}};a=i;g["default"]=a}),98);
__d("ZenonVideoDecodeTimeDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){var d=a.filter(function(a){return a.contentType!=="audio"&&a.remote&&a.webrtcTrack.readyState!=="ended"}).reduce(function(a,d){d=b.get(d.trackId);if(d!=null&&d.cumulativeStat.framesDecoded!=null&&d.cumulativeStat.framesDecoded.getDeltaFromLastUpdate()>0){var e,f;e=((e=d.cumulativeStat.framesDecoded)==null?void 0:e.getTimeSinceLastUpdate())||0;((f=d.cumulativeStat.framesDecoded)==null?void 0:f.getCount())===2&&d.cumulativeStat.framesDecoded&&(e+=h(d.cumulativeStat.framesDecoded,c));return Math.max(e,a)}return a},0);b.forEach(function(a){if(a.cumulativeStat.framesDecoded!=null){a.maxTotalDecodeTime=((a=a.maxTotalDecodeTime)!=null?a:0)+d}})}function b(a,b,e){a.filter(function(a){return a.contentType!=="audio"&&a.remote&&a.webrtcTrack.readyState!=="ended"}).forEach(function(a){a=b.get(a.trackId);if(a!=null&&a.cumulativeStat.framesDecoded!=null&&a.cumulativeStat.framesDecoded.getDeltaFromLastUpdate()>0){var f,g;f=((f=a.cumulativeStat.framesDecoded)==null?void 0:f.getTimeSinceLastUpdate())||0;((g=a.cumulativeStat.framesDecoded)==null?void 0:g.getCount())===2&&a.cumulativeStat.framesDecoded&&(f+=h(a.cumulativeStat.framesDecoded,e));a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_DECODE_TIME]==null?a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_DECODE_TIME]=new(c("ZenonCumulativeMediaStat"))(f):a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_DECODE_TIME].update(a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_DECODE_TIME].getCurrentValue()+f)}})}function h(a,b){return a.getDeltaFromLastUpdate()>0?Math.round(b*a.getFirstValue()/a.getDeltaFromLastUpdate()):0}g.findMaxDecodeTime=a;g.updateTrackerWithDecodeTime=b}),98);
__d("ZenonVideoDecodedBytesDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){a.filter(function(a){return a.contentType!=="audio"&&a.remote&&a.webrtcTrack.readyState!=="ended"}).forEach(function(a){a=b.get(a.trackId);if(a!=null){var e=a.cumulativeStat,f=e.bytesReceived;e=e.framesDecoded;if(f&&e){var g=e.getElapsedTime()===0&&e.getCurrentValue()>0;if(g||e.getDeltaFromLastUpdate()>0){e=f.getDeltaFromLastUpdate();g&&(e=f.getCurrentValue());a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_DECODED_BYTES]==null?a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_DECODED_BYTES]=new(c("ZenonCumulativeMediaStat"))(e):a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_DECODED_BYTES].update(a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_DECODED_BYTES].getCurrentValue()+e)}}}})}g.updateTrackerWithDecodedBytes=a}),98);
__d("ZenonVideoFreezeCountDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f,g){"use strict";var h=10,i=.5,j={aggregateFreezes:function(a,b,c,d){if(a){a=d.getDeltaFromLastUpdate();d=b-c*c/3;return Math.sqrt(d*(a-1))*1e3}return 0},calculateVideoFreeze:function(a){a=a.cumulativeStat;var b=a.framesDecoded,c=a.pauseCount,d=a.totalInterFrameDelay,e=a.totalPausesDuration;a=a.totalSquaredInterFrameDelay;if(b!=null&&d!=null&&a!=null&&b.getDeltaFromLastUpdate()>1){c=(c==null?void 0:c.getDeltaFromLastUpdate())||0;e=(e==null?void 0:e.getDeltaFromLastUpdate())||0;b.updateInactiveDuration(e);if(!(c>0||e>0)){c=b.getDeltaFromLastUpdate();e=b.getAverageOverActiveTime()*1e3;d=d.getDeltaFromLastUpdate();a=a.getDeltaFromLastUpdate();e=1/e;var f=e*h/100;e=Math.max(3*e,e+.15);e=f*f/3+e*e/(c-1);var g=f*f/3+i*i/(c-1);a=(a-d*d/c)/c;d=a>e?1:0;c=a>g?1:0;e=j.aggregateFreezes(d,a,f,b);g=j.aggregateFreezes(c,a,f,b);return{count:d,duration:e,duration500ms:g}}}return{count:0,duration:0,duration500ms:0}},updateStatsWithDerivedMetric:function(a,b){var e=d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_FREEZE_COUNT,f=d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_FREEZE_DURATION,g=d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_FREEZE_DURATION_500MS;a.filter(function(a){return a.contentType==="video"&&a.remote&&a.webrtcTrack.readyState!=="ended"}).forEach(function(a){a=b.get(a.trackId);if(a!=null){var d=j.calculateVideoFreeze(a);a.cumulativeStat[e]!=null?a.cumulativeStat[e].update(a.cumulativeStat[e].getCurrentValue()+d.count):a.cumulativeStat[e]=new(c("ZenonCumulativeMediaStat"))(d.count);a.cumulativeStat[f]!=null?a.cumulativeStat[f].update(a.cumulativeStat[f].getCurrentValue()+d.duration):a.cumulativeStat[f]=new(c("ZenonCumulativeMediaStat"))(d.duration);a.cumulativeStat[g]!=null?a.cumulativeStat[g].update(a.cumulativeStat[g].getCurrentValue()+d.duration500ms):a.cumulativeStat[g]=new(c("ZenonCumulativeMediaStat"))(d.duration500ms)}})}};a=j;g["default"]=a}),98);
__d("ZenonVideoPauseDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f,g){"use strict";var h=5e3;function a(a,b){a.filter(function(a){return a.contentType==="video"&&a.remote}).forEach(function(a){a=b.get(a.trackId);a!=null&&i(a)})}function i(a){var b=a.cumulativeStat,e=b.framesDecoded;b=b.packetsReceived;if(b!=null){var f;f=(f=a.isVideoPaused)!=null?f:!1;if(!f)b.getDeltaFromLastUpdate()===0&&b.getTimeSinceLastUpdate()>1e3&&(a.isVideoPaused=!0,a.lastVideoPacketTime=b.getPreviousTime());else if(e!=null&&e.getDeltaFromLastUpdate()>0){a.isVideoPaused=!1;e=(b.getCurrentTime()+b.getPreviousTime())/2-((f=a.lastVideoPacketTime)!=null?f:b.getPreviousTime());a.lastVideoPacketTime=void 0;e>=h&&(a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_COUNT]!=null?a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_COUNT].update(a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_COUNT].getCurrentValue()+1):a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_COUNT]=new(c("ZenonCumulativeMediaStat"))(1),a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_DURATION]!=null?a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_DURATION].update(a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_DURATION].getCurrentValue()+e):a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_PAUSE_DURATION]=new(c("ZenonCumulativeMediaStat"))(e))}}}g.updateVideoPause=a}),98);
__d("ZenonVideoRenderStallStatsDeriver",["ZenonCumulativeMediaStat","ZenonDeltaMediaStat","ZenonMediaStatsConfig","ZenonMediaStatsParser"],(function(a,b,c,d,e,f,g){"use strict";var h=5e3,i=new Map();function j(a){a=(a=a.srcObject)==null?void 0:a.getVideoTracks();if(!a)return;a.forEach(function(a){a=a.id;var b=i.get(a);if(b==null)i.set(a,{frames_received:new(c("ZenonCumulativeMediaStat"))(0),video_muted:!1,video_render_is_stall:!1,video_render_total_stall_duration_ms:0,video_render_total_stalls:0});else{if(b.video_muted){b.video_muted=!1;b.frames_received.update(b.frames_received.getCount()+1);return}b.frames_received.update(b.frames_received.getCount()+1);a=b.frames_received.getTimeSinceLastUpdate();a>=h?(b.video_render_is_stall||(b.video_render_is_stall=!0,b.video_render_total_stalls++),b.video_render_total_stall_duration_ms+=a):b.video_render_is_stall&&(b.video_render_is_stall=!1,b.video_render_total_stall_duration_ms+=a)}})}function k(a,b){b=b.get(a);return(b==null?void 0:b.deltaStat.videoDecodeIsStalled)===1||(b==null?void 0:b.deltaStat.videoReceivedIsStalled)===1}function l(a,b){b=b.find(function(b){return b.label===a});return b}function m(a){a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_RENDER_IS_STALLED]==null&&(a.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_RENDER_IS_STALLED]=new(c("ZenonDeltaMediaStat"))()),a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_RENDER_STALL_DURATION]==null&&(a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_RENDER_STALL_DURATION]=new(c("ZenonCumulativeMediaStat"))(0)),a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_RENDER_TOTAL_STALLS]==null&&(a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_RENDER_TOTAL_STALLS]=new(c("ZenonCumulativeMediaStat"))(0))}function a(a){var b=a.current;if(b!=null){a=function a(){j(b),typeof b.requestVideoFrameCallback==="function"&&b.requestVideoFrameCallback(a)};typeof b.requestVideoFrameCallback==="function"&&b.requestVideoFrameCallback(a)}}function b(a){a=a==null?void 0:(a=a.srcObject)==null?void 0:a.getVideoTracks();if(a==null)return;a.forEach(function(a){a=a.id;a=i.get(a);a!=null&&(a.video_muted=!0)})}function e(a,b){i.forEach(function(c,e){var f;e=l(e,a);if(e==null||e.webrtcTrack.enabled===!1||k(e.trackId,b))return;e=d("ZenonMediaStatsParser").getOrCreateTrackerFromMap(b,e);m(e);(f=e.deltaStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_RENDER_IS_STALLED])==null?void 0:f.add(+c.video_render_is_stall);(f=e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_RENDER_STALL_DURATION])==null?void 0:f.update(e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_RENDER_STALL_DURATION].getCurrentValue()+c.video_render_total_stall_duration_ms);(f=e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_RENDER_TOTAL_STALLS])==null?void 0:f.update(e.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_RENDER_TOTAL_STALLS].getCurrentValue()+c.video_render_total_stalls)}),i.clear()}g.startVideoRenderStallStatTracking=a;g.stopVideoRenderStallStatTracking=b;g.updateStatsWithDerivedMetric=e}),98);
__d("ZenonVideoStallStatsDeriver",["ZenonCumulativeMediaStat","ZenonDeltaMediaStat","ZenonMediaStatsConfig","ZenonMediaStatsParser"],(function(a,b,c,d,e,f,g){"use strict";var h=0,i=0,j=6e3,k=[(b=d("ZenonMediaStatsConfig")).DERIVED_METRICS.VIDEO_CAPTURE_IS_STALLED,b.DERIVED_METRICS.VIDEO_ENCODE_IS_STALLED,b.DERIVED_METRICS.VIDEO_SENT_IS_STALLED],l=[b.DERIVED_METRICS.VIDEO_CAPTURE_STALL_DURATION,b.DERIVED_METRICS.VIDEO_ENCODE_STALL_DURATION,b.DERIVED_METRICS.VIDEO_SENT_STALL_DURATION],m=[b.DERIVED_METRICS.VIDEO_CAPTURE_TOTAL_STALLS,b.DERIVED_METRICS.VIDEO_ENCODE_TOTAL_STALLS,b.DERIVED_METRICS.VIDEO_SENT_TOTAL_STALLS],n=function(a){return((a=a==null?void 0:a.getCurrentTimeSinceLastUpdate())!=null?a:0)>j};function o(a,b){var c=0;b!=null&&r(a)&&(c=b.getDeltaFromLastUpdate());return c}function p(a,b){var c=0;b!=null&&s(a)&&(c=b.getDeltaFromLastUpdate());return c}function q(a,b,c){var d=0;c!=null&&t(a,b)&&(d=c.getDeltaFromLastUpdate());return d}function r(a){var b=!1;a!=null&&a.getElapsedTime()!==0&&(b=n(a)||a.getDeltaFromLastUpdate()===0||a.getCurrentValue()===0);return b}function s(a){var b=!1;a!=null&&a.getElapsedTime()!==0&&(b=n(a)||a.getDeltaFromLastUpdate()===0||a.getCurrentValue()===0);return b}function t(a,b){var c=!1;if(b!=null&&b.getElapsedTime()!==0){var d=h;a.contentType==="screen"&&(d=i);c=n(b)||b.getDeltaFromLastUpdate()<=d||b.getCurrentValue()===0}return c}function u(a){k.forEach(function(b){a.deltaStat[b]==null&&(a.deltaStat[b]=new(c("ZenonDeltaMediaStat"))())}),l.forEach(function(b){a.cumulativeStat[b]==null&&(a.cumulativeStat[b]=new(c("ZenonCumulativeMediaStat"))(0))}),m.forEach(function(b){a.cumulativeStat[b]==null&&(a.cumulativeStat[b]=new(c("ZenonCumulativeMediaStat"))(0))})}function v(a,b){var c=b.cumulativeStat,e=c.bytesSent,f=c.captureFrameCount,g=c.framesEncoded;c=c.timestamp;var h=b.videoEncoding;if(a.webrtcTrack.enabled===!1)return;else if((h==null?void 0:h.enabled)===!1)return;h=o(f,c);w(b,h,d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CAPTURE_IS_STALLED,d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CAPTURE_STALL_DURATION,d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_CAPTURE_TOTAL_STALLS);if(h===0){f=p(g,c);w(b,f,d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_ENCODE_IS_STALLED,d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_ENCODE_STALL_DURATION,d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_ENCODE_TOTAL_STALLS);if(f===0&&b.transportIceState==="connected"){h=q(a,e,c);w(b,h,d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SENT_IS_STALLED,d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SENT_STALL_DURATION,d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SENT_TOTAL_STALLS)}}}function w(a,b,c,d,e){var f,g=b===0?0:1,h=!x(a,c)&&g?1:0;(f=a.cumulativeStat[e])==null?void 0:f.update(a.cumulativeStat[e].getCurrentValue()+h);if(h){(f=a.cumulativeStat[d])==null?void 0:f.updateLastStretchStartValue(a.cumulativeStat[d].getCurrentValue())}(e=a.cumulativeStat[d])==null?void 0:e.update(a.cumulativeStat[d].getCurrentValue()+b);a.deltaStat[c].add(g)}function x(a,b){return a.deltaStat[b]!=null&&a.deltaStat[b].getLastAddedValue()===1}function a(a,b){a.filter(function(a){return(a.contentType==="video"||a.contentType==="screen")&&!a.remote}).forEach(function(a){var c=d("ZenonMediaStatsParser").getOrCreateTrackerFromMap(b,d("ZenonMediaStatsConfig").OUTBOUND_VIDEO_STATS_TRACK_INFO);a.contentType==="screen"&&(c=d("ZenonMediaStatsParser").getOrCreateTrackerFromMap(b,d("ZenonMediaStatsConfig").OUTBOUND_SCREEN_STATS_TRACK_INFO));c!=null&&(u(c),v(a,c))})}g.updateStatsWithDerivedMetric=a}),98);
__d("ZenonVideoSumPixelDeriver",["ZenonCumulativeMediaStat","ZenonMediaStatsConfig"],(function(a,b,c,d,e,f,g){"use strict";var h=["video","screen"],i={calculateVideoSumPixel:function(a,b,c){var d=a.cumulativeStat,e=d.framesDecoded,f=d.framesEncoded;d=d.timestamp;var g=a.deltaStat,h=g.frameHeight;g=g.frameWidth;c=c?e:f;if(c!=null&&g!=null&&h!=null&&d!=null&&d.getCurrentValue()>a.lastUpdate){e=b?c.getCurrentValue():c.getDeltaFromLastUpdate();d=(f=g.getLastAddedValue())!=null?f:0;b=(a=h.getLastAddedValue())!=null?a:0;return e*d*b}return 0},updateStatsWithDerivedMetric:function(a,b){a.filter(function(a){return h.includes(a.contentType)}).forEach(function(a){var e=a.remote;a=b.get(a.trackId);if(a!=null)if(a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SUM_PIXEL]!=null){var f=a.cumulativeStat,g=f.framesDecoded;f=f.framesEncoded;g=e?g:f;if(g!=null){f=g.getDeltaFromLastUpdate()<0;g=i.calculateVideoSumPixel(a,f,e);if(f){(f=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SUM_PIXEL])==null?void 0:f.update(g)}else{(f=a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SUM_PIXEL])==null?void 0:f.update(a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SUM_PIXEL].getCurrentValue()+g)}}}else{f=i.calculateVideoSumPixel(a,!0,e);a.cumulativeStat[d("ZenonMediaStatsConfig").DERIVED_METRICS.VIDEO_SUM_PIXEL]=new(c("ZenonCumulativeMediaStat"))(f)}})}};a=i;g["default"]=a}),98);
__d("ZenonMediaStatsReportPoller",["ZenonAppProvider","ZenonAudioDecodingNormalDeriver","ZenonAudioDecodingPLCCNGDeriver","ZenonAudioDecodingPLCDeriver","ZenonAudioEchoConfidenceStatsDeriver","ZenonAudioLevelDeriver","ZenonAudioPlaybackIssueLogger","ZenonAudioReceiverStatsUtils","ZenonAudioStallStatsDeriver","ZenonAvSyncDeriver","ZenonMediaElementTracker","ZenonMediaStatsConfig","ZenonMediaStatsParser","ZenonMediaStatsUtil","ZenonMuteStateDeriver","ZenonOutboundStatsWriter","ZenonPacketsLostDeriver","ZenonPerStreamAggregator","ZenonPerfUsageStatsTracker","ZenonReceiverVideoQualityScoreDeriver","ZenonResourceUsageStatsTracker","ZenonSpeakerTracker","ZenonVideoActualEncodedBitrateDeriver","ZenonVideoAndSSReceiverStallStatsDeriver","ZenonVideoCaptureMetricDeriver","ZenonVideoConvertedQpDeriver","ZenonVideoDecodeTimeDeriver","ZenonVideoDecodedBytesDeriver","ZenonVideoFreezeCountDeriver","ZenonVideoPauseDeriver","ZenonVideoRenderStallStatsDeriver","ZenonVideoScaleHistogram","ZenonVideoStallStatsDeriver","ZenonVideoSumPixelDeriver","findInMap"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){return c("findInMap")(b,function(b){return b.trackIDs.includes(a.trackId)})}async function a(a,b){a=await a.getStats();(a instanceof RTCStatsReport||a instanceof Array)&&a.forEach(function(a){a.type==="data-channel"&&b.set(a.id,a)})}async function i(a,b,c,e,f,g,i){var j=c.getSenders().map(async function(c){var g,j=(g=c.track)==null?void 0:g.id;if(j!=null){g=a.find(function(a){return a.webrtcTrack.id===j});if(g!=null&&g.webrtcTrack.readyState!=="ended"){var k=await c.getStats();k=d("ZenonMediaStatsParser").makeStatsReportMap(k);d("ZenonMediaStatsUtil").shouldUseTSLog()&&e&&e.addData(g.enabled,d("ZenonMediaStatsParser").filterMediaReports(k),d("ZenonMediaStatsConfig").TSLOG_STATS_REQUESTED,g.contentType,h(g,f));d("ZenonMediaStatsParser").updateTrackStatsWithReport(g,b,k);d("ZenonMediaStatsParser").updateTrackStatsFromSender(g,b,c);i.push(g)}}});await Promise.all(j);j=c.getReceivers().map(async function(c){var i,j=(i=c.track)==null?void 0:i.id;if(j!=null){i=a.find(function(a){return a.webrtcTrack.id===j});if(i!=null&&i.webrtcTrack.readyState!=="ended"){c=await c.getStats();c=d("ZenonMediaStatsParser").makeStatsReportMap(c);if(d("ZenonMediaStatsUtil").shouldUseTSLog()&&e){var k=i.contentType==="audio"?i.userMuted:i.enabled;e.addData(k,d("ZenonMediaStatsParser").filterMediaReports(c),d("ZenonMediaStatsConfig").TSLOG_STATS_REQUESTED,i.contentType,h(i,f))}d("ZenonMediaStatsParser").updateTrackStatsWithReport(i,b,c);g.push(i)}}});await Promise.all(j)}function j(a,b){a.forEach(function(a){a=b.get(a.trackId);a!=null&&a.cumulativeStat.timestamp!=null&&(a.lastUpdate=a.cumulativeStat.timestamp.getCurrentValue())})}async function b(a,b,e,f,g,h,l){l===void 0&&(l=new Map());var m=[],n=[];await i(a,b,f,g,l,m,n);d("ZenonMediaElementTracker").updateStats(b);if(d("ZenonMediaStatsUtil").shouldUseTSLog()&&g){l=await f.getStats();l=d("ZenonMediaStatsParser").makeStatsReportMap((l=l)!=null?l:new RTCStatsReport());g.addCandidatePairStats(l);g.addNonMediaStates();g.addRenderedFrameData(b,l);g.addDerivedMetricsData(b,a);l=await d("ZenonResourceUsageStatsTracker").getProcessStats();l!=null&&g.addCallCpuData(d("ZenonMediaStatsConfig").GLOBAL_STATS_TRACKID,l);l=d("ZenonPerfUsageStatsTracker").getHeapMemoryStats();l&&g.addHeapMemoryData(d("ZenonMediaStatsConfig").GLOBAL_STATS_TRACKID,l);g.addSenderVideoStallData(b);g.addAudioEchoMetricData(b);g.advance()}d("ZenonSpeakerTracker").updateStats(a,b);d("ZenonPacketsLostDeriver").updatePacketsLost(a,b);d("ZenonMuteStateDeriver").updateMuteState(a,b);c("ZenonVideoFreezeCountDeriver").updateStatsWithDerivedMetric(a,b);d("ZenonVideoPauseDeriver").updateVideoPause(a,b);c("ZenonVideoCaptureMetricDeriver").updateStatsWithDerivedMetric(a,b);c("ZenonVideoSumPixelDeriver").updateStatsWithDerivedMetric(a,b);c("ZenonVideoConvertedQpDeriver").updateStatsWithDerivedMetric(a,b);d("ZenonVideoDecodedBytesDeriver").updateTrackerWithDecodedBytes(a,b);d("ZenonVideoDecodeTimeDeriver").findMaxDecodeTime(a,b,h);d("ZenonVideoDecodeTimeDeriver").updateTrackerWithDecodeTime(a,b,h);d("ZenonVideoScaleHistogram").updateTrackerWithScaleHistogram(a,b);d("ZenonVideoActualEncodedBitrateDeriver").updateVideoActualEncodedBitrate(a,b);d("ZenonAudioLevelDeriver").computeAudioLevels(a,b);d("ZenonAudioStallStatsDeriver").updateStatsWithDerivedMetric(a,b);d("ZenonVideoStallStatsDeriver").updateStatsWithDerivedMetric(a,b);d("ZenonVideoRenderStallStatsDeriver").updateStatsWithDerivedMetric(a,b);d("ZenonAvSyncDeriver").updateTrackerWithAvSync(a,b,e);c("ZenonReceiverVideoQualityScoreDeriver").updateStatsWithDerivedMetric(a,b);d("ZenonAudioReceiverStatsUtils").updateTracksWithAudioReceivePercentStats(a,b);d("ZenonVideoAndSSReceiverStallStatsDeriver").updateReceiverStallStatsWithDerivedMetric(a,b);d("ZenonOutboundStatsWriter").updateOutboundStats(n,b);d("ZenonPerStreamAggregator").aggregatePerStream([].concat(m,n),b);c("ZenonAudioPlaybackIssueLogger").detectAudioPlaybackIssue(a,b);d("ZenonAudioDecodingNormalDeriver").updateAudioDecodingNormal(a,b);d("ZenonAudioDecodingPLCDeriver").updateAudioDecodingPLC(a,b);d("ZenonAudioDecodingPLCCNGDeriver").updateAudioDecodingPLCCNG(a,b);d("ZenonAudioEchoConfidenceStatsDeriver").updateStatsWithDerivedMetric(b);d("ZenonAppProvider").isMetaAI()&&await k(f,a,b);j(a,b)}async function e(a,b,c){b=b.getReceivers().map(async function(b){var d,e=(d=b.track)==null?void 0:d.id;if(e!=null){d=a.find(function(a){return a.webrtcTrack.id===e});if(d!=null&&d.webrtcTrack.readyState!=="ended"){d=await b.getStats();if(!(d instanceof Map||d.result))for(b of d.values())if(b.type==="inbound-rtp"&&b.kind==="video"&&b.codecId!=null&&typeof b.codecId==="string"){var f=d.get(b.codecId);(f==null?void 0:f.type)==="codec"&&c.set(e,f.mimeType.toString())}}}});await Promise.all(b)}async function k(a,b,c){var d,e="conversation_bot_audio",f=(d=b.values().find(function(a){return a.trackId===e}))==null?void 0:d.label;d=a.getReceivers().filter(function(a){return a.track.label===f})[0];b=b.filter(function(a){return a.trackId===e});if(b.length===0)return;b=b[0];c=c.get(b.trackId);if(c==null)return;b=d.getSynchronizationSources()[0];d=b.captureTimestamp;var g=b.senderCaptureTimeOffset;b=b.timestamp;if(d==null||g==null)return;a=await a.getStats();if(a==null||!(a instanceof RTCStatsReport))return;var h=22089888e5;d=d-h;h=a.entries().toArray();a=h.map(function(a){a[0];a=a[1];return a}).filter(function(a){return a.type==="remote-outbound-rtp"})[0];h=h.map(function(a){a[0];a=a[1];return a}).filter(function(a){return a.type==="remote-inbound-rtp"})[0];h=h.roundTripTime;var i=a.remoteTimestamp;if(h==null)return;if(i==null)return;a=a.timestamp-(i+h/2);i=a+g;h=d+i;a=b-h;c.lastServerToClientLatency=a}g.updateStatsForDatachannel=a;g.updateStatsFromConnection=b;g.updateVideoCodecFromReceivers=e}),98);
__d("ZenonLayout",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["Grid","DominantSpeaker"]);c=a;f["default"]=c}),66);
__d("ZenonSpeakerTracker",["ZenonCallsHooks","ZenonLayout","ZenonRenderedView","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useEffect,j=null,k=[],l=[];function m(a,b,c){j=a,k=b,l=c}function a(a,b){for(a of a){if(!a.remote)continue;var d=b.get(a.trackId);if(!d)continue;d.isDominantSpeaker=k.indexOf(a.trackId)!==-1;if(j!=null)switch(j){case c("ZenonLayout").Grid:d.renderedView=c("ZenonRenderedView").GRID;break;case c("ZenonLayout").DominantSpeaker:var e=l.indexOf(a.trackId)!==-1;d.renderedView=e?c("ZenonRenderedView").PINNED:c("ZenonRenderedView").THUMBNAIL;break}}}function b(a,b,d){var e,f=(e=c("ZenonCallsHooks").useLiveMediaTrack((e=b)!=null?e:"","video"))==null?void 0:e.trackId,g=(b=c("ZenonCallsHooks").useLiveMediaTrack((e=b)!=null?e:"","audio"))==null?void 0:b.trackId,h=(b=c("ZenonCallsHooks").useLiveMediaTrack((e=d)!=null?e:"","video"))==null?void 0:b.trackId,j=(b=c("ZenonCallsHooks").useLiveMediaTrack((e=d)!=null?e:"","audio"))==null?void 0:b.trackId;i(function(){m(a,[f,g],[h,j])},[h,j,a,f,g])}g.updateLayout=m;g.updateStats=a;g.useUpdateSpeakerTracker=b}),98);
__d("ZenonMWMessageDebugLogger",["Log","LogHistory","ODS","RpWebStateMachineLoggingBlocklist","ZenonAuditedCheckpointLogId","ZenonIceStatsParser","ZenonInfraActionsLogger","ZenonMWMessageMap","ZenonMWMessageTypes","ZenonMWTranslatorUtils","formatDate","isEmployeeTestUserZenonLogging"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(){this.$1=d("LogHistory").getInstance("webrtc"),this.$2=new Set(c("RpWebStateMachineLoggingBlocklist").MESSAGE_TYPES)}var b=a.prototype;b.$3=function(a,b,d){b===void 0&&(b=!0);var e=c("formatDate")(new Date(),"[H:i:s:X]",{skipPatternLocalization:!0});this.$1.log("Console",e+" "+a);b&&c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"[ZP] "+a,messageID:d})};b.$4=function(a){a=a.jsonPayload.header;return a.responseStatusCode!=null};b.logMWMessage=function(a,b,d){this.$5(a,b,d);if(d.jsonPayload==null||!c("isEmployeeTestUserZenonLogging")())return;var e=d.jsonPayload.header,f=c("ZenonMWMessageMap")[e.type],g=this.$4(d)?"RESPONSE":"REQUEST";d=this.$6(d);a="[ms] "+a+" ["+b+"] "+f+" "+g+" [retryCount: "+e.retryCount+(d!=null?" details: "+d:"")+"]";this.$2.has(f)||this.$3(a,!0,e.transactionId)};b.$5=function(a,b,c){a=this.$7(a,b,c);a!==null&&(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_signaling",a)};b.$7=function(a,b,e){if(e.jsonPayload==null)return null;var f=e.jsonPayload,g=f.body;f=f.header;var h="";switch(f.type){case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.DATA_MESSAGE:if(g.dataMessageRequest){h=(g=d("ZenonMWTranslatorUtils").getGenericDataMessageTopic(g.dataMessageRequest))!=null?g:"undefined"}break}g=this.$4(e)?"RESPONSE":"REQUEST";e=c("ZenonMWMessageMap")[f.type];if(h==="")return a+"-"+b+"-"+e+"-"+g;else return a+"-"+b+"-"+e+"-"+g+"-"+h};b.$6=function(a){if(a.jsonPayload==null)return null;var b=a.jsonPayload.header;switch(b.type){case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.JOIN:return this.$8(a);case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.SERVER_MEDIA_UPDATE:return this.$9(a);case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.CLIENT_MEDIA_UPDATE:return this.$10(a);case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.SUBSCRIPTION:return this.$11(a);case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.ICE_CANDIDATE:return this.$12(a);default:return null}};b.$8=function(a){var b=a.jsonPayload,c=b.body;b=b.header;if(this.$4(a)){return JSON.stringify({hasAnswer:((a=c.joinResponse)==null?void 0:a.answer)!=null,hasRenegotiationOffer:((a=c.joinResponse)==null?void 0:a.renegotiationOffer)!=null,isPendingApproval:(a=c.joinResponse)==null?void 0:a.isPendingApproval,multipleVideoStreamsAllowed:(a=c.joinResponse)==null?void 0:a.multipleVideoStreamsAllowed,statusCode:b.responseStatusCode,subCode:b.responseSubCode})}return JSON.stringify({deviceCapabilities:(a=c.joinRequest)==null?void 0:a.deviceCapabilities,sdpType:((b=c.joinRequest)==null?void 0:b.offer)!=null?"offer":((a=c.joinRequest)==null?void 0:a.answer)!=null?"answer":"null",userCapabilities:(b=c.joinRequest)==null?void 0:b.userCapabilities})};b.$9=function(a){var b=a.jsonPayload,c=b.body;b=b.header;if(this.$4(a)){return JSON.stringify({currentVersion:(a=c.serverMediaUpdateResponse)==null?void 0:a.currentVersion,hasAnswer:((a=c.serverMediaUpdateResponse)==null?void 0:a.answer)!=null,statusCode:b.responseStatusCode,subCode:b.responseSubCode})}return JSON.stringify({fromVersion:(a=c.serverMediaUpdateRequest)==null?void 0:a.fromVersion,messageTags:b.messageTags,renegotiationRequested:(b=(a=c.serverMediaUpdateRequest)==null?void 0:a.renegotiationRequested)!=null?b:!1,sdpType:((a=c.serverMediaUpdateRequest)==null?void 0:a.offer)?"offer":((b=c.serverMediaUpdateRequest)==null?void 0:b.answer)?"answer":((a=c.serverMediaUpdateRequest)==null?void 0:a.update)?"delta":"empty",toVersion:(a=(b=c.serverMediaUpdateRequest)==null?void 0:b.toVersion)!=null?a:""})};b.$10=function(a){var b=a.jsonPayload,c=b.body;b=b.header;if(this.$4(a)){return JSON.stringify({currentVersion:(a=(a=c.clientMediaUpdateResponse)==null?void 0:a.currentVersion)!=null?a:"",statusCode:b.responseStatusCode,subCode:b.responseSubCode})}return JSON.stringify({fromVersion:(b=(a=c.clientMediaUpdateRequest)==null?void 0:a.fromVersion)!=null?b:"",toVersion:(b=(a=c.clientMediaUpdateRequest)==null?void 0:a.toVersion)!=null?b:""})};b.$11=function(a){var b=a.jsonPayload.body;return this.$4(a)?null:JSON.stringify({subscriptions:(b=(a=b.subscriptionRequest)==null?void 0:a.subscriptions)!=null?b:""})};b.$12=function(a){var b=a.jsonPayload.body;if(this.$4(a))return null;b=(a=b.iceCandidateRequest)==null?void 0:a.iceCandidateSdps.map(function(a){a=a.candidateSdpString;if(a!=null)return d("ZenonIceStatsParser").extractIceInfo(a)});return JSON.stringify({iceCandidates:b})};b.logSendMultiwayMessageFailure=function(a,b){(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_multiway","send_message_failure"),h.flush(),c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"Failed to send MW message of type "+b+". Error msg: "+a+":"})};return a}();b=new a();g["default"]=b}),98);
__d("ZenonMWAddRemoveParticipantsTranslator",["ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";var h="new_room_context";function a(a,b){var c={usersToInvite:b.participants};if(b.groupThreadId!=null){b={calling_tags:2,group_thread_id:b.groupThreadId};if(b){b=[{body:{genericMessage:{data:JSON.stringify(b),topic:h}},header:{topic_DEPRECATED:h}}];c.appMessages=b}}return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.ADD_PARTICIPANTS,a,{addParticipantsRequest:c})}function b(a,b){b={usersToRemove:b.participants};return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.REMOVE_PARTICIPANTS,a,{removeParticipantsRequest:b})}g.NEW_ROOM_CONTEXT=h;g.toAddParticipantsRequest=a;g.toRemoveParticipantsRequest=b}),98);
__d("ZenonMWApprovalTranslator",["ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var c=b.approvalStatus;b=b.targetUsers;c={approvalStatus:c,targetUsers:b};return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.APPROVAL,a,{approvalRequest:c})}g.toApprovalRequest=a}),98);
__d("ZenonMWClientEventTranslator",["ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b={clientEvents:[{type:b.clientEventType}]};return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.CLIENT_EVENT,a,{clientEventRequest:b})}g.toClientEventRequest=a}),98);
__d("ZenonMWClientMediaUpdateTranslator",["ZenonMWCommonUtils","ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];a=a.jsonPayload;var c=a.body;a=a.header;c=c.clientMediaUpdateResponse;var e=a.responseStatusCode,f=a.responseSubCode,g=a.retryAfterMsec;if(c){var h=c.answer,i=c.mediaStatus,j=h!=null&&i!=null;d("ZenonMWTranslatorUtils").addStateStoreSignalingEvents(c.stateStore,b,!1,j);var k=d("ZenonMWTranslatorUtils").fetchE2eeServerState(c.stateStore);if(j){h=(j=h==null?void 0:h.sdpString)!=null?j:"";j=d("ZenonMWTranslatorUtils").toZenonMediaStates(i);i={ackMessageId:a.transactionId,eventName:"localSdpResponse",hasAnswerInJoinResponse:!1,source:"clientMediaUpdate"};var l=c.renegotiationOffer,m=null;l!=null&&l.sdpString!=null&&(m={sdp:l.sdpString,type:"offer",version:d("ZenonMWCommonUtils").getSdpVersion(l.sdpString)});l={e2eeServerState:k,eventName:"remoteSdpRequest",mediaPath:c.mediaPath,mediaStates:j,negotiateType:!1,renegotiationOffer:m,sdp:{sdp:h,type:"answer",version:d("ZenonMWCommonUtils").getSdpVersion(h)},sdpOriginLocalId:c.sdpOriginLocalId,source:"clientMediaUpdateResponse"};b.push(i);b.push(l)}k={ackMessageId:a.transactionId,acknowledgedVersion:c.currentVersion,eventName:"mediaUpdateResponse",responseStatusCode:e,responseSubCode:f,retryAfter:g};b.push(k)}return b}function b(a,b,c){b={fromVersion:b.version,mediaUpdates:[{mediaStatus:d("ZenonMWTranslatorUtils").toMWMediaStatus(b),mediaStatusEx:d("ZenonMWTranslatorUtils").toMWMediaStatusEx(b)}],toVersion:b.version};c!==void 0&&(b.offer={sdpString:c.sdp});return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.CLIENT_MEDIA_UPDATE,a,{clientMediaUpdateRequest:b})}g.fromClientMediaUpdateResponse=a;g.toClientMediaUpdateRequest=b}),98);
__d("ZenonMWConferenceStateTranslator",["ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[],c=a.jsonPayload.body.conferenceStateRequest;if(c){var e=c.appMessages,f=c.participantStates,g={eventName:"participantUpdateRequest",participantStates:new Map(),sctpUserIdNodeIdMap:new Map(),versionId:c.version},h={actorRepresentatives:new Map(),eventName:"clientInfoRequest",mediaPath:d("ZenonMWMessageTypes").ZenonMWMediaPath.UNKNOWN,userCapabilities:new Map()};Object.keys(f).forEach(function(a){var b=f[a],c=b.sctpNodeId,e=b.state;b=b.userCapabilities;g.participantStates.set(a,d("ZenonMWTranslatorUtils").fromMWParticipantState(e));c!=null&&g.sctpUserIdNodeIdMap.set(a,c);h.userCapabilities.set(a,(e=b)!=null?e:"")});b.push(g);b.push(h);c=d("ZenonMWTranslatorUtils").getCollisionContextFromAppMessages(e);if(c){c.serverInfoData=a.jsonPayload.header.serverInfoData;e={context:c,eventName:"roomContextUpdateRequest"};b.push(e)}}return b}function b(a,b){b={currentVersion:b.requestVersionId};return d("ZenonMWTranslatorUtils").createMWResponse(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.CONFERENCE_STATE,a,{conferenceStateResponse:b})}g.fromConferenceStateRequest=a;g.toConferenceStateResponse=b}),98);
__d("ZenonMWDataMessageTranslator",["ZenonActorHooks","ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];a=a.jsonPayload.body.dataMessageRequest;if(a){var c=a.message.header,e=d("ZenonMWTranslatorUtils").getGenericDataMessageData(a);a=d("ZenonMWTranslatorUtils").getGenericDataMessageTopic(a);if(e!=null&&a!=null){c={data:e,eventName:"genericDataMessageRequest",recipientIDs:(e=c.recipients)!=null?e:[],serviceRecipients:(e=c.serviceRecipients)!=null?e:[],topic:a};b.push(c)}}return b}function b(a,b){var c={data:b.data,topic:b.topic};return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.DATA_MESSAGE,a,{dataMessageRequest:{message:{body:{genericMessage:c},header:{recipients:b.recipientIDs,sender:d("ZenonActorHooks").ZenonActor.getID(),serviceRecipients:b.serviceRecipients,topic_DEPRECATED:""}}}})}function c(a){return d("ZenonMWTranslatorUtils").createMWResponse(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.DATA_MESSAGE,a,{dataMessageResponse:{deliveryResult:{}}})}g.fromDataMessageRequest=a;g.toDataMessageRequest=b;g.toDataMessageResponse=c}),98);
__d("ZenonMWDismissTranslator",["ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];a=a.jsonPayload.body.dismissRequest;if(a){var c=a.detailedReasonString;a=a.reason;a={eventName:"terminateRequest",fromJoinResponse:!1,reason:d("ZenonMWTranslatorUtils").fromMWDismissReason(a),shouldInformPeer:!0,subreason:c};b.push(a)}return b}function b(a){return d("ZenonMWTranslatorUtils").createMWResponse(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.DISMISS,a,{})}g.fromDismissRequest=a;g.toDismissResponse=b}),98);
__d("ZenonMWHangupTranslator",["ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];a=a.jsonPayload.header;a={ackMessageId:a.transactionId,eventName:"hangupResponse"};b.push(a);return b}function b(a,b){b=b.reason;b={detailedReasonString:"",reason:d("ZenonMWTranslatorUtils").toMWHangupReason(b)};return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.HANGUP,a,{hangupRequest:b})}g.fromHangupResponse=a;g.toHangupRequest=b}),98);
__d("ZenonMWIceCandidateTranslator",["ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];a=a.jsonPayload.body.iceCandidateRequest;if(a){a={eventName:"iceCandidateRequest",iceCandidates:a.iceCandidateSdps.map(function(a){var b;return{candidateSdpString:(b=a.candidateSdpString)!=null?b:"",sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex}})};b.push(a)}return b}function b(a){var b=[];a=a.jsonPayload.header;a={ackMessageId:a.transactionId,eventName:"iceCandidateResponse"};b.push(a);return b}function c(a){return d("ZenonMWTranslatorUtils").createMWResponse(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.ICE_CANDIDATE,a,{})}function e(a,b){b=b.iceCandidates;b=b.map(function(a){return{candidateSdpString:a.candidateSdpString,sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex}});b={iceCandidateSdps:b};return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.ICE_CANDIDATE,a,{iceCandidateRequest:b})}g.fromIceCandidateRequest=a;g.fromIceCandidateResponse=b;g.toIceCandidateResponse=c;g.toIceCandidateRequest=e}),98);
__d("ZenonMWJoinTranslator",["MultiwaySharedTypes","RoboticsPermission","ZenonAuditedCheckpointLogId","ZenonBrowsers","ZenonDismissReason","ZenonInfraActionsLogger","ZenonJoiningContext","ZenonMWCommonUtils","ZenonMWJoinUtils","ZenonMWMessageTypes","ZenonMWTranslatorUtils","ZenonScreenShare","justknobx","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[],e=a.jsonPayload.header,f=e.responseStatusCode,g=e.responseSubCode;if(f&&f!==d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.OK){g="JOIN response status code: "+f+" subcode "+((g=g)!=null?g:"[undefined]");c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,callType:"mw",checkpoint:"[ZP] Got non-OK "+g,errorDomain:"ZenonMWMessageTranslator.fromJoinResponse"});f={detailedReasonFromMW:e.responseStatusMessage,eventName:"terminateRequest",fromJoinResponse:!0,reason:h(f,e.responseSubCode),shouldInformPeer:!1,subreason:g};b.push(f);return b}g=a.jsonPayload.body.joinResponse;if(!g)return b;f=(a=(f=g.answer)==null?void 0:f.sdpString)!=null?a:"";a=f!=="";d("ZenonMWTranslatorUtils").addStateStoreSignalingEvents(g.stateStore,b,!1,a);d("ZenonMWTranslatorUtils").maybeAddOverlayConfigServerUpdateRequest(b,e);var i=d("ZenonMWTranslatorUtils").fetchE2eeServerState(g.stateStore);e={ackMessageId:e.transactionId,eventName:"localSdpResponse",hasAnswerInJoinResponse:a,source:"joinResponse"};b.push(e);if(a){e={sdp:f,type:"answer",version:d("ZenonMWCommonUtils").getSdpVersion(f)};a=d("ZenonMWTranslatorUtils").toZenonMediaStates(g.mediaStatusEx);f=g.renegotiationOffer;var j=null;f!=null&&f.sdpString!=null&&(j={sdp:f.sdpString,type:"offer",version:d("ZenonMWCommonUtils").getSdpVersion(f.sdpString)});f={e2eeServerState:i,eventName:"remoteSdpRequest",mediaPath:g.mediaPath,mediaStates:a,negotiateType:!1,renegotiationOffer:j,sdp:e,sdpOriginLocalId:g.sdpOriginLocalId,source:"joinResponse"};b.push(f)}i={capabilities:{addParticipantEnabled:!0,cowatchEnabled:!0,cowatchGroupEnabled:!0,multipleVideoStreamsAllowed:g.multipleVideoStreamsAllowed},eventName:"capabilitiesRequest"};b.push(i);if(g.isPendingApproval){a={eventName:"pendingApprovalRequest"};b.push(a)}j=g.groupsOfUsers;var k=new Map();j.forEach(function(a){var b=a.aliasId;a=a.users;b!=null&&a.forEach(function(a){k.set(a,b)})});e={actorRepresentatives:k,eventName:"clientInfoRequest",mediaPath:g.mediaPath,userCapabilities:new Map()};b.push(e);return b}function b(a,b,e,f){var g,h=b.initialSyncStates,k=b.isSecondaryJoinRole,l=b.userCapabilities;g={clientMediaMode:j(e.mediaMode),deviceCapabilities:[(g=d("ZenonMWMessageTypes")).ZenonMWCapability.SUPPORT_NEW_PARTICIPANT_STATES,g.ZenonMWCapability.REQUIRE_FULL_SDP_IN_SMU,g.ZenonMWCapability.SUPPORT_SDP_RENEGOTIATION,g.ZenonMWCapability.REQUIRE_FULL_SDP_IN_SMU_OPTIMIZED,g.ZenonMWCapability.SUPPORT_DELTA_SMU].concat(d("ZenonBrowsers").supportsPranswer()?[d("ZenonMWMessageTypes").ZenonMWCapability.SUPPORT_PRECONNECT]:[]),mediaStatus:d("ZenonMWTranslatorUtils").toMWMediaStatus(e.mediaStates),mediaStatusEx:d("ZenonMWTranslatorUtils").toMWMediaStatusEx(e.mediaStates),offer:{},syncPayload:h?{stateStore:d("ZenonMWTranslatorUtils").toMWSyncStateStore(h)}:void 0,userCapabilities:l.get(a.userInfo.userID)};k!=null&&(g.endpointSettings={joinMode:k?d("ZenonMWMessageTypes").ZenonMWJoinMode.SECONDARY:d("ZenonMWMessageTypes").ZenonMWJoinMode.PRIMARY});h=b.isE2eeMandated===!0;g.e2eeEnforcement={infraMandatedExpStatus:(l=b.e2eeInfraMandatedExpStatus)!=null?l:d("MultiwaySharedTypes").E2eeInfraMandatedExpStatus.NOT_SET,mode:h?d("ZenonMWMessageTypes").ZenonMWE2eeMode.E2EE_MANDATED:d("ZenonMWMessageTypes").ZenonMWE2eeMode.E2EE_NOT_MANDATED};e.sdp.type==="offer"&&(g.offer={sdpString:e.sdp.sdp});d("ZenonMWJoinUtils").canUseMwpp(e.sdp.type)&&(g.deviceCapabilities.push(d("ZenonMWMessageTypes").ZenonMWCapability.SUPPORT_MWPP),e.sdp.type==="answer"&&(g.answer={sdpString:e.sdp.sdp}),d("ZenonMWJoinUtils").canDeescalate()&&g.deviceCapabilities.push(d("ZenonMWMessageTypes").ZenonMWCapability.SUPPORT_MWPP_DEESCALATION));(!d("ZenonScreenShare").screenShareWithReplaceTrack()||c("RoboticsPermission").is_authorized_robot)&&g.deviceCapabilities.push(d("ZenonMWMessageTypes").ZenonMWCapability.SUPPORT_MULTIPLE_VIDEO_STREAMS);k=f==null?void 0:f.otherParticipants;k&&(g.usersToCall=k);b=[];e=(l=f==null?void 0:f.roomInfo.context)!=null?l:a.roomInfo.context;if(e!=null){l=d("ZenonJoiningContext").convertCollisionToJoiningContext(e);h&&(l.calling_tags=2);b=[].concat(b,[{body:{genericMessage:{data:JSON.stringify(l),topic:d("ZenonJoiningContext").JOINING_CONTEXT_TOPIC}},header:{topic_DEPRECATED:d("ZenonJoiningContext").JOINING_CONTEXT_TOPIC}}])}(f==null?void 0:f.appMessages)!=null&&(b=[].concat(b,d("ZenonMWTranslatorUtils").signalingMessageAppMessagesToMWAppMessages(f.appMessages,k)));g.appMessages=b;h=d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.JOIN,a,{joinRequest:g});e&&e.serverInfoData!=null&&(h.jsonPayload.header.serverInfoData=e.serverInfoData);i(e,h.jsonPayload.header)&&(h.jsonPayload.header.conferenceType=d("ZenonMWMessageTypes").ZenonMWConferenceType.ROOM);return h}function h(a,b){if(b===d("ZenonMWMessageTypes").ZenonMWResponseSubCode.EXCEEDED_MAX_ALLOWED_PARTICIPANTS)return d("ZenonDismissReason").ZenonDismissReason.MaxAllowedParticipantsReached;if(b===d("ZenonMWMessageTypes").ZenonMWResponseSubCode.PRODUCT_SERVER_DEFINED_END_REASON)return d("ZenonDismissReason").ZenonDismissReason.ProductServerDefinedEndReason;if(b===d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CALLER_HAS_APPEALABLE_CALLING_RESTRICTION&&c("justknobx")._("4391"))return d("ZenonDismissReason").ZenonDismissReason.CallerHasAppealableCallingRestriction;switch(a){case d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.METHOD_NOT_ALLOWED:case d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.UNAUTHORIZED:return d("ZenonDismissReason").ZenonDismissReason.NoPermission;case d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.SERVICE_UNAVAILABLE:return d("ZenonDismissReason").ZenonDismissReason.SignalingMessageFailed;case d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.OK:throw c("unrecoverableViolation")("Response status code is OK; should not return a dismiss reason","rtc_www");default:c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,callType:"mw",error:"[ZP] Got unexpected JOIN response status: "+a+" subcode "+((a=b)!=null?a:"[undefined]"),errorDomain:"fromMWJoinResponseStatusToDismissReason"});return d("ZenonDismissReason").ZenonDismissReason.UnexpectedEndOfCall}}function i(a,b){return((a==null?void 0:a.peerID)!=null||(a==null?void 0:a.groupThreadID)!=null)&&b.conferenceName==null}function j(a){return a==="p2p"?d("ZenonMWMessageTypes").ZenonMWMediaPath.P2P:d("ZenonMWMessageTypes").ZenonMWMediaPath.SFU}g.fromJoinResponse=a;g.toJoinRequest=b}),98);
__d("ZenonMWPingTranslator",["ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];a=a.jsonPayload.header;a={ackMessageId:a.transactionId,eventName:"pingResponse"};b.push(a);return b}function b(a){var b=Object.freeze({});return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.PING,a,{pingRequest:b})}g.fromPingResponse=a;g.toPingRequest=b}),98);
__d("ZenonMWRingTranslator",["ZenonMWCommonUtils","ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c){if(b)return{groupThreadID:b.groupThreadId,peerID:b.peerId,serverInfoData:c};b=d("ZenonMWTranslatorUtils").getCollisionContextFromAppMessages(a);b&&(b.serverInfoData=c);return(a=b)!=null?a:{groupThreadID:null,peerID:null,serverInfoData:c}}function a(a,b){var c=[];a=a.jsonPayload;var e=a.body;a=a.header;e=e.ringRequest;if(e){var f=e.appMessages,g=e.caller,i=e.e2eeEnforcement,j=e.otherParticipants,k=e.ringType,l=e.sdpOriginLocalId,m=e.threadIdInfo;g=g;k=k===d("ZenonMWMessageTypes").ZenonMWRingType.PEER_VIDEO_CALL||k===d("ZenonMWMessageTypes").ZenonMWRingType.GROUP_VIDEO_CALL||k===d("ZenonMWMessageTypes").ZenonMWRingType.LIVE_STREAM||k===d("ZenonMWMessageTypes").ZenonMWRingType.PEER_ESCALATED_AUDIO_CALL;var n=a.conferenceName;a=a.serverInfoData;m=h(f,m,a);var o=d("ZenonMWTranslatorUtils").getRoomMetadataFromAppMessages(f);g={actorID:b.actorID,e2eeInfraMandatedExpStatus:i==null?void 0:i.infraMandatedExpStatus,eventName:"inviteRequest",inviterID:g,isE2eeMandated:(i==null?void 0:i.mode)===d("ZenonMWMessageTypes").ZenonMWE2eeMode.E2EE_MANDATED,isRemoteOfferer:!1,otherParticipants:j,requestingVideo:k,roomInfo:babelHelpers["extends"]({context:m,name:n},o==null?{}:{room:o,sender:o.sender}),serverInfoData:a,userID:b.userInfo.userID};f!=null&&(g.appMessages=d("ZenonMWTranslatorUtils").mwAppMessagesToSignalingAppMessages(f));c.push(g);k=(j=(i=e.offer)==null?void 0:i.sdpString)!=null?j:"";n=(m=e.mediaStatusEx)!=null?m:null;if(k!==""&&n!=null){o={sdp:k,type:"offer",version:d("ZenonMWCommonUtils").getSdpVersion(k)};a=d("ZenonMWTranslatorUtils").toZenonMediaStates(n);b={eventName:"remoteSdpRequest",mediaPath:e.mediaPath,mediaStates:a,negotiateType:!1,sdp:o,sdpOriginLocalId:l,source:"ringRequest"};c.push(b)}}return c}function b(a,b){b=b.status;b==="IN_ANOTHER_CALL"&&(a.signalingID=null);b=d("ZenonMWTranslatorUtils").toMWDeviceStatus(b);b={deviceCapabilities:[d("ZenonMWMessageTypes").ZenonMWCapability.SUPPORT_AUDIO_DEPRECATED,d("ZenonMWMessageTypes").ZenonMWCapability.SUPPORT_VIDEO_DEPRECATED],deviceStatus:b};return d("ZenonMWTranslatorUtils").createMWResponse(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.RING,a,{ringResponse:b})}g.fromRingRequest=a;g.toRingResponse=b}),98);
__d("ZenonMWServerMediaUpdateTranslator",["FBLogger","ZenonAuditedCheckpointLogId","ZenonBrowsers","ZenonInfraActionsLogger","ZenonMWCommonUtils","ZenonMWMessageReliabilityLogger","ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[],e=a.jsonPayload,f=e.body;e=e.header;f=f.serverMediaUpdateRequest;var g=e.messageTags,i=e.transactionId;if(!f)return b;var j=f.answer,k=f.fromVersion,l=f.mediaPath,m=f.mediaStatus,n=f.multipleVideoStreamsAllowed,o=f.offer,p=f.prAnswer,q=f.renegotiationRequested,r=f.sdpOriginLocalId,s=f.stateStore,t=f.toVersion;f=f.update;o=(o=o==null?void 0:o.sdpString)!=null?o:"";j=(j=j==null?void 0:j.sdpString)!=null?j:"";p=(p=p==null?void 0:p.sdpString)!=null?p:"";var u=function(){d("ZenonMWMessageReliabilityLogger").logProcessedMessage(a)},v=o!=="",w=j!=="",x=d("ZenonBrowsers").supportsPranswer()&&p!=="",y=f!==null;y=v||w||x||y;d("ZenonMWTranslatorUtils").addStateStoreSignalingEvents(s,b,!1,y);y=d("ZenonMWTranslatorUtils").fetchE2eeServerState(s);if(q){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"SMU type 1: renegotationRequested"});q={ackMessageId:i,eventName:"initiateRenegotiationRequest",fromVersion:k,hasRemoteOffer:o!=="",mediaPath:l,messageTags:(s=g)!=null?s:[],onProcessed:u,version:t};b.push(q);if(v){s=h(i,k,l,m,{sdp:o,type:"offer",version:d("ZenonMWCommonUtils").getSdpVersion(o)},r,u,g,y);b.push(s)}}else if(w){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"SMU type 2: answer SDP"});q=h(i,k,l,m,{sdp:j,type:"answer",version:d("ZenonMWCommonUtils").getSdpVersion(j)},r,u,g,y);if(q.sdp.sdp!=null&&d("ZenonMWCommonUtils").isUnifiedPlan(q.sdp.sdp)){s={sdp:j,type:"offer",version:d("ZenonMWCommonUtils").getSdpVersion(j)};q.renegotiationOffer=s}b.push(q)}else if(v){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"SMU type 3: offer SDP"});w=h(i,k,l,m,{sdp:o,type:"offer",version:d("ZenonMWCommonUtils").getSdpVersion(o)},r,u,g,y);b.push(w)}else if(f){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"SMU type 4: delta SDP"});j=h(i,k,l,m,{type:"offer",update:f,version:t},r,u,g,y);b.push(j)}else if(x){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"SMU type 5: prAnswer SDP"});s=h(i,k,l,m,{sdp:p,type:"pranswer",version:d("ZenonMWCommonUtils").getSdpVersion(p)},r,u,g,y);b.push(s)}else if(m){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"SMU type 6: media update"});v={ackMessageId:i,eventName:"mediaUpdateRequest",mediaStates:d("ZenonMWTranslatorUtils").toZenonMediaStates(m,k,t),messageTags:(q=g)!=null?q:[],onProcessed:u};b.push(v)}else{o="Warning: unsupported SMU type. TXID: "+i;c("FBLogger")("rpweb").warn(o);c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,error:o,errorDomain:"ZenonMWServerMediaUpdateTranslator"})}d("ZenonMWTranslatorUtils").maybeAddOverlayConfigServerUpdateRequest(b,e);f={capabilities:{multipleVideoStreamsAllowed:n},eventName:"capabilitiesRequest",messageTags:(w=g)!=null?w:[]};b.push(f);return b}function h(a,b,c,e,f,g,h,i,j){return{ackMessageId:a,e2eeServerState:j,eventName:"remoteSdpRequest",fromVersion:b,mediaPath:c,mediaStates:d("ZenonMWTranslatorUtils").toZenonMediaStates(e),messageTags:(a=i)!=null?a:[],negotiateType:!1,onProcessed:h,sdp:f,sdpOriginLocalId:g,source:"serverMediaUpdateRequest"}}function b(a,b,c,e){return i(a,b.acknowledgedVersion,d("ZenonMWTranslatorUtils").toMWResponseStatusCode(b.statusCode),d("ZenonMWTranslatorUtils").toMWResponseStatusSubCode(b.subCode),c,e)}function e(a,b){return i(a,b.acknowledgedVersion,d("ZenonMWTranslatorUtils").toMWResponseStatusCode(b.statusCode),d("ZenonMWTranslatorUtils").toMWResponseStatusSubCode(b.subCode))}function f(a,b){return i(a,b.acknowledgedVersion,(a=b.responseStatusCode)!=null?a:d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.CONDITIONAL_REQUEST_FAILED,b.responseSubCode)}function i(a,b,c,e,f,g){b={currentVersion:b};f&&(b.mediaStatus=d("ZenonMWTranslatorUtils").toMWClientMediaStatus(f));g&&(b.answer={sdpString:g.sdp});return d("ZenonMWTranslatorUtils").createMWResponse(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.SERVER_MEDIA_UPDATE,a,{serverMediaUpdateResponse:b},c,e)}g.fromServerMediaUpdateRequest=a;g.toServerMediaUpdateResponse=b;g.toServerMediaUpdateRenegotiationResponse=e;g.toServerMediaUpdateNoSdpResponse=f}),98);
__d("ZenonMWStateSyncTranslator",["RequestStreamBodyUtils","ZenonMWMessageTypes","ZenonMWTranslatorUtils","ZenonStateSyncPayloadSerializer"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=a.jsonPayload;var b=a.body.updateResponse;a=a.header.transactionId;if(!b)return[];var c=b.topic;b=b.version;a={ackMessageId:a,eventName:"stateSyncUpdateResponse",topic:c,version:b};return[a]}function b(a){a=a.jsonPayload.body.notifyRequest;if(!a)return[];var b=[];if(a.syncPayload!=null)d("ZenonMWTranslatorUtils").addStateStoreSignalingEvents(a.syncPayload.stateStore,b,!0,!1);else{var c=a.data,e=a.topic;a=a.version;c={data:d("ZenonStateSyncPayloadSerializer").stateSyncStringToUint8Array(c),eventName:"stateSyncNotifyRequest",responseRequired:!0,topic:e,version:a};b.push(c)}return b}function c(a){a=a.jsonPayload;var b=a.body.unsubscribeResponse;a=a.header.transactionId;if(!b)return[];var c=b.topic;b=b.version;a={ackMessageId:a,eventName:"stateSyncUnsubscribeResponse",topic:c,version:b};return[a]}function e(a,b){var c=b.data,e=b.topic;b=b.version;c={data:c?d("RequestStreamBodyUtils").uint8ArrayToBase64(c):void 0,topic:e,version:b};return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.UPDATE,a,{updateRequest:c})}function f(a,b){var c=b.topic;b=b.version;c={topic:c,version:b};return d("ZenonMWTranslatorUtils").createMWResponse(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.NOTIFY,a,{notifyResponse:c})}function h(a,b){var c=b.topic;b=b.version;c={topic:c,version:b};return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.UNSUBSCRIBE,a,{unsubscribeRequest:c})}g.fromUpdateResponse=a;g.fromNotifyRequest=b;g.fromUnsubscribeResponse=c;g.toUpdateRequest=e;g.toNotifyResponse=f;g.toUnsubscribeRequest=h}),98);
__d("ZenonMWSubscriptionTranslator",["ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b=b.subscriptions;b={subscriptions:b};return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.SUBSCRIPTION,a,{subscriptionRequest:b})}g.toSubscriptionRequest=a}),98);
__d("ZenonMWWakeupTranslator",["ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];a=a.jsonPayload.header;a={ackMessageId:a.transactionId,eventName:"wakeupRequest"};b.push(a);return b}function b(a){var b=Object.freeze({});return d("ZenonMWTranslatorUtils").createMWResponse(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.WAKEUP,a,{wakeupResponse:b})}g.fromWakeupRequest=a;g.toWakeupResponse=b}),98);
__d("ZenonMWMessageTranslator",["FBLogger","ZenonActorHooks","ZenonMWAddRemoveParticipantsTranslator","ZenonMWApprovalTranslator","ZenonMWClientEventTranslator","ZenonMWClientMediaUpdateTranslator","ZenonMWConferenceStateTranslator","ZenonMWDataMessageTranslator","ZenonMWDismissTranslator","ZenonMWHangupTranslator","ZenonMWIceCandidateTranslator","ZenonMWJoinTranslator","ZenonMWMessageTypes","ZenonMWPingTranslator","ZenonMWRingTranslator","ZenonMWServerMediaUpdateTranslator","ZenonMWStateSyncTranslator","ZenonMWSubscriptionTranslator","ZenonMWTranslatorUtils","ZenonMWWakeupTranslator","ZenonSignalingMessage","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.getHeader();a=a.getEvents();if(a.length===0)throw c("unrecoverableViolation")("Unexpected Translation: called toMWMessage with empty signaling events","rtc_www");else{var e=a[0];switch(e.eventName){case"addParticipantsRequest":return d("ZenonMWAddRemoveParticipantsTranslator").toAddParticipantsRequest(b,e);case"clientEventRequest":return d("ZenonMWClientEventTranslator").toClientEventRequest(b,e);case"clientInfoRequest":if(a.length>=2&&a[1].eventName==="localSdpRequest"&&(a[1].sdp.type==="offer"||a[1].sdp.type==="answer"))return d("ZenonMWJoinTranslator").toJoinRequest(b,e,a[1]);break;case"genericDataMessageRequest":return d("ZenonMWDataMessageTranslator").toDataMessageRequest(b,e);case"inviteRequest":if(a.length>=3&&a[1].eventName==="clientInfoRequest"&&a[2].eventName==="localSdpRequest"&&a[2].sdp.type==="offer")return d("ZenonMWJoinTranslator").toJoinRequest(b,a[1],a[2],e);break;case"genericDataMessageResponse":return d("ZenonMWDataMessageTranslator").toDataMessageResponse(b);case"inviteResponse":return d("ZenonMWRingTranslator").toRingResponse(b,e);case"dismissResponse":return d("ZenonMWDismissTranslator").toDismissResponse(b);case"initiateRenegotiationResponse":if(a.length>=3&&a[1].eventName==="remoteSdpResponse"&&a[2].eventName==="localSdpRequest"&&a[2].sdp.type==="answer")return d("ZenonMWServerMediaUpdateTranslator").toServerMediaUpdateResponse(b,a[1],a[2].mediaStates,a[2].sdp);else return d("ZenonMWServerMediaUpdateTranslator").toServerMediaUpdateRenegotiationResponse(b,e);case"iceCandidateRequest":return d("ZenonMWIceCandidateTranslator").toIceCandidateRequest(b,e);case"iceCandidateResponse":return d("ZenonMWIceCandidateTranslator").toIceCandidateResponse(b);case"localSdpRequest":return d("ZenonMWClientMediaUpdateTranslator").toClientMediaUpdateRequest(b,e.mediaStates,e.sdp);case"mediaUpdateRequest":return d("ZenonMWClientMediaUpdateTranslator").toClientMediaUpdateRequest(b,e.mediaStates);case"mediaUpdateResponse":return d("ZenonMWServerMediaUpdateTranslator").toServerMediaUpdateNoSdpResponse(b,e);case"participantUpdateResponse":return d("ZenonMWConferenceStateTranslator").toConferenceStateResponse(b,e);case"pingRequest":return d("ZenonMWPingTranslator").toPingRequest(b);case"remoteSdpResponse":return e.type==="offer"&&(a.length>=2&&a[1].eventName==="localSdpRequest"&&a[1].sdp.type==="answer")?a[1].mediaMode!=="p2p"?d("ZenonMWServerMediaUpdateTranslator").toServerMediaUpdateResponse(b,e,a[1].mediaStates):d("ZenonMWServerMediaUpdateTranslator").toServerMediaUpdateResponse(b,e,a[1].mediaStates,a[1].sdp):d("ZenonMWServerMediaUpdateTranslator").toServerMediaUpdateResponse(b,e);case"removeParticipantsRequest":return d("ZenonMWAddRemoveParticipantsTranslator").toRemoveParticipantsRequest(b,e);case"stateSyncNotifyResponse":return d("ZenonMWStateSyncTranslator").toNotifyResponse(b,e);case"stateSyncUnsubscribeRequest":return d("ZenonMWStateSyncTranslator").toUnsubscribeRequest(b,e);case"stateSyncUpdateRequest":return d("ZenonMWStateSyncTranslator").toUpdateRequest(b,e);case"subscriptionRequest":return d("ZenonMWSubscriptionTranslator").toSubscriptionRequest(b,e);case"terminateRequest":return d("ZenonMWHangupTranslator").toHangupRequest(b,e);case"usersApprovalRequest":return d("ZenonMWApprovalTranslator").toApprovalRequest(b,e);case"wakeupResponse":return d("ZenonMWWakeupTranslator").toWakeupResponse(b)}}return null}function b(a){var b=a.jsonPayload.header,e=h(b);if(e!=null){c("FBLogger")("rtc_www").info("Ignoring JSON MW message; receiver does not match self ID: "+e,"rtc_www");return null}e=b.type;var f=b.responseStatusCode==null;b=d("ZenonMWTranslatorUtils").mwMessageHeaderToSignalingMessageHeader(b);var g=[];switch(e){case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.RING:f&&(g=d("ZenonMWRingTranslator").fromRingRequest(a,b));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.DISMISS:f&&(g=d("ZenonMWDismissTranslator").fromDismissRequest(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.JOIN:f||(g=d("ZenonMWJoinTranslator").fromJoinResponse(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.ICE_CANDIDATE:f?g=d("ZenonMWIceCandidateTranslator").fromIceCandidateRequest(a):g=d("ZenonMWIceCandidateTranslator").fromIceCandidateResponse(a);break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.CONFERENCE_STATE:f&&(g=d("ZenonMWConferenceStateTranslator").fromConferenceStateRequest(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.CLIENT_MEDIA_UPDATE:f||(g=d("ZenonMWClientMediaUpdateTranslator").fromClientMediaUpdateResponse(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.SERVER_MEDIA_UPDATE:f&&(g=d("ZenonMWServerMediaUpdateTranslator").fromServerMediaUpdateRequest(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.PING:f||(g=d("ZenonMWPingTranslator").fromPingResponse(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.HANGUP:f||(g=d("ZenonMWHangupTranslator").fromHangupResponse(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.DATA_MESSAGE:f&&(g=d("ZenonMWDataMessageTranslator").fromDataMessageRequest(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.UPDATE:f||(g=d("ZenonMWStateSyncTranslator").fromUpdateResponse(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.UNSUBSCRIBE:f||(g=d("ZenonMWStateSyncTranslator").fromUnsubscribeResponse(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.NOTIFY:f&&(g=d("ZenonMWStateSyncTranslator").fromNotifyRequest(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.WAKEUP:f&&(g=d("ZenonMWWakeupTranslator").fromWakeupRequest(a))}return new(c("ZenonSignalingMessage"))(b,g)}function h(a){var b,c=a.receiverUserId;if(d("ZenonActorHooks").ZenonActor.isInstagramUser()||d("ZenonActorHooks").ZenonActor.isOculusUser()||c==null)return null;if(c===d("ZenonActorHooks").ZenonActor.getID()||((b=a.receiver)==null?void 0:b.baseId)===d("ZenonActorHooks").ZenonActor.getAccountID())return null;if(c!==d("ZenonActorHooks").ZenonActor.getID()&&((b=a.receiver)==null?void 0:b.baseId)==null)return"receiverUserId mismatch and missing header.receiver.baseId";return c!==d("ZenonActorHooks").ZenonActor.getID()&&((b=a.receiver)==null?void 0:b.baseId)!==d("ZenonActorHooks").ZenonActor.getAccountID()?"receiverUserId mismatch and mismatched header.receiver.baseId":"unknown error"}g.toMWMessage=a;g.toSignalingMessage=b}),98);
__d("SCTPSignalingListener",["FBLogger","ZenonMWMessageDebugLogger","ZenonMWMessageReliabilityLogger","ZenonMWMessageTranslator","ZenonSCTPConstants","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$1=a}var b=a.prototype;b.setLoggingEventHandler=function(a){this.$2=a};b.subscribe=function(a){if(this.$3!=null)return;this.$3=this.$4(a);c("promiseDone")(this.$1.createDataMessageSubscription(d("ZenonSCTPConstants").SCTP_SIGNALING_TOPIC,this.$3))};b.unsubscribe=function(){if(this.$3==null)return;c("promiseDone")(this.$1.removeDataMessageSubscription(d("ZenonSCTPConstants").SCTP_SIGNALING_TOPIC,this.$3));this.$3=null};b.$4=function(a){return function(b){try{b=JSON.parse(b.message);b=atob(b.signalingMessagePayload);b=JSON.parse(b);b={endpoint:b.endpoint,jsonPayload:{body:b.body,header:b.header}};d("ZenonMWMessageReliabilityLogger").logReceivedMessage(b);c("ZenonMWMessageDebugLogger").logMWMessage("RECEIVED","SCTP",b);var e=d("ZenonMWMessageTranslator").toSignalingMessage(b);if(e==null)return;a(e);d("ZenonMWMessageReliabilityLogger").logProcessingMessage(b)}catch(a){c("FBLogger")("rpweb").catching(a).warn("Error receiving SCTP message from Signaling Listener")}}};return a}();g["default"]=a}),98);
__d("ZenonChildClientPerfQPLLogProcessor",["Promise","QuickPerformanceLogger","ZenonCallInfoManager","ZenonClientPerfQPLConstants","ZenonDismissReason","performanceNow","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;a=function(){function a(a){var b=a.data;a=a.isE2eeMandated;this.$4=c("qpl")._(41156609,"943");this.$3=new(c("ZenonCallInfoManager"))(b);this.$1=b.signalingID;this.$2=a}var e=a.prototype;e.processEvent=function(a){switch(a.name){case"updateLogIdentifiers":a.logIdentifiers.localCallID!=null&&(this.$3.setLocalCallID(a.logIdentifiers.localCallID),(j||(j=c("QuickPerformanceLogger"))).markerAnnotate(this.$4,{string:{local_call_id:a.logIdentifiers.localCallID}},{instanceKey:+this.$1}));break;case"setRemoteSignalingID":this.$3.setSharedCallId(a.remoteSignalingID);(j||(j=c("QuickPerformanceLogger"))).markerAnnotate(this.$4,{string:{shared_call_id:a.remoteSignalingID}},{instanceKey:+this.$1});break;case"callJoinRequest":this.$6();break;case"connectionStart":this.$7(this.$4===c("qpl")._(41156609,"943")?d("ZenonClientPerfQPLConstants").POINT_CONNECTION_OUTGOING_START:d("ZenonClientPerfQPLConstants").POINT_CONNECTION_INCOMING_CONNECTION_STARTED);break;case"inviteSent":this.$7(d("ZenonClientPerfQPLConstants").POINT_CONNECTION_INVITE_SENT);break;case"mwMessageSent":a.mwMessage.jsonPayload.body.joinRequest&&this.$7(d("ZenonClientPerfQPLConstants").POINT_SIGNALING_MW_JOIN_REQ_SENT);break;case"mwThriftMessageSent":a.mwThriftMessage.messageBody.joinRequest&&this.$7(d("ZenonClientPerfQPLConstants").POINT_SIGNALING_MW_JOIN_REQ_SENT);break;case"mwMessageRecv":a.mwMessage.jsonPayload.body.joinResponse&&this.$7(d("ZenonClientPerfQPLConstants").POINT_SIGNALING_MW_JOIN_RESPONSE_RECV);break;case"mwThriftMessageRecv":a.mwThriftMessage.messageBody.joinResponse&&this.$7(d("ZenonClientPerfQPLConstants").POINT_SIGNALING_MW_JOIN_RESPONSE_RECV);break;case"atLeastOneParticipantAlerted":this.$7(d("ZenonClientPerfQPLConstants").POINT_CONNECTION_INVITE_ACK_RECV);break;case"atLeastOneParticipantAnswered":this.$7(d("ZenonClientPerfQPLConstants").POINT_CONNECTION_ANSWER_RECV);break;case"answerSdpReceived":this.$7(d("ZenonClientPerfQPLConstants").POINT_CONNECTION_ANSWER_SDP_RECV);break;case"prAnswerSdpReceived":this.$7(d("ZenonClientPerfQPLConstants").POINT_CONNECTION_PRANSWER_SDP_RECV);break;case"offerSdpReceived":this.$7(d("ZenonClientPerfQPLConstants").POINT_CONNECTION_OFFER_SDP_RECV);break;case"answerSent":this.$7(d("ZenonClientPerfQPLConstants").POINT_CONNECTION_ANSWER_SENT);break;case"peerConnectionManagerCreated":this.$7(d("ZenonClientPerfQPLConstants").POINT_MEDIA_PEER_CONNECTION_FACTORY_CREATED);break;case"negotiationComplete":this.$7(d("ZenonClientPerfQPLConstants").POINT_CONNECTION_NEGOTIATION_COMPLETE);break;case"mediaConnected":this.$7(d("ZenonClientPerfQPLConstants").POINT_CONNECTION_NETWORK_READY);break;case"connectionReady":this.$7(d("ZenonClientPerfQPLConstants").POINT_CONNECTION_READY);break;case"firstMediaPacketSent":a.type==="audio"?this.$7(d("ZenonClientPerfQPLConstants").POINT_MEDIA_FIRST_AUDIO_PACKET_SENT):this.$7(d("ZenonClientPerfQPLConstants").POINT_MEDIA_FIRST_VIDEO_PACKET_SENT);break;case"firstMediaPacketReceived":a.type==="audio"?this.$7(d("ZenonClientPerfQPLConstants").POINT_MEDIA_FIRST_AUDIO_PACKET):this.$7(d("ZenonClientPerfQPLConstants").POINT_MEDIA_FIRST_VIDEO_PACKET);break;case"sfuE2eeNegotiationComplete":this.$7(d("ZenonClientPerfQPLConstants").POINT_ZENON_SFU_E2EE_NEGOTIATION_COMPLETE);break;case"dismissSent":this.$7(d("ZenonClientPerfQPLConstants").POINT_CONNECTION_DISMISS_SENT);break;case"dismissRecv":this.$7(d("ZenonClientPerfQPLConstants").POINT_CONNECTION_DISMISS_RECV);break;case"callEnded":(j||(j=c("QuickPerformanceLogger"))).markerAnnotate(this.$4,{string:{endCallReason:d("ZenonDismissReason").ZenonDismissReason.getName(a.endCallReason),endCallSubreason:a.endCallSubreason}},{instanceKey:+this.$1});(j||(j=c("QuickPerformanceLogger"))).markerEnd(this.$4,2,+this.$1,this.$8());break}return(h||(h=b("Promise"))).resolve()};e.$6=function(){var a=(j||(j=c("QuickPerformanceLogger"))).getMarker(c("qpl")._(41156610,"2039"),+this.$1),b=a==null?void 0:a.points.find(function(a){return a.name===d("ZenonClientPerfQPLConstants").POINT_ZENON_POPUP_OPENED});if(!a||!b){this.$4=c("qpl")._(41156609,"943");this.$5=null;var e=this.$3.getCallInfo(),f=e.deviceID,g=e.localCallID;e=e.serverInfoData;(j||(j=c("QuickPerformanceLogger"))).markerStartFromNavStart(c("qpl")._(41156609,"943"),+this.$1);j.markerAnnotate(this.$4,{bool:{isE2eeMandated:this.$2},"int":{signaling_id:+this.$1},string:{device_id:f,local_call_id:g,shared_call_id:e}},{instanceKey:+this.$1})}else this.$4=c("qpl")._(41156610,"2039"),this.$5=b.timeSinceStart+a.timestamp;this.$7(d("ZenonClientPerfQPLConstants").POINT_ZENON_CALL_JOIN_REQUEST)};e.$7=function(a){(j||(j=c("QuickPerformanceLogger"))).markerPoint(this.$4,a,{instanceKey:+this.$1,timestamp:this.$8()})};e.$8=function(){return this.$5==null?(j||(j=c("QuickPerformanceLogger"))).currentTimestamp():this.$5+(i||(i=c("performanceNow")))()};return a}();e={LogProcessor:a};g.ZenonChildClientPerfQPLLogProcessor=a;g.ZenonChildClientPerfQPLLogProcessorConfig=e}),98);
__d("ZenonChildQPLLogProcessor",["Promise","QPLUserFlow","QuickPerformanceLogger","ZenonDismissReason","ZenonE2eeMandatedStateManager","ZenonInfraActionsLogger","performanceNavigationStart","performanceNow","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;a=function(){function a(a){var b=a.data;a=a.isE2eeMandated;this.$7=!1;this.$8=!1;this.$9=!1;this.$10=!1;this.$11=!1;this.$12=!1;this.$13=!1;this.$1=b.localCallID;this.$2=b.serverInfoData;this.$3=b.signalingID;this.$4=a;this.$5=b.appID}var e=a.prototype;e.processEvent=function(a){switch(a.name){case"updateLogIdentifiers":a.logIdentifiers.localCallID!=null&&(this.$1=a.logIdentifiers.localCallID,(j||(j=c("QuickPerformanceLogger"))).markerAnnotate(c("qpl")._(398997251,"1544"),{string:{appID:this.$5,localCallID:a.logIdentifiers.localCallID}},{instanceKey:+this.$3}));break;case"callJoinRequest":this.$7=a.hasOfferInRingRequest;c("QPLUserFlow").start(c("qpl")._(64232269,"6493"),{annotations:{bool:{isCaller:a.isCaller,isE2eeMandated:this.$4}}});var e=(j||(j=c("QuickPerformanceLogger"))).getMarker(c("qpl")._(398997251,"1544"),+this.$3);if(!e)c("QPLUserFlow").start(c("qpl")._(398997251,"1544"),{annotations:{bool:{isE2eeInfraMandated:c("ZenonE2eeMandatedStateManager").isInfraE2eeMandated(),isE2eeMandated:this.$4},string:{appID:this.$5,cameraPermission:a.cameraPermission,localCallID:this.$1,microphonePermission:a.microphonePermission,serverInfoData:this.$2}},instanceKey:+this.$3}),this.$6=null;else{(j||(j=c("QuickPerformanceLogger"))).markerAnnotate(c("qpl")._(398997251,"1544"),{string:{cameraPermission:a.cameraPermission,microphonePermission:a.microphonePermission}},{instanceKey:+this.$3});var f=e.points.find(function(a){return a.name==="popup_opened"});if(f){var g=c("performanceNavigationStart")();this.$6=f.timeSinceStart+e.timestamp;c("ZenonInfraActionsLogger").logCheckpoint({checkpoint:"popup_opened to child window navStart: "+(g-this.$6)})}}c("QPLUserFlow").addPoint(c("qpl")._(398997251,"1544"),"call_join_request",{instanceKey:+this.$3,timestamp:this.$14()});c("QPLUserFlow").addAnnotations(c("qpl")._(398997251,"1544"),{bool:{isCaller:a.isCaller}},{instanceKey:+this.$3});this.$15();break;case"inviteSent":this.$8=!0;c("QPLUserFlow").addPoint(c("qpl")._(64232269,"6493"),"invite_sent");c("QPLUserFlow").addPoint(c("qpl")._(398997251,"1544"),"invite_sent",{instanceKey:+this.$3,timestamp:this.$14()});this.$15();break;case"setRemoteSignalingID":c("QPLUserFlow").addPoint(c("qpl")._(64232269,"6493"),"set_remote_signaling_id");c("QPLUserFlow").addPoint(c("qpl")._(398997251,"1544"),"set_remote_signaling_id",{instanceKey:+this.$3,timestamp:this.$14()});c("QPLUserFlow").addAnnotations(c("qpl")._(398997251,"1544"),{string:{serverInfoData:a.remoteSignalingID}},{instanceKey:+this.$3});break;case"inviteResponseReceived":c("QPLUserFlow").addPoint(c("qpl")._(64232269,"6493"),"invite_response_received");c("QPLUserFlow").addPoint(c("qpl")._(398997251,"1544"),"invite_response_received",{instanceKey:+this.$3,timestamp:this.$14()});break;case"inviteResponseProcessed":c("QPLUserFlow").addPoint(c("qpl")._(64232269,"6493"),"invite_response_processed");c("QPLUserFlow").addPoint(c("qpl")._(398997251,"1544"),"invite_response_processed",{instanceKey:+this.$3,timestamp:this.$14()});break;case"setHasAnswerInJoinResponse":this.$9=a.hasAnswerInJoinResponse;this.$15();break;case"atLeastOneParticipantAnswered":c("QPLUserFlow").addPoint(c("qpl")._(398997251,"1544"),"at_least_one_participant_answered",{instanceKey:+this.$3,timestamp:this.$14()});break;case"setRemoteSdpAnswer":c("QPLUserFlow").addPoint(c("qpl")._(64232269,"6493"),"set_remote_sdp_answer");c("QPLUserFlow").addPoint(c("qpl")._(398997251,"1544"),"set_remote_sdp_answer",{instanceKey:+this.$3,timestamp:this.$14()});break;case"mediaConnected":c("QPLUserFlow").addPoint(c("qpl")._(64232269,"6493"),"media_connected");c("QPLUserFlow").addPoint(c("qpl")._(398997251,"1544"),"media_connected",{instanceKey:+this.$3,timestamp:this.$14()});break;case"callConnected":c("QPLUserFlow").addPoint(c("qpl")._(64232269,"6493"),"call_connected");c("QPLUserFlow").addPoint(c("qpl")._(398997251,"1544"),"call_connected",{instanceKey:+this.$3,timestamp:this.$14()});break;case"setRemoteSdpOffer":c("QPLUserFlow").addPoint(c("qpl")._(64232269,"6493"),"set_remote_sdp_offer");c("QPLUserFlow").addPoint(c("qpl")._(398997251,"1544"),"set_remote_sdp_offer",{instanceKey:+this.$3,timestamp:this.$14()});break;case"firstMediaPacketReceived":this.$13||(c("QPLUserFlow").addPoint(c("qpl")._(398997251,"1544"),"first_"+a.type+"_packet",{instanceKey:+this.$3,timestamp:this.$14()}),this.$13=!0,c("QPLUserFlow").endSuccess(c("qpl")._(398997251,"1544"),{instanceKey:+this.$3,timestamp:this.$14()}));break;case"sfuE2eeNegotiationComplete":c("QPLUserFlow").addPoint(c("qpl")._(64232269,"6493"),"sfu_e2ee_negotiation_complete");c("QPLUserFlow").addPoint(c("qpl")._(398997251,"1544"),"sfu_e2ee_negotiation_complete",{instanceKey:+this.$3,timestamp:this.$14()});break;case"e2eeComponentCreated":c("QPLUserFlow").addPoint(c("qpl")._(64232269,"6493"),"e2ee_component_created");c("QPLUserFlow").addPoint(c("qpl")._(398997251,"1544"),"e2ee_component_created",{instanceKey:+this.$3,timestamp:this.$14()});c("QPLUserFlow").addAnnotations(c("qpl")._(398997251,"1544"),{bool:{isE2eeStackReady:a.isE2eeStackReady}},{instanceKey:+this.$3});break;case"callEscalated":this.$10=!0;c("QPLUserFlow").addPoint(c("qpl")._(64232269,"6493"),"renegotion_cmu_request_sent");c("QPLUserFlow").addPoint(c("qpl")._(398997251,"1544"),"renegotion_cmu_request_sent",{instanceKey:+this.$3,timestamp:this.$14()});this.$15();break;case"renegotiationSmuReqWithAnswerReceived":this.$11=!0;c("QPLUserFlow").addPoint(c("qpl")._(64232269,"6493"),"renegotation_smu_request_with_answer_received");c("QPLUserFlow").addPoint(c("qpl")._(398997251,"1544"),"renegotation_smu_request_with_answer_received",{instanceKey:+this.$3,timestamp:this.$14()});this.$15();break;case"renegotiationSmuReqWithOfferReceived":this.$12=!0;c("QPLUserFlow").addPoint(c("qpl")._(64232269,"6493"),"renegotation_smu_request_with_offer_received");c("QPLUserFlow").addPoint(c("qpl")._(398997251,"1544"),"renegotation_smu_request_with_offer_received",{instanceKey:+this.$3,timestamp:this.$14()});this.$15();break;case"callEnded":c("QPLUserFlow").endSuccess(c("qpl")._(64232269,"6493"));c("QPLUserFlow").endCancel(c("qpl")._(398997251,"1544"),{annotations:{string:{endCallReason:d("ZenonDismissReason").ZenonDismissReason.getName(a.endCallReason),endCallSubreason:a.endCallSubreason}},instanceKey:+this.$3,timestamp:this.$14()});break}return(h||(h=b("Promise"))).resolve()};e.$15=function(){var a="sfu";this.$11||this.$12?a="deescalated_from_sfu_to_p2p":this.$10?a="escalated_from_p2p_to_sfu":(!this.$9||this.$7&&!this.$8)&&(a="p2p");c("QPLUserFlow").addAnnotations(c("qpl")._(64232269,"6493"),{string:{mediaPath:a}});c("QPLUserFlow").addAnnotations(c("qpl")._(398997251,"1544"),{string:{mediaPath:a}},{instanceKey:+this.$3})};e.$14=function(){return this.$6!=null?this.$6+(i||(i=c("performanceNow")))():(j||(j=c("QuickPerformanceLogger"))).currentTimestamp()};return a}();e={LogProcessor:a};g.ZenonChildQPLLogProcessor=a;g.ZenonChildQPLLogProcessorConfig=e}),98);
__d("ZenonLSCallStartEventLogProcessor",["DateConsts","ZenonInfraActionsLogger","ZenonLSCallStartEventManager","ZenonLSCallStartEventStore","ZenonPeerID"],(function(a,b,c,d,e,f,g){"use strict";var h=10*d("DateConsts").MS_PER_SEC;a=function(){function a(a){var b=a.data;a=a.updateLogIdentifiers;this.$2=null;this.$3=!1;this.$4=!1;b.peerID=d("ZenonPeerID").ZenonMWPeerID;this.$6=a;this.$5=b.peerID;var e=d("ZenonLSCallStartEventStore").ZenonLSCallStartEventStoreInstance.retrieveCallStartEventManager(b.peerID,b.signalingID);e?this.$1=e:this.$1=new(c("ZenonLSCallStartEventManager"))(b);a&&a({localCallID:this.$1.getCallInfo().localCallID})}var b=a.prototype;b.log=function(){if(this.$4)return;this.$4=!0;this.$1.delete(d("ZenonLSCallStartEventStore").ZenonLSCallStartEventStoreInstance)};b.processEvent=async function(a){var b=this;if(this.$3)return;switch(a.name){case"atLeastOneParticipantAnswered":this.$1.updateEventTimestamp("answer_recv_ms");this.$1.save(d("ZenonLSCallStartEventStore").ZenonLSCallStartEventStoreInstance);break;case"connectionReady":this.$1.updateEventTimestamp("connection_ready_ms");this.$1.save(d("ZenonLSCallStartEventStore").ZenonLSCallStartEventStoreInstance);break;case"connectionStart":a.isIncomingConnection?this.$1.updateEventTimestamp("incoming_connection_start_ms"):this.$1.updateEventTimestamp("outgoing_connection_start_ms");this.$1.save(d("ZenonLSCallStartEventStore").ZenonLSCallStartEventStoreInstance);break;case"answerSent":this.$1.updateEventTimestamp("answer_sent_ms");this.$1.save(d("ZenonLSCallStartEventStore").ZenonLSCallStartEventStoreInstance);break;case"callEnded":this.$3=!0;this.$2!==null&&window.clearInterval(this.$2);c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"Uploading NSL call start summary"});this.log();break;case"inviteSent":this.$1.updateEventTimestamp("invite_sent_ms");this.$1.save(d("ZenonLSCallStartEventStore").ZenonLSCallStartEventStoreInstance);break;case"mediaConnected":this.$1.updateEventTimestamp("network_ready_ms");this.$1.save(d("ZenonLSCallStartEventStore").ZenonLSCallStartEventStoreInstance);break;case"setRemoteSignalingID":this.$6({sharedCallID:a.remoteSignalingID});this.$1.setSharedCallId(a.remoteSignalingID);this.$1.save(d("ZenonLSCallStartEventStore").ZenonLSCallStartEventStoreInstance);break;case"answerSdpReceived":this.$1.receivedFromServer();this.$1.save(d("ZenonLSCallStartEventStore").ZenonLSCallStartEventStoreInstance);break;case"prAnswerSdpReceived":this.$1.receivedFromServer();this.$1.save(d("ZenonLSCallStartEventStore").ZenonLSCallStartEventStoreInstance);break;case"offerSdpReceived":this.$1.receivedFromInvite();this.$1.save(d("ZenonLSCallStartEventStore").ZenonLSCallStartEventStoreInstance);break;case"startHeartbeat":this.$2===null&&(this.$2=window.setInterval(function(){b.$1.save(d("ZenonLSCallStartEventStore").ZenonLSCallStartEventStoreInstance)},h));break}};return a}();b={LogProcessor:a};g.ZenonLSCallStartEventLogProcessor=a;g.ZenonLSCallStartEventLogProcessorConfig=b}),98);
__d("ZenonLSCallSummaryLogProcessor",["DateConsts","LsRtcCallSummaryFalcoEvent","LsRtcTslogFalcoEvent","ODS","PersistedQueue","ResumableUploadService","URI","ZenonAuditedCheckpointLogId","ZenonDeviceId","ZenonDismissReason","ZenonInfraActionsLogger","ZenonLSCallSummary","ZenonLSCallSummaryStore","ZenonLoggingEventTypes","ZenonPeerID","gkx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=10*d("DateConsts").MS_PER_SEC,k="tslog_upload_backend",l=500*1024*.6;a=function(){function a(a){var b,e=a.data;a=a.updateLogIdentifiers;this.$2=null;this.$3=!1;this.$6=!1;e.peerID=d("ZenonPeerID").ZenonMWPeerID;this.$5=e.peerID;this.$4=(b=e.disableTsData)!=null?b:!1;b=d("ZenonLSCallSummaryStore").ZenonLSCallSummaryStoreInstance.retrieveCallSummary(e.peerID,e.signalingID);b?(this.$1=b,this.$1.unsetEndCallFields(),this.$1.setDeviceID(d("ZenonDeviceId").getZenonLocalStorageDeviceIdWithFallback())):this.$1=new(c("ZenonLSCallSummary"))(e);e.conferenceName!=null&&this.$1.setConferenceName(e.conferenceName);this.$1.save(d("ZenonLSCallSummaryStore").ZenonLSCallSummaryStoreInstance);a&&a({localCallID:this.$1.getCallInfo().localCallID})}var b=a.prototype;b.$7=function(a){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:a})};b.$8=function(a){var b,e=a.format,f=a.timeSeries;if(f==null||f.length===0){this.$7("Not sending empty TSLog data");return}this.$7("Sending TSLog data of length "+f.length);b=(b=a.sequenceNumber)==null?void 0:b.toString();var g=babelHelpers.extends({},this.$1.getLoggingArgs(),{format:e,is_terminal:a.isTerminal,sequence_number:b,source:d("ZenonLoggingEventTypes").tslogSource,time_series:f});if(c("gkx")("25247")&&f.length>l){this.$7("Sending TSLog data through Upload Service");e=new(i||(i=c("URI")))(window.location.href).getDomain().split(".").slice(-2).join(".");a=c("ResumableUploadService").create({consumer:k,serviceDomain:e});b=new File([JSON.stringify(g)],"tslog");c("promiseDone")(a.resume(b))}else c("PersistedQueue").eventEmitter.emit("active",null),c("LsRtcTslogFalcoEvent").logImmediately(function(){return g});return};b.processEvent=async function(a){var b=this;switch(a.name){case"logTSData":if(this.$4)return;this.$7("Preparing TSLog data for sending");this.$8(a.serializedTSLog);this.$7("Sent TSLog data");break;case"mqttConnectionState":this.$6=a.pending;break}if(this.$3)return;switch(a.name){case"callConnected":this.$1.onCallConnected();this.$1.save(d("ZenonLSCallSummaryStore").ZenonLSCallSummaryStoreInstance);break;case"callEnded":this.$3=!0;this.$2!==null&&window.clearInterval(this.$2);a.endCallReason===d("ZenonDismissReason").ZenonDismissReason.ClientError&&(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_client_crashes","zenon_client_error_end_call_reason");await this.$1.onCallEnded(a.endCallReason,a.isRemoteEnded,!1,a.endCallSubreason);this.$1.save(d("ZenonLSCallSummaryStore").ZenonLSCallSummaryStoreInstance);c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"[ZP] ZenonLoggingEvent_callEnded: "+JSON.stringify({dismissReason:a.endCallReason,endCallReason:d("ZenonDismissReason").dismissToEndCallReason(a.endCallReason),endCallSubreason:a.endCallSubreason,mqttPending:this.$6})});c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"Uploading NSL call summary"});c("LsRtcCallSummaryFalcoEvent").logCritical(function(){return babelHelpers.extends({},b.$1.getSummaryLoggingInfo())});this.$1.remove(d("ZenonLSCallSummaryStore").ZenonLSCallSummaryStoreInstance);break;case"callEscalated":this.$1.onCallEscalated();this.$1.save(d("ZenonLSCallSummaryStore").ZenonLSCallSummaryStoreInstance);break;case"callJoinRequest":this.$1.setRtcActorID(a.rtcActorID);this.$1.save(d("ZenonLSCallSummaryStore").ZenonLSCallSummaryStoreInstance);break;case"peerConnectionStateChanged":this.$1.onPCStateChange(a.connected);this.$1.save(d("ZenonLSCallSummaryStore").ZenonLSCallSummaryStoreInstance);break;case"setMaxConnectedParticipants":this.$1.setMaxConnectedParticipants(a.connectedParticipantsCount);this.$1.save(d("ZenonLSCallSummaryStore").ZenonLSCallSummaryStoreInstance);break;case"setMediaStats":this.$1.setMediaStats(a.mediaStats);this.$1.save(d("ZenonLSCallSummaryStore").ZenonLSCallSummaryStoreInstance);break;case"setRemoteSignalingID":this.$1.setSharedCallId(a.remoteSignalingID);a.conferenceName!==null&&a.conferenceName!==""&&this.$1.setConferenceName(a.conferenceName);this.$1.save(d("ZenonLSCallSummaryStore").ZenonLSCallSummaryStoreInstance);break;case"startHeartbeat":this.$2===null&&(this.$2=window.setInterval(function(){b.$1.save(d("ZenonLSCallSummaryStore").ZenonLSCallSummaryStoreInstance),b.$1.updateLastUpdatedTime()},j));break}};return a}();b={LogProcessor:a};g.ZenonLSCallSummaryLogProcessor=a;g.ZenonLSCallSummaryLogProcessorConfig=b}),98);
__d("ZenonLSE2EEStatsLogProcessor",["DateConsts","LsRtcGroupE2eeFalcoEvent","LsRtcP2pE2eeFalcoEvent","ZenonInfraActionsLogger","ZenonLSE2EEStatsManager","ZenonLSE2EEStore","ZenonPeerID"],(function(a,b,c,d,e,f,g){"use strict";var h=10*d("DateConsts").MS_PER_SEC;a=function(){function a(a){var b=a.data;a=a.updateLogIdentifiers;this.$2=null;this.$3=!1;b.peerID=d("ZenonPeerID").ZenonMWPeerID;this.$4=b.peerID;var e=d("ZenonLSE2EEStore").ZenonLSE2EEStoreInstance.retrieveE2eeStats(b.peerID,b.signalingID);e?this.$1=e:this.$1=new(c("ZenonLSE2EEStatsManager"))(b);a&&a({localCallID:this.$1.getCallInfo().localCallID})}var b=a.prototype;b.processEvent=async function(a){var b=this;if(this.$3)return;switch(a.name){case"updateE2EEStats":this.$1.updateE2eeStats(a.e2eeStats);this.$1.save(d("ZenonLSE2EEStore").ZenonLSE2EEStoreInstance);break;case"setRemoteSignalingID":this.$1.setSharedCallId(a.remoteSignalingID);this.$1.save(d("ZenonLSE2EEStore").ZenonLSE2EEStoreInstance);break;case"startHeartbeat":this.$2===null&&(this.$2=window.setInterval(function(){b.$1.save(d("ZenonLSE2EEStore").ZenonLSE2EEStoreInstance)},h));break;case"callEnded":this.$3=!0;this.$2!==null&&window.clearInterval(this.$2);c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"Uploading NSL E2EE summary"});c("LsRtcGroupE2eeFalcoEvent").logCritical(function(){return b.$1.getGroupE2eeMetricsInFalcoShape()});c("LsRtcP2pE2eeFalcoEvent").logCritical(function(){return b.$1.getP2pE2eeMetricsInFalcoShape()});this.$1.delete(d("ZenonLSE2EEStore").ZenonLSE2EEStoreInstance);break}};return a}();b={LogProcessor:a};g.ZenonLSE2EEStatsLogProcessor=a;g.ZenonLSE2EEStatsLogProcessorConfig=b}),98);
__d("ZenonLSPeerConnectionSummaryLogProcessor",["LsRtcPeerConnectionSummaryFalcoEvent","ZenonInfraActionsLogger","ZenonLSPeerConnectionSummary","ZenonLSPeerConnectionSummaryStore","ZenonPeerID"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=a.data;a=a.updateLogIdentifiers;this.$2=!1;b.peerID=d("ZenonPeerID").ZenonMWPeerID;this.$3=b.signalingID;this.$4=b.peerID;var e=d("ZenonLSPeerConnectionSummaryStore").ZenonLSPeerConnectionSummaryStoreInstance.retrievePeerConnectionSummary(b.peerID,b.signalingID);e?this.$1=e:this.$1=new(c("ZenonLSPeerConnectionSummary"))(b);a({localCallID:this.$1.getCallInfo().localCallID})}var b=a.prototype;b.processEvent=async function(a){var b=this;if(this.$2)return;switch(a.name){case"setMediaPath":this.$1.setMediaPath(a.mediaPath);this.$1.save(d("ZenonLSPeerConnectionSummaryStore").ZenonLSPeerConnectionSummaryStoreInstance);break;case"setMediaStats":this.$1.setMediaStats(a.mediaStats);this.$1.save(d("ZenonLSPeerConnectionSummaryStore").ZenonLSPeerConnectionSummaryStoreInstance);break;case"setRemoteSignalingID":this.$1.setSharedCallId(a.remoteSignalingID);this.$1.save(d("ZenonLSPeerConnectionSummaryStore").ZenonLSPeerConnectionSummaryStoreInstance);break;case"peerConnectionStateChanged":this.$1.onPCStateChange(a.connected);this.$1.save(d("ZenonLSPeerConnectionSummaryStore").ZenonLSPeerConnectionSummaryStoreInstance);break;case"updateIceInfo":this.$1.updateIceInfo(a.sdpString,a.direction);this.$1.save(d("ZenonLSPeerConnectionSummaryStore").ZenonLSPeerConnectionSummaryStoreInstance);break;case"callEnded":this.$2=!0;this.$1.onCallEnded();this.$1.save(d("ZenonLSPeerConnectionSummaryStore").ZenonLSPeerConnectionSummaryStoreInstance);c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"Uploading NSL PCS summary"});c("LsRtcPeerConnectionSummaryFalcoEvent").logCritical(function(){return b.$1.getPeerConnectionSummary()});this.$1.delete(d("ZenonLSPeerConnectionSummaryStore").ZenonLSPeerConnectionSummaryStoreInstance);break}};return a}();b={LogProcessor:a};g.ZenonLSPeerConnectionSummaryLogProcessor=a;g.ZenonLSPeerConnectionSummaryLogProcessorConfig=b}),98);
__d("ZenonLSStarRatingsLogProcessor",["ZenonLSStarRatingsManager","ZenonLSStarRatingsStore","ZenonPeerID"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=a.data;a=a.updateLogIdentifiers;b.peerID=d("ZenonPeerID").ZenonMWPeerID;var e=d("ZenonLSStarRatingsStore").ZenonLSStarRatingsStoreInstance.retrieveStarRatings(b.peerID,b.signalingID);e?this.$1=e:this.$1=new(c("ZenonLSStarRatingsManager"))(b);a({localCallID:this.$1.getCallInfo().localCallID})}var b=a.prototype;b.processEvent=async function(a){switch(a.name){case"callRated":this.$1.setRating(a.rating,a.isBinaryRating);this.$1.save(d("ZenonLSStarRatingsStore").ZenonLSStarRatingsStoreInstance);return;case"callSurveySubmitted":this.$1.setSurvey(a.feedback,a.surveyChoice,a.surveyIssue);this.$1.save(d("ZenonLSStarRatingsStore").ZenonLSStarRatingsStoreInstance);return;case"setRemoteSignalingID":this.$1.setSharedCallId(a.remoteSignalingID);this.$1.save(d("ZenonLSStarRatingsStore").ZenonLSStarRatingsStoreInstance);break}};return a}();b={LogProcessor:a};g.ZenonLSStarRatingsLogProcessor=a;g.ZenonLSStarRatingsLogProcessorConfig=b}),98);
__d("ZenonLastCallManager",["ZenonCallInfoManager"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.save=function(a){var b=this.getCallInfo(),c=b.peerID;b=b.signalingID;a.storeCallIdentifiers(c,b,this)};c.setConferenceName=function(a){if(a==null)return;this.getCallInfo().conferenceName=a};c.toJSONString=function(){return JSON.stringify(this.getCallInfo())};return b}(c("ZenonCallInfoManager"));g["default"]=a}),98);
__d("ZenonLastCallStore",["ZenonAppProvider","ZenonGenericLocalStorageStore","ZenonLastCall"],(function(a,b,c,d,e,f,g){"use strict";var h="localstorage",i=3;a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.call(this,d("ZenonLastCall").STORAGE_KEY,h,d("ZenonLastCall").STORAGE_PREFIX)||this}var c=b.prototype;c.isAllowedApp=function(){return d("ZenonAppProvider").isMessengerWebApp()};c.storeCallIdentifiers=function(a,b,c){if(!this.isAllowedApp())return;this.mutateLocalStorageObjects(function(d){var e;return d={},d[a]=(e={},e[b]={__d:c.toJSONString(),__t:Date.now(),__z:!0},e),d},i,!1,{peerID:a,signalingID:b})};return b}(c("ZenonGenericLocalStorageStore"));b=new a();g.ZenonLastCallStoreInstance=b}),98);
__d("ZenonLastCallLogProcessor",["ZenonLastCallManager","ZenonLastCallStore","ZenonPeerID"],(function(a,b,c,d,e,f,g){"use strict";var h=1e3*30;a=function(){function a(a){var b=a.data;a=a.updateLogIdentifiers;this.$2=!1;this.$3=0;this.$1=new(c("ZenonLastCallManager"))(babelHelpers.extends({},b,{peerID:d("ZenonPeerID").ZenonMWPeerID}));a&&a({localCallID:this.$1.getCallInfo().localCallID})}var b=a.prototype;b.processEvent=async function(a){if(this.$2)return;switch(a.name){case"updateLogIdentifiers":a.logIdentifiers.localCallID!=null&&this.$1.setLocalCallID(a.logIdentifiers.localCallID);a.logIdentifiers.sharedCallID!=null&&this.$1.setSharedCallId(a.logIdentifiers.sharedCallID);a.logIdentifiers.clientSessionID!=null&&this.$1.setSignalingID(a.logIdentifiers.clientSessionID);break;case"setRemoteSignalingID":this.$1.setSharedCallId(a.remoteSignalingID);this.$1.setConferenceName(a.conferenceName);break;case"callEnded":this.$2=!0;break}Date.now()-this.$3>=h&&(this.$1.save(d("ZenonLastCallStore").ZenonLastCallStoreInstance),this.$3=Date.now())};return a}();b={LogProcessor:a};g.MIN_UPDATE_INTERVAL=h;g.ZenonLastCallLogProcessor=a;g.ZenonLastCallLogProcessorConfig=b}),98);
__d("ZenonPeerConnectionConfig",["ZenonBrowsers","shouldUseInsertableStreams"],(function(a,b,c,d,e,f,g){"use strict";var h="stun:stun.fbsbx.com:3478";function i(a,b,c){a={urls:a};b!==void 0&&c!==void 0&&(a.username=b,a.credential=c);return[a]}a=function(){function a(){this.sslPort="",this.tcpPort="",this.turnIP="",this.turnIP_6="",this.turnPassword="",this.turnUsername="",this.udpPort=""}var b=a.prototype;b.setTurnCredentials=function(a){this.turnIP=a.ip,this.turnIP_6=a.ip_6,this.udpPort=a.udp_port,this.tcpPort=a.tcp_port,this.sslPort=a.ssl_tcp_port,this.turnUsername=a.username,this.turnPassword=a.password};b.getConfigZenonPlatform=function(){var a=c("shouldUseInsertableStreams")(),b="max-compat",d=this.turnIP==="";d?d=i([h]):d=i([h]).concat(i(this.$1(),this.turnUsername,this.turnPassword));return{bundlePolicy:b,encodedInsertableStreams:a,iceServers:d}};b.getConstraints=function(a){a===void 0&&(a=!1);var b=!0;d("ZenonBrowsers").isChromium()&&d("ZenonBrowsers").webrtcVersion()<57&&a&&(b=!1);return{mandatory:{},optional:[{DtlsSrtpKeyAgreement:b}]}};b.$2=function(a,b){a=a?"["+this.turnIP_6+"]":this.turnIP;var c,d=b;switch(b){case"tcp":c=this.tcpPort;break;case"udp":c=this.udpPort;break;case"ssl":c=this.sslPort;d="tcp";break;default:c=this.udpPort;d=null;break}return!((a==null?void 0:a.length)&&((b=c)==null?void 0:b.length))?null:d!=null&&d.length>0?"turn:"+a+":"+c+"?transport="+d:"turn:"+a+":"+c};b.$1=function(){if(d("ZenonBrowsers").isFirefox()&&d("ZenonBrowsers").webrtcVersion()<27)return[this.$2(!1)].filter(Boolean);else return[this.$2(!1,"udp"),this.$2(!1,"tcp"),this.$2(!1,"ssl"),this.$2(!0,"udp"),this.$2(!0,"tcp"),this.$2(!0,"ssl")].filter(Boolean)};return a}();b=new a();g["default"]=b}),98);
__d("RtcProductConnectFunnelFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("3544");b=d("FalcoLoggerInternal").create("rtc_product_connect_funnel",a);e=b;g["default"]=e}),98);
__d("ZenonProductConnectFunnelManager",["ZenonCallInfoManager","ZenonProductConnectFunnel","performanceNow"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){b=a.call(this,b)||this;b.$ZenonProductConnectFunnelManager$p_1={connected:null,created:Math.trunc((h||(h=c("performanceNow")))()),ended:null,firstAction:null,firstMediaPacketReceived:null,firstMediaPacketSent:null,peerConnected:null,peerConnecting:null,peerRinging:null,selfConnected:null,selfConnecting:null};return b}var d=b.prototype;d.$ZenonProductConnectFunnelManager$p_2=function(a){if(this.$ZenonProductConnectFunnelManager$p_1[a]!=null)return;this.$ZenonProductConnectFunnelManager$p_1[a]=Math.trunc((h||(h=c("performanceNow")))())};d.setFirstAction=function(){this.$ZenonProductConnectFunnelManager$p_2("firstAction")};d.setFirstMediaPacketSent=function(a){var b="firstMediaPacketSent";if(this.$ZenonProductConnectFunnelManager$p_1[b]!=null)return;this.$ZenonProductConnectFunnelManager$p_1[b]=Math.trunc(a)};d.setFirstMediaPacketReceived=function(a){var b="firstMediaPacketReceived";if(this.$ZenonProductConnectFunnelManager$p_1[b]!=null)return;this.$ZenonProductConnectFunnelManager$p_1[b]=Math.trunc(a)};d.setSelfConnecting=function(){this.$ZenonProductConnectFunnelManager$p_2("selfConnecting")};d.setSelfConnected=function(){this.$ZenonProductConnectFunnelManager$p_2("selfConnected")};d.setPeerRinging=function(){this.$ZenonProductConnectFunnelManager$p_2("peerRinging")};d.setPeerConnecting=function(){this.$ZenonProductConnectFunnelManager$p_2("peerConnecting")};d.setPeerConnected=function(){this.$ZenonProductConnectFunnelManager$p_2("peerConnected")};d.setConnected=function(){this.$ZenonProductConnectFunnelManager$p_2("connected")};d.setEnded=function(){this.$ZenonProductConnectFunnelManager$p_2("ended")};d.getFunnelMetricsInFalcoShape=function(){var a,b,d=this.getCallInfo(),e=d.callTrigger,f=d.isCaller,g=d.isVideo,h=d.localCallID,i=d.serverInfoData;d=d.signalingID;var j=c("ZenonProductConnectFunnel").getTimings(d);d=c("ZenonProductConnectFunnel").getAnnotations(d);a=Math.min((a=j==null?void 0:j.acceptedTs)!=null?a:0,(a=j==null?void 0:j.ringingTs)!=null?a:0,(a=j==null?void 0:j.triggeredTs)!=null?a:0);var k=a<0?Math.abs(a):0,l=function(a){return a!=null?a+k:null};a=function(a){return String(l(a))};return{annotations:{camera_permission:(b=d==null?void 0:d.cameraPermission)!=null?b:"unknown",microphone_permission:(b=d==null?void 0:d.microphonePermission)!=null?b:"unknown"},call_trigger:e,funnel_event:"END",funnel_id:(d=i)!=null?d:h,funnel_origin:"UNKNOWN",is_outbound:f,is_video:g,local_call_id:h,points:{media_first_audio_packet:a((b=this.$ZenonProductConnectFunnelManager$p_1)==null?void 0:b.firstMediaPacketReceived),media_first_audio_packet_sent:a((e=this.$ZenonProductConnectFunnelManager$p_1)==null?void 0:e.firstMediaPacketSent),permissions_request_end:a(j==null?void 0:j.permissionsReceivedTs),permissions_request_start:a(j==null?void 0:j.permissionsRequestTs)},shared_call_id:i,time_created_ms:l((d=this.$ZenonProductConnectFunnelManager$p_1)==null?void 0:d.created),time_ended_ms:(j==null?void 0:j.endCallTs)!=null?l(j==null?void 0:j.endCallTs):l((f=this.$ZenonProductConnectFunnelManager$p_1)==null?void 0:f.ended),time_rsys_connected_ms:l((g=this.$ZenonProductConnectFunnelManager$p_1)==null?void 0:g.connected),time_rsys_ended_ms:l((h=this.$ZenonProductConnectFunnelManager$p_1)==null?void 0:h.ended),time_rsys_first_action_ms:l((b=this.$ZenonProductConnectFunnelManager$p_1)==null?void 0:b.firstAction),time_rsys_peer_connected_ms:l((e=this.$ZenonProductConnectFunnelManager$p_1)==null?void 0:e.peerConnected),time_rsys_peer_connecting_ms:l((a=this.$ZenonProductConnectFunnelManager$p_1)==null?void 0:a.peerConnecting),time_rsys_peer_ringing_ms:l((i=this.$ZenonProductConnectFunnelManager$p_1)==null?void 0:i.peerRinging),time_rsys_self_connected_ms:l((d=this.$ZenonProductConnectFunnelManager$p_1)==null?void 0:d.selfConnected),time_rsys_self_connecting_ms:l((f=this.$ZenonProductConnectFunnelManager$p_1)==null?void 0:f.selfConnecting),time_ui_accepted_ms:l(j==null?void 0:j.acceptedTs),time_ui_connected_ms:l(j==null?void 0:j.connectedTs),time_ui_connecting_ms:l(j==null?void 0:j.connectingTs),time_ui_contacting_ms:l(j==null?void 0:j.contactingTs),time_ui_end_call_ms:l(j==null?void 0:j.endCallTs),time_ui_ringing_ms:l(j==null?void 0:j.ringingTs),time_ui_triggered_ms:l(j==null?void 0:j.triggeredTs)}};d.save=function(a){var b=this.getCallInfo(),c=b.peerID;b=b.signalingID;a.storeFunnel(c,b,this)};d["delete"]=function(a){var b=this.getCallInfo(),d=b.peerID;b=b.signalingID;a.removeLocalStorageObjects([{peerID:d,signalingID:b}]);c("ZenonProductConnectFunnel").remove(b)};d.toJsonString=function(){var a={callInfo:this.getCallInfo(),timings:this.$ZenonProductConnectFunnelManager$p_1};return JSON.stringify(a)};b.fromJsonString=function(a){var c;try{c=JSON.parse(a)}catch(a){return null}if(c==null||c.callInfo==null)return null;a=new b(c.callInfo);a.$ZenonProductConnectFunnelManager$p_1=c.timings;return a};return b}(c("ZenonCallInfoManager"));g["default"]=a}),98);
__d("ZenonProductConnectFunnelStore",["ZenonGenericLocalStorageStore","ZenonProductConnectFunnelManager"],(function(a,b,c,d,e,f,g){"use strict";var h="localstorage",i="RTC_PRODUCT_CONNECT_FUNNEL_",j="product_connect_funnel",k=3;a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.call(this,j,h,i)||this}var d=b.prototype;d.retrieveFunnel=function(a,b){var d=this.getLocalStorageObjects();a=(d=d[a])==null?void 0:d[b];return a==null?null:c("ZenonProductConnectFunnelManager").fromJsonString(a.__d)};d.storeFunnel=function(a,b,c){this.mutateLocalStorageObjects(function(d){d[a]||(d[a]={});d[a][b]={__d:c.toJsonString(),__t:Date.now(),__z:!0};return d},k,!1,{peerID:a,signalingID:b})};return b}(c("ZenonGenericLocalStorageStore"));b=new a();g.ZenonProductConnectFunnelStoreInstance=b}),98);
__d("ZenonProductConnectFunnelLogProcessor",["RtcProductConnectFunnelFalcoEvent","ZenonInfraActionsLogger","ZenonPeerID","ZenonProductConnectFunnelManager","ZenonProductConnectFunnelStore"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=a.data;a=a.updateLogIdentifiers;this.$1=!1;this.$2=!1;b.peerID=d("ZenonPeerID").ZenonMWPeerID;this.$4=a;var e=d("ZenonProductConnectFunnelStore").ZenonProductConnectFunnelStoreInstance.retrieveFunnel(b.peerID,b.signalingID);e?this.$3=e:this.$3=new(c("ZenonProductConnectFunnelManager"))(b);a&&a({localCallID:this.$3.getCallInfo().localCallID})}var b=a.prototype;b.log=function(){var a=this;if(this.$2)return;this.$2=!0;c("RtcProductConnectFunnelFalcoEvent").logCritical(function(){return a.$3.getFunnelMetricsInFalcoShape()});this.$3.delete(d("ZenonProductConnectFunnelStore").ZenonProductConnectFunnelStoreInstance)};b.processEvent=async function(a){if(this.$1)return;this.$3.setFirstAction();switch(a.name){case"callConnected":this.$3.setConnected();this.$3.save(d("ZenonProductConnectFunnelStore").ZenonProductConnectFunnelStoreInstance);break;case"callEnded":this.$1=!0;this.$3.setEnded();this.log();c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"Uploading product connect funnel summary"});break;case"atLeastOneParticipantAlerted":this.$3.setPeerRinging();break;case"callJoinRequest":this.$3.setSelfConnecting();break;case"setMediaPath":this.$3.setSelfConnected();break;case"smuWithAnswerReceived":case"setRemoteSdpAnswer":this.$3.setPeerConnecting();break;case"peerConnectionStateChanged":this.$3.setPeerConnected();break;case"setRemoteSignalingID":this.$3.setSharedCallId(a.remoteSignalingID);this.$3.save(d("ZenonProductConnectFunnelStore").ZenonProductConnectFunnelStoreInstance);break;case"updateLogIdentifiers":this.$3.save(d("ZenonProductConnectFunnelStore").ZenonProductConnectFunnelStoreInstance);break;case"firstMediaPacketReceived":this.$3.setFirstMediaPacketReceived(a.timestamp);break;case"firstMediaPacketSent":this.$3.setFirstMediaPacketSent(a.timestamp);break}};return a}();b={LogProcessor:a};g.ZenonProductConnectFunnelLogProcessor=a;g.ZenonProductConnectFunnelLogProcessorConfig=b}),98);
__d("ZenonReliabilityQPLLogProcessor",["Promise","QuickPerformanceLogger","ZenonCallInfoManager","ZenonDismissReason","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i;a=function(){function a(a){a=a.data;this.$2=!1;this.$3=c("qpl")._(144192964,"2904");this.$1=new(c("ZenonCallInfoManager"))(a);(i||(i=c("QuickPerformanceLogger"))).markerStartFromNavStart(this.$3,this.$4());i.markerAnnotate(this.$3,this.$5(),{instanceKey:this.$4()})}var e=a.prototype;e.$5=function(){var a=this.$1.getCallInfo(),b=a.callTrigger,c=a.conferenceName,d=a.deviceID,e=a.isCaller,f=a.localCallID,g=a.serverInfoData;a=a.signalingID;e={"int":{is_outgoing:e?1:0},string:{call_trigger:b!=null?b:void 0,conference_name:c!=null?c:void 0,device_id:d!=null?d:void 0,is_connected:this.$2?"1":"0",localCallId:f!=null?f:void 0,shared_call_id:g!=null?g:void 0,signaling_id:a!=null?a:void 0,trigger_source:b!=null?b:void 0}};return e};e.$4=function(){return+this.$1.getCallInfo().signalingID};e.processEvent=function(a){var d;d=(d=a.logIdentifiers)!=null?d:{};var e=d.clientSessionID,f=d.localCallID;d=d.sharedCallID;switch(a.name){case"updateLogIdentifiers":f!=null&&this.$1.setLocalCallID(f);e!=null&&this.$1.setSignalingID(e);d!=null&&this.$1.setSharedCallId(d);(i||(i=c("QuickPerformanceLogger"))).markerAnnotate(this.$3,this.$5(),{instanceKey:this.$4()});break;case"callConnected":this.$2=!0;(i||(i=c("QuickPerformanceLogger"))).markerAnnotate(this.$3,this.$5(),{instanceKey:this.$4()});break;case"callEnded":(i||(i=c("QuickPerformanceLogger"))).markerEnd(this.$3,this.$6(a)?722:2,this.$4(),(i||(i=c("QuickPerformanceLogger"))).currentTimestamp());break}return(h||(h=b("Promise"))).resolve()};e.$6=function(a){return a.endCallReason===d("ZenonDismissReason").ZenonDismissReason.WebRTCError||a.endCallReason===d("ZenonDismissReason").ZenonDismissReason.ClientError};return a}();e={LogProcessor:a};g.ZenonReliabilityQPLLogProcessor=a;g.ZenonReliabilityQPLLogProcessorConfig=e}),98);
__d("ZenonRenderResolutionTracker",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$2={}}var b=a.prototype;b.setRenderResolutionListener=function(a){this.$1=a};b.getRenderResolutionMap=function(){return this.$2};b.setRenderResolutionMap=function(a){this.$2=a,this.$1&&this.$1.onRenderResolutionChange(a)};return a}();f["default"]=a}),66);
__d("ZenonMWMessageLogger",["ZenonLoggingEventTypes","ZenonMWMessageTypes"],(function(a,b,c,d,e,f,g){"use strict";var h=new Set(),i=new Set();function a(a,b){a=a.jsonPayload;var c=a.body;a=a.header;if(h.has(a.transactionId))return;switch(a.type){case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.JOIN:c.joinRequest&&j(c.joinRequest,b);break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.ICE_CANDIDATE:c.iceCandidateRequest&&l(c.iceCandidateRequest,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send);break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.CLIENT_MEDIA_UPDATE:c.clientMediaUpdateRequest&&m(c.clientMediaUpdateRequest,b);break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.SERVER_MEDIA_UPDATE:c.serverMediaUpdateResponse&&p(c.serverMediaUpdateResponse,b);break}h.add(a.transactionId)}function b(a,b){a=a.jsonPayload;var c=a.body;a=a.header;if(i.has(a.transactionId))return;switch(a.type){case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.JOIN:c.joinResponse&&k(c.joinResponse,b);break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.ICE_CANDIDATE:c.iceCandidateRequest&&l(c.iceCandidateRequest,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Receive);break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.CLIENT_MEDIA_UPDATE:c.clientMediaUpdateResponse&&n(c.clientMediaUpdateResponse,b);break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.SERVER_MEDIA_UPDATE:c.serverMediaUpdateRequest&&o(c.serverMediaUpdateRequest,b);break}i.add(a.transactionId)}function j(a,b){var c=a.answer;a=a.offer;b({name:"inviteSent"});q(a,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send);c&&q(c,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send)}function k(a,b){a=a.answer;a&&q(a,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Receive)}function l(a,b,c){a=a.iceCandidateSdps;a.forEach(function(a){a.candidateSdpString!=null&&b({direction:c,name:"updateIceInfo",sdpString:a.candidateSdpString})})}function m(a,b){a=a.offer;a&&q(a,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send)}function n(a,b){a=a.answer;a&&q(a,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Receive)}function o(a,b){var c=a.answer;a=a.offer;a&&q(a,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Receive);c&&q(c,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Receive)}function p(a,b){a=a.answer;a&&q(a,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send)}function q(a,b,c){a.sdpString!=null&&b({direction:c,name:"updateIceInfo",sdpString:a.sdpString})}g.logSentMessage=a;g.logReceivedMessage=b}),98);
__d("ZenonValidateMWMessage",["FBLogger","ZenonAuditedCheckpointLogId","ZenonInfraActionsLogger","ZenonMWMessageTypes"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.jsonPayload.header.type;if(a.jsonPayload.header.serverInfoData==null&&b!=null&&b!==d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.JOIN){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"[ZP][DROP] No remoteSignalingID in message: "+b});c("FBLogger")("rtc_www").warn("[ZP][DROP] No remoteSignalingID in message: "+b);return!1}return!0}g["default"]=a}),98);
__d("ZenonSctpMWMessageSender",["RequestStreamBodyUtils","ZenonActorHooks","ZenonAuditedCheckpointLogId","ZenonInfraActionsLogger","ZenonMWMessageDebugLogger","ZenonMWMessageLogger","ZenonMWMessageReliabilityLogger","ZenonMWMessageTranslator","ZenonMWMessageTypes","ZenonPeerConnectionConstants","ZenonSCTPConstants","ZenonValidateMWMessage","err","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$3=a}var b=a.prototype;b.$4=async function(a){var b;b=(b=a.jsonPayload.header.clientSessionId)!=null?b:"";try{await this.$3.waitForSctpOpened(b)}catch(a){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"Not sending MWS message through SCTP because SCTP could not connect. Error: "+a});return}d("ZenonMWMessageReliabilityLogger").logSendingMessage(a);c("ZenonMWMessageDebugLogger").logMWMessage("SENDING","SCTP",a);this.$2&&d("ZenonMWMessageLogger").logSentMessage(a,this.$2);var e,f;switch(a.jsonPayload.header.type){default:e=this.$5(a);f=d("ZenonSCTPConstants").SCTP_SIGNALING_TOPIC;break}if(e!=null&&f!=null)try{await this.$3.sendDataMessage(b,f,{message:JSON.stringify(e),recipients:{recipientIDs:[d("ZenonPeerConnectionConstants").SCTP_MEDIA_SERVER_ID]},sender:d("ZenonActorHooks").ZenonActor.getID()}),d("ZenonMWMessageReliabilityLogger").logSentMessage(a),this.$2&&this.$2({mwMessage:a,name:"mwMessageSent"})}catch(b){this.$6(a,b.toString())}else this.$6(a,"Invalid message type sent through datachannel")};b.$5=function(a){var b;b=(b=a.jsonPayload.body.serverMediaUpdateResponse)==null?void 0:b.currentVersion;a={body:a.jsonPayload.body,endpoint:a.endpoint,header:a.jsonPayload.header,senderId:(a=(a=a.jsonPayload.header.sender)==null?void 0:a.id)!=null?a:""};return{signalingMessagePayload:d("RequestStreamBodyUtils").stringToBase64WithoutPadding(JSON.stringify(a)),version:b}};b.$6=function(a,b){b=b!=null?b:"SCTP Message Send Error";d("ZenonMWMessageReliabilityLogger").logSendMessageFailed(a,"[SCTP] "+b);c("ZenonMWMessageDebugLogger").logSendMultiwayMessageFailure(b,a.jsonPayload.header.type)};b.sendMessage=function(a){a=d("ZenonMWMessageTranslator").toMWMessage(a);if(!a||!c("ZenonValidateMWMessage")(a))return Promise.reject(c("err")("Invalid MW message"));var b=a.jsonPayload.header.type;return c("gkx")("25222")&&(b===d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.SERVER_MEDIA_UPDATE||b===d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.WAKEUP)?this.$4(a):Promise.reject(c("err")("SCTP only supports SMU"))};b.setMessageReceiver=function(a){this.$1=a};b.setLoggingEventHandler=function(a){this.$2=a};return a}();g.default=a}),98);
__d("ZenonSctpMWMessageSenderHelper",["ZenonAuditedCheckpointLogId","ZenonInfraActionsLogger","ZenonSCTPConstants","err"],(function(a,b,c,d,e,f,g){"use strict";var h=15e3,i="SCTP not opened";a=function(){function a(){this.$2=new Map()}var b=a.prototype;b.setupSctpChannelApi=function(a,b,c){this.$1=b,this.$2.set(a,c)};b.sendDataMessage=async function(a,b,d){a=this.$2.get(a);if(a!=null){var e;((e=this.$1)==null?void 0:e.getMediaMode())==="sfu"?await a.sendDataMessage(b,d):c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"Not sending message on topic "+b+" because we are not in SFU mode"})}else this.$3()};b.getDataChannelState=function(a,b){a=this.$2.get(a);if(a!=null)return a.getDataChannelState(b);else this.$3()};b.subscribeDataChannelOpen=function(a,b,c){a=this.$2.get(a);a!=null?a.subscribeDataChannelOpen(b,c):this.$3()};b.unsubscribeDataChannelOpen=function(a,b,c){a=this.$2.get(a);a!=null?a.unsubscribeDataChannelOpen(b,c):this.$3()};b.waitForSctpOpened=function(a){var b=this;return new Promise(function(e,f){var g=b.getDataChannelState(a,d("ZenonSCTPConstants").SCTP_SIGNALING_TOPIC);switch((g=g)!=null?g:"does-not-exist"){case"open":e();break;case"closed":case"closing":f(c("err")("channel is closed"));break;case"does-not-exist":case"connecting":c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"SCTP not opened, deferring sending MWS message"});c("ZenonInfraActionsLogger").startTimer(i);var j=function f(){c("ZenonInfraActionsLogger").stopTimer(i),c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"SCTP not opened, deferring sending MWS message"}),b.unsubscribeDataChannelOpen(a,f,d("ZenonSCTPConstants").SCTP_SIGNALING_TOPIC),window.clearTimeout(k),e()},k=window.setTimeout(function(){b.unsubscribeDataChannelOpen(a,j,d("ZenonSCTPConstants").SCTP_SIGNALING_TOPIC),c("ZenonInfraActionsLogger").stopTimer(i),c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"SCTP never opened."}),f(c("err")("timeout"))},h);b.subscribeDataChannelOpen(a,j,d("ZenonSCTPConstants").SCTP_SIGNALING_TOPIC);break}})};b.$3=function(){var a="ZenonSctpMWMessageSenderHelper",b="[ZP] Peer Connection Manager was not setup for SCTP communication yet";c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:b,errorDomain:a})};return a}();g.default=a}),98);
__d("ZenonSignalingInitState",["setInterval"],(function(a,b,c,d,e,f,g){"use strict";var h=1e4;function a(a,b){if(b.type==="receiveInviteRequest"){a.onInviteReceived(b.payload,b.configuration);return{inviteMessageID:b.messageID}}return{}}function b(a,b){b.type==="sendInviteRequest"&&a.sendSignalingEvent(b.payload,b.onSent,b.onError)}function d(a){if(!a.pingTimer){var b;b=(b=(b=a.config)==null?void 0:b.getConfigManager().getSignalingPingConfig().getPingIntervalMs())!=null?b:h;var d={eventName:"pingRequest"};b=c("setInterval")(function(){a.signalingModel.getRemoteSignalingID()!=null&&a.sendSignalingEvent(d)},b);return{pingTimer:b}}return{}}g.onReceiveInvite=a;g.onSendInvite=b;g.startPingTimer=d}),98);
__d("ZenonSignalingInviteReceivedState",["FBLogger"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){if(b.type==="sendInviteResponse"){var d=a.inviteMessageID;d!=null?(b.payload.ackMessageId=d,a.sendSignalingEvent(b.payload,b.onSent,b.onError)):c("FBLogger")("rtc_www").mustfix("onSendInviteResponse handler invoked without populated inviteMessageID in signaling state machine context.")}}g.onSendInviteResponse=a}),98);
__d("ZenonSignalingNegotiationCompleteState",["ZenonAuditedCheckpointLogId","ZenonInfraActionsLogger","err","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){if(b.type==="receiveRemoteSdpRequest"){var d,e=b.payload,f=e.e2eeServerState,g=e.fromVersion;g=g===void 0?-1:g;var h=e.mediaPath,i=e.mediaStates,j=e.onProcessed,k=e.sdp,l=e.sdpOriginLocalId;e=e.source;d=(d=a.lastAckedLocalSdpVersion)!=null?d:-1;c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"negotiationComplete receiveAnswer: lastAckedLocalSdpVersion: "+d+", fromVersion: "+g+", source: "+e});c("promiseDone")(a.onSdpReceived(k,h,i,(d=e)!=null?d:null,null,l,j,b.payload.ackMessageId,f));return{lastRemoteMediaUpdateVersion:k.version}}return{}}function b(a,b){if(b.type==="sendMediaUpdateRequest")if(a.isMediaUpdateResponsePending===!0){var d,e=b.onError,f=b.onSent,g=b.payload;(d=a.mediaUpdateRequestToSend)==null?void 0:d.onError(c("err")("pending media update replaced by newer update"));return{mediaUpdateRequestToSend:{onError:e,onSent:f,payload:g}}}else{d=a.sendSignalingEvent(b.payload,b.onSent,b.onError);return{isMediaUpdateResponsePending:!0,mediaUpdateRequestToSend:null,mediaUpdateRequestTransactionId:d}}return{}}g.onReceiveAnswer=a;g.onSendMediaUpdateRequest=b}),98);
__d("ZenonSignalingSharedActions",["ZenonAuditedCheckpointLogId","ZenonDebugLogger","ZenonInfraActionsLogger","ZenonMWMessageTypes","ZenonSignalingTypes","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b.type!=="messageSent"&&a.sendSignalingEvent(b.payload,b.onSent?b.onSent:void 0,b.onError?b.onError:void 0)}function b(a,b){if(b.type!=="receiveCapabilitiesRequest")return;c("promiseDone")(a.onCapabilitiesReceived(b.payload.capabilities,(a=b.payload.escalationConferenceName)!=null?a:null))}function e(a,b){if(b.type!=="receiveClientInfoRequest")return;c("promiseDone")(a.onClientInfoReceived(b.payload.userCapabilities,b.payload.actorRepresentatives,b.payload.mediaPath))}function f(a,b){if(b.type!=="receiveGenericDataMessageRequest")return;a.sendSignalingEvent({ackMessageId:b.messageID,eventName:"genericDataMessageResponse"});var d={message:b.payload.data,sender:""};c("promiseDone")(a.onGenericDataMessageReceived(b.payload.topic,d))}function h(a,b){if(b.type!=="receiveIceCandidateRequest")return;var c={ackMessageId:b.messageID,eventName:"iceCandidateResponse"};a.sendSignalingEvent(c);var d=a.onIceCandidateReceived;b.payload.iceCandidates.forEach(function(a){return d(a)})}function i(a,b){var e;if(b.type!=="receiveInitiateRenegotiationRequest")return{};var f=b.payload,g=f.hasRemoteOffer;f=f.messageTags;var h=x(a.lastRemoteMediaUpdateVersion,b.payload.fromVersion);e={ackMessageId:b.messageID,acknowledgedVersion:h?(e=a.lastRemoteMediaUpdateVersion)!=null?e:0:b.payload.version,eventName:"initiateRenegotiationResponse",hasRemoteOffer:g,messageTags:f,statusCode:h?d("ZenonSignalingTypes").ZenonSignalingStatusCode.REJECTED_FROM_VERSION_DOES_NOT_MATCH:d("ZenonSignalingTypes").ZenonSignalingStatusCode.OK};a.sendSignalingEvent(e);b.payload.onProcessed();c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"onProcessed called in ZenonSignalingSharedActions.onReceiveInitiateRenegotiationRequest"});if(h)return{};f=a.signalingModel.getMediaModeManager();b.payload.mediaPath===d("ZenonMWMessageTypes").ZenonMWMediaPath.P2P?(f.onDeescalated(),g?(a.logEvent({name:"renegotiationSmuReqWithOfferReceived"}),c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"initiateRenegotiationRequest: De-escalation callee"})):(a.logEvent({name:"renegotiationSmuReqWithAnswerReceived"}),c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"initiateRenegotiationRequest: De-escalation caller"}))):(f.onSfuEscalated(),c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"initiateRenegotiationRequest: SFU escalation"}));c("promiseDone")(a.onRenegotiationRequested(g));return g?{}:C((e=a.lastRemoteMediaUpdateVersion)!=null?e:null,b.payload.version)}function j(a,b){if(b.type!=="receiveLocalSdpResponse")return;b.payload.source==="joinResponse"&&a.logEvent({name:"inviteResponseReceived"});b=b.payload.hasAnswerInJoinResponse;!b?a.logEvent({name:"inviteResponseProcessed"}):a.signalingModel.getMediaModeManager().onSfuEscalated();a.logEvent({hasAnswerInJoinResponse:b,name:"setHasAnswerInJoinResponse"});a.logEvent({name:"startHeartbeat"})}function k(a,b){if(b.type!=="receiveMediaUpdateRequest")return{};var e=a.lastRemoteMediaUpdateVersion,f=b.payload,g=f.mediaStates,h=g.fromVersion;g=g.version;var i=f.messageTags;f=f.onProcessed;f&&(f(),c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"onProcessed called in ZenonSignalingSharedActions.onReceiveMediaUpdateRequest"}));f=e!=null&&h!=null&&e!==h;h={ackMessageId:b.messageID,acknowledgedVersion:f&&a.lastRemoteMediaUpdateVersion!=null?a.lastRemoteMediaUpdateVersion:b.payload.mediaStates.version,eventName:"mediaUpdateResponse",messageTags:i,responseStatusCode:f?d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.CONDITIONAL_REQUEST_FAILED:d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.OK};a.sendSignalingEvent(h);if(!f){c("promiseDone")(a.onMediaUpdateReceived(b.payload.mediaStates));if(e==null||g>e)return{lastRemoteMediaUpdateVersion:g}}return{}}function l(a,b){if(b.type!=="receiveParticipantUpdateRequest")return{};var d={ackMessageId:b.messageID,eventName:"participantUpdateResponse",requestVersionId:b.payload.versionId};a.sendSignalingEvent(d);d=a.lastParticipantUpdateVersion;if(d==null||d<b.payload.versionId){c("promiseDone")(a.onParticipantUpdateReceived(b.payload.participantStates,b.payload.sctpUserIdNodeIdMap));return{lastParticipantUpdateVersion:b.payload.versionId}}return{}}function m(a){c("promiseDone")(a.onPendingApprovalReceived()),a.logEvent({name:"pendingApproval"})}function n(a){c("promiseDone")(a.onServerRenegotiationFinished())}function o(a,b){var e;if(b.type!=="receiveRemoteSdpRequest")return{};var f=x(a.lastRemoteMediaUpdateVersion,b.payload.fromVersion);if(((e=b.payload)==null?void 0:e.source)!=="joinResponse"){e={ackMessageId:b.messageID,acknowledgedVersion:f?(e=a.lastRemoteMediaUpdateVersion)!=null?e:0:b.payload.sdp.version,eventName:"remoteSdpResponse",messageTags:b.payload.messageTags,negotiateType:b.payload.negotiateType,statusCode:f?d("ZenonSignalingTypes").ZenonSignalingStatusCode.REJECTED_FROM_VERSION_DOES_NOT_MATCH:d("ZenonSignalingTypes").ZenonSignalingStatusCode.OK,type:b.payload.sdp.type};a.sendSignalingEvent(e)}if(f){b.payload.onProcessed?(b.payload.onProcessed(),c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"onProcessed called in ZenonSignalingSharedActions.onReceiveRemoteSdpRequest"})):c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"onProcessed is not set in ZenonSignalingSharedActions.onReceiveRemoteSdpRequest!"});return{}}b.payload.source==="serverMediaUpdateRequest"&&b.payload.sdp.type==="answer"&&a.logEvent({name:"smuWithAnswerReceived"});c("promiseDone")(a.onSdpReceived(b.payload.sdp,b.payload.mediaPath,b.payload.mediaStates,(e=b.payload.source)!=null?e:null,b.payload.renegotiationOffer,b.payload.sdpOriginLocalId,b.payload.onProcessed,b.payload.ackMessageId,b.payload.e2eeServerState));return babelHelpers["extends"]({},C((f=a.lastRemoteMediaUpdateVersion)!=null?f:null,b.payload.sdp.version),{lastRemoteSdpResponseMessageId:b.messageID})}function p(a,b){if(b.type!=="receiveRoomContextUpdateRequest")return;c("promiseDone")(a.onRoomContextUpdateReceived(b.payload.context))}function q(a,b){if(b.type!=="receiveStateSyncNotifyRequest")return;var c=a.signalingModel,d=b.payload,e=d.data,f=d.responseRequired,g=d.topic;d=d.version;c.getStateSyncStore().updateOutputState(g,{data:e,version:d});c.notify();if(f){e={ackMessageId:b.messageID,eventName:"stateSyncNotifyResponse",topic:g,version:d};a.sendSignalingEvent(e)}}function r(a,b){if(b.type!=="receiveOverlayConfigServerUpdateRequest")return;a=a.signalingModel;a.updateOverlayConfigServerLayer(b.payload.serverLayer);a.notify()}function s(a,b){if(b.type!=="receiveTerminateRequest")return;b.payload.fromJoinResponse===!0&&a.logEvent({name:"inviteResponseReceived"});if(b.payload.shouldInformPeer){var d={ackMessageId:b.messageID,eventName:"dismissResponse"};a.sendSignalingEvent(d)}c("promiseDone")(a.onDismissReceived(a.signalingModel.getSignalingID(),b.payload.reason,(d=b.payload.subreason)!=null?d:null,b.payload.detailedReasonFromMW))}function t(a,b){if(b.type!=="sendSubscriptionRequest")return{};var c=a.lastSubscriptions;a=a.sendSignalingEvent;var d=[].concat(b.payload.subscriptions).sort(D);d=JSON.stringify(d);c!==d&&a(b.payload,b.onSent,b.onError);return{lastSubscriptions:d}}function u(a,b){if(b.type!=="sendClientRenegotiationRequest")return;b=b.payload.negotiationEvent;a.onClientRenegotiationReceived(b)}function v(a,b){if(b.type!=="sendTerminateRequest")return;b.payload.shouldInformPeer&&a.signalingModel.getRemoteSignalingID()!=null&&a.sendSignalingEvent(b.payload,b.onSent,b.onError)}function w(a,b){if(b.type!=="sendUsersApprovalRequest")return;a.sendSignalingEvent(b.payload,b.onSent,b.onError)}function x(a,b){return a!=null&&b!=null&&a!==b}function y(a,b){return A(a,b,!1)}function z(a,b){return A(a,b,!0)}function A(a,b,d){if(b.type==="receiveMediaUpdateResponse"){var e;e=(e=a==null?void 0:a.lastAckedLocalSdpVersion)!=null?e:-1;var f=b.payload.acknowledgedVersion;c("ZenonDebugLogger").getInstance().logConsole("receiveMediaUpdate: lastAckedSdpVersion "+String(e)+", remoteAckedVersion: "+String(f));if(f>=e){a.lastAckedLocalSdpVersion=f;c("promiseDone")(a.onMediaUpdateResponseReceived({cancelNegotiations:d,responseStatusCode:(e=b.payload.responseStatusCode)!=null?e:null,responseSubCode:(f=b.payload.responseSubCode)!=null?f:null,retryAfter:(d=b.payload.retryAfter)!=null?d:null}))}else c("ZenonDebugLogger").getInstance().logConsole("mediaUpdateResponse: Ignoring old message response");e=a.mediaUpdateRequestToSend;if(e){f=e.onError;b=e.onSent;d=e.payload;e=a.sendSignalingEvent(d,b,f);return{isMediaUpdateResponsePending:!0,lastAckedLocalSdpVersion:a.lastAckedLocalSdpVersion,mediaUpdateRequestToSend:null,mediaUpdateRequestTransactionId:e}}else return{isMediaUpdateResponsePending:!1,lastAckedLocalSdpVersion:a.lastAckedLocalSdpVersion,mediaUpdateRequestTransactionId:""}}return{}}function B(a,b){if(b.type!=="sendLocalSdpRequest")return{};a=a.sendSignalingEvent(b.payload,b.onSent,b.onError);return{mediaUpdateRequestTransactionId:a}}function C(a,b){return a==null||b>a?{lastRemoteMediaUpdateVersion:b}:{}}function D(a,b){if(a.type!==b.type)return a.type-b.type;a=(a=a.trackId)!=null?a:null;b=(b=b.trackId)!=null?b:null;if(a===null||b===null)return 0;else return a.localeCompare(b)}g.genericEventSender=a;g.onReceiveCapabilitiesRequest=b;g.onReceiveClientInfoRequest=e;g.onReceiveGenericDataMessageRequest=f;g.onReceiveIceCandidateRequest=h;g.onReceiveInitiateRenegotiationRequest=i;g.onReceiveLocalSdpResponse=j;g.onReceiveMediaUpdateRequest=k;g.onReceiveParticipantUpdateRequest=l;g.onReceivePendingApprovalRequest=m;g.onServerRenegotiationFinished=n;g.onReceiveRemoteSdpRequest=o;g.onReceiveRoomContextUpdateRequest=p;g.onReceiveStateSyncNotifyRequest=q;g.onReceiveOverlayConfigServerUpdateRequest=r;g.onReceiveTerminateRequest=s;g.onSendSubscriptionRequest=t;g.onSendClientRenegotiationRequest=u;g.onSendTerminateRequest=v;g.onSendUsersApprovalRequest=w;g.shouldRejectRequest=x;g.onNonSDPReceiveMediaUpdateResponse=y;g.onReceiveMediaUpdateResponse=z;g.onSendLocalSdpRequestOffer=B}),98);
__d("ZenonSignalingSMGuards",["ZenonAuditedCheckpointLogId","ZenonInfraActionsLogger","ZenonMWMessageTypes","ZenonSignalingSharedActions","isEmployeeTestUserZenonLogging"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return b.type==="receiveRemoteSdpRequest"&&b.payload.sdp.type==="offer"&&d("ZenonSignalingSharedActions").shouldRejectRequest(a.lastRemoteMediaUpdateVersion,b.payload.fromVersion)===!1}function b(a,b){return b.type==="receiveRemoteSdpRequest"&&b.payload.sdp.type==="offer"&&d("ZenonSignalingSharedActions").shouldRejectRequest(a.lastRemoteMediaUpdateVersion,b.payload.fromVersion)}function e(a,b){return b.type==="receiveRemoteSdpRequest"&&b.payload.sdp.type==="pranswer"}function f(a,b){return b.type==="receiveRemoteSdpRequest"&&b.payload.sdp.type==="answer"}function h(a,b){return b.type==="sendLocalSdpRequest"&&b.payload.sdp.type==="answer"}function i(a,b){return b.type==="receiveLocalSdpResponse"&&b.payload.source==="joinResponse"}function j(a,b){a=b.type==="receiveRemoteSdpRequest"&&(b.payload.source==="serverMediaUpdateRequest"||b.payload.source==="clientMediaUpdateResponse");b.type==="receiveRemoteSdpRequest"&&!a&&(c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"[ZP] Calling the processed function for transaction id: "+String(b.payload.ackMessageId)+". Payload source: "+String(b.payload.source)+"."}),b.payload.onProcessed&&b.payload.onProcessed());return a}function k(a,b){return b.type==="receiveRemoteSdpRequest"&&b.payload.sdp.type==="offer"}function l(a,b){return b.type==="sendLocalSdpRequest"&&b.payload.sdp.type==="offer"}function m(a,b){return b.type==="sendLocalSdpRequest"&&b.payload.sdp.type==="offer"}function n(a,b){var e=b.type==="receiveMediaUpdateResponse"&&b.payload.responseStatusCode!==d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.OK&&b.payload.ackMessageId===a.mediaUpdateRequestTransactionId;b.type==="receiveMediaUpdateResponse"&&b.payload.responseStatusCode!==d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.OK&&c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"[ZP] Server rejected offer with code: "+String(b.payload.responseStatusCode)+", subCode: "+String(b.payload.responseSubCode)+". Outgoing transaction id was: "+String(a.mediaUpdateRequestTransactionId)+". Incoming transaction id was: "+String(b.payload.ackMessageId)+". Transaction should be canceled: "+String(e)+"."});return e}function o(a,b){var d=b.type==="messageSent"&&b.messageID===a.lastRemoteSdpResponseMessageId;b=b.messageID;if(c("isEmployeeTestUserZenonLogging")()){c("ZenonInfraActionsLogger").logCheckpoint({checkpoint:"lastRemoteSdpResponseMessageIdSentGuard: "+(d?"Passed":"Failed")+" Last ID: "+((a=a.lastRemoteSdpResponseMessageId)!=null?a:"null")+". 'Incoming ID: "+((a=b)!=null?a:"null")})}return d}g.sdpOfferReceiveNotRejectedGuard=a;g.sdpOfferReceiveRejectedGuard=b;g.sdpPrAnswerReceiveGuard=e;g.sdpAnswerReceiveGuard=f;g.sdpAnswerSendGuard=h;g.sdpJoinResponseReceiveGuard=i;g.receiveRemoteSdpRequestSmuOrCmuGuard=j;g.sdpOfferReceiveGuard=k;g.sdpOfferSendGuard=l;g.sdpOfferSendGuardNegotiationComplete=m;g.receiveNonOkMediaUpdateResponseGuard=n;g.lastRemoteSdpResponseMessageIdSentGuard=o}),98);
__d("ZenonSignalingTerminatedState",["ODS","ZenonAuditedCheckpointLogId","ZenonInfraActionsLogger","ZenonMWMessageTypes","ZenonSignalingTypes","clearInterval"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){if(a.pingTimer){c("clearInterval")(a.pingTimer);delete a.pingTimer;return a}return{}}function b(a,b){var e;if(b.type!=="receiveRemoteSdpRequest")return;(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_signaling","received_sdp_request_in_signaling_terminated_state");b.payload.onProcessed&&(b.payload.onProcessed(),c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"onProcessed called in ZenonSignalingTerminatedState.onReceiveRemoteSdpRequest"}));e={ackMessageId:(e=b.payload.ackMessageId)!=null?e:b.messageID,acknowledgedVersion:b.payload.sdp.version,eventName:"remoteSdpResponse",messageTags:b.payload.messageTags,negotiateType:b.payload.negotiateType,statusCode:d("ZenonSignalingTypes").ZenonSignalingStatusCode.METHOD_NOT_ALLOWED,subCode:d("ZenonSignalingTypes").ZenonSignalingStatusSubCode.CLIENT_TERMINATED,type:b.payload.sdp.type};a.sendSignalingEvent(e)}function e(a,b){if(b.type!=="receiveInitiateRenegotiationRequest")return;b.payload.onProcessed&&(b.payload.onProcessed(),c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"onProcessed called in ZenonSignalingTerminatedState.onReceiveInitiateRenegotiationRequest"}));b={ackMessageId:b.messageID,acknowledgedVersion:b.payload.version,eventName:"initiateRenegotiationResponse",hasRemoteOffer:!1,statusCode:d("ZenonSignalingTypes").ZenonSignalingStatusCode.METHOD_NOT_ALLOWED,subCode:d("ZenonSignalingTypes").ZenonSignalingStatusSubCode.CLIENT_TERMINATED};a.sendSignalingEvent(b)}function f(a,b){if(b.type!=="receiveMediaUpdateRequest")return;b.payload.onProcessed&&(b.payload.onProcessed(),c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"onProcessed called in ZenonSignalingTerminatedState.onReceiveMediaUpdateRequest"}));b={ackMessageId:b.messageID,acknowledgedVersion:b.payload.mediaStates.version,eventName:"mediaUpdateResponse",responseStatusCode:d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.METHOD_NOT_ALLOWED,responseSubCode:d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CLIENT_TERMINATED};a.sendSignalingEvent(b)}g.stopPingTimer=a;g.onReceiveRemoteSdpRequest=b;g.onReceiveInitiateRenegotiationRequest=e;g.onReceiveMediaUpdateRequest=f}),98);
__d("getReceiveEvent",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c){switch(a.eventName){case"addParticipantsRequest":return{payload:a,type:"receiveAddParticipantsRequest"};case"addParticipantsResponse":return{payload:a,type:"receiveAddParticipantsResponse"};case"pendingApprovalRequest":return{configuration:c,messageID:b,payload:a,type:"receivePendingApprovalRequest"};case"answerIntentRequest":return null;case"clientEventRequest":return null;case"clientRenegotiationRequest":return null;case"capabilitiesRequest":return{configuration:c,messageID:b,payload:a,type:"receiveCapabilitiesRequest"};case"clientInfoRequest":return{configuration:c,messageID:b,payload:a,type:"receiveClientInfoRequest"};case"dismissResponse":return{configuration:c,messageID:b,payload:a,type:"receiveDismissResponse"};case"iceCandidateRequest":return{configuration:c,messageID:b,payload:a,type:"receiveIceCandidateRequest"};case"iceCandidateResponse":return{configuration:c,messageID:b,payload:a,type:"receiveIceCandidateResponse"};case"initiateRenegotiationRequest":return{configuration:c,messageID:b,payload:a,type:"receiveInitiateRenegotiationRequest"};case"initiateRenegotiationResponse":return null;case"inviteRequest":return{configuration:c,messageID:b,payload:a,type:"receiveInviteRequest"};case"inviteResponse":return{configuration:c,messageID:b,payload:a,type:"receiveInviteResponse"};case"localSdpRequest":return null;case"localSdpResponse":return{configuration:c,messageID:b,payload:a,type:"receiveLocalSdpResponse"};case"mediaUpdateRequest":return{configuration:c,messageID:b,payload:a,type:"receiveMediaUpdateRequest"};case"mediaUpdateResponse":return{configuration:c,messageID:b,payload:a,type:"receiveMediaUpdateResponse"};case"overlayConfigServerUpdateRequest":return{configuration:c,messageID:b,payload:a,type:"receiveOverlayConfigServerUpdateRequest"};case"participantUpdateRequest":return{configuration:c,messageID:b,payload:a,type:"receiveParticipantUpdateRequest"};case"participantUpdateResponse":return{configuration:c,messageID:b,payload:a,type:"receiveParticipantUpdateResponse"};case"pingResponse":return{configuration:c,messageID:b,payload:a,type:"receivePingResponse"};case"pingRequest":return null;case"remoteSdpRequest":return{configuration:c,messageID:b,payload:a,type:"receiveRemoteSdpRequest"};case"remoteSdpResponse":return{configuration:c,messageID:b,payload:a,type:"receiveRemoteSdpResponse"};case"stateSyncNotifyRequest":return{configuration:c,messageID:b,payload:a,type:"receiveStateSyncNotifyRequest"};case"stateSyncNotifyResponse":return null;case"stateSyncUnsubscribeRequest":return null;case"stateSyncUnsubscribeResponse":return{configuration:c,messageID:b,payload:a,type:"receiveStateSyncUnsubscribeResponse"};case"stateSyncUpdateRequest":return null;case"stateSyncUpdateResponse":return{configuration:c,messageID:b,payload:a,type:"receiveStateSyncUpdateResponse"};case"subscriptionRequest":return null;case"removeParticipantsRequest":return null;case"usersApprovalRequest":return null;case"terminateRequest":return{configuration:c,messageID:b,payload:a,type:"receiveTerminateRequest"};case"hangupResponse":return null;case"roomContextUpdateRequest":return{configuration:c,messageID:b,payload:a,type:"receiveRoomContextUpdateRequest"};case"genericDataMessageRequest":return{configuration:c,messageID:b,payload:a,type:"receiveGenericDataMessageRequest"};case"genericDataMessageResponse":return{configuration:c,messageID:b,payload:a,type:"receiveGenericDataMessageResponse"};case"wakeupRequest":return{configuration:c,messageID:b,payload:a,type:"receiveWakeupRequest"};case"wakeupResponse":return null;default:a;return null}}f["default"]=a}),66);
__d("getSendEvent",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c){switch(a.eventName){case"addParticipantsRequest":return{onError:c,onSent:b,payload:a,type:"sendAddParticipantsRequest"};case"addParticipantsResponse":return{onError:c,onSent:b,payload:a,type:"sendAddParticipantsResponse"};case"answerIntentRequest":return{onError:c,onSent:b,payload:a,type:"sendAnswerIntentRequest"};case"usersApprovalRequest":return{onError:c,onSent:b,payload:a,type:"sendUsersApprovalRequest"};case"capabilitiesRequest":return{onError:c,onSent:b,payload:a,type:"sendCapabilitiesRequest"};case"clientEventRequest":return{onError:c,onSent:b,payload:a,type:"sendClientEventRequest"};case"clientInfoRequest":return{onError:c,onSent:b,payload:a,type:"sendClientInfoRequest"};case"clientRenegotiationRequest":return{onError:c,onSent:b,payload:a,type:"sendClientRenegotiationRequest"};case"dismissResponse":return{onError:c,onSent:b,payload:a,type:"sendDismissResponse"};case"iceCandidateRequest":return{onError:c,onSent:b,payload:a,type:"sendIceCandidateRequest"};case"iceCandidateResponse":return{onError:c,onSent:b,payload:a,type:"sendIceCandidateResponse"};case"initiateRenegotiationRequest":return null;case"initiateRenegotiationResponse":return{onError:c,onSent:b,payload:a,type:"sendInitiateRenegotiationResponse"};case"inviteRequest":return{onError:c,onSent:b,payload:a,type:"sendInviteRequest"};case"inviteResponse":return{onError:c,onSent:b,payload:a,type:"sendInviteResponse"};case"localSdpRequest":return{onError:c,onSent:b,payload:a,type:"sendLocalSdpRequest"};case"localSdpResponse":return{onError:c,onSent:b,payload:a,type:"sendLocalSdpResponse"};case"mediaUpdateRequest":return{onError:c,onSent:b,payload:a,type:"sendMediaUpdateRequest"};case"mediaUpdateResponse":return{onError:c,onSent:b,payload:a,type:"sendMediaUpdateResponse"};case"overlayConfigServerUpdateRequest":return{onError:c,onSent:b,payload:a,type:"sendOverlayConfigServerUpdateRequest"};case"participantUpdateRequest":return{onError:c,onSent:b,payload:a,type:"sendParticipantUpdateRequest"};case"participantUpdateResponse":return{onError:c,onSent:b,payload:a,type:"sendParticipantUpdateResponse"};case"pingResponse":return null;case"pingRequest":return{onError:c,onSent:b,payload:a,type:"sendPingRequest"};case"remoteSdpRequest":return null;case"remoteSdpResponse":return{onError:c,onSent:b,payload:a,type:"sendRemoteSdpResponse"};case"subscriptionRequest":return{onError:c,onSent:b,payload:a,type:"sendSubscriptionRequest"};case"removeParticipantsRequest":return{onError:c,onSent:b,payload:a,type:"sendRemoveParticipantsRequest"};case"stateSyncNotifyRequest":return null;case"stateSyncNotifyResponse":return{onError:c,onSent:b,payload:a,type:"sendStateSyncNotifyResponse"};case"stateSyncUnsubscribeRequest":return{onError:c,onSent:b,payload:a,type:"sendStateSyncUnsubscribeRequest"};case"stateSyncUnsubscribeResponse":return null;case"stateSyncUpdateRequest":return{onError:c,onSent:b,payload:a,type:"sendStateSyncUpdateRequest"};case"stateSyncUpdateResponse":return null;case"terminateRequest":return{onError:c,onSent:b,payload:a,type:"sendTerminateRequest"};case"hangupResponse":return null;case"roomContextUpdateRequest":return null;case"genericDataMessageRequest":return{onError:c,onSent:b,payload:a,type:"sendGenericDataMessageRequest"};case"pendingApprovalRequest":return null;case"genericDataMessageResponse":return{onError:c,onSent:b,payload:a,type:"sendGenericDataMessageResponse"};case"wakeupRequest":return null;case"wakeupResponse":return{onError:c,onSent:b,payload:a,type:"sendWakeupResponse"};default:a;return null}}f["default"]=a}),66);
__d("ZenonSignalingStateMachine",["Promise","ZenonDebugLogger","ZenonInfraActionsLogger","ZenonLogPromiseRejection","ZenonMWMessageReliabilityLogTypes","ZenonSignalingInitState","ZenonSignalingInviteReceivedState","ZenonSignalingNegotiationCompleteState","ZenonSignalingSMGuards","ZenonSignalingSharedActions","ZenonSignalingTerminatedState","ZenonStateMachineBase","err","getReceiveEvent","getSendEvent","qpl","xstate"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=["receiveRemoteSdpRequest","receiveInitiateRenegotiationRequest","receiveMediaUpdateRequest"],l={loggingStateName:"signalingState",name:"SignalingStateMachine",shortname:"Signaling"};e=function(a){babelHelpers.inheritsLoose(e,a);function e(b,e){var f;e===void 0&&(e="init");f=a.call(this,{base:{guards:d("ZenonSignalingSMGuards"),initState:"init"},logging:babelHelpers["extends"]({},l,{eventToLogTimeoutsOn:null,getTransactionId:function(a){return a.type!=="messageSent"?a.payload.ackMessageId:null},loggableEvents:k,loggingId:+b.signalingModel.getSignalingID()}),machine:{context:babelHelpers["extends"]({},b),initialState:e,states:J}})||this;f.sm.onTransition(function(a){c("ZenonInfraActionsLogger").updateCachedValues({signalingState:a.value});var b=a.event.type==="receiveRemoteSdpRequest"?a.event.messageID:null;f.logTransition(a,b);f.logTransaction(a.event,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSED_SM_EVENT);f.ifDroppedEvent(a,function(a){a.onError&&a.onError(c("err")("event was dropped: "+a.type))})});f.$ZenonSignalingStateMachine$p_1=b.sendSignalingEvent;c("ZenonDebugLogger").getInstance().startQPL(c("qpl")._(64245348,"8823"),f.loggingId);return f}var f=e.prototype;f.processSendEvent=function(a){var d=this;return c("ZenonLogPromiseRejection")(new(j||(j=b("Promise")))(function(b,e){e=c("getSendEvent")(a,b,e);e!=null?d.$ZenonSignalingStateMachine$p_2(e):b()}))};f.processReceiveEvent=function(a,b,d){if(a.eventName==="wakeupRequest"){this.$ZenonSignalingStateMachine$p_1(a);return}a=c("getReceiveEvent")(a,b,d);a!=null&&this.$ZenonSignalingStateMachine$p_2(a)};f.processEvent=function(a){this.$ZenonSignalingStateMachine$p_2(a)};f.$ZenonSignalingStateMachine$p_2=function(a){var b=a.type==="receiveRemoteSdpRequest"?a.messageID:null;this.logEvent(a,b);this.sm.send(a)};return e}((a=d("ZenonStateMachineBase")).ZenonStateMachineBase);var m={actions:[(f=d("ZenonSignalingSharedActions")).genericEventSender]},n={actions:[f.onReceiveTerminateRequest],target:"terminated"},o={actions:[f.genericEventSender]},p={actions:[f.genericEventSender]},q={actions:[f.genericEventSender]},r={actions:[f.onReceiveCapabilitiesRequest]},s={actions:[f.onReceiveClientInfoRequest]},t={actions:[f.onReceiveGenericDataMessageRequest]},u={actions:[f.onReceiveIceCandidateRequest]},v={actions:[f.genericEventSender]},w={actions:[f.genericEventSender]},x={actions:[f.genericEventSender]},y={actions:[(h=d("xstate")).assign(f.onSendSubscriptionRequest)]},z={actions:[f.onSendTerminateRequest],target:"terminated"},A={actions:[f.genericEventSender]},B={actions:[h.assign(f.onReceiveParticipantUpdateRequest)]},C={actions:[f.onReceiveRoomContextUpdateRequest]},D={actions:[f.onReceiveOverlayConfigServerUpdateRequest]},E={actions:[f.onReceiveStateSyncNotifyRequest]},F={actions:[f.genericEventSender]},G={actions:[f.genericEventSender]},H={actions:[f.onSendUsersApprovalRequest]},I={actions:[h.assign(f.onReceiveMediaUpdateRequest)]},J={init:{on:{sendInviteRequest:{actions:[h.assign((i=d("ZenonSignalingInitState")).startPingTimer),i.onSendInvite],target:"inviteSent"},receiveInviteRequest:{target:"inviteReceived",actions:[h.assign(i.startPingTimer),h.assign(i.onReceiveInvite)]},receiveTerminateRequest:n,sendTerminateRequest:z,receiveRoomContextUpdateRequest:C,sendClientInfoRequest:m,sendRemoveParticipantsRequest:A,sendUsersApprovalRequest:H,sendSubscriptionRequest:y,receiveMediaUpdateRequest:I,receiveOverlayConfigServerUpdateRequest:D,receiveStateSyncNotifyRequest:E,sendLocalSdpRequest:a.defer,receiveCapabilitiesRequest:a.defer,receiveClientInfoRequest:a.defer,receiveGenericDataMessageRequest:a.defer,receiveIceCandidateRequest:a.defer,receiveParticipantUpdateRequest:a.defer,receiveLocalSdpResponse:a.defer,receiveMediaUpdateResponse:a.defer,receiveRemoteSdpRequest:a.defer,sendGenericDataMessageRequest:a.defer,sendIceCandidateRequest:a.defer,sendStateSyncUnsubscribeRequest:a.defer,sendStateSyncUpdateRequest:a.defer,sendCapabilitiesRequest:a.defer,sendClientRenegotiationRequest:a.defer}},inviteSent:{on:{sendLocalSdpRequest:{actions:[f.genericEventSender],cond:(i=d("ZenonSignalingSMGuards")).sdpOfferSendGuard,target:"offerSdpSent"},receiveTerminateRequest:n,sendTerminateRequest:z,receiveIceCandidateRequest:u,receiveParticipantUpdateRequest:B,receiveRoomContextUpdateRequest:C,sendCapabilitiesRequest:x,sendClientInfoRequest:m,sendRemoveParticipantsRequest:A,receiveMediaUpdateRequest:I,receiveOverlayConfigServerUpdateRequest:D,receiveStateSyncNotifyRequest:E,sendSubscriptionRequest:y,sendUsersApprovalRequest:H,sendMediaUpdateRequest:a.defer,sendIceCandidateRequest:a.defer,receiveGenericDataMessageRequest:a.defer,sendGenericDataMessageRequest:a.defer,sendStateSyncUnsubscribeRequest:a.defer,sendStateSyncUpdateRequest:a.defer,sendClientRenegotiationRequest:a.defer}},offerSdpSent:{on:{receiveLocalSdpResponse:{actions:[f.onReceiveLocalSdpResponse],cond:i.sdpJoinResponseReceiveGuard,target:"offerSdpAcknowledged"},receiveTerminateRequest:n,receiveCapabilitiesRequest:r,receiveClientInfoRequest:s,receiveIceCandidateRequest:u,receiveMediaUpdateRequest:I,receiveParticipantUpdateRequest:B,receiveRoomContextUpdateRequest:C,sendAddParticipantsRequest:w,sendAnswerIntentRequest:o,sendUsersApprovalRequest:H,sendClientInfoRequest:m,sendRemoveParticipantsRequest:A,receiveOverlayConfigServerUpdateRequest:D,receiveStateSyncNotifyRequest:E,sendSubscriptionRequest:y,receivePendingApprovalRequest:a.defer,receiveRemoteSdpRequest:a.defer,receiveInitiateRenegotiationRequest:a.defer,sendGenericDataMessageRequest:a.defer,sendIceCandidateRequest:a.defer,sendMediaUpdateRequest:a.defer,receiveGenericDataMessageRequest:a.defer,sendStateSyncUnsubscribeRequest:a.defer,sendStateSyncUpdateRequest:a.defer,sendTerminateRequest:a.defer,sendClientRenegotiationRequest:a.defer}},offerSdpAcknowledged:{on:{receivePendingApprovalRequest:{actions:[f.onReceivePendingApprovalRequest]},receiveRemoteSdpRequest:[{actions:[h.assign(f.onReceiveRemoteSdpRequest)],cond:i.sdpAnswerReceiveGuard,target:"negotiationComplete"},{actions:[h.assign(f.onReceiveRemoteSdpRequest)],cond:i.sdpPrAnswerReceiveGuard},babelHelpers["extends"]({},a.defer,{cond:i.sdpOfferReceiveGuard})],receiveInitiateRenegotiationRequest:{actions:[h.assign(f.onReceiveInitiateRenegotiationRequest)],target:"negotiationComplete"},receiveTerminateRequest:n,sendTerminateRequest:z,receiveCapabilitiesRequest:r,receiveClientInfoRequest:s,receiveIceCandidateRequest:u,receiveMediaUpdateRequest:I,receiveParticipantUpdateRequest:B,receiveRoomContextUpdateRequest:C,sendAddParticipantsRequest:w,sendAnswerIntentRequest:o,sendUsersApprovalRequest:H,sendClientInfoRequest:m,sendRemoveParticipantsRequest:A,receiveOverlayConfigServerUpdateRequest:D,receiveStateSyncNotifyRequest:E,sendStateSyncUnsubscribeRequest:G,sendStateSyncUpdateRequest:F,sendSubscriptionRequest:y,sendIceCandidateRequest:q,sendGenericDataMessageRequest:a.defer,sendMediaUpdateRequest:a.defer,receiveGenericDataMessageRequest:a.defer,sendClientRenegotiationRequest:a.defer}},inviteReceived:{on:{sendInviteResponse:{actions:[d("ZenonSignalingInviteReceivedState").onSendInviteResponse],target:"inviteAcknowledged"},sendTerminateRequest:z,receiveRoomContextUpdateRequest:C,sendAnswerIntentRequest:o,sendIceCandidateRequest:q,sendUsersApprovalRequest:H,sendRemoveParticipantsRequest:A,receiveMediaUpdateRequest:I,receiveOverlayConfigServerUpdateRequest:D,receiveStateSyncNotifyRequest:E,sendStateSyncUnsubscribeRequest:G,sendStateSyncUpdateRequest:F,sendSubscriptionRequest:y,receiveCapabilitiesRequest:a.defer,receiveClientInfoRequest:a.defer,receiveGenericDataMessageRequest:a.defer,receiveIceCandidateRequest:a.defer,receiveParticipantUpdateRequest:a.defer,receiveRemoteSdpRequest:a.defer,sendGenericDataMessageRequest:a.defer,receiveTerminateRequest:a.defer,sendClientRenegotiationRequest:a.defer,sendMediaUpdateRequest:a.defer}},inviteAcknowledged:{on:{sendLocalSdpRequest:[{actions:[f.genericEventSender],cond:i.sdpOfferSendGuard,target:"offerSdpSent"},{actions:[f.genericEventSender],cond:i.sdpAnswerSendGuard,target:"negotiationComplete"}],receiveRemoteSdpRequest:{actions:[h.assign(f.onReceiveRemoteSdpRequest)],cond:i.sdpOfferReceiveGuard,target:"offerSdpReceived"},receiveTerminateRequest:n,sendTerminateRequest:z,receiveCapabilitiesRequest:r,receiveClientInfoRequest:s,receiveIceCandidateRequest:u,receiveMediaUpdateRequest:I,receiveParticipantUpdateRequest:B,receiveRoomContextUpdateRequest:C,sendAnswerIntentRequest:o,sendClientInfoRequest:m,sendIceCandidateRequest:q,receiveOverlayConfigServerUpdateRequest:D,receiveStateSyncNotifyRequest:E,sendSubscriptionRequest:y,sendStateSyncUpdateRequest:a.defer,sendUsersApprovalRequest:a.defer,sendRemoveParticipantsRequest:a.defer,sendStateSyncUnsubscribeRequest:a.defer,sendMediaUpdateRequest:a.defer,sendGenericDataMessageRequest:a.defer,receiveGenericDataMessageRequest:a.defer,sendClientRenegotiationRequest:a.defer}},offerSdpReceived:{on:{sendLocalSdpRequest:[{actions:f.genericEventSender,cond:i.sdpAnswerSendGuard}],receiveTerminateRequest:n,sendTerminateRequest:z,receiveLocalSdpResponse:{actions:[f.onReceiveLocalSdpResponse],target:"negotiationComplete"},receiveCapabilitiesRequest:r,receiveClientInfoRequest:s,receiveIceCandidateRequest:u,receiveMediaUpdateRequest:I,receiveParticipantUpdateRequest:B,receiveRoomContextUpdateRequest:C,sendAnswerIntentRequest:o,sendCapabilitiesRequest:x,sendClientInfoRequest:m,sendIceCandidateRequest:q,receiveOverlayConfigServerUpdateRequest:D,receiveStateSyncNotifyRequest:E,sendSubscriptionRequest:y,sendUsersApprovalRequest:a.defer,sendRemoveParticipantsRequest:a.defer,sendStateSyncUnsubscribeRequest:a.defer,sendStateSyncUpdateRequest:a.defer,receiveRemoteSdpRequest:a.defer,sendGenericDataMessageRequest:a.defer,receiveGenericDataMessageRequest:a.defer,sendClientRenegotiationRequest:a.defer,sendMediaUpdateRequest:a.defer}},negotiationComplete:{on:{receiveInitiateRenegotiationRequest:{actions:[h.assign(f.onReceiveInitiateRenegotiationRequest)]},receiveLocalSdpResponse:{actions:[f.onReceiveLocalSdpResponse],cond:i.sdpJoinResponseReceiveGuard},receiveMediaUpdateResponse:{actions:[h.assign(f.onNonSDPReceiveMediaUpdateResponse)]},receivePendingApprovalRequest:{actions:[f.onReceivePendingApprovalRequest]},receiveRemoteSdpRequest:[{actions:[h.assign(f.onReceiveRemoteSdpRequest)],cond:i.sdpOfferReceiveNotRejectedGuard,target:"serverInitiatedRenegotiating"},{actions:[h.assign(f.onReceiveRemoteSdpRequest)],cond:i.sdpOfferReceiveRejectedGuard},{actions:[h.assign(d("ZenonSignalingNegotiationCompleteState").onReceiveAnswer)],cond:i.sdpAnswerReceiveGuard}],sendClientRenegotiationRequest:{actions:[f.onSendClientRenegotiationRequest],target:"clientInitiatedRenegotiating"},sendLocalSdpRequest:[{actions:[h.assign(f.onSendLocalSdpRequestOffer)],cond:i.sdpOfferSendGuardNegotiationComplete,target:"clientInitiatedRenegotiating"},{actions:[f.genericEventSender],cond:i.sdpAnswerSendGuard}],receiveTerminateRequest:n,sendTerminateRequest:z,receiveOverlayConfigServerUpdateRequest:D,receiveParticipantUpdateRequest:B,receiveMediaUpdateRequest:I,receiveCapabilitiesRequest:r,receiveClientInfoRequest:s,receiveGenericDataMessageRequest:t,receiveIceCandidateRequest:u,receiveRoomContextUpdateRequest:C,receiveStateSyncNotifyRequest:E,sendAddParticipantsRequest:w,sendClientEventRequest:v,sendGenericDataMessageRequest:p,sendIceCandidateRequest:q,sendMediaUpdateRequest:[{actions:[h.assign(d("ZenonSignalingNegotiationCompleteState").onSendMediaUpdateRequest)]}],sendPingRequest:{actions:[f.genericEventSender]},sendRemoveParticipantsRequest:A,sendStateSyncUnsubscribeRequest:G,sendStateSyncUpdateRequest:F,sendSubscriptionRequest:y,sendUsersApprovalRequest:H}},serverInitiatedRenegotiating:{on:{sendLocalSdpRequest:[{actions:["defer"],cond:i.sdpOfferSendGuard},{actions:[f.genericEventSender,f.onServerRenegotiationFinished],cond:i.sdpAnswerSendGuard,target:"negotiationComplete"}],messageSent:{actions:[f.onServerRenegotiationFinished],cond:i.lastRemoteSdpResponseMessageIdSentGuard,target:"negotiationComplete"},receiveTerminateRequest:n,sendTerminateRequest:z,receiveGenericDataMessageRequest:t,receiveIceCandidateRequest:u,receiveParticipantUpdateRequest:B,receiveRoomContextUpdateRequest:C,sendUsersApprovalRequest:H,sendIceCandidateRequest:q,sendSubscriptionRequest:y,sendGenericDataMessageRequest:p,sendClientEventRequest:v,receiveMediaUpdateRequest:a.defer,receiveCapabilitiesRequest:a.defer,receiveClientInfoRequest:a.defer,receiveLocalSdpResponse:a.defer,receiveRemoteSdpRequest:a.defer,sendMediaUpdateRequest:a.defer,sendClientRenegotiationRequest:a.defer,receiveMediaUpdateResponse:a.defer,sendRemoveParticipantsRequest:a.defer,receiveOverlayConfigServerUpdateRequest:a.defer,receiveStateSyncNotifyRequest:a.defer,sendStateSyncUnsubscribeRequest:a.defer,sendStateSyncUpdateRequest:a.defer,sendAddParticipantsRequest:a.defer}},clientInitiatedRenegotiating:{on:{receiveRemoteSdpRequest:[{actions:["defer"],cond:i.sdpOfferReceiveGuard},{actions:[h.assign(f.onReceiveRemoteSdpRequest)],cond:i.sdpAnswerReceiveGuard,target:"negotiationComplete"}],receiveMediaUpdateResponse:[{actions:[h.assign(f.onReceiveMediaUpdateResponse)],cond:i.receiveNonOkMediaUpdateResponseGuard,target:"negotiationComplete"},{actions:["defer"]}],receiveTerminateRequest:n,sendTerminateRequest:z,sendLocalSdpRequest:[{actions:[h.assign(f.onSendLocalSdpRequestOffer)],cond:i.sdpOfferSendGuard},{actions:["defer"],cond:i.sdpAnswerSendGuard}],receiveCapabilitiesRequest:r,receiveClientInfoRequest:s,receiveGenericDataMessageRequest:t,receiveIceCandidateRequest:u,receiveMediaUpdateRequest:I,receiveParticipantUpdateRequest:B,receiveRoomContextUpdateRequest:C,sendUsersApprovalRequest:H,sendAddParticipantsRequest:w,sendIceCandidateRequest:q,sendRemoveParticipantsRequest:A,receiveOverlayConfigServerUpdateRequest:D,receiveStateSyncNotifyRequest:E,sendStateSyncUnsubscribeRequest:G,sendStateSyncUpdateRequest:F,sendSubscriptionRequest:y,sendGenericDataMessageRequest:p,sendClientEventRequest:v,receiveLocalSdpResponse:a.defer,sendMediaUpdateRequest:a.defer,sendClientRenegotiationRequest:a.defer,receiveInitiateRenegotiationRequest:a.defer}},terminated:{entry:[h.assign((o=d("ZenonSignalingTerminatedState")).stopPingTimer)],on:{receiveRemoteSdpRequest:[{actions:[o.onReceiveRemoteSdpRequest],cond:i.receiveRemoteSdpRequestSmuOrCmuGuard}],receiveInitiateRenegotiationRequest:[{actions:[o.onReceiveInitiateRenegotiationRequest]}],receiveMediaUpdateRequest:[{actions:[o.onReceiveMediaUpdateRequest]}]}}};g["default"]=e}),98);
__d("ZenonSignalingClient",["Promise","ZenonActorHooks","ZenonDismissReason","ZenonE2eeMandatedStateManager","ZenonInfraActionsLogger","ZenonMWMessageTypes","ZenonMediaActionLogger","ZenonSignalingStateMachine","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a,b,d,e,f){var g=this;f===void 0&&(f=null);this.$5=null;this.$6=function(){};this.$1=a;var h=this.$7();this.$2=new(c("ZenonSignalingStateMachine"))(babelHelpers["extends"]({config:f,logEvent:function(a){return g.$6(a)},onInviteReceived:function(a,b){e(a,b,g)},sendSignalingEvent:function(a,b,c){return d.sendEvent(a,b,c)}},h,{signalingModel:a}));b.setReceiver(function(a,b,c){return g.processReceiveEvent(a,b,c)});this.$3=b;this.$4=d}var e=a.prototype;e.getSignalingModel=function(){return this.$1};e.processReceiveEvent=function(a,b,c){this.$2.processReceiveEvent(a,b,c)};e.sendInvite=function(a,b,c,e){e===void 0&&(e=d("ZenonActorHooks").ZenonActor.getID());c={actorID:null,appMessages:b,eventName:"inviteRequest",inviterID:"0",isRemoteOfferer:!1,otherParticipants:a,requestingVideo:!1,roomInfo:{name:"mock"},userID:e};return this.$2.processSendEvent(c)};e.initiateClientRenegotiation=function(a){a={eventName:"clientRenegotiationRequest",negotiationEvent:a};return this.$2.processSendEvent(a)};e.sendSdp=function(a,b){var c=this.$1.getMediaModeManager().getMediaMode();c={eventName:"localSdpRequest",mediaMode:c,mediaStates:b,sdp:a};return this.$2.processSendEvent(c)};e.sendIceCandidate=function(a){a={eventName:"iceCandidateRequest",iceCandidates:[a]};return this.$2.processSendEvent(a)};e.sendClientEvent=function(a){a={clientEventType:a,eventName:"clientEventRequest"};return this.$2.processSendEvent(a)};e.sendDismiss=function(a){this.$6({name:"dismissSent"});a={eventName:"terminateRequest",fromJoinResponse:!1,reason:a,shouldInformPeer:!0};return this.$2.processSendEvent(a)};e.silentlyTerminate=function(){var a={eventName:"terminateRequest",fromJoinResponse:!1,reason:d("ZenonDismissReason").ZenonDismissReason.OtherInstanceHandled,shouldInformPeer:!1};return this.$2.processSendEvent(a)};e.sendGenericDataMessage=function(a,b,c,d){b={data:b,eventName:"genericDataMessageRequest",recipientIDs:c,serviceRecipients:d,topic:a};return this.$2.processSendEvent(b)};e.sendMediaUpdate=function(a){a={eventName:"mediaUpdateRequest",mediaStates:a};return this.$2.processSendEvent(a)};e.sendAddParticipantsMessage=function(a,b){b={eventName:"addParticipantsRequest",groupThreadId:b,participants:a};return this.$2.processSendEvent(b)};e.sendRemoveParticipantsRequest=function(a){a={eventName:"removeParticipantsRequest",participants:a};return this.$2.processSendEvent(a)};e.sendUsersApprovalRequest=function(a,b){a={approvalStatus:a,eventName:"usersApprovalRequest",targetUsers:b};return this.$2.processSendEvent(a)};e.sendClientInfo=function(a,b,e,f){var g=this,h;(b||e)&&(h=new Map());b&&b.forEach(function(a,b){var c;(c=h)==null?void 0:c.set(b,g.getSignalingModel().getStateSyncStore().updateInputState(b,a))});e&&e.forEach(function(a,b){var c;(c=h)==null?void 0:c.set(b,a)});b=this.$1.getMediaModeManager().getMediaMode();e={actorRepresentatives:new Map(),e2eeInfraMandatedExpStatus:c("ZenonE2eeMandatedStateManager").getE2eeInfraMandatedExpStatus(),eventName:"clientInfoRequest",initialSyncStates:h,isE2eeMandated:c("ZenonE2eeMandatedStateManager").areBothInfraAndProductE2eeMandated(),isSecondaryJoinRole:f,mediaPath:d("ZenonMWMessageTypes").ZenonMWMediaPath[b.toUpperCase()],userCapabilities:a};return this.$2.processSendEvent(e)};e.sendStateSyncUnsubscribe=function(a){var b=this.getSignalingModel(),c=b.getStateSyncStore().unsubscribe(a);a={eventName:"stateSyncUnsubscribeRequest",topic:a,version:c.version};c=this.$2.processSendEvent(a);b.notify();return c};e.sendStateSyncUpdate=function(a,b){var c=this.getSignalingModel();b=c.getStateSyncStore().updateInputState(a,b);a={data:b.data!=null?b.data:void 0,eventName:"stateSyncUpdateRequest",topic:a,version:b.version};b=this.$2.processSendEvent(a);c.notify();return b};e.sendSubscriptionRequest=function(a){a={eventName:"subscriptionRequest",subscriptions:a};return this.$2.processSendEvent(a)};e.receiveMessage=function(a){var b=a.getHeader(),d=b.remoteSignalingID;b=b.roomInfo;d!=null&&this.$1.getRemoteSignalingID()!==d&&(this.$1.updateRemoteSignalingID(d),this.$6({conferenceName:b.name,name:"setRemoteSignalingID",remoteSignalingID:d}),this.$1.notify());b!=null&&this.$1.getRoomInfo().name!==b.name&&(c("ZenonInfraActionsLogger").updateCachedValues({conferenceName:b.name}),c("ZenonMediaActionLogger").updateCachedValues({conferenceName:b.name}),this.$1.updateRoomInfo(b),this.$1.notify());this.$3.receiveMessage(a)};e.isTerminated=function(){return this.$2.getState()==="terminated"};e.sendAnswerIntent=function(){var a={eventName:"answerIntentRequest"};return this.$2.processSendEvent(a)};e.respondToInvite=function(a){a={ackMessageId:"",eventName:"inviteResponse",status:a};return this.$2.processSendEvent(a)};e.setSignalingEventHandlers=function(a){if(this.$5!=null){c("recoverableViolation")("setSignalingEventHandlers should only be called once, to avoid accidentally losing handlers.","rtc_www");return}this.$5=a};e.setLoggingEventHandler=function(a){this.$6=a,this.$3.setLoggingEventHandler(a)};e.setSecureDataMessageManager=function(a){a!=null&&this.$3.setSecureDataMessageManager(a)};e.$7=function(){return{onCapabilitiesReceived:this.$8("onCapabilitiesReceived"),onClientInfoReceived:this.$8("onClientInfoReceived"),onClientRenegotiationReceived:this.$9("onClientRenegotiationReceived"),onDismissReceived:this.$8("onDismissReceived"),onGenericDataMessageReceived:this.$8("onGenericDataMessageReceived"),onIceCandidateReceived:this.$8("onIceCandidateReceived"),onInviteAcknowledgeSent:this.$8("onInviteAcknowledgeSent"),onMediaUpdateReceived:this.$8("onMediaUpdateReceived"),onMediaUpdateResponseReceived:this.$8("onMediaUpdateResponseReceived"),onParticipantUpdateReceived:this.$8("onParticipantUpdateReceived"),onPendingApprovalReceived:this.$8("onPendingApprovalReceived"),onRenegotiationRequested:this.$8("onRenegotiationRequested"),onRoomContextUpdateReceived:this.$8("onRoomContextUpdateReceived"),onSdpReceived:this.$8("onSdpReceived"),onServerRenegotiationFinished:this.$8("onServerRenegotiationFinished")}};e.$9=function(a){var b=this;return function(){if(b.$5&&b.$5[a]){var c;(c=b.$5)[a].apply(c,arguments)}}};e.$8=function(a){var c=this;return function(){if(c.$5&&c.$5[a]){var d;return(d=c.$5)[a].apply(d,arguments)}return(h||(h=b("Promise"))).resolve()}};return a}();g["default"]=a}),98);
__d("ZenonSimulcastUtils",["UserAgent","ZenonSimulcastManager","gkx"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a;return(a=c("gkx")("25212"))!=null?a:!1}function a(){return i()&&h()}function i(){return c("UserAgent").isBrowser("Chrome >= 88")}function b(){return c("gkx")("25212")?d("ZenonSimulcastManager").NUM_LAYERS:1}function e(){return d("ZenonSimulcastManager").MAX_NUM_ACTIVE_LAYERS}g.shouldUseChromeSimulcast=h;g.shouldUseSimulcast=a;g.isCurrentBrowserCompatibleWithSimulcast=i;g.getNumLayers=b;g.getMaxNumLayers=e}),98);
__d("ZenonTransportEventEmitter",["EventEmitter"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.emitJoinReady=function(a){this.emit("transportPlatformEvent",{messageType:"joinReady",mwThriftRingRequest:a})};c.emitParentWindowConnectionTimeout=function(){this.emit("transportPlatformEvent",{messageType:"parentWindowConnectionTimeout",mwThriftRingRequest:null})};return b}(c("EventEmitter"));b=new a();d=b;g["default"]=d}),98);
__d("XVideoCallTurnDiscoveryController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/videocall/turndiscovery/",{version:{type:"Int",required:!0},call_id:{type:"String"}})}),null);
__d("ZenonUtils",["AsyncRequest","AsyncResponse","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h=6e3;function a(a,b,d,e,f,g){b===void 0&&(b=c("emptyFunction"));d===void 0&&(d=c("emptyFunction"));e===void 0&&(e=!1);f===void 0&&(f=h);g===void 0&&(g={});a=new(c("AsyncRequest"))().setURI(a).setData(g).setAllowCrossPageTransition(!0).setHandler(b).setErrorHandler(d).setTimeoutHandler(f,function(a){d(new(c("AsyncResponse"))(a,{}))});a.setMethod("POST");e&&a.setOption("asynchronous_DEPRECATED",!1);a.send()}g.sendServerRequest=a}),98);
__d("ZenonTurnDiscovery",["Promise","XVideoCallTurnDiscoveryController","ZenonDebugLogger","ZenonInfraActionsLogger","ZenonUtils","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i=3,j=null;function a(a,e,f){f===void 0&&(f=i);var g=j;if(g!=null){c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({callType:"mw",checkpoint:"[ZP] returning cached TURN credentials"});return g}g=1;var k=c("XVideoCallTurnDiscoveryController").getURIBuilder().setInt("version",g).setString("call_id",a).getURI();c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({callType:"mw",checkpoint:"[ZP] sending TURN server request to url "+k.toString()});j=new(h||(h=b("Promise")))(function(b,g){h(f);function h(f){d("ZenonUtils").sendServerRequest(k,function(a){a=a.payload;return b(a)},function(){f>0?(c("ZenonDebugLogger").getFBLogger({peerID:e,signalingID:a}).warn("Failed turn; going to retry"),h(f-1)):g(c("err")("failed"))})}});return j}g.requestTurnCreds=a}),98);
__d("ZenonCallsManager",["invariant","FBLogger","JSResourceForInteraction","MultiwaySharedTypes","OverlayConfigManagerWithServerLayer","PersistedQueue","RTWebIncomingRingConfiguration","SCTPSignalingListener","ZenonActorHooks","ZenonAppProvider","ZenonAuditedCheckpointLogId","ZenonCallLogger","ZenonChildClientPerfQPLLogProcessor","ZenonChildQPLLogProcessor","ZenonCollisionContext","ZenonConnectionStateManager","ZenonDismissReason","ZenonE2ee","ZenonE2eeMandatedStateManager","ZenonEncryptionKeysManagerState","ZenonGraphQLMWThriftMessageSender","ZenonInfraActionsLogger","ZenonLSCallStartEventLogProcessor","ZenonLSCallSummaryLogProcessor","ZenonLSE2EEStatsLogProcessor","ZenonLSPeerConnectionSummaryLogProcessor","ZenonLSStarRatingsLogProcessor","ZenonLastCallLogProcessor","ZenonLocalMediaSDK","ZenonLoggingEventTypes","ZenonMWThriftMessageTranslator","ZenonMediaStatsUtil","ZenonMessageSenderChain","ZenonMqttMWThriftMessageSender","ZenonPeerConnectionConfig","ZenonProductConnectFunnelLogProcessor","ZenonRTWebBrowserFeatureSupport","ZenonReliabilityQPLLogProcessor","ZenonRenderResolutionTracker","ZenonRequestedMediaType","ZenonSCTPConstants","ZenonSDKRateLimiter","ZenonSctpMWMessageSender","ZenonSctpMWMessageSenderHelper","ZenonSignalingChildTransport","ZenonSignalingClient","ZenonSignalingClientManager","ZenonSignalingProtocol","ZenonSimulcastUtils","ZenonTransportEventEmitter","ZenonTransportType","ZenonTurnDiscovery","ZenonUnloadHooks","fb-error","filterMap","findInMap","getZenonMqttChannel","isEmployeeTestUserZenonLogging","promiseDone","qex","uuidv4"],(function(a,b,c,d,e,f,g,h){"use strict";var i=c("JSResourceForInteraction")("setE2eeIsMandatedForZenonLoggers").__setRef("ZenonCallsManager");function j(a){return(a==null?void 0:a.messageBody.ringRequest)==null?null:(a=a==null?void 0:(a=a.messageBody.ringRequest)==null?void 0:(a=a.e2eeEnforcement)==null?void 0:a.infraMandatedExpStatus)!=null?a:d("MultiwaySharedTypes").E2eeInfraMandatedExpStatus.NOT_SET}a=function(){function a(a){var b=this;this.$4=new Map();this.$5=null;this.$7=null;this.$8=new(c("ZenonSctpMWMessageSenderHelper"))();this.$9=new(c("ZenonRenderResolutionTracker"))();var d=a.getRelayEnvironment();this.$7=new(c("ZenonSDKRateLimiter"))();this.$1=new Map();this.$2=a;d=new(c("ZenonMessageSenderChain"))([new(c("ZenonMqttMWThriftMessageSender"))()].concat(d?[new(c("ZenonGraphQLMWThriftMessageSender"))(d)]:[],[new(c("ZenonSctpMWMessageSender"))(this.$8)]));this.$3=new(c("ZenonSignalingClientManager"))(c("ZenonSignalingClient"),function(a,c,d){return b.onInviteReceived(a,c,d)},d,a);this.$6=this.$10()}var b=a.prototype;b.$10=async function(){c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({callType:"mw",checkpoint:"[ZP] starting TURN discovery"});var a=Date.now();try{var b=await d("ZenonTurnDiscovery").requestTurnCreds("ZenonPlatform","MW_PEER_ID");c("ZenonPeerConnectionConfig").setTurnCredentials(b);if(c("isEmployeeTestUserZenonLogging")()){b={ip:b.ip,ip_6:b.ip_6,ssl_tcp_port:b.ssl_tcp_port,tcp_port:b.tcp_port,udp_port:b.udp_port};c("ZenonInfraActionsLogger").logCheckpoint({callType:"mw",checkpoint:"[ZP] successfully acquired TURN credentials: "+JSON.stringify(b)+". Took "+(Date.now()-a)+" ms."})}else c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,callType:"mw",checkpoint:"[ZP] successfully acquired TURN credentials. Took "+(Date.now()-a)+" ms."})}catch(b){c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,callType:"mw",checkpoint:"[ZP] failed to get TURN credentials. Took "+(Date.now()-a)+" ms. Error message: "+b,errorDomain:"ZenonCallsManager_fetchTurnCredentials"})}};b.getLogProcessors=function(){var a=[d("ZenonLSCallSummaryLogProcessor").ZenonLSCallSummaryLogProcessorConfig,d("ZenonChildQPLLogProcessor").ZenonChildQPLLogProcessorConfig,d("ZenonLSPeerConnectionSummaryLogProcessor").ZenonLSPeerConnectionSummaryLogProcessorConfig,d("ZenonLSE2EEStatsLogProcessor").ZenonLSE2EEStatsLogProcessorConfig,d("ZenonLSStarRatingsLogProcessor").ZenonLSStarRatingsLogProcessorConfig,d("ZenonLastCallLogProcessor").ZenonLastCallLogProcessorConfig,d("ZenonChildClientPerfQPLLogProcessor").ZenonChildClientPerfQPLLogProcessorConfig,d("ZenonLSCallStartEventLogProcessor").ZenonLSCallStartEventLogProcessorConfig];(d("ZenonAppProvider").isMetaAI()||d("ZenonAppProvider").isMessengerWebApp()||d("ZenonAppProvider").isBizWebApp())&&a.push(d("ZenonProductConnectFunnelLogProcessor").ZenonProductConnectFunnelLogProcessorConfig);d("ZenonAppProvider").isMetaAI()&&a.push(d("ZenonReliabilityQPLLogProcessor").ZenonReliabilityQPLLogProcessorConfig);return a};b.onInviteReceived=function(a,b,e){b=this.$2.getConfigManager().getZenonMultiCallSupportConfig().getMaxConnectedCalls();var f=c("filterMap")(this.$1,function(a){return a.getConnectionState()!=="terminated"}),g=c("filterMap")(f,function(b){return b.getRemoteSignalingID()===((b=a.roomInfo.context)==null?void 0:b.serverInfoData)});if(g.size>0){c("promiseDone")(e.respondToInvite("OK"));return}g=c("findInMap")(f,function(a){return a.getRemoteSignalingID()==null})!=null;f.size>=b&&(f.size>b&&c("FBLogger")("rtc_www").warn("We have more than supported number of calls occurring"),d("ZenonActorHooks").ZenonActor.getAppID()===436761779744620..toString()?c("promiseDone")(e.sendDismiss(d("ZenonDismissReason").ZenonDismissReason.InAnotherCall)):c("promiseDone")(e.respondToInvite("IN_ANOTHER_CALL")),g||c("promiseDone")(e.sendDismiss(d("ZenonDismissReason").ZenonDismissReason.InAnotherCall)))};b.join=async function(a){var b=this;c("PersistedQueue").eventEmitter.emit("active",null);var e=a.peerID;e!=null||h(0,18600);a.roomID!=null||!d("ZenonCollisionContext").isCollisionContextEmpty(a.joiningContext)||h(0,69267);var f={userID:e},g=a.actorID,i=a.callMedia,k=a.callTrigger,l=a.clientCallID,m=a.isSecondaryJoinRole;m=m===void 0?!1:m;var n=a.joiningContext,o=a.mwThriftRingRequest,p=a.roomID;p=p===void 0?null:p;var q=a.setE2eeModel,r=a.signalingID,s=a.usersToRing;m=m?d("ZenonLoggingEventTypes").ZenonJoinMode.Secondary:d("ZenonLoggingEventTypes").ZenonJoinMode.Primary;n={context:babelHelpers.extends({},n),name:p};if(o!=null){o.messageHeader.clientSessionId=(p=r)!=null?p:""}if(this.$1.get(l)!=null){p="Call ID already exists. Use a new clientCallID/clientSessionID if rejoining.";c("FBLogger")("rtc_www").catching(c("fb-error").err(p)).mustfixThrow("Call ID already exists.");return}c("ZenonE2eeMandatedStateManager").processE2eeMandatedStateFromProductAndRing((p=a.isE2eeMandated)!=null?p:!1,j(o));p=null;r!=null&&(p=this.$3.getSignalingClient(r));var t=null;if(g!=null)t=g;else if(o!=null){t=(g=(g=o.messageHeader.receiver)==null?void 0:g.actorId)!=null?g:null}p==null?p=this.$3.createSignalingClient(r,f,a.serverInfoData,c("ZenonSignalingProtocol").MWPP,n,t,d("ZenonActorHooks").ZenonActor.getID()):p.getSignalingModel().setActorID(t);g=p.getSignalingModel();f=g.getSignalingID();c("ZenonInfraActionsLogger").updateCachedValues({signalingID:f});a.serverInfoData!=null&&this.$11(f,a.serverInfoData);n=o==null;var u=!1;if(o!=null){var v;u=((v=o.messageBody.ringRequest)==null?void 0:(v=v.offer)==null?void 0:v.sdpString)!=null}g.getMediaModeManager().onJoin(n,s.length,u);var w=this.$4.get(l);if(w==null){v=i===c("ZenonRequestedMediaType").Video||i===c("ZenonRequestedMediaType").Audiovideo;var x=new(c("ZenonCallLogger"))({config:this.$2.getConfigManager(),initLoggerInfo:{appID:d("ZenonActorHooks").ZenonActor.getAppID(),callTrigger:k,conferenceName:a.roomID,disableTsData:c("ZenonE2eeMandatedStateManager").areBothInfraAndProductE2eeMandated(),isCaller:n,isVideo:v,joinMode:m,localCallID:(i=(s=this.$5)==null?void 0:s.getLocalCallIDFromParent())!=null?i:c("uuidv4")(),peerID:e,protocol:c("ZenonSignalingProtocol").MWPP,serverInfoData:a.serverInfoData,signalingID:(k=r)!=null?k:f},isE2eeMandated:c("ZenonE2eeMandatedStateManager").areBothInfraAndProductE2eeMandated(),processorConfigs:this.getLogProcessors()});this.$4.set(l,x);c("promiseDone")(this.$2.getSignalingListener().then(function(a){a.setLoggingEventHandler(function(a){return x.log(a)})}));w=x}v=await d("ZenonLocalMediaSDK").getCurrentPermissions();w.log({cameraPermission:v==null?void 0:v.cameraState,hasOfferInRingRequest:u,isCaller:n,microphonePermission:v==null?void 0:v.microphoneState,name:"callJoinRequest",rtcActorID:t});m=d("ZenonSimulcastUtils").shouldUseSimulcast();p!=null||h(0,23327);g.getMediaModeManager().getMediaMode()==="p2p"&&await this.$6;if(d("ZenonRTWebBrowserFeatureSupport").isInsertableStreamsSupported()&&q!=null){c("ZenonInfraActionsLogger").startTimer("[E2ee] Create E2ee Components");s=function(a){void b.endCall(l,"EndToEndEncryptionInvariantViolated",a)};i=function(a,c){void b.sendGenericDataMessage(l,d("ZenonSCTPConstants").E2EE_DATA_MESSAGE_MEDIA_CHANNEL_TOPIC,c,{recipientIDs:[a]},d("ZenonTransportType").ZenonTransportType.SCTP)};await c("ZenonE2ee").createE2eeComponents(w,p,q,s,i,(e=c("qex")._("369"))!=null?e:!1);w.log({isE2eeStackReady:c("ZenonE2ee").isE2eeStackReady(),name:"e2eeComponentCreated"});c("ZenonInfraActionsLogger").stopTimer("[E2ee] Create E2ee Components")}c("ZenonE2eeMandatedStateManager").isInfraE2eeMandated()&&!c("ZenonE2ee").isE2eeStackReady()&&(!d("ZenonRTWebBrowserFeatureSupport").isInsertableStreamsSupported()?void this.endCall(l,"EndToEndEncryptionInvariantViolated","E2ee is mandated, but Insertable Streams API is not supported"):void this.endCall(l,"EndToEndEncryptionInvariantViolated","e2ee stack is not initialized: "+c("ZenonE2ee").getE2eeComponentCreationFailureMessage()));k=new(c("OverlayConfigManagerWithServerLayer"))(this.$2.getConfigManager());u=new(c("ZenonConnectionStateManager"))(l,p,n?"outgoing":"incoming",k,w,this.$8,m,this.$9);this.$1.set(l,u);if(!d("RTWebIncomingRingConfiguration").isSupportedClient()){c("promiseDone")(this.endCall(a.clientCallID,"VersionUnsupported","Browser not supported"));return}await u.start(a);c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,callType:"mw",checkpoint:"[ZP] ZenonCallsManager_join called, starting connectionStateManager",conferenceName:a.roomID,isCaller:n,signalingID:r});if(o!=null){v=d("ZenonMWThriftMessageTranslator").toSignalingMessage(o);v!=null&&this.$3.receiveMessage(v)}var y=new(c("SCTPSignalingListener"))(u);t=function(a){switch(a){case"sfu":y.subscribe(function(a){return b.$3.receiveMessage(a)});break;case"p2p":y.unsubscribe();break}};g.getMediaModeManager().addListener("mediaMode",t);t(g.getMediaModeManager().getMediaMode());y.setLoggingEventHandler(function(a){var b;return(b=w)==null?void 0:b.log(a)});d("ZenonMediaStatsUtil").shouldUseTSLog()?c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,callType:"mw",checkpoint:"[ZP] Eligible for tslog logging",conferenceName:a.roomID,isCaller:n,serverInfoData:a.serverInfoData,signalingID:this.$12(f,l)}):c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,callType:"mw",checkpoint:"[ZP] Not eligible for tslog logging",conferenceName:a.roomID,isCaller:n,serverInfoData:a.serverInfoData,signalingID:this.$12(f,l)})};b.$12=function(a,b){return(a=a)!=null?a:b};b.addLocalTrack=function(a,b){return(a=this.$13(a,function(a){return a.addLocalTrack(b)}))!=null?a:Promise.resolve()};b.removeLocalTrack=function(a,b){return(a=this.$13(a,function(a){return a.removeLocalTrack(b)}))!=null?a:Promise.resolve()};b.muteTrack=function(a,b,c){c===void 0&&(c=!1);return!this.$14("muteTrack")?Promise.resolve():(a=this.$13(a,function(a){return a.muteTrack(b,c)}))!=null?a:Promise.resolve()};b.unmuteTrack=function(a,b,c){c===void 0&&(c=!1);return!this.$14("unmuteTrack")?Promise.resolve():(a=this.$13(a,function(a){return a.unmuteTrack(b,c)}))!=null?a:Promise.resolve()};b.stopLocalTrack=function(a,b){return(a=this.$13(a,function(a){return a.stopLocalTrack(b)}))!=null?a:Promise.resolve()};b.initializeLogging=function(a,b){var e=b.callTrigger,f=b.initializeVideo,g=b.isE2eeMandated,h=b.peerID,j=b.roomID;j=j===void 0?null:j;var k=b.serverInfoData,l=b.signalingID;if(l!=null){g&&c("promiseDone")(i.load(),function(a){return a(l)});c("ZenonInfraActionsLogger").updateCachedValues({signalingID:String(l)});if(!this.$4.has(a)){var m=new(c("ZenonCallLogger"))({config:this.$2.getConfigManager(),initLoggerInfo:{appID:d("ZenonActorHooks").ZenonActor.getAppID(),callTrigger:e,conferenceName:j,isCaller:!0,isVideo:f,localCallID:(e=(b=this.$5)==null?void 0:b.getLocalCallIDFromParent())!=null?e:c("uuidv4")(),peerID:h,protocol:c("ZenonSignalingProtocol").MWPP,serverInfoData:k,signalingID:String(l)},isE2eeMandated:g,processorConfigs:this.getLogProcessors()});this.$4.set(a,m);c("promiseDone")(this.$2.getSignalingListener().then(function(a){a.setLoggingEventHandler(function(a){return m.log(a)})}))}}};b.initializeSignaling=function(a,b,d,e){var f=this;return this.$2.getSignalingListener().then(function(g){g.subscribe(function(a){return f.$3.receiveMessage(a)},function(a){});g=c("getZenonMqttChannel")();c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"[ZP] Subscribed to MQTT channels. MQTT connection state: "+g.getConnectionState()});g=f.$2.getConfigManager().getZenonStartCallImmediatelyConfig().isEnabled();if(g)c("ZenonTransportEventEmitter").emitJoinReady();else if(b!=null){g=f.$2.getConfigManager().getZenonPlatformSupportConfig().getParentWindowConnectionTimeoutMs();f.$5=new(c("ZenonSignalingChildTransport"))({onLocalCallIDUpdate:function(a){f.$4.forEach(function(b){b.updateLogIdentifiers({localCallID:a})})},parentNonce:b,peerID:a,roomID:d,serverInfoData:e,timeoutMS:g})}else c("ZenonTransportEventEmitter").emitParentWindowConnectionTimeout();f.$5&&c("promiseDone")(f.$5.connect(),function(a){a.state==="join_ready"?c("ZenonTransportEventEmitter").emitJoinReady(a.mwThriftRingRequest):c("ZenonTransportEventEmitter").emitParentWindowConnectionTimeout()})})};b.endCall=function(a,b,e){b=d("ZenonDismissReason").endCallToDismissReason(b);var f=this.$1.get(a);if(f)return f.end(b,e);else{f=this.$4.get(a);f!=null?f.log({endCallReason:b,endCallSubreason:e,isRemoteEnded:!1,name:"callEnded"}):e!==d("ZenonUnloadHooks").DID_NOT_INITIATE&&c("FBLogger")("rtc_www").warn("ZenonCallLogger missing for endCall")}return Promise.resolve()};b.ringParticipants=function(a,b,c){return(a=this.$13(a,function(a){return a.addParticipants(b,c)}))!=null?a:Promise.resolve()};b.removeParticipants=function(a,b){return(a=this.$13(a,function(a){return a.removeParticipants(b)}))!=null?a:Promise.resolve()};b.replaceLocalTrack=function(a,b,c,d){d===void 0&&(d=!1);return(a=this.$13(a,function(a){return a.replaceLocalTrack(b,c,d)}))!=null?a:Promise.resolve()};b.forceEncodingEnabled=function(a,b){return(a=this.$13(a,function(a){return a.forceEncodingEnabled(b)}))!=null?a:Promise.resolve()};b.submitRating=function(a,b,c,d,e,f){d===void 0&&(d=null);e===void 0&&(e=null);f===void 0&&(f=null);a=this.$4.get(a);a&&(b!=null&&a.log({isBinaryRating:c||!1,name:"callRated",rating:b}),(d!=null||e!=null||f!=null)&&a.log({feedback:d,name:"callSurveySubmitted",surveyChoice:f,surveyIssue:e}))};b.getCalls=function(){return this.$1};b.setCalls=function(a){this.$1=a};b.createDataMessageSubscription=function(a,b,c,d,e){return(a=this.$13(a,function(a){return a.createDataMessageSubscription(b,c,d,e)}))!=null?a:Promise.resolve()};b.removeDataMessageSubscription=function(a,b,c){return(a=this.$13(a,function(a){return a.removeDataMessageSubscription(b,c)}))!=null?a:Promise.resolve()};b.sendGenericDataMessage=function(a,b,c,e,f){return f!==d("ZenonTransportType").ZenonTransportType.SCTP&&!this.$14("dataMessage-"+b)?Promise.resolve():(a=this.$13(a,function(a){return a.sendGenericDataMessage(b,c,e,f)}))!=null?a:Promise.resolve()};b.registerDataMessageService=function(a,b,c){return(a=this.$13(a,function(a){return a.registerDataMessageService(b,c)}))!=null?a:Promise.resolve()};b.getLogIdentifiers=function(a){return(a=this.$4.get(a))==null?void 0:a.getLogIdentifiers()};b.subscribeToRemoteVideo=function(a,b,c){a=this.$1.get(a);return a!=null?a.subscribeToRemoteVideo(b,c):Promise.resolve()};b.updateStateSyncTopic=function(a,b,c){return!this.$14("updateStateSync-"+b)?Promise.resolve():(a=this.$13(a,function(a){return a.updateStateSyncTopic(b,c)}))!=null?a:Promise.resolve()};b.unsubscribeFromStateSyncTopic=function(a,b){return(a=this.$13(a,function(a){return a.unsubscribeFromStateSyncTopic(b)}))!=null?a:Promise.resolve()};b.approveParticipants=function(a,b){return(a=this.$13(a,function(a){return a.approveParticipants(b)}))!=null?a:Promise.resolve()};b.denyParticipants=function(a,b){return(a=this.$13(a,function(a){return a.denyParticipants(b)}))!=null?a:Promise.resolve()};b.getEncryptionKeysManagerState=function(a){a=this.$13(a,function(a){return a.getEncryptionKeysManagerState()});return a===null?d("ZenonEncryptionKeysManagerState").ZenonEncryptionKeysManagerState$DefaultConstructor():a};b.getSignalingProtocol=function(a){var b=this;return this.$13(a,function(a){return(a=b.$3.getSignalingClient(a.getSignalingID()))==null?void 0:a.getSignalingModel().getProtocol()})};b.getMediaMode=function(a){var b=this;return this.$13(a,function(a){return(a=b.$3.getSignalingClient(a.getSignalingID()))==null?void 0:a.getSignalingModel().getMediaModeManager().getMediaMode()})};b.getSCTPDataChannelState=function(a,b){return this.$13(a,function(a){return a.getSCTPDataChannelState(b)})};b.getConferenceName=function(a){var b=this;return this.$13(a,function(a){return(a=b.$3.getSignalingClient(a.getSignalingID()))==null?void 0:a.getSignalingModel().getRoomInfo().name})};b.$14=function(a){if(this.$7&&!this.$7.take(a)){c("FBLogger")("rtc_www").mustfix("[ZP] Dropping %s invocation. This SDK method is being called too rapidly.",a);return!1}return!0};b.$13=function(a,b){a=this.$1.get(a);return a!=null?b(a):null};b.$11=function(a,b){b=this.$3.getSignalingClientsWithRemoteSignalingID(b);b.forEach(function(b){b.getSignalingModel().getSignalingID()!==a&&c("promiseDone")(b.silentlyTerminate())})};b.updateRenderedResolutionMap=function(a){this.$9.setRenderResolutionMap(a)};return a}();g.default=a}),98);
__d("ZenonClientTslogUploader",["DateConsts","ZenonAuditedCheckpointLogId","ZenonInfraActionsLogger"],(function(a,b,c,d,e,f,g){"use strict";var h=5*d("DateConsts").MS_PER_MIN,i="[ZP] Tslog Uploader";a=function(){function a(a,b){a===void 0&&(a=function(){}),this.$1=function(){},this.$3=h,this.$1=a,this.$2=b,this.$3=h}var b=a.prototype;b.$4=function(a){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:i+" - "+a})};b.logTslog=function(){var a=this.$2.timeSeries();if(a){if(a.timeSeries==null||a.timeSeries.length===0){this.$4("TSLog is empty - stop sending from logTslog");return}this.$1({name:"logTSData",serializedTSLog:a})}};return a}();g["default"]=a}),98);
__d("ZenonIceConnectionMonitor",["DateConsts","ZenonAuditedCheckpointLogId","ZenonInfraActionsLogger","ZenonNetworkQualityMonitor","ZenonPeerConnectionConstants","clearTimeout","emptyFunction","performanceNow","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h,i=30*d("DateConsts").MS_PER_SEC,j=3,k=new Set([(a=d("ZenonNetworkQualityMonitor")).ZenonNetworkQuality.Disconnected,a.ZenonNetworkQuality.Poor]),l=new Set([a.ZenonNetworkQuality.Excellent,a.ZenonNetworkQuality.Good,a.ZenonNetworkQuality.Fair]);b=function(){function a(){this.$1="new",this.$2=d("ZenonNetworkQualityMonitor").ZenonNetworkQuality.Excellent,this.$3=null,this.$4=null,this.$5=0,this.$6=!1,this.$7=0}var b=a.prototype;b.clearIceRestartTimer=function(){this.$4!=null&&(c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"Clearing platform ice restart timer"}),c("clearTimeout")(this.$4),this.$4=null)};b.clearIceConnectionTimer=function(){this.$3!=null&&(c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"Clearing platform connection drop timer"}),c("clearTimeout")(this.$3),this.$3=null)};b.updateIceConnectionState=function(a){this.$1=a,c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"iceConnectionStateChange: "+a})};b.updateNetworkStatus=function(a){this.$2=a};b.updateIceRestartTimer=function(a,b){if(this.$8())this.clearIceRestartTimer();else if(this.$9()&&this.$4==null&&this.$5<j)this.$7=(h||(h=c("performanceNow")))()+b,c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"Creating an ICE Restart timer"}),this.$10(a,b);else if(this.$9()){var d=this.$7-(h||(h=c("performanceNow")))();d>b&&(c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"Creating a shorter ICE Restart timer"}),this.clearIceRestartTimer(),this.$10(a,b))}};b.$10=function(a,b){var d=this;this.$4=c("setTimeout")(function(){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"Issuing an ICE Restart"}),d.$5++,a.processEvent({onError:c("emptyFunction"),onSuccess:c("emptyFunction"),type:"iceRestart"})},b)};b.updateIceConnectionTimer=function(a,b){b===void 0&&(b=i),d("ZenonPeerConnectionConstants").CONNECTED_STATES.has(this.$1)?this.clearIceConnectionTimer():d("ZenonPeerConnectionConstants").DISCONNECTED_STATES.has(this.$1)&&this.$3==null&&(c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"Setting platform connection drop timer"}),this.$3=c("setTimeout")(function(){c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"Ending call on platform connection drop timeout"}),a()},b))};b.logIceConnectionState=function(a){this.$11()||a({connected:this.$12(),name:"peerConnectionStateChanged",newState:this.$1}),this.$12()&&a({name:"mediaConnected"}),this.$1==="connected"&&a({name:"iceConnectionStateChangedConnected"}),this.$1==="disconnected"&&a({name:"iceConnectionStateChangedDisconnected"})};b.$8=function(){return this.$6?this.$12()&&l.has(this.$2):this.$12()};b.$9=function(){return this.$6?this.$13()||k.has(this.$2):this.$13()};b.$12=function(){return d("ZenonPeerConnectionConstants").CONNECTED_STATES.has(this.$1)};b.$13=function(){return d("ZenonPeerConnectionConstants").DISCONNECTED_STATES.has(this.$1)};b.$11=function(){return d("ZenonPeerConnectionConstants").INDETERMINANT_STATES.has(this.$1)};return a}();g["default"]=b}),98);
__d("ZenonPeerConnectionDataActions",["promiseDone"],(function(a,b,c,d,e,f,g){"use strict";a=function(a,b){if(b.type==="createDataChannel"){var c=b.payload,d=c.dataChannelLabel,e=c.dataChannelOptions,f=c.onDataChannelMessage,g=c.onDataChannelOpen;c=c.shouldEstablishDataChannel;a.mediaChannelManager.createDataChannel(d,f,g,c,e);b.onSuccess()}};b=function(a,b){if(b.type==="dataChannelMessageReceived"){var d=b.payload,e=d.dataChannelLabel;d=d.dataMessage;c("promiseDone")(a.onDataChannelMessageReceived(e,d),b.onSuccess,b.onError)}};d=function(a,b){if(b.type==="createDataMessageSubscription"){var d=b.payload,e=d.dataChannelLabel;d=d.onSignalingDataMessage;c("promiseDone")(a.onCreateDataMessageSubscription(e,d),b.onSuccess,b.onError)}};e=function(a,b){if(b.type==="removeDataMessageSubscription"){var d=b.payload,e=d.dataChannelLabel;d=d.onSignalingDataMessage;c("promiseDone")(a.onRemoveDataMessageSubscription(e,d),b.onSuccess,b.onError)}};g.onCreateDataChannel=a;g.onDataChannelMessageReceived=b;g.onCreateDataMessageSubscription=d;g.onRemoveDataMessageSubscription=e}),98);
__d("ZenonPeerConnectionIceActions",["ZenonAuditedCheckpointLogId","ZenonInfraActionsLogger","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h={onIceConnected:function(a){return a.onConnectionEstablished()},onIceConnectionStateChanged:function(a,b){if(b.type==="iceConnectionStateChange"){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"iceConnectionStateChange: "+b.payload.iceConnectionState});var d=b.payload.iceConnectionState==="connected"||b.payload.iceConnectionState==="completed",e=b.payload.iceConnectionState==="disconnected"||b.payload.iceConnectionState==="failed";d?c("promiseDone")(h.onIceConnected(a),b.onSuccess,b.onError):e&&c("promiseDone")(a.onConnectionDropped(),b.onSuccess,b.onError);return{iceConnectionState:b.payload.iceConnectionState}}return{}}};a=h;g["default"]=a}),98);
__d("ZenonPeerConnectionMediaActions",["AggregateError","ZenonAuditedCheckpointLogId","ZenonInfraActionsLogger","ZenonLoggingEventTypes","ZenonRequestedMediaType","emptyFunction","err","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";e=function(a,b){b.type==="applyRemoteIceCandidate"&&b.payload!=null&&c("promiseDone")(a.sdpManager.setRemoteIceCandidate(b.payload),function(){a.logEvent({direction:d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Receive,name:"updateIceInfo",sdpString:b.payload.candidate}),b.onSuccess()},b.onError)};f=function(a,b){c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"Failed to add local tracks: "+b.data.toString(),errorDomain:"ZenonPeerConnectionMediaActions_onAddLocalTracks"})};var h=function(a,b){c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"Successfully added local tracks"});return b.data},i=async function(a,b){if(b.type!=="addLocalTracks")return{};var d=b.payload,e=d.callMedia;d=d.tracks;var f=[],g=await Promise.all(d.map(async function(c){try{await a.mediaChannelManager.addTrack(c,b.payload.mediaMode);A(a,c.trackId,c.enabled);return{status:"fulfilled"}}catch(a){return{reason:a,status:"rejected"}}}));g.forEach(function(a){a.status==="rejected"&&f.push(c("err")(a.reason))});if(f.length>0){g=new(c("AggregateError"))(f);b.onError(g);throw g}g=b.payload.callInitiator!==!0&&b.payload.mediaMode==="p2p";(e===c("ZenonRequestedMediaType").Video||e===c("ZenonRequestedMediaType").Audiovideo)&&!g&&a.mediaChannelManager.addReceiveOnlyVideoTransceiverIfMissing();(e===c("ZenonRequestedMediaType").Audio||e===c("ZenonRequestedMediaType").Audiovideo)&&await a.mediaChannelManager.addAudioTrackOrRecvOnlyTransceiverIfMissing(b.payload.mediaMode);c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"add local tracks"});b.onSuccess();return{localMediaStateVersion:a.localMediaStateVersion+d.length}},j=function(a,b){if(b.type!=="forceEncodingEnabled")return;c("promiseDone")(a.mediaChannelManager.forceEncodingEnabled(b.payload.enabled),b.onSuccess,b.onError)},k=function(a,b){b.type==="iceCandidateReady"&&c("promiseDone")(a.onIceCandidateReady(b.payload),b.onSuccess,b.onError)},l=function(a,b){if(b.type!=="localMediaStateUpdateRetry")return{};c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"local media state update retry with media status only"});a=B(a,b.onSuccess,b.onError);b=a.localMediaStateVersion;return{localMediaStateUpdateRetryTimerId:null,localMediaStateVersion:b}},m=function(a,b){if(b.type==="muteLocalTrack"){a=z(a,b.payload.trackId,!1,b.onSuccess,b.onError);c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"mute local track"});return a}return{}},n=function(a,b){b.type==="muteRemoteTrack"&&(A(a,b.payload.trackId,!1),c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"mute remote track"}));return{}},o=function(a,b){c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"Failed to remove local track: "+b.data.toString(),errorDomain:"ZenonPeerConnectionMediaActions_onRemoveLocalTracks"})},p=function(a,b){c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"Successfully removed local track"});return b.data},q=async function(a,b){if(b.type!=="removeLocalTrack")return{};var d=b.payload.trackId;await a.mediaChannelManager.removeTrack(d);a=z(a,d,!1,b.onSuccess,b.onError);c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"remove local track with id "+d});return a},r=function(a,b){c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"Failed to replace local tracks: "+b.data.toString(),errorDomain:"ZenonPeerConnectionMediaActions_onReplaceLocalTrack"})},s=async function(a,b){if(b.type!=="replaceLocalTrack")return{};var d=b.payload,e=d.preserveOriginal,f=d.replacementTrack;d=d.trackIdToReplace;await a.mediaChannelManager.replaceTrack(d,f,e!=null?e:!1);e=z(a,b.payload.trackIdToReplace,!1,c("emptyFunction"),c("emptyFunction"));e=z(babelHelpers.extends({},a,e),b.payload.replacementTrack.trackId,b.payload.replacementTrack.enabled,b.onSuccess,b.onError);c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"replace local track with id "+d+" by track "+f.trackId});return e},t=function(a,b){c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"Successfully replaced local track"});return b.data},u=function(a,b){if(b.type!=="setLocalMediaStateVersion")return{};b.onSuccess();return{localMediaStateVersion:b.payload.version}},v=function(a,b){if(b.type!=="stopLocalTrack")return;var c=b.payload.trackId;try{a.mediaChannelManager.stopLocalTrack(c),b.onSuccess()}catch(a){b.onError(a)}},w=function(a,b){if(b.type==="unmuteLocalTrack"){a=z(a,b.payload.trackId,!0,b.onSuccess,b.onError);c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"unmute local track"});return a}return{}},x=function(a,b){b.type==="unmuteRemoteTrack"&&(A(a,b.payload.trackId,!0),c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"unmute remote track"}));return{}};function a(a,b){if(b.type!=="applyMediaUpdate")return;y(a.mediaChannelManager,b.payload.mediaStates);b.onSuccess()}function y(a,b,c){c===void 0&&(c=!0),b&&(a.updateTrackInfos(b),a.updateMuteStates(b),c&&a.removeMissingTracks(b.tracks.map(function(a){return a.trackID})))}function z(a,b,c,d,e){A(a,b,c);return B(a,d,e)}function A(a,b,c){a=a.mediaChannelManager;c?a.unmuteTrack(b):a.muteTrack(b)}function B(a,b,d){var e=a.mediaChannelManager,f=[];e=e.getLocalTracksForMWS();e.forEach(function(a){a={enabled:a.enabled,name:a.name,trackID:a.trackId,type:a.contentType};f.push(a)});e=a.localMediaStateVersion+1;var g={tracks:f,version:e};c("promiseDone")(a.onLocalMediaStateUpdate(g),b,d);return{localMediaStateVersion:e}}function b(a){(a=a.tslogUploader)==null?void 0:a.logTslog()}g.applyRemoteIceCandidate=e;g.onAddLocalTracksError=f;g.onAddedLocalTracks=h;g.onAddingLocalTracks=i;g.onForceEncodingEnabled=j;g.onIceCandidateReady=k;g.onLocalMediaStateUpdateRetry=l;g.onMuteLocalTrack=m;g.onMuteRemoteTrack=n;g.onRemoveLocalTrackError=o;g.onRemovedLocalTrack=p;g.onRemovingLocalTrack=q;g.onReplaceLocalTrackError=r;g.onReplacingLocalTrack=s;g.onReplacedLocalTrack=t;g.onSetLocalMediaStateVersion=u;g.onStopLocalTrack=v;g.onUnmuteLocalTrack=w;g.onUnmuteRemoteTrack=x;g.onApplyMediaUpdate=a;g.applyMediaStates=y;g.startTslog=b}),98);
__d("ZenonPeerConnectionSMGuards",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return b.type==="applyRemoteSdp"&&b.payload.sdp.type==="offer"}function b(a,b){return b.type==="applyRemoteSdp"&&(b.payload.sdp.type==="answer"||b.payload.sdp.type==="pranswer")}function c(a,b){return((a=b.data)==null?void 0:a.type)==="pranswer"}function d(a,b){return b.type==="iceConnectionStateChange"&&(b.payload.iceConnectionState==="connected"||b.payload.iceConnectionState==="completed")}function e(a){return a.iceConnectionState==="connected"||a.iceConnectionState==="completed"}function g(a,b){return b.type==="iceConnectionStateChange"&&b.payload.iceConnectionState==="disconnected"}function h(a){return a.iceConnectionState!=="connected"&&a.iceConnectionState!=="completed"}function i(a){return(a=a.outstandingLocalOffer)!=null?a:!1}f.applyRemoteOfferSdpGuard=a;f.applyRemoteAnswerSdpGuard=b;f.prAnswerSetGuard=c;f.iceConnectedEventGuard=d;f.iceConnectedGuard=e;f.iceDisconnectedEventGuard=g;f.iceNotConnectedGuard=h;f.outstandingLocalOfferGuard=i}),66);
__d("ZenonPeerConnectionSdpActions",["ZenonAuditedCheckpointLogId","ZenonBrowsers","ZenonInfraActionsLogger","ZenonPeerConnectionMediaActions","ZenonSDP","promiseDone","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){c("promiseDone")(a.onRemoteSdpSet())};b=async function(a,b){if(b.type!=="remoteSdpFailed")return;c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"trying to rollback to last successful sdp pair"});if(d("ZenonBrowsers").supportsRollback())await a.sdpManager.rollbackSdp();else{if(a.lastSuccessfulSdpPair==null)throw c("unrecoverableViolation")("No last successfully negotiated SDP pair, should never happen here","rtc_www");var e=a.lastSuccessfulSdpPair,f=e.localSdp;e=e.remoteSdp;await a.sdpManager.setLocalSdp(f);c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"setting remote sdp, name: "+b.type});await a.sdpManager.setRemoteSdp(e,a.logEvent);b.onSuccess()}c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"successful rollback to last successful sdp pair"})};e=async function(a,b){if(b.type==="applyLocalSdp"||b.type==="localMediaStateUpdateRetry"||b.type==="iceRestart"){var d=b.type==="iceRestart",e=a.localMediaStateVersion+1;await a.sdpManager.createAndSetLocalSdp(e,"offer",{iceRestart:d});c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"apply local SDP"});d=b.type==="localMediaStateUpdateRetry"?null:a.localMediaStateUpdateRetryTimerId;b.onSuccess();return{localMediaStateUpdateRetryTimerId:d,localMediaStateVersion:e,outstandingLocalOffer:!0}}return{}};f=async function(a,b){if(b.type==="applyRemoteSdp"){var e=a.mediaChannelManager,f=a.sdpManager,g=b.payload.sdp,h=g.sdp;g=g.type;var i=b.payload.sdpOriginLocalId,j=b.payload.e2eeServerState;g==="answer"?(a.logEvent({name:"setRemoteSdpAnswer"}),c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"setting remote sdp, name: "+b.type}),await f.setRemoteSdp(new(d("ZenonSDP").ZenonRemoteSDP)({sdp:h,type:g}),a.logEvent,i,j),a.logEvent({name:"endSetRemoteDescription"}),c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"apply remote answer"})):g==="pranswer"&&(a.logEvent({name:"setRemoteSdpPrAnswer"}),c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"setting remote sdp, name: "+b.type}),await f.setRemoteSdp(new(d("ZenonSDP").ZenonRemoteSDP)({sdp:h,type:g}),a.logEvent,i,j),a.logEvent({name:"endSetRemoteDescription"}),c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"apply remote pranswer"}));d("ZenonPeerConnectionMediaActions").applyMediaStates(e,b.payload.mediaStates);h=b.payload.renegotiationOffer;if(h!=null){g=h.sdp;e=h.type;c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"setting remote sdp, name: "+b.type});await f.setRemoteSdp(new(d("ZenonSDP").ZenonRemoteSDP)({sdp:g,type:e}),a.logEvent,i,j);h=a.localMediaStateVersion+1;await a.sdpManager.createAndSetLocalSdp(h,"answer");c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"Apply renegotiation offer and set local answer"})}b.payload.source==="joinResponse"?a.logEvent({name:"inviteResponseProcessed"}):b.payload.source==="serverMediaUpdateRequest"&&b.payload.sdp.type==="answer"&&a.logEvent({name:"smuWithAnswerProcessed"});b.payload.onProcessed&&(b.payload.onProcessed(),c("ZenonInfraActionsLogger").logCheckpoint({checkpoint:"onProcessed called in ZenonPeerConnectionSdpActions.applyRemoteAnswer"}));b.onSuccess();return b.payload.sdp}};var h=async function(a,b){var e=a.mediaChannelManager,f=a.sdpManager;if(b.type==="applyRemoteSdp"){var g=b.payload.sdp,h=b.payload.sdpOriginLocalId,i=b.payload.e2eeServerState;if(g.type==="offer"){a.logEvent({name:"setRemoteSdpOffer"});var j;if(g.update){var k;j=(k=a.sdpManager.getRemoteSdp())!=null?k:new(d("ZenonSDP").ZenonRemoteSDP)({type:g.type});k=Object.keys(g.update.media);k.forEach(function(a){var b=g.update.media[a].body;j.updateMSection(parseInt(a,10),b)});j.setVersion(g.version);j.setType(g.type);j.updateMids(k.map(function(a){return g.update.media[a].mid}));j.updateMsidSemantic();e.removeMissingTracks(j.getActiveTrackIDs())}else j=new(d("ZenonSDP").ZenonRemoteSDP)({sdp:g.sdp,type:g.type});c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"setting remote sdp, name: "+b.type});k=await f.setRemoteSdp(j,a.logEvent,h,i);d("ZenonPeerConnectionMediaActions").applyMediaStates(e,b.payload.mediaStates,g.update==null);b.payload.onProcessed&&(b.payload.onProcessed(),c("ZenonInfraActionsLogger").logCheckpoint({checkpoint:"onProcessed called in ZenonPeerConnectionSdpActions.applyRemoteOfferAndSetLocalAnswer"}));f=a.localMediaStateVersion+1;h=await a.sdpManager.createAndSetLocalSdp(f,"answer");c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"apply remote offer and set local answer"});b.onSuccess();return{lastSuccessfulSdpPair:{localSdp:h.copyWithTypeAndActpass("offer"),remoteSdp:k.copyWithType("answer")},localMediaStateVersion:f}}}return{}},i=function(a,b){c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"Failed to apply remote offer and set local answer: "+b.data.toString(),errorDomain:"ZenonPeerConnectionSdpActions_onApplyRemoteOfferAndSetLocalAnswer"})},j=function(a){var b=a.sdpManager.getLocalSdp();if(b==null)throw c("unrecoverableViolation")("Local sdp should never be null after setting remote answer","rtc_www");a=a.sdpManager.getRemoteSdp();if(a==null)throw c("unrecoverableViolation")("Remote sdp should never be null after setting remote answer","rtc_www");return{lastSuccessfulSdpPair:{localSdp:b,remoteSdp:a},outstandingLocalOffer:!1}},k=function(a){a.logEvent({name:"negotiationComplete"})},l=function(a,b){var d=a.sdpManager.getLocalSdp(),e=b.data.localMediaStateVersion;if(d!==null&&e!=null){var f=d.toDesc(),g=f.sdp;f=f.type;c("promiseDone")(a.onLocalSdpSet({sdp:g,type:f,version:e},a.mediaChannelManager.getLocalTracksForMWS()))}d!==null&&a.mediaChannelManager.onLocalSdpSet(d);return b.data};g.onRemoteSdpSet=a;g.applyingLastSuccessfulSdpPair=b;g.applyLocalSdp=e;g.applyRemoteAnswer=f;g.applyRemoteOfferAndSetLocalAnswer=h;g.onApplyRemoteOfferSetLocalAnswerError=i;g.updateSdpPair=j;g.logNegotiationCompleted=k;g.onLocalSdpSet=l}),98);
__d("ZenonPeerConnectionTerminatedState",[],(function(a,b,c,d,e,f){"use strict";a=function(a){a.sdpManager.restartPeerConnection()};f.restart=a}),66);
__d("ZenonPeerConnectionTerminatingState",["FBLogger","Promise","ZenonAuditedCheckpointLogId","ZenonInfraActionsLogger","ZenonMediaError","err","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a,e){var f;a.mediaChannelManager.stopStatsPolling();(e.type!=="endCall"||e.payload.stopLocalTracks)&&(c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"stopping local tracks"}),a.mediaChannelManager.stopLocalTracks());switch(e.type){case"endCall":if(((f=e.payload)==null?void 0:f.restart)!==!0){c("promiseDone")(a.onConnectionDestroyed((f=e.payload.error)!=null?f:null))}e.onSuccess();break;case"applyLocalSdp":case"error.platform.applyLocalSdpInvoke":c("promiseDone")(a.onConnectionDestroyed(d("ZenonMediaError").ZenonMediaError.SetLocalSdpFailed));e.onError==null?void 0:e.onError(c("err")(d("ZenonMediaError").ZenonMediaError.SetLocalSdpFailed));break;case"applyRemoteSdp":case"error.platform.applyRemoteSdpInvoke":case"error.platform.renegotiatingInvoke":c("promiseDone")(a.onConnectionDestroyed(d("ZenonMediaError").ZenonMediaError.SetRemoteSdpFailed));e.onError==null?void 0:e.onError(c("err")(d("ZenonMediaError").ZenonMediaError.SetRemoteSdpFailed));break;case"error.platform.rollingSdpBackInvoke":c("promiseDone")(a.onConnectionDestroyed(d("ZenonMediaError").ZenonMediaError.RollbackSdpFailed));e.onError==null?void 0:e.onError(c("err")(d("ZenonMediaError").ZenonMediaError.RollbackSdpFailed));break;default:c("FBLogger")("rtc_www").warn("Event "+e.type+" logged as unknown error. Please add a more specific error for this event type.");c("promiseDone")(a.onConnectionDestroyed(d("ZenonMediaError").ZenonMediaError.UnknownError));e.onError==null?void 0:e.onError(c("err")(d("ZenonMediaError").ZenonMediaError.UnknownError));break}a.sdpManager.closePeerConnection();(f=a.tslogUploader)==null?void 0:f.logTslog();return(h||(h=b("Promise"))).resolve(c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"cleaning up peer connection, event: "+e.type}))};e=function(a,b){};g.cleanUp=a;g.done=e}),98);
__d("ZenonPeerConnectionStateMachine",["ZenonDebugLogger","ZenonInfraActionsLogger","ZenonMWMessageReliabilityLogTypes","ZenonPeerConnectionDataActions","ZenonPeerConnectionIceActions","ZenonPeerConnectionMediaActions","ZenonPeerConnectionSMGuards","ZenonPeerConnectionSdpActions","ZenonPeerConnectionTerminatedState","ZenonPeerConnectionTerminatingState","ZenonStateMachineBase","err","qpl","xstate"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m={iceConnectionState:"new",iceConnectionTimeoutID:null,lastSuccessfulSdpPair:null,localMediaStateUpdateRetryTimerId:null,localMediaStateVersion:1,outstandingLocalOffer:!1,retryCount:0},n={loggingStateName:"peerConnectionState",name:"PeerConnectionStateMachine",shortname:"Peer Connection"};function o(a){var b;return((b=a.payload)==null?void 0:b.messageID)!=null?String((b=a.payload)==null?void 0:b.messageID):null}b=function(a){babelHelpers.inheritsLoose(b,a);function b(b,e){var f;e===void 0&&(e="init");f=a.call(this,{base:{guards:d("ZenonPeerConnectionSMGuards"),initState:"init"},logging:babelHelpers["extends"]({},n,{eventToLogTimeoutsOn:"applyRemoteSdp",getTransactionId:o,loggableEvents:["applyRemoteSdp"],loggingId:Date.now()}),machine:{context:babelHelpers["extends"]({},m,b),initialState:e,states:t}})||this;f.sm.onTransition(function(a){f.logTransaction(a.event,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSED_SM_EVENT),f.ifDroppedEvent(a,function(a){return a.onError(c("err")("event was dropped: "+a.type))})});f.sm.onTransition(function(a){c("ZenonInfraActionsLogger").updateCachedValues({peerConnectionState:a.value}),f.logTransition(a),a.value==="terminated"&&c("ZenonDebugLogger").getInstance().endQPL(c("qpl")._(64239068,"6172"),f.loggingId)});c("ZenonDebugLogger").getInstance().startQPL(c("qpl")._(64239068,"6172"),f.loggingId);return f}var e=b.prototype;e.getLocalMediaStateVersion=function(){return this.sm.state.context.localMediaStateVersion};return b}((a=d("ZenonStateMachineBase")).ZenonStateMachineBase);f={actions:[(e=d("ZenonPeerConnectionMediaActions")).onApplyMediaUpdate]};var p={actions:[(l=d("xstate")).assign((h=c("ZenonPeerConnectionIceActions")).onIceConnectionStateChanged)]},q={actions:[(i=d("ZenonPeerConnectionDataActions")).onDataChannelMessageReceived]},r={actions:[e.onForceEncodingEnabled]},s={actions:[e.onIceCandidateReady]},t={init:{exit:[e.startTslog],on:{addLocalTracks:{target:"addingLocalTracks"},applyLocalSdp:{target:"applyingLocalSdp"},applyRemoteSdp:{cond:(j=d("ZenonPeerConnectionSMGuards")).applyRemoteOfferSdpGuard,target:"renegotiating"},removeLocalTrack:{target:"removingLocalTrack"},replaceLocalTrack:{target:"replacingLocalTrack"},applyMediaUpdate:f,createDataChannel:{actions:[i.onCreateDataChannel]},createDataMessageSubscription:{actions:[i.onCreateDataMessageSubscription]},dataChannelMessageReceived:q,iceConnectionStateChange:p,localMediaStateUpdateRetry:{actions:[l.assign(e.onLocalMediaStateUpdateRetry)]},muteLocalTrack:{actions:[l.assign(e.onMuteLocalTrack)]},muteRemoteTrack:{actions:[l.assign(e.onMuteRemoteTrack)]},removeDataMessageSubscription:{actions:[i.onRemoveDataMessageSubscription]},setLocalMediaStateVersion:{actions:[l.assign(e.onSetLocalMediaStateVersion)]},stopLocalTrack:{actions:[e.onStopLocalTrack]},unmuteLocalTrack:{actions:[l.assign(e.onUnmuteLocalTrack)]},unmuteRemoteTrack:{actions:[l.assign(e.onUnmuteRemoteTrack)]},applyRemoteIceCandidate:a.defer,forceEncodingEnabled:a.defer,iceCandidateReady:a.defer}},applyingLocalSdp:{invoke:{id:"applyLocalSdpInvoke",onDone:{actions:[l.assign((k=d("ZenonPeerConnectionSdpActions")).onLocalSdpSet)],target:"hasLocalSdp"},onError:"terminating",src:k.applyLocalSdp},on:{endCall:{target:"terminating"},applyMediaUpdate:f,dataChannelMessageReceived:q,iceConnectionStateChange:p,addLocalTracks:a.defer,applyLocalSdp:a.defer,applyRemoteIceCandidate:a.defer,applyRemoteSdp:a.defer,createDataChannel:a.defer,createDataMessageSubscription:a.defer,forceEncodingEnabled:a.defer,iceCandidateReady:a.defer,localMediaStateUpdateRetry:a.defer,muteLocalTrack:a.defer,removeDataMessageSubscription:a.defer,removeLocalTrack:a.defer,replaceLocalTrack:a.defer,stopLocalTrack:a.defer,unmuteLocalTrack:a.defer}},rollingSdpBack:{invoke:{id:"rollingSdpBackInvoke",onDone:{target:"connected"},onError:{target:"terminating"},src:k.applyingLastSuccessfulSdpPair},on:{endCall:{target:"terminating"},applyMediaUpdate:f,dataChannelMessageReceived:q,iceCandidateReady:s,iceConnectionStateChange:p,addLocalTracks:a.defer,applyLocalSdp:a.defer,applyRemoteIceCandidate:a.defer,applyRemoteSdp:a.defer,createDataChannel:a.defer,createDataMessageSubscription:a.defer,forceEncodingEnabled:a.defer,localMediaStateUpdateRetry:a.defer,muteLocalTrack:a.defer,remoteSdpFailed:a.defer,removeDataMessageSubscription:a.defer,removeLocalTrack:a.defer,replaceLocalTrack:a.defer,stopLocalTrack:a.defer,unmuteLocalTrack:a.defer}},hasLocalSdp:{entry:[function(a){return a.mediaChannelManager.setSimulcastSingleLayerParams()}],on:{applyRemoteSdp:[{cond:j.applyRemoteAnswerSdpGuard,target:"applyingRemoteSdp"},{cond:j.applyRemoteOfferSdpGuard,target:"renegotiating"}],remoteSdpFailed:{target:"rollingSdpBack"},endCall:{target:"terminating"},applyMediaUpdate:f,dataChannelMessageReceived:q,iceCandidateReady:s,iceConnectionStateChange:p,addLocalTracks:a.defer,applyRemoteIceCandidate:a.defer,createDataChannel:a.defer,createDataMessageSubscription:a.defer,removeDataMessageSubscription:a.defer,forceEncodingEnabled:a.defer,localMediaStateUpdateRetry:a.defer,muteLocalTrack:a.defer,removeLocalTrack:a.defer,replaceLocalTrack:a.defer,stopLocalTrack:a.defer,unmuteLocalTrack:a.defer}},applyingRemoteSdp:{invoke:[{id:"applyRemoteSdpInvoke",onDone:[{actions:[l.assign(k.updateSdpPair)],cond:j.prAnswerSetGuard,target:"prNegotiated"},{actions:[l.assign(k.updateSdpPair),k.onRemoteSdpSet],cond:j.iceNotConnectedGuard,target:"negotiated"},{actions:[l.assign(k.updateSdpPair),k.onRemoteSdpSet],cond:j.iceConnectedGuard,target:"connected"}],onError:{target:"terminating"},src:k.applyRemoteAnswer}],on:{endCall:{target:"terminating"},iceCandidateReady:s,iceConnectionStateChange:p,addLocalTracks:a.defer,applyMediaUpdate:a.defer,applyLocalSdp:a.defer,applyRemoteIceCandidate:a.defer,applyRemoteSdp:a.defer,createDataChannel:a.defer,createDataMessageSubscription:a.defer,dataChannelMessageReceived:a.defer,forceEncodingEnabled:a.defer,localMediaStateUpdateRetry:a.defer,muteLocalTrack:a.defer,removeDataMessageSubscription:a.defer,removeLocalTrack:a.defer,replaceLocalTrack:a.defer,stopLocalTrack:a.defer,unmuteLocalTrack:a.defer}},negotiated:{entry:[k.logNegotiationCompleted],on:{endCall:{target:"terminating"},iceConnectionStateChange:[{actions:[l.assign(h.onIceConnectionStateChanged)],cond:j.iceConnectedEventGuard,target:"connected"},{actions:[l.assign(h.onIceConnectionStateChanged)]}],iceRestart:{target:"applyingLocalSdp"},applyMediaUpdate:f,applyRemoteIceCandidate:{actions:[e.applyRemoteIceCandidate]},dataChannelMessageReceived:q,forceEncodingEnabled:r,iceCandidateReady:s,addLocalTracks:a.defer,applyLocalSdp:a.defer,applyRemoteSdp:a.defer,createDataChannel:a.defer,createDataMessageSubscription:a.defer,localMediaStateUpdateRetry:a.defer,muteLocalTrack:a.defer,removeDataMessageSubscription:a.defer,removeLocalTrack:a.defer,replaceLocalTrack:a.defer,stopLocalTrack:a.defer,unmuteLocalTrack:a.defer}},prNegotiated:{on:{endCall:{target:"terminating"},applyRemoteSdp:[{cond:j.applyRemoteAnswerSdpGuard,target:"applyingRemoteSdp"}],applyMediaUpdate:f,applyRemoteIceCandidate:{actions:[e.applyRemoteIceCandidate]},dataChannelMessageReceived:q,forceEncodingEnabled:r,iceCandidateReady:s,iceConnectionStateChange:p,addLocalTracks:a.defer,applyLocalSdp:a.defer,createDataChannel:a.defer,createDataMessageSubscription:a.defer,iceRestart:a.defer,localMediaStateUpdateRetry:a.defer,muteLocalTrack:a.defer,removeDataMessageSubscription:a.defer,removeLocalTrack:a.defer,replaceLocalTrack:a.defer,stopLocalTrack:a.defer,unmuteLocalTrack:a.defer}},connected:{on:{addLocalTracks:{target:"addingLocalTracks"},applyLocalSdp:{target:"applyingLocalSdp"},applyRemoteSdp:{cond:j.applyRemoteOfferSdpGuard,target:"renegotiating"},endCall:{target:"terminating"},iceConnectionStateChange:[{actions:[l.assign(h.onIceConnectionStateChanged)],cond:j.iceDisconnectedEventGuard,target:"negotiated"},{actions:[l.assign(h.onIceConnectionStateChanged)]}],localMediaStateUpdateRetry:[{cond:j.outstandingLocalOfferGuard,target:"applyingLocalSdp"},{actions:[l.assign(e.onLocalMediaStateUpdateRetry)]}],removeLocalTrack:{target:"removingLocalTrack"},replaceLocalTrack:{target:"replacingLocalTrack"},applyMediaUpdate:f,applyRemoteIceCandidate:{actions:[e.applyRemoteIceCandidate]},createDataChannel:{actions:[i.onCreateDataChannel]},createDataMessageSubscription:{actions:[i.onCreateDataMessageSubscription]},dataChannelMessageReceived:q,forceEncodingEnabled:r,iceCandidateReady:s,muteLocalTrack:{actions:[l.assign(e.onMuteLocalTrack)]},muteRemoteTrack:{actions:[l.assign(e.onMuteRemoteTrack)]},removeDataMessageSubscription:{actions:[i.onRemoveDataMessageSubscription]},stopLocalTrack:{actions:[e.onStopLocalTrack]},unmuteLocalTrack:{actions:[l.assign(e.onUnmuteLocalTrack)]},unmuteRemoteTrack:{actions:[l.assign(e.onUnmuteRemoteTrack)]}}},addingLocalTracks:{invoke:{id:"addLocalTracksInvoke",onDone:{actions:[l.assign(e.onAddedLocalTracks)],target:"connected"},onError:{actions:[e.onAddLocalTracksError],target:"connected"},src:e.onAddingLocalTracks},on:{endCall:{target:"terminating"},applyMediaUpdate:f,dataChannelMessageReceived:q,iceConnectionStateChange:p,addLocalTracks:a.defer,applyLocalSdp:a.defer,applyRemoteIceCandidate:a.defer,applyRemoteSdp:a.defer,createDataChannel:a.defer,createDataMessageSubscription:a.defer,forceEncodingEnabled:a.defer,iceCandidateReady:a.defer,localMediaStateUpdateRetry:a.defer,muteLocalTrack:a.defer,removeDataMessageSubscription:a.defer,removeLocalTrack:a.defer,replaceLocalTrack:a.defer,stopLocalTrack:a.defer,unmuteLocalTrack:a.defer}},removingLocalTrack:{invoke:{id:"removeLocalTrackInvoke",onDone:{actions:[l.assign(e.onRemovedLocalTrack)],target:"connected"},onError:{actions:[e.onRemoveLocalTrackError],target:"connected"},src:e.onRemovingLocalTrack},on:{endCall:{target:"terminating"},dataChannelMessageReceived:q,iceConnectionStateChange:p,addLocalTracks:a.defer,applyLocalSdp:a.defer,applyMediaUpdate:a.defer,applyRemoteIceCandidate:a.defer,applyRemoteSdp:a.defer,createDataChannel:a.defer,createDataMessageSubscription:a.defer,forceEncodingEnabled:a.defer,iceCandidateReady:a.defer,localMediaStateUpdateRetry:a.defer,muteLocalTrack:a.defer,removeDataMessageSubscription:a.defer,removeLocalTrack:a.defer,replaceLocalTrack:a.defer,stopLocalTrack:a.defer,unmuteLocalTrack:a.defer}},replacingLocalTrack:{invoke:{id:"replaceLocalTrackInvoke",onDone:{actions:[l.assign(e.onReplacedLocalTrack)],target:"connected"},onError:{actions:[e.onReplaceLocalTrackError],target:"connected"},src:e.onReplacingLocalTrack},on:{endCall:{target:"terminating"},dataChannelMessageReceived:q,iceConnectionStateChange:p,addLocalTracks:a.defer,applyLocalSdp:a.defer,applyMediaUpdate:a.defer,applyRemoteIceCandidate:a.defer,applyRemoteSdp:a.defer,createDataChannel:a.defer,createDataMessageSubscription:a.defer,forceEncodingEnabled:a.defer,iceCandidateReady:a.defer,localMediaStateUpdateRetry:a.defer,muteLocalTrack:a.defer,removeDataMessageSubscription:a.defer,removeLocalTrack:a.defer,replaceLocalTrack:a.defer,stopLocalTrack:a.defer,unmuteLocalTrack:a.defer}},renegotiating:{invoke:{id:"renegotiatingInvoke",onDone:[{actions:[l.assign(k.onLocalSdpSet)],cond:j.iceNotConnectedGuard,target:"negotiated"},{actions:[l.assign(k.onLocalSdpSet)],cond:j.iceConnectedGuard,target:"connected"}],onError:{actions:[k.onApplyRemoteOfferSetLocalAnswerError],target:"terminating"},src:k.applyRemoteOfferAndSetLocalAnswer},on:{endCall:{target:"terminating"},addLocalTracks:a.defer,applyLocalSdp:a.defer,applyMediaUpdate:a.defer,applyRemoteIceCandidate:a.defer,applyRemoteSdp:a.defer,createDataChannel:a.defer,createDataMessageSubscription:a.defer,dataChannelMessageReceived:a.defer,forceEncodingEnabled:a.defer,iceConnectionStateChange:a.defer,localMediaStateUpdateRetry:a.defer,muteLocalTrack:a.defer,removeDataMessageSubscription:a.defer,removeLocalTrack:a.defer,replaceLocalTrack:a.defer,stopLocalTrack:a.defer,unmuteLocalTrack:a.defer}},terminating:{exit:[d("ZenonPeerConnectionTerminatingState").done],invoke:[{onDone:{target:"terminated"},src:d("ZenonPeerConnectionTerminatingState").cleanUp}],on:{addLocalTracks:a.defer,applyLocalSdp:a.defer,applyMediaUpdate:a.defer,applyRemoteIceCandidate:a.defer,applyRemoteSdp:a.defer,createDataChannel:a.defer,createDataMessageSubscription:a.defer,dataChannelMessageReceived:a.defer,forceEncodingEnabled:a.defer,iceConnectionStateChange:a.defer,localMediaStateUpdateRetry:a.defer,muteLocalTrack:a.defer,removeDataMessageSubscription:a.defer,removeLocalTrack:a.defer,replaceLocalTrack:a.defer,restartPeerConnection:a.defer,stopLocalTrack:a.defer,unmuteLocalTrack:a.defer}},terminated:{on:{restartPeerConnection:{actions:[d("ZenonPeerConnectionTerminatedState").restart],target:"init"},addLocalTracks:a.defer,applyLocalSdp:a.defer,applyMediaUpdate:a.defer,applyRemoteIceCandidate:a.defer,applyRemoteSdp:a.defer,createDataChannel:a.defer,createDataMessageSubscription:a.defer,dataChannelMessageReceived:a.defer,forceEncodingEnabled:a.defer,iceConnectionStateChange:a.defer,localMediaStateUpdateRetry:a.defer,muteLocalTrack:a.defer,removeDataMessageSubscription:a.defer,removeLocalTrack:a.defer,replaceLocalTrack:a.defer,stopLocalTrack:a.defer,unmuteLocalTrack:a.defer}}};g["default"]=b}),98);
__d("SctpSctpDatagramSerializers",["ThriftTypes","jsbi"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return{sender:0,receivers:new Set(),payload:Uint8Array.of()}}function b(a,b){b.writeStructBegin("Datagram");b.writeFieldBegin({fname:"sender",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1});if(a.sender!=null)b.writeI64(c("jsbi").BigInt(a.sender));else{var d=0;b.writeI64(c("jsbi").BigInt(d))}b.writeFieldEnd();b.writeFieldBegin({fname:"receivers",ftype:h.SET,fid:2});if(a.receivers!=null){b.writeSetBegin({etype:(h||(h=c("ThriftTypes"))).I64,size:a.receivers.size});for(d of a.receivers)b.writeI64(c("jsbi").BigInt(d));b.writeSetEnd()}else{d=new Set();b.writeSetBegin({etype:(h||(h=c("ThriftTypes"))).I64,size:d.size});for(d of d)b.writeI64(c("jsbi").BigInt(d));b.writeSetEnd()}b.writeFieldEnd();b.writeFieldBegin({fname:"payload",ftype:h.STRING,fid:3});if(a.payload!=null)b.writeBinary(a.payload);else{d=Uint8Array.of();b.writeBinary(d)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function d(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I64?b.sender=Number(a.readI64()):a.skip(e);break;case 2:if(e===(h||(h=c("ThriftTypes"))).SET){b.receivers=new Set();d=a.readSetBegin();for(var f=0;f<d.size;f++){var g=Number(a.readI64());b.receivers.add(g)}}else a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.payload=a.readBinary():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.sender===void 0&&(b.sender=0);b.receivers===void 0&&(b.receivers=new Set());b.payload===void 0&&(b.payload=Uint8Array.of());return b}g.Datagram$DefaultConstructor=a;g.serializeDatagram=b;g.deserializeDatagram=d}),98);
__d("ZenonDataChannelWrapper",["CompactSerializerPolyfill","RequestStreamBodyUtils","SctpSctpDatagramSerializers","ZenonAuditedCheckpointLogId","ZenonE2ee","ZenonInfraActionsLogger","err"],(function(a,b,c,d,e,f,g){"use strict";var h=100;a=function(){function a(a,b,d){var e=this;this.$1=[];this.onMessage=function(a){a=a.data;typeof a==="string"?e.$12(a,null):a instanceof ArrayBuffer?e.$13(a):c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,error:"Message type is not supported "+typeof a+" and will not be processed.",errorDomain:"ZenonDataChannelWrapper onMessage"})};this.onClose=function(){var a;e.$1=[];(a=e.$6)==null?void 0:a.deregisterSctpTopic(e.$3);(a=e.$5)==null?void 0:a.onClosing()};this.onOpen=function(){var a;e.$14();(a=e.$5)==null?void 0:a.onOpen()};this.$2=a;this.$3=this.$2.label;this.$4=b;this.$5=d;this.$2.onclose=this.onClose;this.$2.onmessage=this.onMessage;this.$2.onopen=this.onOpen;this.$6=c("ZenonE2ee").getSecureDataMessageManager();this.$7=this.$8();(a=this.$6)==null?void 0:a.registerSctpTopic(this.$3,this.$7)}var b=a.prototype;b.send=function(a){if(this.getState()!=="open"){this.$9(a);return}this.$10(a)};b.$10=function(a){try{if(!this.$11(a))return;a=this.$4.toSctpDatagram(a);if(a==null){c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,error:"Could not convert ZenonDataMessage to Datagram. Not sending message.",errorDomain:"ZenonDataChannelWrapper send"});return}a=d("CompactSerializerPolyfill").serialize(a,d("SctpSctpDatagramSerializers").serializeDatagram);this.$2.send(a)}catch(a){c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,error:"Could not convert serialize Datagram with error: "+a+". Not sending message.",errorDomain:"ZenonDataChannelWrapper send"})}};b.$11=function(a){if(this.$6==null)return!0;var b=this.$6.encryptSctpMessage(this.$3,a.message);if(b==null)return!1;a.message=b;return!0};b.close=function(){this.$2.close()};b.getState=function(){return this.$2.readyState};b.setListeners=function(a){this.$5=a};b.$14=function(){while(this.$1.length>0&&this.getState()==="open")this.$10(this.$1.shift())};b.$9=function(a){this.getState()!=="closed"&&this.$1.length<h?this.$1.push(a):c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"We failed to queue message for"+this.$3+" max queue size of"+h+" current queue size: "+this.$1.length+" current data channel state is "+this.getState()})};b.$8=function(){var a=this;return function(b,c,d){var e;(e=a.$5)==null?void 0:e.onMessage({message:b,sender:c,senderNodeId:d})}};b.$12=function(a,b){if(b==null){this.$7(a,"",-1);return}var d=this.$4.toUserId(b);if(d==null){c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,error:"Could not find associated sender id of node id. "+b,errorDomain:"ZenonDataChannelWrapper _onSctpMessage"});return}if(this.$6==null){this.$7(a,d,b);return}this.$6.onSctpMessage(this.$3,a,d,b)};b.$13=function(a){try{var b=d("CompactSerializerPolyfill").deserialize(new Uint8Array(a),d("SctpSctpDatagramSerializers").deserializeDatagram);if(b.sender===0)throw c("err")("Incorrectly deserialized datagram. Received a node id of 0.");this.$12(d("RequestStreamBodyUtils").uint8ArrayToString(b.payload),b.sender)}catch(b){c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,error:"Could not deserialize datagram with error "+b+". Treating as unwrapped payload.",errorDomain:"ZenonDataChannelWrapper onMessage"}),this.$12(d("RequestStreamBodyUtils").uint8ArrayToString(new Uint8Array(a)),null)}};return a}();g["default"]=a}),98);
__d("ZenonEventListenerCache",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=new Map()}var b=a.prototype;b.add=function(a,b){var c=this.getByType(a);c.push(b);this.$1.set(a,c)};b["delete"]=function(a,b){var c=this.getByType(a);c=c.filter(function(a){return a!==b});c.length<1?this.$1["delete"](a):this.$1.set(a,c)};b.forEachEventListener=function(a){var b=this,c=this.getCachedEventTypes();c.forEach(function(c){var d=b.getByType(c);d.forEach(function(b){a(c,b)})})};b.getByType=function(a){return(a=this.$1.get(a))!=null?a:[]};b.getCachedEventTypes=function(){return Array.from(this.$1.keys())};b.getAll=function(){return this.$1};return a}();f["default"]=a}),66);
__d("ZenonPeerConnectionHelper",["FBLogger"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a.signalingState!=="closed"&&a.close()}function b(){return RTCPeerConnection.generateCertificate({name:"ECDSA",namedCurve:"P-256"})}function d(a,b){b===void 0&&(b={});try{return new RTCPeerConnection(babelHelpers["extends"]({},b))}catch(a){c("FBLogger")("rtc_www").catching(a).warn("Failed to create peer connection");throw a}}g.closePeerConnection=a;g.generateCertificate=b;g.createPeerConnection=d}),98);
__d("ZenonSimulcastSdpUtils",["Random","UserAgent","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h="\r\n";function i(a){a=a.filter(function(a){return a.startsWith("a=ssrc:")}).map(function(a){return a.split(" ")[0].split(":")[1]});return new Set(a)}function j(a,b){var c=new RegExp("^a=ssrc:\\d+ "+b+":");b=a.filter(function(a){return c.test(a)})[0];return b?b.split(" ")[1].split(":")[1]:b}function k(a){a=a.filter(function(a){return a.startsWith("a=ssrc-group:FID")}).map(function(a){return a.split(" ")[2]});return new Set(a)}function l(a){var b=new RegExp("^a=ssrc:\\d+ msid:");a=a.filter(function(a){return b.test(a)})[0];a=a.split(" ");return a.length>2?a[2]:null}function m(a,b){var c=[];for(var e=0;e<a;e++){var f=0;while(f===0||b.has(f.toString()))f=d("Random").uint32();b.add(f.toString());c.push(f.toString())}return c}function a(a,b){if(!c("UserAgent").isBrowser("Chrome >= 88")){c("recoverableViolation")("Attempted to add unified-plan simulcast in unsupported browser","rtc_www");return a}if(b<=1||b>3){c("recoverableViolation")("Unsupported number of layers passed: "+b,"rtc_www");return a}var d=a.trim().split(h),e=i(d),f=d.findIndex(function(a){return/^m=video/.test(a)});if(f===-1)return a;a=f+1;while(a<d.length){if(d[a].startsWith("m="))break;a++}a=d.splice(f,a-f);var g=i(a),n=k(a);g=new Set(Array.from(g).filter(function(a){return!n.has(a)}));if(g.size!==1||n.size>1)return[].concat(d.slice(0,f),a,d.slice(f)).join(h);var o=n.size===1;g=Array.from(g)[0];var p="";o&&(p=Array.from(n)[0]);var q=j(a,"cname"),r=j(a,"msid"),s=l(a);s!=null&&(r+=" "+s);var t=j(a,"mslabel"),u=j(a,"label");s=[g].concat(m(b-1,e));g=[];o&&(s.forEach(function(a){return e.add(a)}),g=[p].concat(m(b-1,e)));var v=[];v.push("a=ssrc-group:SIM "+s.join(" "));for(p=0;p<g.length;p++)v.push("a=ssrc-group:FID "+s[p]+" "+g[p]);b=[];if(o)for(p=0;p<s.length;p++)b.push(s[p]),b.push(g[p]);else b=s;b.forEach(function(a){v.push("a=ssrc:"+a+" cname:"+q),v.push("a=ssrc:"+a+" msid:"+r),t&&v.push("a=ssrc:"+a+" mslabel:"+t),u&&v.push("a=ssrc:"+a+" label:"+u)});a=a.filter(function(a){return!a.startsWith("a=ssrc")});a=[].concat(a,v);return[].concat(d.slice(0,f),a,d.slice(f)).join(h)+h}g.addSimulcastToChromeOffer=a}),98);
__d("ZenonPeerConnectionWrapper",["FBLogger","FrameEncryptionWasmTypes","ZenonAppProvider","ZenonAuditedCheckpointLogId","ZenonBrowsers","ZenonDataChannelWrapper","ZenonE2ee","ZenonEventListenerCache","ZenonInfraActionsLogger","ZenonPeerConnectionHelper","ZenonSDP","ZenonSimulcastSdpUtils","ZenonSimulcastUtils","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,e,f){var g=this;e===void 0&&(e={});f===void 0&&(f=!1);this.$4=new(c("ZenonEventListenerCache"))();this.$9=!1;this.$10=!1;this.$15=function(a){a=a.channel;var b=g.$6.get(a.label);g.$5.set(a.label,new(c("ZenonDataChannelWrapper"))(a,g.$7,b))};this.$2=a;this.$3=e;this.$1=d("ZenonPeerConnectionHelper").createPeerConnection(a,e);this.$5=new Map();this.$6=new Map();this.$7=b;this.$8=f;f&&(this.$9=!0);this.$11=new Map();this.$12=new Map();this.$13=new Map();this.addEventListener("datachannel",this.$15)}var b=a.prototype;b.$16=function(a){if(a==null)return;return a.replace(/a=sendonly|a=recvonly/g,"a=sendrecv")};b.createOffer=async function(a){a===void 0&&(a={});a=await this.$17(a);d("ZenonAppProvider").isMetaAI()&&d("ZenonBrowsers").isFirefox()&&(a.sdp=this.$16(a.sdp));if(this.$9){if(a.sdp!=null)try{a.sdp=d("ZenonSimulcastSdpUtils").addSimulcastToChromeOffer(a.sdp,d("ZenonSimulcastUtils").getNumLayers())}catch(a){c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,error:a.toString(),errorDomain:"ZenonPeerConnectionWrapper_createOffer_addSimulcastToChromeOffer"})}this.$9=!1}return new(d("ZenonSDP").ZenonLocalSDP)(a)};b.rollbackSdp=async function(){try{await this.$1.setLocalDescription({type:"rollback"})}catch(a){c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,error:a.toString(),errorDomain:"ZenonPeerConnectionWrapper_rollbackSDP"});throw a}};b.setLocalDescription=async function(a){this.$18(a.getMedia(),this.$11);a=a.toDescInit();try{this.getSignalingState()!=="closed"&&await this.$1.setLocalDescription(a)}catch(a){c("FBLogger")("rtc_www").catching(a).mustfix("Error processing modern API setLocalDescription in ZenonPeerConnectionWrapper.");throw a}};b.createAnswer=async function(){var a=await this.$1.createAnswer();a=new(d("ZenonSDP").ZenonLocalSDP)(a);this.$14=a.getSSLRole();return a};b.setRemoteDescription=async function(a){this.$18(a.getMedia(),this.$12);if(a.getType()==="answer"){var b=a.getSSLRole();if(b!=null&&this.$14==null)this.$14=this.getOppositeSSLRole(b);else if(b==null&&this.$14!=null){b=this.getOppositeSSLRole(this.$14);a.setSSLRole(b)}}b=a.toDescInit();this.$19(b);c("ZenonE2ee").terminateCallIfE2eeViolation(d("FrameEncryptionWasmTypes").ZenonE2eeComponent.PRE_REMOTE_SDP,"");try{await this.$1.setRemoteDescription(b)}catch(a){c("FBLogger")("rtc_www").catching(a).mustfix("Error processing modern API setRemoteDescription in ZenonPeerConnectionWrapper.");throw a}};b.setRemoteIceCandidate=function(a){if(this.$1.remoteDescription===null){c("FBLogger")("rtc_www").mustfix("Remote ICE candidate should not be applied before remote description");return Promise.resolve()}return this.$1.addIceCandidate(a)};b.close=function(){this.$5.forEach(function(a){return a.close()}),this.$5.clear(),d("ZenonPeerConnectionHelper").closePeerConnection(this.$1)};b.restart=function(){this.$1=d("ZenonPeerConnectionHelper").createPeerConnection(this.$2,this.$3),this.addCachedEventListenersToPeerConnection()};b.addEventListener=function(a,b){this.$4.add(a,b),this.$1.addEventListener(a,b)};b.createDataChannel=function(a,b,d,e,f){var g=function(){};g={onClosing:g,onMessage:b,onOpen:d};b=this.$5.get(a);if(b==null)if(e){d=this.$1.createDataChannel(a,this.$20(f));d==null?c("recoverableViolation")("Unable to create requested data channel: "+a,"rtc_www"):(d.binaryType="arraybuffer",this.$5.set(a,new(c("ZenonDataChannelWrapper"))(d,this.$7,g)))}else this.$6.set(a,g);else b.setListeners(g)};b.getDataChannelState=function(a){a=this.$5.get(a);return a==null?void 0:a.getState()};b.sendDataMessage=function(a,b){var d=this.$5.get(a);d!=null?d.send(b):c("recoverableViolation")("Unable to send a message on data channel: "+a,"rtc_www")};b.getCnameFromTrackId=function(a){return(a=this.$13.get(a))!=null?a:null};b.getAllEventListeners=function(){return this.$4.getAll()};b.getEventListenersForType=function(a){return(a=this.$4.getByType(a))!=null?a:[]};b.canAcceptRemoteSdp=function(){return this.$1.iceConnectionState!=="closed"&&this.$1.signalingState!=="closed"};b.removeEventListener=function(a,b){this.$4.delete(a,b),this.$1.removeEventListener(a,b)};b.removeAllEventListeners=function(){var a=this;this.$4.forEachEventListener(function(b,c){a.$1.removeEventListener(b),a.$4.delete(b,c)})};b.addCachedEventListenersToPeerConnection=function(){var a=this;this.$4.forEachEventListener(function(b,c){a.$1.addEventListener(b,c)})};b.addTrack=function(a,b){return b==null?this.$1.addTrack(a):this.$1.addTrack(a,b)};b.addTransceiver=function(a,b){return this.$1.addTransceiver(a,b)};b.getTransceivers=function(){return typeof this.$1.getTransceivers==="function"?this.$1.getTransceivers():[]};b.getTransceiverFromSender=function(a){return this.getTransceivers().find(function(b){return b.sender===a})};b.getReceivers=function(){return typeof this.$1.getReceivers==="function"?this.$1.getReceivers():[]};b.getSenders=function(){return typeof this.$1.getSenders==="function"?this.$1.getSenders():[]};b.getStats=function(a){return this.$1.getStats(a)};b.getSignalingState=function(){return this.$1.signalingState};b.removeTrack=function(a){var b=!1;for(var d of this.$1.getSenders())d.track===a&&(this.$1.removeTrack(d),b=!0);b||c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"ZenonPeerConnectionWrapper.removeTrack: Could not find sender for track "+a.id})};b.supportsSimulcast=function(){return this.$8};b.getSimulcastInitialized=function(){return this.$10};b.setSimulcastInitialized=function(a){this.$10=a};b.$17=function(a){return Promise.resolve(this.$1.createOffer(a))};b.$18=function(a,b){var c=this;a.forEach(function(a){if(a.type!=="application"){var d=a.msid;d=c.getTrackIdFromMsid(d);d!=null&&a.mid!=null&&b.set(String(a.mid),d)}})};b.$20=function(a){a===void 0&&(a={});a.negotiated=!1;return a};b.$19=function(a){var b=this,c=a.sdp;a=a.type;c=new(d("ZenonSDP").ZenonRemoteSDP)({sdp:c,type:a}).getTrackIdAndCnameMap();c.forEach(function(a,c){b.$13.set(c,a)})};b.getTrackIdFromMsid=function(a){if(a!=null){a=a.split(" ");if(a.length>=2)return a[1];else c("FBLogger")("rtc_www").warn("MSID did not have an eligible ID for caching")}return null};b.getLocalMWTrackId=function(a){return a!==null?(a=this.$11.get(a))!=null?a:null:null};b.getRemoteMWTrackId=function(a){return a!==null?(a=this.$12.get(a))!=null?a:null:null};b.getCurrentRemoteDescription=function(){return this.$1.currentRemoteDescription!=null?new(d("ZenonSDP").ZenonRemoteSDP)({sdp:this.$1.currentRemoteDescription.sdp,type:this.$1.currentRemoteDescription.type}):null};b.getOppositeSSLRole=function(a){return a==="active"?"passive":"active"};b.getDataChannel_TESTONLY=function(a){return this.$5.get(a)};return a}();g.default=a}),98);
__d("ZenonSDPRtpHeaderExtensionManager",["ZenonAppProvider","ZenonBrowsers","ZenonInfraActionsLogger","ZenonODSLogger"],(function(a,b,c,d,e,f,g){"use strict";var h=[1,2,3,4,5,6,7,8,9,10,11,12,13,14],i="http://www.webrtc.org/experiments/rtp-hdrext/video-layers-allocation00",j="http://www.webrtc.org/experiments/rtp-hdrext/generic-frame-descriptor-00",k="urn:ietf:params:rtp-hdrext:encrypt",l="urn:ietf:params:rtp-hdrext:ssrc-audio-level",m="http://www.webrtc.org/experiments/rtp-hdrext/abs-capture-time",n=0;a=function(){function a(a){this.$1=[],this.$2=a,this.$3()}var b=a.prototype;b.$3=function(){if(d("ZenonBrowsers").isVideoLayersAllocationSupported()){var a={existingId:n,isRemoteSupported:!0,mediaType:"video",notFoundCounterName:"no_unused_extension_id_found_for_vla",uri:i};this.$1.push(a)}if(this.$2){a={existingId:n,isRemoteSupported:!0,mediaType:"video",notFoundCounterName:"no_unused_extension_id_found_for_gfd",uri:j};this.$1.push(a);a={config:l,existingId:n,isRemoteSupported:!0,mediaType:"audio",notFoundCounterName:"no_unused_extension_id_found_for_encrypted_audio_rtp_header",uri:k};this.$1.push(a)}if(d("ZenonAppProvider").isMetaAI()){a={existingId:n,isRemoteSupported:!0,mediaType:"audio",notFoundCounterName:"no_unused_extension_id_found_for_abs_capture_time",uri:m};this.$1.push(a)}};b.resetRtpHeaderExtensionStatus=function(){this.$1=[],this.$3()};b.setExtensionsSupportedByRemote=function(a){var b=this;this.$1.forEach(function(c){var d=b.$4(a,c);d===n?c.isRemoteSupported=!1:c.existingId===n&&(c.existingId=d)})};b.enableRegisteredExtensions=function(a){var b=this,d=a.getMedia();if(d==null)return;this.$1.forEach(function(e){if(e.isRemoteSupported){var f=e.existingId!==n?e.existingId:b.$5(d,e);if(f===n)return;e.existingId=f;c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"[ZP] enabling header extension for <uri: "+e.uri+"\n          , id: "+f+", media type: "+e.mediaType+",\n          config: "+String(e.config)+">"});a.enableExtension(e.uri,e.mediaType,f,e.config)}})};b.$5=function(a,b){var d=this,e=new Set(h),f=0;a.forEach(function(a){if(a.ext==null)return;for(a of a.ext){if(d.$6(b,a)){f=a.value;return}e["delete"](a.value)}});if(f===n&&e.size===0){b.notFoundCounterName!==""&&c("ZenonODSLogger").logCounter(b.notFoundCounterName);return n}return f===n?Array.from(e)[0]:f};b.$4=function(a,b){var c=this,d=n;a=a.getMedia();if(a!=null)for(a of a){var e;(e=a.ext)==null?void 0:e.forEach(function(a){c.$6(b,a)&&(d=a.value)})}return d};b.getRegisteredRtpHeaderExtensions=function(){return this.$1};b.$6=function(a,b){if(a.uri!==b.uri)return!1;return a.config==null?!0:a.config===b.config};return a}();g["default"]=a}),98);
__d("ZenonSDPManager",["FBLogger","FrameEncryptionWasmTypes","ZenonAuditedCheckpointLogId","ZenonBrowsers","ZenonE2ee","ZenonE2eeMandatedStateManager","ZenonInfraActionsLogger","ZenonODSLogger","ZenonSDPRtpHeaderExtensionManager","gkx","pako","performanceNow"],(function(a,b,c,d,e,f,g){"use strict";var h,i="http://www.webrtc.org/experiments/rtp-hdrext/playout-delay",j="urn:3gpp:video-orientation",k="set_local_sdp_error",l="set_remote_sdp_error",m="rollback_sdp_error";a=function(){function a(a,b){this.$2=null,this.$3=null,this.$1=a,this.$4=b.getZenonSdpTransformConfig(),this.$5=new(c("ZenonSDPRtpHeaderExtensionManager"))(c("ZenonE2ee").isE2eeStackReady()||c("ZenonE2eeMandatedStateManager").isInfraE2eeMandated())}var b=a.prototype;b.getLocalSdp=function(){return this.$2};b.getRemoteSdp=function(){return this.$3};b.getZenonSDPRtpHeaderExtensionManager=function(){return this.$5};b.shouldPreferH264Multiway=function(){return c("gkx")("25217")};b.shouldPreferAV1Multiway=function(){return c("gkx")("25218")};b.createLocalSdp=async function(a,b,d){b=b==="offer"?await this.$1.createOffer(babelHelpers.extends({},d,{preserveH264:this.$4.isPreserveH264()})):await this.$1.createAnswer();this.shouldPreferH264Multiway()&&(this.$4.isPreferSwH264()?b.preferH264Codec({levelAsymmetryAllowed:!0,packetizationMode:!0,profileLevelId:"42e01f"}):b.preferCodec("video",{preferredCodec:"H264",preferredCodecRate:9e4}));b.removeH264CodecsWithPacketizationMode0();this.$4.isPreserveH264()||b.removeCodec("H264");b.removeH264CodecsWithProfileLevelId("42001f");d=this.shouldPreferAV1Multiway();d&&b.preferCodec("video",{preferredCodec:"AV1",preferredCodecRate:9e4});b.removeCodec("flexfec-03");b.removeCodec("VP9");d||b.removeCodec("AV1");b.removeCodec("red");b.removeCodec("ulpfec");b.removeCodec("H265");this.$6(b);d=c("ZenonE2ee").generateDtlsAuthenticationInfo(b);d!=null&&b.updateDtlsAuthenticationInfo(d);b.setVersion(a);this.$2=b;return b};b.setLocalSdp=async function(a){try{this.$7(a,"local");var b=(h||(h=c("performanceNow")))();await this.$1.setLocalDescription(a);b=h()-b;c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"[ZP]["+a.getType()+"] Finished setting local sdp of type in: "+String(b)})}catch(a){c("ZenonODSLogger").logCounter(k);this.$8(a,"Failed to set local sdp","ZenonSDPManager_setLocalSdp");throw a}this.$2=a};b.rollbackSdp=async function(){try{await this.$1.rollbackSdp(),c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"[ZP] Successfully called rollback sdp"})}catch(a){c("ZenonODSLogger").logCounter(m);this.$8(a,"Failed to set rollback sdp","ZenonSDPManager_rollbackSDP");throw a}};b.createAndSetLocalSdp=async function(a,b,c){a=await this.createLocalSdp(a,b,c);await this.setLocalSdp(a);return a};b.setRemoteSdp=async function(a,b,e,f){a.isRemote()||c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"[ZP] Wrong SDP location",error:"Non-remote SDP passed to setRemoteSdp()",errorDomain:"ZenonSDPManager_setRemoteSdp"});if(!this.$1.canAcceptRemoteSdp())return a;b({name:"beginRemoteSdpMunging"});this.$6(a);this.shouldPreferAV1Multiway()||a.removeCodec("AV1");b({name:"endRemoteSdpMunging"});c("gkx")("25219")&&(c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"[ZP]["+a.getType()+"] Munge inactive media SSRC"}),a.mungeInactiveMediaSSRC(this.$1.getCurrentRemoteDescription()));c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"processing e2ee attributes while setting remote sdp, e2eeServerState is null? "+(f==null?"yes":"no")+", server state size is "+((b=f==null?void 0:f.byteLength)!=null?b:0)+" bytes"});e!=null&&c("ZenonE2ee").updateRemoteUserId(e);f!=null&&await c("ZenonE2ee").processE2eeServerState(f);await c("ZenonE2ee").verifyDtlsAuthenticationInfo(a);try{this.$7(a,"remote");b=(h||(h=c("performanceNow")))();await this.$1.setRemoteDescription(a);e=h()-b;c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"[ZP]["+a.getType()+"] Finished setting remote sdp in: "+String(e)})}catch(a){c("ZenonODSLogger").logCounter(l);this.$8(a,"Failed to set remote sdp","ZenonSDPManager_setRemoteSdp");throw a}c("ZenonE2ee").terminateCallIfE2eeViolation(d("FrameEncryptionWasmTypes").ZenonE2eeComponent.POST_REMOTE_SDP,"");this.$3=a;return a};b.$8=function(a,b,d){b="[ZP] "+b;c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:b,error:a.toString(),errorDomain:d})};b.$7=function(a,b){try{var d=btoa(c("pako").deflate(a.toLoggingString(),{to:"string"}));c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"[ZP]["+a.getType()+"] Set "+b+" description sdp: "+d})}catch(a){c("FBLogger")("rtc_www").catching(a).warn("Failed to log the SDP"),c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"[ZP] Failed to log the SDP",error:a.toString(),errorDomain:"ZenonSDPManager_logSdp"})}};b.setRemoteIceCandidate=async function(a){try{await this.$1.setRemoteIceCandidate(a)}catch(b){c("FBLogger")("rtc_www").catching(b).warn("Failed to setRemoteIceCandidate with ",JSON.stringify(a));c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"[ZP] Failed to set remote ice candidate",error:b.toString(),errorDomain:"ZenonSDPManager_setRemoteIceCandidate"});throw b}};b.closePeerConnection=function(){this.$1.close()};b.restartPeerConnection=function(){this.$5.resetRtpHeaderExtensionStatus(),this.$1.restart()};b.$6=function(a){a.stripLocalIceCandidates();a.useDTLSOverCrypto();a.stripDataChannel();a.maybeAddPtimeForOpusOnly(60);c("gkx")("25220")&&a.addFmtpConfig("H264","sps-pps-idr-in-keyframe","1");this.$4.isDisableOpusStereo()&&a.addFmtpConfig("opus","stereo","0");a.addFmtpConfig("opus","useinbandfec",this.$4.isSetOpusUseinbandfec()?"1":"0");a.addFmtpConfig("opus","usedtx",this.$4.isSetOpusUsedtx()?"1":"0");var b=this.$4.getSetOpusMaxaveragebitrate();b>0&&a.addFmtpConfig("opus","maxaveragebitrate",b.toString());b=this.$4.getSetOpusMaxplaybackrate();b>0&&a.addFmtpConfig("opus","maxplaybackrate",b.toString());a.addAudioNACK();a.isRemote()?(this.$5.setExtensionsSupportedByRemote(a),d("ZenonBrowsers").isFirefox()&&a.addSetupActPass()):(a.filterExtension(i,"video"),a.filterExtension(j,"video"),this.$5.enableRegisteredExtensions(a))};return a}();g.default=a}),98);
__d("ZenonSimulcastDataMessageParser",["recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=null,c=0;a.perSsrcTargetBitrateBpsMap!=null&&(b=h(a.perSsrcTargetBitrateBpsMap));if(a.qualityMask!=null){a=parseInt(a.qualityMask,10);isNaN(a)||(c=a)}return{perSsrcTargetBitrateBpsMap:b,qualityMask:c}}function h(a){var b=new Map();Object.keys(a).forEach(function(d){var e=parseInt(a[d],10);if(isNaN(e)){c("recoverableViolation")("Simulcast bitrate string could not be parsed as int","rtc_www");return}b.set(d,e)});return b}g.parseSimulcastControlMessage=a}),98);
__d("ZenonPeerConnectionManager",["DateConsts","FBLogger","ODS","Promise","ZenonAuditedCheckpointLogId","ZenonBrowsers","ZenonClientTslogUploader","ZenonIceConnectionMonitor","ZenonInfraActionsLogger","ZenonLogPromiseRejection","ZenonMediaActionLogger","ZenonMediaChannelManager","ZenonMediaError","ZenonMediaStatsUtil","ZenonPeerConnectionConfig","ZenonPeerConnectionStateMachine","ZenonPeerConnectionWrapper","ZenonSDPManager","ZenonSimulcastDataMessageParser","ZenonSimulcastManager","ZenonSimulcastUtils","emptyFunction","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=2*d("DateConsts").MS_PER_SEC,k=6;a=function(){function a(a){var b=this,e;this.$5=null;this.$6=function(){};this.$7=new Set();this.$8=new Map();this.$9=new Map();this.$10=!1;this.$12=new Map();this.$13=!1;this.$16=0;this.$17=!1;this.$18=!1;this.$20=function(a){a=a.target;a=a.iceConnectionState;b.$14.updateIceConnectionState(a);b.$14.logIceConnectionState(b.$6);b.$14.updateIceConnectionTimer(function(){return b.$1.processEvent({onError:c("emptyFunction"),onSuccess:c("emptyFunction"),payload:{error:d("ZenonMediaError").ZenonMediaError.IceDisconnected,stopLocalTracks:!0},type:"endCall"})});b.$13&&b.$14.updateIceRestartTimer(b.$1,j);b.$1.processEvent({onError:c("emptyFunction"),onSuccess:c("emptyFunction"),payload:{iceConnectionState:a},type:"iceConnectionStateChange"})};this.$22=function(a){a=a.target;a.signalingState==="closed"&&c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"Peer connection signaling state changed to closed"});if(a.connectionState==="closed"){a=!0;var e=d("ZenonMediaError").ZenonMediaError.ConnectionClosed;c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"Peer connection state changed to closed"});b.$1.processEvent({onError:c("emptyFunction"),onSuccess:c("emptyFunction"),payload:{error:e,stopLocalTracks:a},type:"endCall"})}};this.$21=function(a){a=a.candidate;a!=null&&b.$1.processEvent({onError:c("emptyFunction"),onSuccess:c("emptyFunction"),payload:a,type:"iceCandidateReady"})};this.$14=new(c("ZenonIceConnectionMonitor"))();this.$10=(e=a.shouldUseSimulcast)!=null?e:!1;this.$11=a.configManager.getSimulcastOverSignalingConfig().isSimulcastOverSignalingEnabled();a.loggingEventHandler&&(this.$6=a.loggingEventHandler);this.$5=null;e=c("ZenonPeerConnectionConfig").getConfigZenonPlatform();this.$4=new(c("ZenonPeerConnectionWrapper"))(a.configManager,a.dataMessageTranslator,babelHelpers["extends"]({},e),this.$10);this.$6({name:"peerConnectionCreated"});e=d("ZenonMediaStatsUtil").shouldUseTSLog();this.$2=new(c("ZenonMediaChannelManager"))({areTslogsEnabled:e,dataMessageTranslator:a.dataMessageTranslator,mediaStats:a.mediaStats,onFirstMediaPacket:function(a,c){return b.$6({name:"firstMediaPacketReceived",timestamp:c,type:a})},onFirstSentMediaPacket:function(a,c){return b.$6({name:"firstMediaPacketSent",timestamp:c,type:a})},onMediaStatUpdate:function(a){return b.$6({mediaStats:a,name:"setMediaStats"})},peerConnection:this.$4});this.$3=new(c("ZenonSDPManager"))(this.$4,a.configManager);this.$1=new(c("ZenonPeerConnectionStateMachine"))(babelHelpers["extends"]({},this.$19(),{logEvent:function(a){return b.$6(a)},mediaChannelManager:this.$2,sdpManager:this.$3,tslogUploader:e?new(c("ZenonClientTslogUploader"))(function(a){return b.$6(a)},this.$2):null}));this.$4.addEventListener("iceconnectionstatechange",this.$20);this.$4.addEventListener("icecandidate",this.$21);this.$4.addEventListener("signalingstatechange",this.$22)}var e=a.prototype;e.subscribeDataChannelOpen=function(a,b){var c;c=(c=this.$12.get(b))!=null?c:[];c.push(a);this.$12.set(b,c)};e.unsubscribeDataChannelOpen=function(a,b){var c;c=(c=this.$12.get(b))!=null?c:[];c=c.filter(function(b){return b!==a});this.$12.set(b,c)};e.onNetworkUpdate=function(a){this.$14.updateNetworkStatus(a.local),this.$13&&this.$14.updateIceRestartTimer(this.$1,j)};e.getLocalMediaStateVersion=function(){return this.$1.getLocalMediaStateVersion()};e.setLocalMediaStateVersion=function(a){var d=this;return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,c){d.$1.processEvent({onError:c,onSuccess:b,payload:{version:a},type:"setLocalMediaStateVersion"})}))};e.addLocalTracks=function(a,d,e,f){var g=this;return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,c){g.$1.processEvent({onError:c,onSuccess:b,payload:{callInitiator:f,callMedia:e,mediaMode:d,tracks:a},type:"addLocalTracks"})}))};e.removeLocalTrack=function(a){var d=this;return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,c){d.$1.processEvent({onError:c,onSuccess:b,payload:{trackId:a},type:"removeLocalTrack"})}))};e.replaceLocalTrack=function(a,d,e){var f=this;e===void 0&&(e=!1);return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,c){f.$1.processEvent({onError:c,onSuccess:b,payload:babelHelpers["extends"]({},e?{preserveOriginal:e}:{},{replacementTrack:d,trackIdToReplace:a}),type:"replaceLocalTrack"})}))};e.createDataChannel=function(a,d,e){var f=this;this.$23(d);this.$15==null&&c("FBLogger")("rtweb").warn("Data channel instantion role not setup properly");return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,g){f.$7.add(a);e&&f.$8.set(a,e);f.$1.processEvent({onError:g,onSuccess:b,payload:{dataChannelLabel:a,dataChannelOptions:e,onDataChannelMessage:function(b){f.$1.processEvent({onError:c("emptyFunction"),onSuccess:c("emptyFunction"),payload:{dataChannelLabel:a,dataMessage:b},type:"dataChannelMessageReceived"}),f.$10&&a==="data"&&f.maybeHandleSimulcastDataMessage(b)},onDataChannelOpen:function(){var b=f.$12.get(a);b==null?void 0:b.forEach(function(a){a()});f.$24(d);f.$16++},shouldEstablishDataChannel:(g=f.$15)!=null?g:!0},type:"createDataChannel"})}))};e.$23=function(a){this.$17||(this.$25("sctp_"+a.toString()+"_attempt"),this.$17=!0)};e.$24=function(a){this.$18||(this.$25("sctp_"+a.toString()+"_success"),this.$18=!0)};e.$25=function(a){(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_sctp",a)};e.onSimulcastSignalingDataMessage=function(a){this.$10&&this.$11&&this.maybeHandleSignalingSimulcastDataMessage(a)};e.createDataMessageSubscription=function(a,d){var e=this;if(!this.$9.has(a)){this.$9.set(a,d);return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,c){e.$1.processEvent({onError:c,onSuccess:b,payload:{dataChannelLabel:a,onSignalingDataMessage:d},type:"createDataMessageSubscription"})}))}return(i||(i=b("Promise"))).resolve()};e.removeDataMessageSubscription=function(a){var d=this;if(this.$9.has(a)){var e,f=(e=this.$9.get(a))!=null?e:function(){};this.$9["delete"](a);return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,c){d.$1.processEvent({onError:c,onSuccess:b,payload:{dataChannelLabel:a,onSignalingDataMessage:f},type:"removeDataMessageSubscription"})}))}return(i||(i=b("Promise"))).resolve()};e.getDataChannelOpenCount=function(){return this.$16};e.getDataChannelLabels=function(){return this.$7};e.getDataChannelOptions=function(a){return(a=this.$8.get(a))!=null?a:{}};e.getDataChannelState=function(a){return this.$4.getDataChannelState(a)};e.getDataMessageSubscriptions=function(){return this.$9};e.getSupportsSimulcastOverSignaling=function(){return this.$11};e.setShouldEstablishDataChannel=function(a){this.$15=a};e.setSupportsSimulcastOverSignaling=function(a){this.$11=a};e.setIceRestartEligible=function(a){this.$13=a&&d("ZenonBrowsers").supportsIceRestart(),this.$13||this.$14.clearIceRestartTimer()};e.getIceRestartEnabled=function(){return this.$13};e.localMediaStateUpdateRetry=function(a){var d=this;return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,c){var e=d.$1.getContext();e.retryCount<k&&(e.retryCount++,e.localMediaStateUpdateRetryTimerId=window.setTimeout(function(){d.$1.processEvent({onError:c,onSuccess:b,type:"localMediaStateUpdateRetry"})},a))}))};e.clearRetryCount=function(){var a=this.$1.getContext();a.retryCount=0};e.cancelPendingNegotiation=function(){var a=this;return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,c){a.$1.processEvent({onError:c,onSuccess:b,type:"remoteSdpFailed"})}))};e.muteRemoteTrack=function(a){var d=this;return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,c){d.$1.processEvent({onError:c,onSuccess:b,payload:{trackId:a},type:"muteRemoteTrack"})}))};e.unmuteRemoteTrack=function(a){var d=this;return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,c){d.$1.processEvent({onError:c,onSuccess:b,payload:{trackId:a},type:"unmuteRemoteTrack"})}))};e.muteLocalTrack=function(a){var d=this;return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,c){d.$1.processEvent({onError:c,onSuccess:b,payload:{trackId:a},type:"muteLocalTrack"})}))};e.unmuteLocalTrack=function(a){var d=this;return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,c){d.$1.processEvent({onError:c,onSuccess:b,payload:{trackId:a},type:"unmuteLocalTrack"})}))};e.stopLocalTrack=function(a){var d=this;return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,c){d.$1.processEvent({onError:c,onSuccess:b,payload:{trackId:a},type:"stopLocalTrack"})}))};e.applyLocalSdp=function(){var a=this;return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,c){a.$1.processEvent({onError:c,onSuccess:b,type:"applyLocalSdp"})}))};e.applyMediaUpdate=function(a){var d=this;return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,c){d.$1.processEvent({onError:c,onSuccess:b,payload:{mediaStates:a},type:"applyMediaUpdate"})}))};e.applyRemoteSdp=function(a,d,e,f,g,h,j,k){var l=this;return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,c){l.$1.processEvent({onError:c,onSuccess:b,payload:{e2eeServerState:k,mediaStates:d,messageID:j,onProcessed:h,renegotiationOffer:f,sdp:a,sdpOriginLocalId:g,source:e},type:"applyRemoteSdp"})}))};e.applyRemoteIceCandidate=function(a){var d=this;return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,c){d.$1.processEvent({onError:c,onSuccess:b,payload:a,type:"applyRemoteIceCandidate"})}))};e.forceEncodingEnabled=function(a){var d=this;return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,c){d.$1.processEvent({onError:c,onSuccess:b,payload:{enabled:a},type:"forceEncodingEnabled"})}))};e.end=function(a,d){var e=this;return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,c){e.$14.clearIceRestartTimer(),e.$1.processEvent({onError:c,onSuccess:b,payload:{restart:d,stopLocalTracks:a},type:"endCall"})}))};e.restart=function(){var a=this;return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,d){c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"Beginning the restart process on peer connection"}),c("promiseDone")(a.end(!1,!0)),a.$2.clearTracks(),a.$17=!1,a.$18=!1,a.$1.processEvent({onError:d,onSuccess:b,type:"restartPeerConnection"})}))};e.getTracks=function(){return this.$2.getTracks()};e.getLocalTracksForMWS=function(){return this.$2.getLocalTracksForMWS()};e.getRtpSenders=function(){return this.$4.getSenders()};e.getRtpReceivers=function(){return this.$4.getReceivers()};e.setPeerConnectionEventHandlers=function(a){this.$5=a};e.swapPeerConnectionEventHandlers=function(a){var b=this.$5;this.$5=a.$5;a.$5=b};e.setNetworkStatusListener=function(a){this.$2.setNetworkStatusListener(a)};e.registerTrackListener=function(a){this.$2.registerTrackListener(a)};e.setTrackListenersFromManager=function(a){this.$2.setTrackListenersFromManager(a.$2)};e.setLoggingEventHandler=function(a){this.$6=a};e.sendDataMessage=function(a,d){var e=this;return c("ZenonLogPromiseRejection")(new(i||(i=b("Promise")))(function(b,c){e.$4.sendDataMessage(a,d),b()}))};e.$19=function(){return{onConnectionDestroyed:this.$26("onConnectionDestroyed"),onConnectionDropped:this.$26("onConnectionDropped"),onConnectionEstablished:this.$26("onConnectionEstablished"),onCreateDataMessageSubscription:this.$26("onCreateDataMessageSubscription"),onDataChannelMessageReceived:this.$26("onDataChannelMessageReceived"),onIceCandidateReady:this.$26("onIceCandidateReady"),onLocalMediaStateUpdate:this.$26("onLocalMediaStateUpdate"),onLocalSdpSet:this.$26("onLocalSdpSet"),onRemoteSdpSet:this.$26("onRemoteSdpSet"),onRemoveDataMessageSubscription:this.$26("onRemoveDataMessageSubscription")}};e.$26=function(a){var c=this;return function(){if(c.$5&&c.$5[a]){var d;return(d=c.$5)[a].apply(d,arguments)}return(i||(i=b("Promise"))).resolve()}};e.maybeHandleSimulcastDataMessage=function(a){try{a=JSON.parse(a.message);a=a.body;a=a.videoUploadRequest;var b=a.perSsrcTargetBitrateBpsMap,e=a.qualityMask;if(a!=null&&(e!=null&&e!==0&&b!=null)){a=d("ZenonSimulcastDataMessageParser").parseSimulcastControlMessage({perSsrcTargetBitrateBpsMap:b,qualityMask:e});this.handleSimulcastUploadRequest(a)}}catch(a){c("FBLogger")("rtc_www").warn("MaybeHandleSimulcastDataMessage failed:",a)}};e.maybeHandleSignalingSimulcastDataMessage=function(a){try{a=JSON.parse(a.message);if(a.qualityMask!=null&&a.qualityMask!==0&&a.perSsrcTargetBitrateBpsMap!=null){a={perSsrcTargetBitrateBpsMap:a.perSsrcTargetBitrateBpsMap,qualityMask:a.qualityMask};a=d("ZenonSimulcastDataMessageParser").parseSimulcastControlMessage(a);this.handleSimulcastUploadRequest(a)}}catch(a){c("FBLogger")("rtc_www").warn("MaybeHandleSignalingSimulcastDataMessage failed:",a)}};e.handleSimulcastUploadRequest=function(a){var b,e;if(!d("ZenonSimulcastUtils").isCurrentBrowserCompatibleWithSimulcast()||!this.$4.supportsSimulcast()||typeof ((b=RTCRtpSender)==null?void 0:b.prototype.getParameters)!=="function"){c("ZenonMediaActionLogger").logCheckpoint("ZenonPeerConnectionManager: handleSimulcastUploadRequest: Simulcast not supported!");return}b=this.$4.getSenders().filter(function(a){return a.track&&a.track.kind==="video"});if(b.length===0){c("ZenonMediaActionLogger").logCheckpoint("ZenonPeerConnectionManager: handleSimulcastUploadRequest: No Senders!");return}b=b[0];if(!("getParameters"in b)||!("setParameters"in b))return;var f=this.$4.getTransceiverFromSender(b);if(!f){c("ZenonMediaActionLogger").logCheckpoint("ZenonPeerConnectionManager: handleSimulcastUploadRequest: Transceiver is null!");return}if(f.stopped)return;f=!1;var g=this.$2.getTracks();if((e=b.track)==null?void 0:e.id){g=g.get((e=b.track)==null?void 0:e.id);f=g&&g.contentType==="screen"}e=this.getTotalVideoParticipants();a=d("ZenonSimulcastManager").getSimulcastEncodingParameters(b.getParameters(),a,e,d("ZenonSimulcastManager").getSimulcastSsrcToLayerMap(((g=this.$3.getLocalSdp())==null?void 0:g.toDesc().sdp)||""),f,d("ZenonSimulcastUtils").getMaxNumLayers(),{height:(e=(a=b.track)==null?void 0:a.getSettings().height)!=null?e:720,width:(f=(g=b.track)==null?void 0:g.getSettings().width)!=null?f:1280},d("ZenonSimulcastManager").ALLOW_SCREENSHARE_SIMULCAST,d("ZenonSimulcastManager").MIN_NUM_ACTIVE_LAYERS);e=a.params;c("promiseDone")(b.setParameters(e))};e.getTotalVideoParticipants=function(){var a=this.$4.getTransceivers(),b=this.$4.getReceivers();if(a!=null&&a.length>0){a=a.filter(function(a){var b;return((b=a.receiver.track)==null?void 0:b.kind)==="video"&&a.currentDirection!=="inactive"&&((b=a.receiver.track)==null?void 0:b.readyState)==="live"});a=a.length}else{b=b.filter(function(a){return((a=a.track)==null?void 0:a.kind)==="video"});a=b.length+1}return a};e.renegotiateNullSenderTransport=function(){for(var a of this.getRtpSenders())if(a.transport==null){c("promiseDone")(this.applyLocalSdp());break}};return a}();g["default"]=a}),98);
__d("ZenonSdkMethod",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["ADD_LOCAL_TRACK","REGISTER_SERVICE_NODE_ID","REMOVE_LOCAL_TRACK","REPLACE_LOCAL_TRACK","MUTE_TRACK","UNMUTE_TRACK","STOP_LOCAL_TRACK","CREATE_DATA_MESSAGE_SUBSCRIPTION","REMOVE_DATA_MESSAGE_SUBSCRIPTION","SEND_GENERIC_DATA_MESSAGE","SUBSCRIBE_TO_REMOTE_VIDEO","JOIN","UNSUBSCRIBE_FROM_STATESYNC_TOPIC","SUBSCRIBE_TO_STATESYNC_TOPIC","UPDATE_STATESYNC_TOPIC","APPROVE_PARTICIPANTS","DENY_PARTICIPANTS","END_CALL","RING_PARTICIPANTS","REMOVE_PARTICIPANTS","FORCE_ENCODING_ENABLED"]);f.ZenonSdkMethod=a}),66);
__d("ZenonCallInstanceSDK",["QuickPerformanceLogger","Random","ZenonLoggingUtils","ZenonSdkMethod","ZenonTransportType","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a,b){this.$2=a,this.$1=b}var b=a.prototype;b.ringParticipants=function(a,b){return this.$3(this.$1.ringParticipants(this.$2,a,b),d("ZenonSdkMethod").ZenonSdkMethod.RING_PARTICIPANTS)};b.removeParticipants=function(a){return this.$3(this.$1.removeParticipants(this.$2,a),d("ZenonSdkMethod").ZenonSdkMethod.REMOVE_PARTICIPANTS)};b.forceEncodingEnabled=function(a){return this.$3(this.$1.forceEncodingEnabled(this.$2,a),d("ZenonSdkMethod").ZenonSdkMethod.FORCE_ENCODING_ENABLED)};b.addLocalTrack=function(a){return this.$3(this.$1.addLocalTrack(this.$2,a),d("ZenonSdkMethod").ZenonSdkMethod.ADD_LOCAL_TRACK,{string:{trackType:a.contentType}})};b.stopLocalTrack=function(a){return this.$3(this.$1.stopLocalTrack(this.$2,a),d("ZenonSdkMethod").ZenonSdkMethod.STOP_LOCAL_TRACK)};b.muteTrack=function(a,b){b===void 0&&(b=!1);return this.$3(this.$1.muteTrack(this.$2,a,b),d("ZenonSdkMethod").ZenonSdkMethod.MUTE_TRACK)};b.unmuteTrack=function(a,b){b===void 0&&(b=!1);return this.$3(this.$1.unmuteTrack(this.$2,a,b),d("ZenonSdkMethod").ZenonSdkMethod.UNMUTE_TRACK)};b.subscribeToRemoteVideo=function(a,b){return this.$3(this.$1.subscribeToRemoteVideo(this.$2,a,b),d("ZenonSdkMethod").ZenonSdkMethod.SUBSCRIBE_TO_REMOTE_VIDEO)};b.getLogIdentifiers=function(){return this.$1.getLogIdentifiers(this.$2)};b.unsubscribeFromStateSyncTopic=function(a){return this.$3(this.$1.unsubscribeFromStateSyncTopic(this.$2,a),d("ZenonSdkMethod").ZenonSdkMethod.UNSUBSCRIBE_FROM_STATESYNC_TOPIC)};b.subscribeToStateSyncTopic=function(a){return this.$3(this.$1.updateStateSyncTopic(this.$2,a,null),d("ZenonSdkMethod").ZenonSdkMethod.SUBSCRIBE_TO_STATESYNC_TOPIC)};b.replaceLocalTrack=function(a,b,c){c===void 0&&(c=!1);return this.$3(this.$1.replaceLocalTrack(this.$2,a,b,c),d("ZenonSdkMethod").ZenonSdkMethod.REPLACE_LOCAL_TRACK,{string:{trackType:b.contentType}})};b.removeLocalTrack=function(a){return this.$3(this.$1.removeLocalTrack(this.$2,a),d("ZenonSdkMethod").ZenonSdkMethod.REMOVE_LOCAL_TRACK)};b.createDataMessageSubscription=function(a,b,c,e){return this.$3(this.$1.createDataMessageSubscription(this.$2,a,b,c,e),d("ZenonSdkMethod").ZenonSdkMethod.CREATE_DATA_MESSAGE_SUBSCRIPTION)};b.removeDataMessageSubscription=function(a,b){return this.$3(this.$1.removeDataMessageSubscription(this.$2,a,b),d("ZenonSdkMethod").ZenonSdkMethod.REMOVE_DATA_MESSAGE_SUBSCRIPTION)};b.sendGenericDataMessage=function(a,b,c,e){e===void 0&&(e=d("ZenonTransportType").ZenonTransportType.SIGNALING);return this.$3(this.$1.sendGenericDataMessage(this.$2,a,b,c,e),d("ZenonSdkMethod").ZenonSdkMethod.SEND_GENERIC_DATA_MESSAGE)};b.registerDataMessageService=function(a,b){return this.$3(this.$1.registerDataMessageService(this.$2,a,b),d("ZenonSdkMethod").ZenonSdkMethod.REGISTER_SERVICE_NODE_ID)};b.submitRating=function(a,b,c,d,e){this.$1.submitRating(this.$2,a,b,c,d,e)};b.getConferenceName=function(){return this.$1.getConferenceName(this.$2)};b.getMediaMode=function(){return this.$1.getMediaMode(this.$2)};b.getSCTPDataChannelState=function(a){return this.$1.getSCTPDataChannelState(this.$2,a)};b.updateStateSyncTopic=function(a,b){return this.$3(this.$1.updateStateSyncTopic(this.$2,a,b),d("ZenonSdkMethod").ZenonSdkMethod.UPDATE_STATESYNC_TOPIC)};b.approveParticipants=function(a){return this.$3(this.$1.approveParticipants(this.$2,a),d("ZenonSdkMethod").ZenonSdkMethod.APPROVE_PARTICIPANTS)};b.denyParticipants=function(a){return this.$3(this.$1.denyParticipants(this.$2,a),d("ZenonSdkMethod").ZenonSdkMethod.DENY_PARTICIPANTS)};b.getSignalingProtocol=function(){return this.$1.getSignalingProtocol(this.$2)};b.getEncryptionKeysManagerState=function(){return this.$1.getEncryptionKeysManagerState(this.$2)};b.endCall=function(a,b){return this.$3(this.$1.endCall(this.$2,a,b),d("ZenonSdkMethod").ZenonSdkMethod.END_CALL)};b.join=function(a){var b=this;return this.$3(this.$1.join(babelHelpers["extends"]({clientCallID:this.$2},a)),d("ZenonSdkMethod").ZenonSdkMethod.JOIN).then(function(){return b})};b.initLogging=function(a){this.$1.initializeLogging(this.$2,a)};b.getClientCallID_DEPRECATED=function(){return this.$2};b.$3=function(a,b,e){e===void 0&&(e={});var f=c("qpl")._(398989351,"1493"),g=c("Random").uint32(),i=d("ZenonLoggingUtils").shouldAllowLogging();i&&(e.string?e.string.method=b:e.string={method:b},(h||(h=c("QuickPerformanceLogger"))).markerStart(f,g),h.markerAnnotate(f,e,{instanceKey:g}));return a.then(function(){i&&(h||(h=c("QuickPerformanceLogger"))).markerEnd(f,2,g)})["catch"](function(){i&&(h||(h=c("QuickPerformanceLogger"))).markerEnd(f,87,g)})};return a}();g["default"]=a}),98);
__d("ZenonOverlayConfigManager",["ChromeOverlayConfigLayer","EdgeOverlayConfigLayer","FirefoxOverlayConfigLayer","JSResourceForInteraction","OperaOverlayConfigLayer","OverlayConfigManager","Promise","UserAgentData"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("JSResourceForInteraction")("RTWebSignalingListener").__setRef("ZenonOverlayConfigManager");a=function(){function a(a){this.$1=a;this.$2=new(c("OverlayConfigManager"))();var b={Chrome:c("ChromeOverlayConfigLayer"),"Edge (Chromium Based)":c("EdgeOverlayConfigLayer"),"Edge PWA (Chromium Based)":c("EdgeOverlayConfigLayer"),Firefox:c("FirefoxOverlayConfigLayer"),Opera:c("OperaOverlayConfigLayer")};b=b[c("UserAgentData").browserName];b&&this.$2.layerManager.addLayer(b);a.appConfig&&this.$2.layerManager.addLayer(a.appConfig)}var d=a.prototype;d.getRelayEnvironment=function(){return this.$1.relayEnvironment};d.getSignalingListener=function(){var a=this;return this.$1.signalingListener?(h||(h=b("Promise"))).resolve(this.$1.signalingListener):new(h||(h=b("Promise")))(function(b){return i.load().then(function(c){a.$1.signalingListener=new c(),b(a.$1.signalingListener)})})};d.getConfigManager=function(){return this.$2};return a}();g["default"]=a}),98);
__d("ZenonSignalingIDType",["randomInt"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a}function b(){return c("randomInt")(0,4294967294)+1}g.convertNumberToZenonSignalingID=a;g.generateZenonSignalingID=b}),98);
__d("ZenonCallSDK",["EventEmitter","ZenonCallInstanceSDK","ZenonCallsManager","ZenonCallsModelEmitter","ZenonOverlayConfigManager","ZenonSignalingIDType","ZenonTransportEventEmitter","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var e;e=a.call(this)||this;b=new(c("ZenonOverlayConfigManager"))(b);e.$ZenonCallSDK$p_1=new(c("ZenonCallsManager"))(b);d("ZenonCallsModelEmitter").CallsModelEmitterInstance.addListener("callsModelUpdate",function(a){e.emit("callsModelUpdate",a)});c("ZenonTransportEventEmitter").addListener("transportPlatformEvent",function(a){e.emit("signalingEvent",a)});return e}var e=b.prototype;e.initSignaling=function(a,b,d,e){c("promiseDone")(this.$ZenonCallSDK$p_1.initializeSignaling(a,b,d,e))};e.createCall=function(){var a=String(d("ZenonSignalingIDType").generateZenonSignalingID());return new(c("ZenonCallInstanceSDK"))(a,this.$ZenonCallSDK$p_1)};e.getCallInstance=function(a){return new(c("ZenonCallInstanceSDK"))(a,this.$ZenonCallSDK$p_1)};e.getCurrentCallsModel=function(){return d("ZenonCallsModelEmitter").CallsModelEmitterInstance.getCallsModel()};e.updateRenderedResolutionMap=function(a){this.$ZenonCallSDK$p_1.updateRenderedResolutionMap(a)};return b}(c("EventEmitter"));g["default"]=a}),98);
__d("ZenonBackgroundBlurHooks",["fbt","Decoil","FBLogger","ODS","RPWebUXLogger","ZenonBackgroundBlurStopOnErrors","ZenonCallsContext","ZenonCallsHooks","ZenonLoggingHooks","ZenonVideoProcessingConstants","ZenonVideoProcessingContext","ZenonVideoProcessingTypeAtom","promiseDone","react","useDebouncedComet"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||d("react"),l=k.useCallback,m=k.useContext,n=k.useEffect,o=k.useState,p=200;function q(){var a=s(),b=d("ZenonLoggingHooks").useCheckpointLogging(),e=z(),f=y(),g=c("ZenonCallsHooks").useLocalVideo(),h=c("RPWebUXLogger").useClickEventLogger();return l(function(){!a?((j||(j=d("ODS"))).bumpEntityKey(4272,"zenon_product","background_blur_enabled"),h==null?void 0:h({component:"toggle_background_blur_button",eventName:"enable_background_blur"}),c("promiseDone")(e(g)),b("Background blur was enabled")):((j||(j=d("ODS"))).bumpEntityKey(4272,"zenon_product","background_blur_disabled"),h==null?void 0:h({component:"toggle_background_blur_button",eventName:"disable_background_blur"}),f(),b("Background blur was disabled"))},[a,h,e,g,b,f])}function a(a){a===void 0&&(a="background_blur");var b=d("Decoil").useDecoilState(d("ZenonVideoProcessingTypeAtom").ZenonVideoProcessingTypeAtom),e=b[0],f=b[1],g=s();b=o(!1);var h=b[0],i=b[1],j=q();b=l(function(){!g?(i(!0),f(a),j()):a!==e?f(a):j()},[g,e,a,f,j]);n(function(){h&&g&&i(!1)},[g,h]);var k=c("useDebouncedComet")(b,{wait:p});b=l(function(){k()},[k]);return{isLoading:h,toggleVideoProcessing:b}}function r(){var a=m(c("ZenonVideoProcessingContext"));a=a.videoProcessingState;var b=d("Decoil").useDecoilValue(d("ZenonVideoProcessingTypeAtom").ZenonVideoProcessingTypeAtom);return a===d("ZenonVideoProcessingConstants").ZenonVideoProcessingState.Active&&b==="background_blur"}function b(){var a=m(c("ZenonVideoProcessingContext"));a=a.videoProcessingState;var b=d("Decoil").useDecoilValue(d("ZenonVideoProcessingTypeAtom").ZenonVideoProcessingTypeAtom);return a===d("ZenonVideoProcessingConstants").ZenonVideoProcessingState.Active&&b==="replace_background"}function s(){var a=m(c("ZenonVideoProcessingContext"));a=a.videoProcessingState;return a===d("ZenonVideoProcessingConstants").ZenonVideoProcessingState.Active}function e(){var a=m(c("ZenonVideoProcessingContext"));a=a.videoProcessingState;return a===d("ZenonVideoProcessingConstants").ZenonVideoProcessingState.Paused}function f(){var a=m(c("ZenonVideoProcessingContext"));a=a.isVideoProcessingSupported;var b=c("ZenonCallsHooks").useLocalVideo();return(b==null?void 0:b.enabled)===!0&&a}function t(){var a=m(c("ZenonVideoProcessingContext"));a=a.start;d("ZenonBackgroundBlurStopOnErrors").useStopBackgroundBlurOnErrors();return a}function u(){var a=m(c("ZenonVideoProcessingContext")),b=a.pause;return l(function(a){b(a)},[b])}function v(){var a=m(c("ZenonVideoProcessingContext")),b=a.stop;return l(function(a){b(a)},[b])}function w(){var a=m(c("ZenonVideoProcessingContext"));a=a.processedStream;return a}function x(){var a=m(c("ZenonVideoProcessingContext"));a=a.originalVideoTrack;return a}function y(){var a=s(),b=m(c("ZenonVideoProcessingContext")),d=b.originalVideoTrack,e=b.stop;b=m(c("ZenonCallsContext"));var f=b.currentCallInstanceSDK,g=c("ZenonCallsHooks").useLocalVideo();return l(function(){a&&(g==null?void 0:g.enabled)&&e(function(){d!=null&&c("promiseDone")(f.replaceLocalTrack(g.trackId,d,!0),function(){g.webrtcTrack.stop()})})},[f,a,g==null?void 0:g.enabled,g==null?void 0:g.trackId,g==null?void 0:g.webrtcTrack,d,e])}function z(){var a=m(c("ZenonCallsContext")),b=a.currentCallInstanceSDK;a=m(c("ZenonVideoProcessingContext"));var d=a.start;return l(async function(a){try{var e=await d({trackToReplace:a});e!=null&&a!=null&&c("promiseDone")(b.replaceLocalTrack(a.trackId,e,!0))}catch(a){c("FBLogger")("rtc_www").catching(a).warn("Failed to start video processing")}},[d,b])}function A(a){var b=r(),d=m(c("ZenonVideoProcessingContext"));d=d.isVideoProcessingSupported;if(!d)return h._(/*BTDS*/"Background blur not available, use Chrome or Edge browser instead");if(a)return h._(/*BTDS*/"Background blur not available, your video is off");d=b?h._(/*BTDS*/"Turn off background blur"):h._(/*BTDS*/"Turn on background blur");return d}g.useToggleVideoProcessingAndReplaceTrack=q;g.useDebouncedToggleVideoProcessing=a;g.useIsBackgroundBlurActive=r;g.useIsVirtualBackgroundActive=b;g.useIsVideoProcessingActive=s;g.useIsVideoProcessingPaused=e;g.useCanToggle=f;g.useStartVideoProcessing=t;g.usePauseVideoProcessing=u;g.useStopVideoProcessing=v;g.useBlurredStream=w;g.useOriginalVideoTrack=x;g.useBackgroundBlurButtonTooltip=A}),226);
__d("ZenonBackgroundBlurStopOnErrors",["FBLogger","ZenonCallsHooks","ZenonCallsModelTypes","ZenonLocalAudioVideoHooks","ZenonVideoProcessingConstants","ZenonVideoProcessingContext","gkx","promiseDone","react"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");var i=b.useContext,j=b.useEffect;function a(){var a=i(c("ZenonVideoProcessingContext")),b=a.resetErrorState,e=a.start,f=a.videoProcessingState,g=c("ZenonCallsHooks").useCallState()===d("ZenonCallsModelTypes").ZenonCallState.New,h=c("ZenonCallsHooks").useMuteTrack();a=c("ZenonCallsHooks").useLocalVideo();var k=(a=a==null?void 0:a.trackId)!=null?a:"",l=c("ZenonLocalAudioVideoHooks").useDisableVideo();j(function(){if(!c("gkx")("528"))return;f===d("ZenonVideoProcessingConstants").ZenonVideoProcessingState.Error&&(c("FBLogger")("rtc_www").warn("Stopping local video because video processing is in the error state"),g||c("promiseDone")(h(k)),l("PRIMARY_VIDEO"),b())},[l,g,h,b,e,k,f])}g.useStopBackgroundBlurOnErrors=a}),98);